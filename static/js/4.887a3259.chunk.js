(this.webpackJsonptelegram_react=this.webpackJsonptelegram_react||[]).push([[4],Array(336).concat([function(e,t,a){"use strict";var n=a(7),r=a.n(n),i=a(13),o=a(8),s=a(9),c=a(11),l=a(10),u=a(21),d=a(339),p=a(16),h=a(2),m=new(function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;return Object(o.a)(this,a),(e=t.call(this)).reset=function(){e.callbacks=[],e.db=null,e.urls=new WeakMap,e.dataUrls=new Map,e.items=new Map,e.blobItems=new Map,e.locationItems=new Map,e.downloads=new Map,e.uploads=new Map},e.onUpdate=function(){var t=Object(i.a)(r.a.mark((function t(a){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=a["@type"],t.next="updateAuthorizationState"===t.t0?3:"updateFile"===t.t0?6:10;break;case 3:return t.next=5,e.onUpdateAuthorizationState(a);case 5:return t.abrupt("break",11);case 6:return e.set(a.file),e.onUpdateFile(a),e.emit(a["@type"],a),t.abrupt("break",11);case 10:return t.abrupt("break",11);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onClientUpdate=function(t){switch(t["@type"]){case"clientUpdateAudioThumbnailBlob":case"clientUpdateAudioBlob":case"clientUpdateDocumentBlob":case"clientUpdateSendFiles":e.emit(t["@type"],t)}},e.addTdLibListener=function(){h.a.on("update",e.onUpdate),h.a.on("clientUpdate",e.onClientUpdate)},e.removeTdLibListener=function(){h.a.off("update",e.onUpdate),h.a.off("clientUpdate",e.onClientUpdate)},e.onUpdateAuthorizationState=function(){var t=Object(i.a)(r.a.mark((function t(a){var n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return");case 2:if(n=a.authorization_state){t.next=5;break}return t.abrupt("return");case 5:t.t0=n["@type"],t.next="authorizationStateWaitTdlibParameters"===t.t0?8:"authorizationStateClosed"===t.t0?11:13;break;case 8:return t.next=10,e.initDB();case 10:return t.abrupt("break",13);case 11:return e.reset(),t.abrupt("break",13);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onUpdateFile=function(t){if(t){var a=t.file;a&&(e.handleDownloads(a),e.handleUploads(a))}},e.handleDownloads=function(t){var a=t.arr,n=t.id,r=(t.idb_key,t.local);if(delete t.arr,e.downloads.has(n)&&r.is_downloading_completed){0;var i=e.downloads.get(n);if(i){e.downloads.delete(n);var o=e.getStore();i.forEach((function(n){switch(n["@type"]){case"animation":e.handleAnimation(o,n,t,a,null);break;case"audio":e.handleAudio(o,n,t,a,null);break;case"chat":e.handleChat(o,n,t,a);break;case"document":e.handleDocument(o,n,t,a,null);break;case"game":e.handleGame(o,n,t,a,null);break;case"location":e.handleLocation(o,n,t,a,null);break;case"message":e.handleMessage(o,n,t,a);break;case"pageBlockMap":e.handlePageBlockMap(o,n,t,a,null);break;case"photo":e.handlePhoto(o,n,t,a,null);break;case"sticker":e.handleSticker(o,n,t,a,null);break;case"video":e.handleVideo(o,n,t,a,null);break;case"videoNote":e.handleVideoNote(o,n,t,a,null);break;case"voiceNote":e.handleVoiceNote(o,n,t,a,null);break;case"user":e.handleUser(o,n,t,a);break;default:console.error("FileStore.onUpdateFile unhandled item",n)}}))}}},e.handleUploads=function(t){var a=t.id,n=t.remote;delete t.arr,e.uploads.has(a)&&(n.is_uploading_completed||e.uploads.delete(a))},e.handleChat=function(t,a,n,r){a&&e.getLocalFile(t,n,r,(function(){return e.updateChatPhotoBlob(a.id,n.id)}),(function(){return e.getRemoteFile(n.id,p.f,a)}))},e.handleUser=function(t,a,n,r){a&&e.getLocalFile(t,n,r,(function(){return e.updateUserPhotoBlob(a.id,n.id)}),(function(){return e.getRemoteFile(n.id,p.f,a)}))},e.handleMessage=function(t,a,n,r){if(a){var i=a.content;if(i)switch(i["@type"]){case"messageAnimation":var o=i.animation;e.handleAnimation(t,o,n,r,a);break;case"messageAudio":var s=i.audio;e.handleAudio(t,s,n,r,a);break;case"messageChatChangePhoto":var c=i.photo;e.handlePhoto(t,c,n,r,a);break;case"messageDocument":var l=i.document;e.handleDocument(t,l,n,r,a);break;case"messageGame":var u=i.game;e.handleGame(t,u,n,r,a);break;case"messageLocation":var d=i.location;e.handleLocation(t,d,n,r,a);break;case"messagePhoto":var p=i.photo;e.handlePhoto(t,p,n,r,a);break;case"messageSticker":var h=i.sticker;e.handleSticker(t,h,n,r,a);break;case"messageText":var m=i.web_page;if(!m)break;var f=m.animation,g=m.audio,v=m.document,b=m.photo,C=m.sticker,y=m.video,k=m.video_note,E=m.voice_note;f&&e.handleAnimation(t,f,n,r,a),g&&e.handleAudio(t,g,n,r,a),v&&e.handleDocument(t,v,n,r,a),b&&e.handlePhoto(t,b,n,r,a),C&&e.handleSticker(t,C,n,r,a),y&&e.handleVideo(t,y,n,r,a),E&&e.handleVoiceNote(t,E,n,r,a),k&&e.handleVideoNote(t,k,n,r,a);break;case"messageVenue":var S=i.venue.location;e.handleLocation(t,S,n,r,a);break;case"messageVideo":var O=i.video;e.handleVideo(t,O,n,r,a);break;case"messageVideoNote":var U=i.video_note;e.handleVideoNote(t,U,n,r,a);break;case"messageVoiceNote":var w=i.voice_note;e.handleVoiceNote(t,w,n,r,a)}}},e.handleAnimation=function(t,a,n,r,i){var o=i?i.chat_id:0,s=i?i.id:0;if(a.thumbnail){var c=a.thumbnail.photo;c&&c.id===n.id&&e.getLocalFile(t,c,r,(function(){return e.updateAnimationThumbnailBlob(o,s,n.id)}),(function(){return e.getRemoteFile(n.id,p.ob,i||a)}))}if(a.animation){var l=a.animation;l&&l.id===n.id&&e.getLocalFile(t,l,r,(function(){return e.updateAnimationBlob(o,s,n.id)}),(function(){return e.getRemoteFile(n.id,p.f,i||a)}))}},e.handleAudio=function(t,a,n,r,i){var o=i?i.chat_id:0,s=i?i.id:0;if(a.album_cover_thumbnail){var c=a.album_cover_thumbnail.photo;c&&c.id===n.id&&e.getLocalFile(t,c,r,(function(){return e.updateAudioThumbnailBlob(o,s,n.id)}),(function(){return e.getRemoteFile(n.id,p.ob,i||a)}))}if(a.audio){var l=a.audio;l&&l.id===n.id&&e.getLocalFile(t,l,r,(function(){return e.updateAudioBlob(o,s,n.id)}),(function(){return e.getRemoteFile(n.id,p.f,i||a)}))}},e.handleGame=function(t,a,n,r,i){if(a){var o=a.animation,s=a.photo;s&&e.handlePhoto(t,s,n,r,i),o&&e.handleAnimation(t,o,n,r,i)}},e.handleDocument=function(t,a,n,r,i){var o=i?i.chat_id:0,s=i?i.id:0;if(a.thumbnail){var c=a.thumbnail.photo;c&&c.id===n.id&&e.getLocalFile(t,c,r,(function(){return e.updateDocumentThumbnailBlob(o,s,n.id)}),(function(){return e.getRemoteFile(n.id,p.ob,i||a)}))}if(a.document){var l=a.document;l&&l.id===n.id&&e.getLocalFile(t,l,r,(function(){return e.updateDocumentBlob(o,s,n.id)}),(function(){return e.getRemoteFile(n.id,p.f,i||a)}))}},e.handleLocation=function(t,a,n,r,i){var o=i?i.chat_id:0,s=i?i.id:0,c=Object(d.p)(a);if(c){var l=e.getLocationFile(c);l&&l.id===n.id&&e.getLocalFile(t,l,r,(function(){return e.updateLocationBlob(o,s,n.id)}),(function(){return e.getRemoteFile(n.id,p.ob,i||a)}))}},e.handlePageBlockMap=function(t,a,n,r,i){var o=i?i.chat_id:0,s=i?i.id:0,c=a.location,l=Object(d.p)(c,p.h,p.g);if(l){var u=e.getLocationFile(l);u&&u.id===n.id&&e.getLocalFile(t,u,r,(function(){return e.updateLocationBlob(o,s,n.id)}),(function(){return e.getRemoteFile(n.id,p.ob,i||a)}))}},e.handlePhoto=function(t,a,n,r,i){var o=i?i.chat_id:0,s=i?i.id:0;if(a)for(var c=0;c<a.sizes.length;c++){var l=a.sizes[c];if(l){var u=l.photo;if(u&&u.id===n.id){e.getLocalFile(t,u,r,(function(){return e.updatePhotoBlob(o,s,n.id)}),(function(){return e.getRemoteFile(n.id,p.f,i||a)}));break}}}},e.handleSticker=function(t,a,n,r,i){var o=i?i.chat_id:0,s=i?i.id:0;if(a.thumbnail){var c=a.thumbnail.photo;c&&c.id===n.id&&e.getLocalFile(t,c,r,(function(){return e.updateStickerThumbnailBlob(o,s,n.id)}),(function(){return e.getRemoteFile(n.id,p.ob,i||a)}))}if(a.sticker){var l=a.sticker;l&&l.id===n.id&&e.getLocalFile(t,l,r,(function(){return e.updateStickerBlob(o,s,n.id)}),(function(){return e.getRemoteFile(n.id,p.f,i||a)}))}},e.handleVoiceNote=function(t,a,n,r,i){var o=i?i.chat_id:0,s=i?i.id:0;if(a.voice){var c=a.voice;c&&c.id===n.id&&e.getLocalFile(t,c,r,(function(){return e.updateVoiceNoteBlob(o,s,n.id)}),(function(){return e.getRemoteFile(n.id,p.f,i||a)}))}},e.handleVideoNote=function(t,a,n,r,i){var o=i?i.chat_id:0,s=i?i.id:0;if(a.thumbnail){var c=a.thumbnail.photo;c&&c.id===n.id&&e.getLocalFile(t,c,r,(function(){return e.updateVideoNoteThumbnailBlob(o,s,n.id)}),(function(){return e.getRemoteFile(n.id,p.ob,i||a)}))}if(a.video){var l=a.video;l&&l.id===n.id&&e.getLocalFile(t,l,r,(function(){return e.updateVideoNoteBlob(o,s,n.id)}),(function(){return e.getRemoteFile(n.id,p.f,i||a)}))}},e.handleVideo=function(t,a,n,r,i){var o=i?i.chat_id:0,s=i?i.id:0;if(a.thumbnail){var c=a.thumbnail.photo;c&&c.id===n.id&&e.getLocalFile(t,c,r,(function(){return e.updateVideoThumbnailBlob(o,s,n.id)}),(function(){return e.getRemoteFile(n.id,p.ob,i||a)}))}if(a.video){var l=a.video;l&&l.id===n.id&&e.getLocalFile(t,l,r,(function(){return e.updateVideoBlob(o,s,n.id)}),(function(){return e.getRemoteFile(n.id,p.f,i||a)}))}},e.deleteLocalFile=function(e,t){},e.get=function(t){return e.items.get(t)},e.set=function(t){e.items.set(t.id,t)},e.getBlob=function(t){return e.blobItems.get(t)},e.setBlob=function(t,a){e.blobItems.set(t,a)},e.deleteBlob=function(t){e.blobItems.delete(t)},e.getLocationFile=function(t){var a=e.locationItems.get(t);return e.get(a)},e.setLocationFile=function(t,a){e.locationItems.set(t,a.id),e.set(a)},e.getDataUrl=function(t){return t&&e.dataUrls.has(t)?e.dataUrls.get(t):null},e.setDataUrl=function(t,a){e.dataUrls.set(t,a)},e.deleteDataUrl=function(t){e.dataUrls.delete(t)},e.getBlobUrl=function(t){if(!t)return null;if(e.urls.has(t))return e.urls.get(t);var a=URL.createObjectURL(t);return e.urls.set(t,a),a},e.deleteBlobUrl=function(t){e.urls.has(t)&&e.urls.delete(t)},e.updatePhotoBlob=function(t,a,n){e.emit("clientUpdatePhotoBlob",{chatId:t,messageId:a,fileId:n})},e.updateAudioThumbnailBlob=function(e,t,a){h.a.clientUpdate({"@type":"clientUpdateAudioThumbnailBlob",chatId:e,messageId:t,fileId:a})},e.updateAudioBlob=function(e,t,a){h.a.clientUpdate({"@type":"clientUpdateAudioBlob",chatId:e,messageId:t,fileId:a})},e.updateVoiceNoteBlob=function(t,a,n){e.emit("clientUpdateVoiceNoteBlob",{chatId:t,messageId:a,fileId:n})},e.updateVideoNoteThumbnailBlob=function(t,a,n){e.emit("clientUpdateVideoNoteThumbnailBlob",{chatId:t,messageId:a,fileId:n})},e.updateVideoNoteBlob=function(t,a,n){e.emit("clientUpdateVideoNoteBlob",{chatId:t,messageId:a,fileId:n})},e.updateAnimationThumbnailBlob=function(t,a,n){e.emit("clientUpdateAnimationThumbnailBlob",{chatId:t,messageId:a,fileId:n})},e.updateAnimationBlob=function(t,a,n){e.emit("clientUpdateAnimationBlob",{chatId:t,messageId:a,fileId:n})},e.updateDocumentBlob=function(e,t,a){h.a.clientUpdate({"@type":"clientUpdateDocumentBlob",chatId:e,messageId:t,fileId:a})},e.updateVideoThumbnailBlob=function(t,a,n){e.emit("clientUpdateVideoThumbnailBlob",{chatId:t,messageId:a,fileId:n})},e.updateVideoBlob=function(t,a,n){e.emit("clientUpdateVideoBlob",{chatId:t,messageId:a,fileId:n})},e.updateStickerThumbnailBlob=function(t,a,n){e.emit("clientUpdateStickerThumbnailBlob",{chatId:t,messageId:a,fileId:n})},e.updateStickerBlob=function(t,a,n){e.emit("clientUpdateStickerBlob",{chatId:t,messageId:a,fileId:n})},e.updateLocationBlob=function(t,a,n){e.emit("clientUpdateLocationBlob",{chatId:t,messageId:a,fileId:n})},e.updateDocumentThumbnailBlob=function(t,a,n){e.emit("clientUpdateDocumentThumbnailBlob",{chatId:t,messageId:a,fileId:n})},e.reset(),e.addTdLibListener(),e}return Object(s.a)(a,[{key:"initDB",value:function(){var e=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.db){e.next=3;break}return t&&t(),e.abrupt("return");case 3:if(!this.initiatingDB){e.next=6;break}return t&&this.callbacks.push(t),e.abrupt("return");case 6:return t&&this.callbacks.push(t),this.initiatingDB=!0,e.next=10,this.openDB().catch((function(e){return console.log("[FileStore] initDB error",e)}));case 10:if(this.db=e.sent,this.initiatingDB=!1,this.callbacks.length){for(a=0;a<this.callbacks.length;a++)this.callbacks[a]();this.callbacks=[]}case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"openDB",value:function(){return new Promise((function(e,t){var a=window.indexedDB.open("tdlib");a.onsuccess=function(){return e(a.result)},a.onerror=function(){return t(a.error)}}))}},{key:"getStore",value:function(){}},{key:"getReadWriteStore",value:function(){}},{key:"getLocalFile",value:function(e,t,a,n,o){var s=this;return(t=this.get(t.id)||t)&&t.local&&!t.local.is_downloading_completed?void o():void function(){var e=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.send({"@type":"readFile",file_id:t.id});case 2:a=e.sent,s.setBlob(t.id,a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(t).then(n,o)}},{key:"getRemoteFile",value:function(e,t,a){var n=this.downloads.get(e)||[];n.some((function(e){return e===a}))||(n.push(a),this.downloads.set(e,n),h.a.send({"@type":"downloadFile",file_id:e,priority:t}))}},{key:"cancelGetRemoteFile",value:function(e,t){if(this.downloads.has(e)){if(t){var a=this.downloads.get(e).filter((function(e){return e!==t}));this.downloads.set(e,a)}else this.downloads.delete(e);h.a.send({"@type":"cancelDownloadFile",file_id:e,only_if_pending:!1})}}},{key:"uploadFile",value:function(e,t){this.uploads.has(e)?this.uploads.get(e).push(t):this.uploads.set(e,[t]);console.log("[perf] uploadFile file_id="+e)}},{key:"cancelUploadFile",value:function(e,t){this.uploads.has(e)&&(this.uploads.delete(e),console.log("cancel_upload_message id="+t.id),h.a.send({"@type":"deleteMessages",chat_id:t.chat_id,message_ids:[t.id],revoke:!0}))}},{key:"updateUserPhotoBlob",value:function(e,t){this.emit("clientUpdateUserBlob",{userId:e,fileId:t})}},{key:"updateChatPhotoBlob",value:function(e,t){this.emit("clientUpdateChatBlob",{chatId:e,fileId:t})}}]),a}(u.a));window.file=m,t.a=m},function(e,t,a){"use strict";a.d(t,"J",(function(){return Q})),a.d(t,"o",(function(){return ee})),a.d(t,"j",(function(){return ae})),a.d(t,"a",(function(){return ue})),a.d(t,"G",(function(){return he})),a.d(t,"A",(function(){return Oe})),a.d(t,"s",(function(){return we})),a.d(t,"r",(function(){return Me})),a.d(t,"h",(function(){return b})),a.d(t,"y",(function(){return Y})),a.d(t,"x",(function(){return le})),a.d(t,"H",(function(){return pe})),a.d(t,"b",(function(){return de})),a.d(t,"z",(function(){return ge})),a.d(t,"I",(function(){return ve})),a.d(t,"t",(function(){return ye})),a.d(t,"u",(function(){return Ee})),a.d(t,"v",(function(){return Se})),a.d(t,"w",(function(){return Ne})),a.d(t,"B",(function(){return V})),a.d(t,"E",(function(){return Ie})),a.d(t,"C",(function(){return Ue})),a.d(t,"D",(function(){return z})),a.d(t,"F",(function(){return Ce})),a.d(t,"K",(function(){return X})),a.d(t,"c",(function(){return $})),a.d(t,"i",(function(){return ie})),a.d(t,"k",(function(){return ne})),a.d(t,"q",(function(){return je})),a.d(t,"l",(function(){return _e})),a.d(t,"e",(function(){return xe})),a.d(t,"f",(function(){return Te})),a.d(t,"m",(function(){return Le})),a.d(t,"g",(function(){return Pe})),a.d(t,"n",(function(){return re})),a.d(t,"p",(function(){return te})),a.d(t,"d",(function(){return Re}));var n=a(7),r=a.n(n),i=a(60),o=a(13),s=a(22),c=a(338),l=a(344),u=a(339),d=a(16),p=a(38),h=a(336),m=a(129),f=a(77),g=a(2);function v(e){return e?e<1024?"".concat(e," B"):e<1048576?"".concat((e/1024).toFixed(1)," KB"):e<1073741824?"".concat((e/1024/1024).toFixed(1)," MB"):"".concat((e/1024/1024/1024).toFixed(1)," GB"):"0 B"}function b(e){if(!e)return"";var t=e.size;return t?v(t):""}function C(e,t){if("undefined"!==typeof window.navigator.msSaveBlob)window.navigator.msSaveBlob(e,t);else{var a=window.URL.createObjectURL(e),n=document.createElement("a");n.style.display="none",n.href=a,n.setAttribute("download",t),"undefined"===typeof n.download&&n.setAttribute("target","_blank"),document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(a)}}function y(e,t,a){return k.apply(this,arguments)}function k(){return(k=Object(o.a)(r.a.mark((function e(t,a,n){var i,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:if(n){e.next=4;break}return e.abrupt("return");case 4:if(n.length){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,g.a.send({"@type":"getMessages",chat_id:a,message_ids:n});case 8:for((i=e.sent).messages=i.messages.map((function(e,t){return e||{"@type":"deletedMessage",chat_id:a,id:n[t],content:null}})),m.a.setItems(i.messages),o=n.length-1;o>=0;o--)m.a.emit("getMessageResult",m.a.get(a,n[o]));E(h.a.getStore(),i.messages);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e,t){for(var a=t.length-1;a>=0;a--){var n=t[a];if(n){var r=n.content;if(r)switch(r["@type"]){case"messageAnimation":I(e,r.animation,n);break;case"messageAudio":O(e,r.audio,n);break;case"messageChatChangePhoto":A(e,r.photo,n);break;case"messageDocument":x(e,r.document,n);break;case"messageGame":L(e,r.game,n);break;case"messagePhoto":A(e,r.photo,n);break;case"messageSticker":z(e,r.sticker,n);break;case"messageText":var i=r.web_page;if(!i)break;var o=i.animation,s=i.audio,c=i.document,l=i.photo,u=i.sticker,d=i.video,p=i.video_note;if(l){A(e,l,n);break}if(o){I(e,o,n);break}if(s){O(e,s,n);break}if(c){x(e,c,n);break}if(u){z(e,u,n);break}if(d){Z(e,d,n);break}if(p){K(e,p,n);break}break;case"messageVideo":Z(e,r.video,n);break;case"messageVideoNote":K(e,r.video_note,n)}}}}function S(e,t,a){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t){var r=t.audio;if(r){var i=r=h.a.get(r.id)||r,o=i.id,s=i.size,c=h.a.getBlob(o);if(!c){var l=a?a.chat_id:0,u=a?a.id:0;h.a.getLocalFile(e,r,null,(function(){return h.a.updateAudioBlob(l,u,o)}),(function(){(!n||s&&s<d.X)&&h.a.getRemoteFile(o,d.f,a||t)}))}}}}function O(e,t,a){if(!t)return!1;var n=t.album_cover_thumbnail;if(!n)return!1;var r=n.photo;if(!r)return!1;var i=(r=h.a.get(r.id)||r).id;if(h.a.getBlob(r.id))return!0;var o=a?a.chat_id:0,s=a?a.id:0;return h.a.getLocalFile(e,r,null,(function(){return h.a.updateAudioThumbnailBlob(o,s,i)}),(function(){return h.a.getRemoteFile(i,d.ob,a||t)})),!0}function U(e){var t=e.animation;if(t){var a=t.id;t.blob||h.a.getBlob(a)||h.a.cancelGetRemoteFile(a)}}function w(e,t,a){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t){var r=t.animation;if(r){var i=r=h.a.get(r.id)||r,o=i.id,s=i.size,c=h.a.getBlob(o);if(!c){var l=a?a.chat_id:0,u=a?a.id:0;h.a.getLocalFile(e,r,null,(function(){return h.a.updateAnimationBlob(l,u,o)}),(function(){(!n||s&&s<d.W)&&h.a.getRemoteFile(o,d.f,a||t)}))}}}}function M(e){if(e){var t=e.thumbnail;if(t){var a=t.photo;if(a){var n=(a=h.a.get(a.id)||a).id;h.a.getBlob(n)||h.a.cancelGetRemoteFile(n)}}}}function I(e,t,a){if(!t)return!1;var n=t.thumbnail;if(!n)return!1;var r=n.photo;if(!r)return!1;var i=(r=h.a.get(r.id)||r).id;if(h.a.getBlob(r.id))return!0;var o=a?a.chat_id:0,s=a?a.id:0;return h.a.getLocalFile(e,r,null,(function(){return h.a.updateAnimationThumbnailBlob(o,s,i)}),(function(){return h.a.getRemoteFile(i,d.ob,a||t)})),!0}function j(e,t,a){if(t&&a){var n=t.user_id,r=f.a.get(n);r&&be(e,r)}}function _(e,t,a){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t){var r=t.document;if(r){var i=r=h.a.get(r.id)||r,o=i.id,s=i.size,c=h.a.getBlob(o);if(!c){var l=a?a.chat_id:0,u=a?a.id:0;h.a.getLocalFile(e,r,null,(function(){return h.a.updateDocumentBlob(l,u,o)}),(function(){(!n||s&&s<d.Y)&&h.a.getRemoteFile(o,d.f,a||t)}))}}}}function x(e,t,a){if(!t)return!1;var n=t.thumbnail;if(!n)return!1;var r=n.photo;if(!r)return!1;var i=(r=h.a.get(r.id)||r).id;if(h.a.getBlob(r.id))return!0;var o=a?a.chat_id:0,s=a?a.id:0;return h.a.getLocalFile(e,r,null,(function(){return h.a.updateDocumentThumbnailBlob(o,s,i)}),(function(){return h.a.getRemoteFile(i,d.ob,a||t)})),!0}function T(e,t,a){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t){var r=t.animation;w(e,r,a,n)}}function L(e,t,a){if(!t)return!1;var n=t.photo;return I(e,t.animation,a)||A(e,n,a),!0}function P(){return(P=Object(o.a)(r.a.mark((function e(t,a,n){var i,o,s,c,l,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:if(i=a.location,o=Object(u.p)(i,d.h,d.g)){e.next=6;break}return e.abrupt("return");case 6:if(s=h.a.getLocationFile(o)){e.next=13;break}return e.next=10,g.a.send({"@type":"getMapThumbnailFile",location:i,width:d.h,height:d.g,zoom:d.p,scale:d.n,chat_id:n?n.chat_id:0});case 10:s=e.sent,h.a.setLocationFile(o,s),t=h.a.getStore();case 13:if(s=h.a.get(s.id)||s,c=s.id,!h.a.getBlob(s.id)){e.next=18;break}return e.abrupt("return");case 18:l=n?n.chat_id:0,p=n?n.id:0,h.a.getLocalFile(t,s,null,(function(){return h.a.updateLocationBlob(l,p,c)}),(function(){return h.a.getRemoteFile(c,d.f,n||a)}));case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e,t,a){return D.apply(this,arguments)}function D(){return(D=Object(o.a)(r.a.mark((function e(t,a,n){var i,o,s,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:if(i=Object(u.p)(a)){e.next=5;break}return e.abrupt("return");case 5:if(o=h.a.getLocationFile(i)){e.next=12;break}return e.next=9,g.a.send({"@type":"getMapThumbnailFile",location:a,width:d.o,height:d.m,zoom:d.p,scale:d.n,chat_id:n?n.chat_id:0});case 9:o=e.sent,h.a.setLocationFile(i,o),t=h.a.getStore();case 12:if(o=h.a.get(o.id)||o,s=o.id,!h.a.getBlob(o.id)){e.next=17;break}return e.abrupt("return");case 17:c=n?n.chat_id:0,l=n?n.id:0,h.a.getLocalFile(t,o,null,(function(){return h.a.updateLocationBlob(c,l,s)}),(function(){return h.a.getRemoteFile(s,d.f,n||a)}));case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e){if(e){var t=e.sizes;if(t){var a=Object(s.n)(t,d.B);if(a){var n=a.photo;if(n){var r=(n=h.a.get(n.id)||n).id;h.a.getBlob(r)||h.a.cancelGetRemoteFile(r)}}}}}function B(e,t,a){if(t){var n=t.sizes;if(n){var r=Object(s.n)(n,d.B);if(r){var i=r.photo;if(i){var o=(i=h.a.get(i.id)||i).id;if(!h.a.getBlob(o)){var c=a?a.chat_id:0,l=a?a.id:0;h.a.getLocalFile(e,i,null,(function(){return h.a.updatePhotoBlob(c,l,o)}),(function(){return h.a.getRemoteFile(o,d.f,a||t)}))}}}}}}function A(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:d.F;if(t){var r=t.sizes;if(r){var i=Object(s.k)(r,n);if(i){var o=i.photo;if(o){var c=o=h.a.get(o.id)||o,l=c.id,u=h.a.getBlob(l);if(!u){var p=a?a.chat_id:0,m=a?a.id:0;h.a.getLocalFile(e,o,null,(function(){return h.a.updatePhotoBlob(p,m,l)}),(function(){return h.a.getRemoteFile(l,d.f,a||t)}))}}}}}}function F(e,t,a){if(!t)return!1;if(!a)return!1;var n=Object(s.l)(t.sizes);if(!n)return!1;if(Object(s.k)(t.sizes)!==n){var r=n.photo;if(!r)return!1;var i=(r=h.a.get(r.id)||r).id;return h.a.getBlob(i)||h.a.getLocalFile(e,r,null,(function(){return h.a.updatePhotoBlob(a.chat_id,a.id,i)}),(function(){return h.a.getRemoteFile(i,d.ob,a)})),!0}}function V(e,t,a){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t){var r=t.sticker;if(r){var i=r=h.a.get(r.id)||r,o=i.id,s=i.size,c=h.a.getBlob(o);if(!c){var l=a?a.chat_id:0,u=a?a.id:0;h.a.getLocalFile(e,r,null,(function(){return h.a.updateStickerBlob(l,u,o)}),(function(){(!n||s&&s<d.Z)&&h.a.getRemoteFile(o,d.f,a||t)}))}}}}function z(e,t,a){if(!t)return!1;var n=t.thumbnail;if(!n)return!1;var r=n.photo;if(!r)return!1;var i=(r=h.a.get(r.id)||r).id;if(h.a.getBlob(i))return!0;var o=a?a.chat_id:0,s=a?a.id:0;return h.a.getLocalFile(e,r,null,(function(){return h.a.updateStickerThumbnailBlob(o,s,i)}),(function(){return h.a.getRemoteFile(i,d.ob,a||t)})),!0}function H(e){if(e){var t=e.video;if(t){var a=(t=h.a.get(t.id)||t).id;h.a.getBlob(a)||h.a.cancelGetRemoteFile(a)}}}function W(e,t,a){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t){var r=t.video;if(r){var i=r=h.a.get(r.id)||r,o=i.id,s=i.size,c=h.a.getBlob(o);if(!c){var l=a?a.chat_id:0,u=a?a.id:0;h.a.getLocalFile(e,r,null,(function(){return h.a.updateVideoBlob(l,u,o)}),(function(){(!n||s&&s<d.bb)&&h.a.getRemoteFile(o,d.f,a||t)}))}}}}function G(e){if(e){var t=e.thumbnail;if(!t)return!1;var a=t.photo;if(!a)return!1;var n=(a=h.a.get(a.id)||a).id;if(h.a.getBlob(n))return!0;h.a.cancelGetRemoteFile(n)}}function Z(e,t,a){if(!t)return!1;var n=t.thumbnail;if(!n)return!1;var r=n.photo;if(!r)return!1;var i=(r=h.a.get(r.id)||r).id;if(h.a.getBlob(i))return!0;var o=a?a.chat_id:0,s=a?a.id:0;return h.a.getLocalFile(e,r,null,(function(){return h.a.updateVideoThumbnailBlob(o,s,i)}),(function(){return h.a.getRemoteFile(i,d.ob,a||t)})),!0}function q(e,t,a){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t){var r=t.video;if(r){var i=r=h.a.get(r.id)||r,o=i.id,s=i.size,c=h.a.getBlob(o);if(!c){var l=a?a.chat_id:0,u=a?a.id:0;h.a.getLocalFile(e,r,null,(function(){return h.a.updateVideoNoteBlob(l,u,o)}),(function(){(!n||s&&s<d.ab)&&h.a.getRemoteFile(o,d.f,a||t)}))}}}}function K(e,t,a){if(!t)return!1;var n=t.thumbnail;if(!n)return!1;var r=n.photo;if(!r)return!1;var i=(r=h.a.get(r.id)||r).id;if(h.a.getBlob(i))return!0;var o=a?a.chat_id:0,s=a?a.id:0;return h.a.getLocalFile(e,r,null,(function(){return h.a.updateVideoNoteThumbnailBlob(o,s,i)}),(function(){return h.a.getRemoteFile(i,d.ob,a||t)})),!0}function J(e,t,a){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t){var r=t.voice;if(r){var i=r=h.a.get(r.id)||r,o=i.id,s=i.size,c=h.a.getBlob(o);if(!c){var l=a?a.chat_id:0,u=a?a.id:0;h.a.getLocalFile(e,r,null,(function(){return h.a.updateVoiceNoteBlob(l,u,o)}),(function(){(!n||s&&s<d.cb)&&h.a.getRemoteFile(o,d.f,a||t)}))}}}}function Y(e,t){for(var a=new Map,n=0,r=new Map,o=t.length-1;o>=0;o--){var s=t[o];if(s){var c=s.chat_id,l=s.content,u=s.sender_user_id,d=s.reply_to_message_id;if(u&&a.set(u,u),d&&(n=c,r.set(d,d)),l)switch(l["@type"]){case"messageAnimation":var p=l.animation;w(e,p,s),I(e,p,s);break;case"messageAudio":var h=l.audio;S(e,h,s),O(e,h,s);break;case"messageChatChangePhoto":var m=l.photo;A(e,m,s),B(e,m,s);break;case"messageContact":j(e,l.contact,s);break;case"messageDocument":var f=l.document;_(e,f,s),x(e,f,s);break;case"messageGame":var g=l.game;T(e,g,s),L(e,g,s);break;case"messageLocation":N(e,l.location,s);break;case"messageText":var v=l.web_page;if(!v)break;var b=v.animation,C=v.audio,k=v.document,E=v.photo,U=v.sticker,M=v.video,P=v.video_note,D=v.voice_note,R=!0;b&&(w(e,b,s),R=!I(e,b,s)),C&&(S(e,C,s),R=!O(e,C,s)),k&&(_(e,k,s),R=!x(e,k,s)),U&&(V(e,U,s),R=!z(e,U,s)),M&&(R=!Z(e,M,s)),P&&(q(e,P,s),R=!K(e,P,s)),D&&J(e,D,s),R&&(B(e,E,s),A(e,E,s),F(e,E,s));break;case"messagePhoto":var H=l.photo;B(e,H,s),A(e,H,s),F(e,H,s);break;case"messageSticker":var W=l.sticker;V(e,W,s),z(e,W,s);break;case"messageVenue":N(e,l.venue.location,s);break;case"messageVideo":Z(e,l.video,s);break;case"messageVideoNote":var G=l.video_note;q(e,G,s),K(e,G,s);break;case"messageVoiceNote":J(e,l.voice_note,s)}}}Ce(e,Object(i.a)(a.keys())),y(e,n,Object(i.a)(r.keys()))}function Q(e,t){if(e)switch(e["@type"]){case"animation":!function(e,t){var a=t?t.chat_id:0,n=t?t.id:0;if(!e)return;var r=e.animation,i=e.file_name;if(!r)return;var o=r.id;X(r,i||o,t||e,(function(){return h.a.updateAnimationBlob(a,n,o)}))}(e,t);break;case"document":!function(e,t){var a=t?t.chat_id:0,n=t?t.id:0;if(!e)return;var r=e.document,i=e.file_name;if(!r)return;var o=r.id;X(r,i||o,t||e,(function(){return h.a.updateDocumentBlob(a,n,o)}))}(e,t);break;case"photo":!function(e,t){var a=t?t.chat_id:0,n=t?t.id:0;if(!e)return;var r=Object(s.n)(e.sizes,d.B);if(!r)return;var i=r.photo;if(!i)return;var o=i.id;X(i,o+".jpg",t||e,(function(){return h.a.updatePhotoBlob(a,n,o)}))}(e,t);break;case"video":!function(e,t){var a=t?t.chat_id:0,n=t?t.id:0;if(!e)return;var r=e.video,i=e.file_name;if(!r)return;var o=r.id;X(r,i||o,t||e,(function(){return h.a.updateVideoBlob(a,n,o)}))}(e,t)}}function X(e,t,a,n){if(e&&t)if(e.arr)!function(e,t,a){var n=new Blob([e],{type:a||"application/octet-stream"});if("undefined"!==typeof window.navigator.msSaveBlob)window.navigator.msSaveBlob(n,t);else{var r=window.URL.createObjectURL(n),i=document.createElement("a");i.style.display="none",i.href=r,i.setAttribute("download",t),"undefined"===typeof i.download&&i.setAttribute("target","_blank"),document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(r)}}(e.arr,t);else{var r=h.a.getBlob(e.id)||e.blob;r?C(r,t):$(e,a,(function(){n&&n(),(r=h.a.getBlob(e.id)||e.blob)&&C(r,t)}))}}function $(e,t,a){if(e){var n=e.id,r=e.local;if(!h.a.getBlob(n))if(r.is_downloading_completed){var i=h.a.getStore();h.a.getLocalFile(i,e,null,a,(function(){r.can_be_downloaded&&h.a.getRemoteFile(e.id,d.f,t)}))}else r.can_be_downloaded&&h.a.getRemoteFile(n,d.f,t)}}function ee(e){if(!e)return[0,0,null];switch(e["@type"]){case"animation":var t=e.minithumbnail;if(t)return[t.width,t.height,t];break;case"document":var a=e.minithumbnail;if(a)return[a.width,a.height,a];break;case"photo":var n=e.minithumbnail;if(n)return[n.width,n.height,n];break;case"video":var r=e.minithumbnail;if(r)return[r.width,r.height,r];break;default:return[0,0,null]}return[0,0,null]}function te(e){if(!e)return[0,0,null];switch(e["@type"]){case"animation":var t=e.thumbnail;if(t)return[t.width,t.height,t.photo];break;case"document":var a=e.thumbnail;if(a)return[a.width,a.height,a.photo];break;case"photo":return re(e,d.F);case"video":var n=e.thumbnail;if(n)return[n.width,n.height,n.photo];break;default:return[0,0,null]}return[0,0,null]}function ae(e,t){var a=m.a.get(e,t);if(!a)return[0,0,null];var n=a.content;if(!n)return[0,0,null];switch(n["@type"]){case"messageAnimation":var r=n.animation;if(r&&r.minithumbnail)return[r.minithumbnail.width,r.minithumbnail.height,r.minithumbnail];break;case"messageChatChangePhoto":var i=n.photo;if(i&&i.minithumbnail)return[i.minithumbnail.width,i.minithumbnail.height,i.minithumbnail];break;case"messageDocument":var o=n.document;if(o&&o.minithumbnail)return[o.minithumbnail.width,o.minithumbnail.height,o.minithumbnail];break;case"messagePhoto":var s=n.photo;if(s&&s.minithumbnail)return[s.minithumbnail.width,s.minithumbnail.height,s.minithumbnail];break;case"messageText":var c=n.web_page;if(c){var l=c.animation,u=c.document,d=c.video,p=c.photo;if(l&&l.minithumbnail)return[l.minithumbnail.width,l.minithumbnail.height,l.minithumbnail];if(u&&u.minithumbnail)return[u.minithumbnail.width,u.minithumbnail.height,u.minithumbnail];if(d&&d.minithumbnail)return[d.minithumbnail.width,d.minithumbnail.height,d.minithumbnail];if(p&&p.minithumbnail)return[p.minithumbnail.width,p.minithumbnail.height,p.minithumbnail]}break;case"messageVideo":var h=n.video;if(h&&h.minithumbnail)return[h.minithumbnail.width,h.minithumbnail.height,h.minithumbnail];break;default:return[0,0,null]}return[0,0,null]}function ne(e,t){var a=m.a.get(e,t);if(!a)return[0,0,null];var n=a.content;if(!n)return[0,0,null];switch(n["@type"]){case"messageAnimation":var r=n.animation;if(r&&r.thumbnail)return[r.thumbnail.width,r.thumbnail.height,r.thumbnail.photo];break;case"messageChatChangePhoto":return ie(e,t,d.F);case"messageDocument":var i=n.document;if(i)return[50,50,i.document];break;case"messagePhoto":return ie(e,t,d.F);case"messageText":var o=n.web_page;if(o){var s=o.animation,c=o.document,l=o.video,u=o.photo;if(s&&s.thumbnail)return[s.thumbnail.width,s.thumbnail.height,s.thumbnail.photo];if(c)return[50,50,c.document];if(l&&l.thumbnail)return[l.thumbnail.width,l.thumbnail.height,l.thumbnail.photo];if(u)return ie(e,t,d.F)}break;case"messageVideo":var p=n.video;if(p&&p.thumbnail)return[p.thumbnail.width,p.thumbnail.height,p.thumbnail.photo];break;default:return[0,0,null]}return[0,0,null]}function re(e,t){if(!t)return[0,0,null,""];switch(e["@type"]){case"animation":return[e.width,e.height,e.animation,e.mime_type];case"photo":var a=Object(s.n)(e.sizes,t);if(a)return[a.width,a.height,a.photo,""];break;case"document":return[50,50,document.document,document.mime_type];case"video":return[e.width,e.height,e.video,e.mime_type]}return[0,0,null,""]}function ie(e,t,a){if(!a)return[0,0,null];var n=m.a.get(e,t);if(!n)return[0,0,null,""];var r=n.content;if(!r)return[0,0,null,""];switch(r["@type"]){case"messageAnimation":var i=r.animation;if(i)return[i.width,i.height,i.animation,i.mime_type];break;case"messageChatChangePhoto":var o=r.photo;if(o){var c=Object(s.n)(o.sizes,a);if(c)return[c.width,c.height,c.photo,""]}break;case"messageDocument":var l=r.document;if(l)return[50,50,l.document,l.mime_type];break;case"messagePhoto":var u=r.photo;if(u){var d=Object(s.n)(u.sizes,a);if(d)return[d.width,d.height,d.photo,""]}break;case"messageText":var p=r.web_page;if(p){var h=p.animation,f=p.document,g=p.photo,v=p.video;if(h)return[h.width,h.height,h.animation,h.mime_type];if(f)return[50,50,f.document,f.mime_type];if(g){var b=Object(s.n)(g.sizes,a);if(b)return[b.width,b.height,b.photo,""];break}if(v)return[v.width,v.height,v.video,v.mime_type]}break;case"messageVideo":var C=r.video;if(C)return[C.width,C.height,C.video,C.mime_type]}return[0,0,null,""]}function oe(e){if(e&&e.length)for(var t=0;t<e.length;t++){var a=e[t];if(a)switch(a["@type"]){case"pageBlockAnimation":var n=a.animation;if(!n)break;M(n),U(n);break;case"pageBlockPhoto":var r=a.photo;if(!r)break;R(r);break;case"pageBlockVideo":var i=a.video;if(!i)break;G(i),H(i)}}}function se(e){if(e&&e.length)for(var t=0;t<e.length;t++){var a=e[t],n=a.content;if(n)switch(n["@type"]){case"messageAnimation":var r=n.animation;if(!r)break;M(r),U(r);break;case"messagePhoto":var i=n.photo;if(!i)break;R(i);break;case"messageVideo":var o=n.video;if(!o)break;G(o),H(o);break;case"messageText":var s=a.content.web_page;if(s){var c=s.animation,l=s.photo,u=s.video;c&&(M(c),U(c)),l&&R(l),u&&(G(u),H(u))}}}}function ce(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e&&e.length)for(var a=h.a.getStore(),n=0;n<e.length;n++){var r=e[n];if(r)switch(r["@type"]){case"pageBlockAnimation":var i=r.animation;w(a,i,null,t),I(a,i,null);break;case"pageBlockPhoto":var o=r.photo;B(a,o,null);break;case"pageBlockVideo":var s=r.video;Z(a,s,null),W(a,s,null,t)}}}function le(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e&&e.length)for(var a=h.a.getStore(),n=0;n<e.length;n++){var r=e[n],i=r.content;if(i)switch(i["@type"]){case"messageAnimation":var o=i.animation;w(a,o,r,t),I(a,o,r);break;case"messageChatChangePhoto":var s=i.photo;B(a,s,r);break;case"messageDocument":var c=i.document;_(a,c,r,t);break;case"messagePhoto":var l=i.photo;B(a,l,r);break;case"messageText":var u=r.content.web_page;if(!u)break;var d=u.animation,p=u.document,m=u.photo,f=u.video,g=!0;d&&(w(a,d,r,t),g=!I(a,d,r)),p&&(_(a,p,r,t),g=!1),f&&(W(a,f,r,t),g=!Z(a,f,r)),g&&B(a,m,r);break;case"messageVideo":var v=i.video;Z(a,v,r),W(a,v,r,t)}}}function ue(e,t){if(t.length){var a=[];e>0&&a.push(t[e-1]),e<t.length-1&&a.push(t[e+1]),oe([t[e]]),oe(t)}}function de(e,t){if(t.length){var a=[];e>0&&a.push(t[e-1]),e<t.length-1&&a.push(t[e+1]),se([t[e]]),se(a)}}function pe(e,t){if(t.length){var a=[];e>0&&a.push(t[e-1]),e<t.length-1&&a.push(t[e+1]),le([t[e]],!1),le(a,!0)}}function he(e,t){if(t.length){var a=[];e>0&&a.push(t[e-1]),e<t.length-1&&a.push(t[e+1]),ce([t[e]],!1),ce(a,!0)}}function me(e,t,a){if(t){var n=t.id;t=h.a.get(n)||t;var r=f.a.get(a);if(r)t.blob||h.a.getBlob(n)||h.a.getLocalFile(e,t,null,(function(){return h.a.updateUserPhotoBlob(a,n)}),(function(){return h.a.getRemoteFile(n,d.ob,r)}))}}function fe(e,t,a){if(t){var n=t.id;t=h.a.get(n)||t;var r=p.a.get(a);if(r)if(!h.a.getDataUrl(n))t.blob||h.a.getBlob(n)||h.a.getLocalFile(e,t,null,(function(){return h.a.updateChatPhotoBlob(a,n)}),(function(){return h.a.getRemoteFile(n,d.ob,r)}))}}function ge(e,t){if(t){var a=h.a.getStore();t.forEach((function(t){switch(t["@type"]){case"chatPhoto":var n=t,r=n.small,i=n.big;fe(a,r,e),fe(a,i,e);break;case"profilePhoto":var o=Object(c.u)(e),s=t,u=s.small,d=s.big;me(a,u,o),me(a,d,o);break;case"userProfilePhoto":if(!(t=Object(l.a)(t)))break;var p=Object(c.u)(e),h=t,m=h.small,f=h.big;me(a,m,p),me(a,f,p)}}))}}function ve(e,t,a){if(a.length){var n=[];t>0&&n.push(a[t-1]),t<a.length-1&&n.push(a[t+1]),t>=0&&t<a.length&&n.push(a[t]),ge(e,n)}}function be(e,t){var a=f.a.get(t);if(a){var n=a.profile_photo;if(n)me(e,n.small,t)}}function Ce(e,t){t&&t.forEach((function(t){return be(e,t)}))}function ye(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=p.a.get(t);if(n){var r=n.photo;ke(e,r,n.id,a)}}function ke(e,t,a,n){if(t){var r=t.small,i=t.big;fe(e,r,a),n&&fe(e,i,a)}}function Ee(e,t){t&&t.forEach((function(t){return ye(e,t)}))}function Se(e,t){var a=p.a.get(t);if(a){var n=a.draft_message;if(n){var r=n.reply_to_message_id;r&&y(e,t,[r])}}}function Oe(e,t){t&&Ie(e,t.stickers)}function Ue(e,t){t&&Ie(e,t.stickers)}function we(e,t){t&&t.forEach((function(t){Me(e,t,!1)}))}function Me(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t)switch(t.type["@type"]){case"backgroundTypeFill":break;case"backgroundTypePattern":var n=t.document;n&&(x(e,n,null),a&&_(e,n,null,!1));break;case"backgroundTypeWallpaper":var r=t.document;r&&(x(e,r,null),a&&_(e,r,null,!1))}}function Ie(e,t){t&&t.forEach((function(t){z(e,t,null),t.is_animated&&V(e,t,null)}))}function je(e){return e&&"image/gif"===e.toLowerCase()}function _e(e){var t=e&&h.a.getDataUrl(e.id);if(t)return t;var a=xe(e);return h.a.getBlobUrl(a)||""}function xe(e){return e?h.a.getBlob(e.id)||e.blob:null}function Te(e){return e&&e.local&&e.local.is_downloading_active?v(e.local.downloaded_size):"0"}function Le(e){return e&&e.remote&&e.remote.is_uploading_active?v(e.remote.uploaded_size):"0"}function Pe(e){if(!e)return"";var t=e.split(".");return 1===t.length||""===t[0]&&2===t.length?"":t.pop().toLowerCase()}function Ne(e){if(e){var t=e.page_blocks;if(t){var a=h.a.getStore();t.forEach((function(e){return function e(t,a){if(!a)return;switch(a["@type"]){case"pageBlockAnchor":break;case"pageBlockAnimation":var n=a.animation,r=a.caption;I(t,n,null),w(t,n,null),e(t,r);break;case"pageBlockAudio":var i=a.audio,o=a.caption;O(t,i,null),S(t,i,null),e(t,o);break;case"pageBlockAuthorDate":var s=a.author;De(t,s);break;case"pageBlockBlockQuote":var c=a.text,l=a.credit;De(t,c),De(t,l);break;case"pageBlockCaption":var u=a.text,p=a.credit;De(t,u),De(t,p);break;case"pageBlockChatLink":var h=a.photo;ke(t,h,0);break;case"pageBlockCollage":var m=a.page_blocks,f=a.caption;e(t,f),m.forEach((function(a){return e(t,a)}));break;case"pageBlockCover":var g=a.cover;e(t,g);break;case"pageBlockDetails":var v=a.header,b=a.page_blocks;e(t,v),b.forEach((function(a){return e(t,a)}));break;case"pageBlockDivider":break;case"pageBlockEmbedded":var C=a.poster_photo,y=a.caption;A(t,C,null),e(t,y);break;case"pageBlockEmbeddedPost":var k=a.author_photo,E=a.page_blocks,U=a.caption;A(t,k,null),E.forEach((function(a){return e(t,a)})),e(t,U);break;case"pageBlockFooter":var M=a.footer;De(t,M);break;case"pageBlockHeader":var j=a.header;De(t,j);break;case"pageBlockKicker":var _=a.kicker;De(t,_);break;case"pageBlockList":a.items.forEach((function(a){return e(t,a)}));break;case"pageBlockListItem":a.page_blocks.forEach((function(a){return e(t,a)}));break;case"pageBlockMap":var x=a.caption;!function(e,t,a){P.apply(this,arguments)}(t,a,null),e(t,x);break;case"pageBlockParagraph":var T=a.text;De(t,T);break;case"pageBlockPhoto":var L=a.photo,N=a.caption;A(t,L,null,d.j),e(t,N);break;case"pageBlockPreformatted":var D=a.text;De(t,D);break;case"pageBlockPullQuote":var R=a.text,B=a.credit;De(t,R),De(t,B);break;case"pageBlockRelatedArticles":var F=a.header,V=a.articles;De(t,F),V.forEach((function(a){return e(t,a)}));break;case"pageBlockRelatedArticle":var z=a.photo;A(t,z,null);break;case"pageBlockSlideshow":var H=a.page_blocks,G=a.caption;e(t,G),H.forEach((function(a){return e(t,a)}));break;case"pageBlockSubheader":var q=a.subheader;De(t,q);break;case"pageBlockSubtitle":var K=a.subtitle;De(t,K);break;case"pageBlockTable":var J=a.caption,Y=a.cells;De(t,J),Y.forEach((function(a){return a.forEach((function(a){return e(t,a)}))}));break;case"pageBlockTableCell":var Q=a.text;De(t,Q);break;case"pageBlockTitle":var X=a.title;De(t,X);break;case"pageBlockVideo":var $=a.video,ee=a.caption;Z(t,$,null),W(t,$,null),e(t,ee)}}(a,e)}))}}}function De(e,t){if(t)switch(t["@type"]){case"richTextAnchor":var a=t.text;De(e,a);break;case"richTextBold":var n=t.text;De(e,n);break;case"richTextEmailAddress":var r=t.text;De(e,r);break;case"richTextFixed":var i=t.text;De(e,i);break;case"richTextIcon":var o=t.document;x(e,o,null),_(e,o,null,!1);break;case"richTextItalic":var s=t.text;De(e,s);break;case"richTextMarked":var c=t.text;De(e,c);break;case"richTextPhoneNumber":var l=t.text;De(e,l);break;case"richTextPlain":var u=t.text;De(e,u);break;case"richTexts":t.texts.forEach((function(t){return De(e,t)}));break;case"richTextStrikethrough":var d=t.text;De(e,d);break;case"richTextSubscript":var p=t.text;De(e,p);break;case"richTextSuperscript":var h=t.text;De(e,h);break;case"richTextUnderline":var m=t.text;De(e,m);break;case"richTextUrl":var f=t.text;De(e,f)}}function Re(e){return new Promise((function(t){if(e){var a=h.a.getBlob(e.id);if(a){var n=new FileReader;n.onload=function(e){return t(JSON.parse(e.target.result))},n.onerror=function(){return t(null)},n.onabort=function(){return t(null)},n.readAsText(a)}else t(null)}else t(null)}))}},function(e,t,a){"use strict";a.d(t,"h",(function(){return y})),a.d(t,"K",(function(){return k})),a.d(t,"g",(function(){return E})),a.d(t,"i",(function(){return S})),a.d(t,"R",(function(){return K})),a.d(t,"Q",(function(){return ve})),a.d(t,"W",(function(){return de})),a.d(t,"k",(function(){return pe})),a.d(t,"l",(function(){return he})),a.d(t,"t",(function(){return O})),a.d(t,"Y",(function(){return j})),a.d(t,"X",(function(){return _})),a.d(t,"q",(function(){return D})),a.d(t,"r",(function(){return N})),a.d(t,"z",(function(){return M})),a.d(t,"C",(function(){return w})),a.d(t,"B",(function(){return U})),a.d(t,"x",(function(){return I})),a.d(t,"y",(function(){return P})),a.d(t,"A",(function(){return L})),a.d(t,"n",(function(){return R})),a.d(t,"H",(function(){return A})),a.d(t,"I",(function(){return B})),a.d(t,"M",(function(){return T})),a.d(t,"v",(function(){return F})),a.d(t,"o",(function(){return V})),a.d(t,"j",(function(){return z})),a.d(t,"U",(function(){return H})),a.d(t,"S",(function(){return W})),a.d(t,"J",(function(){return G})),a.d(t,"O",(function(){return x})),a.d(t,"L",(function(){return Z})),a.d(t,"P",(function(){return fe})),a.d(t,"N",(function(){return ge})),a.d(t,"s",(function(){return q})),a.d(t,"w",(function(){return Y})),a.d(t,"m",(function(){return Q})),a.d(t,"F",(function(){return $})),a.d(t,"G",(function(){return ae})),a.d(t,"V",(function(){return ee})),a.d(t,"E",(function(){return te})),a.d(t,"u",(function(){return ne})),a.d(t,"D",(function(){return re})),a.d(t,"p",(function(){return oe})),a.d(t,"T",(function(){return J})),a.d(t,"a",(function(){return se})),a.d(t,"b",(function(){return ce})),a.d(t,"c",(function(){return me})),a.d(t,"d",(function(){return ie})),a.d(t,"e",(function(){return ue})),a.d(t,"f",(function(){return le}));var n=a(7),r=a.n(n),i=a(13),o=a(30),s=(a(0),a(366)),c=a(344),l=a(130),u=a(38);var d=a(22),p=a(339),h=a(375),m=a(90);var f=a(16),g=a(363),v=a(134),b=a(77),C=a(2);function y(e){var t=u.a.get(e);return!!t&&t.pinned_message_id>0}function k(e){var t=u.a.get(e);if(!t)return!1;var a=t.chat_list;return!!a&&"chatListArchive"===a["@type"]}function E(e){var t=u.a.get(e);if(!t)return!1;var a=t.is_sponsored,n=t.chat_list;return!a&&(!!n&&("chatListMain"!==n["@type"]||!J(e)&&e!==f.hb))}function S(e,t){if(!e&&!t)return!0;if(e&&!t)return!1;if(t&&!e)return!1;var a=e.input_message_text,n=e.reply_to_message_id,r=t.input_message_text;if(n!==t.reply_to_message_id)return!1;if(a["@type"]!==r["@type"])return!1;if("inputMessageText"!==a["@type"])return!0;var i=a.text,o=r.text;if(!i&&!o)return!0;if(i&&!o)return!1;if(o&&!i)return!1;var s=i.text,c=i.entities,l=o.text,u=o.entities;return s===l&&function(e,t){if(!e&&!t)return!0;if(e&&!t)return!1;if(t&&!e)return!1;if(e.length!==t.length)return!1;var a=new Map;return e.forEach((function(e){a.set("".concat(e.type["@type"],"_").concat(e.offset,"_").concat(e.length),e)})),t.every((function(e){return a.has("".concat(e.type["@type"],"_").concat(e.offset,"_").concat(e.length))}))}(c,u)}function O(e){var t=u.a.get(e);if(!t)return null;if(!t.type)return null;var a=u.a.getTypingManager(t.id);if(!a)return null;switch(t.type["@type"]){case"chatTypePrivate":case"chatTypeSecret":var n=function(e){if(!e)return null;if(e.actions.size>=1)switch(e.actions.values().next().value.action["@type"]){case"chatActionRecordingVideo":return"recording a video";case"chatActionRecordingVideoNote":return"recording a video message";case"chatActionRecordingVoiceNote":return"recording a voice message";case"chatActionStartPlayingGame":return"playing a game";case"chatActionUploadingDocument":return"sending a file";case"chatActionUploadingPhoto":return"sending a photo";case"chatActionUploadingVideo":return"sending a video";case"chatActionUploadingVideoNote":return"sending a video message";case"chatActionUploadingVoiceNote":return"sending a voice message";case"chatActionChoosingContact":case"chatActionChoosingLocation":case"chatActionTyping":default:return"typing"}return null}(a);return n?n+"...":null;case"chatTypeBasicGroup":case"chatTypeSupergroup":var r=function(e){if(!e)return null;var t,a=e.actions.size;if(a>2)return"".concat(a," people are typing");if(a>1){var n,r,i,s=Object(o.a)(e.actions.keys());try{for(s.s();!(i=s.n()).done;){var c=i.value;if(n){if(!r){r=b.a.get(c);break}}else n=b.a.get(c)}}catch(p){s.e(p)}finally{s.f()}return n&&r?(n=n.first_name?n.first_name:n.second_name,r=r.first_name?r.first_name:r.second_name,n&&r?"".concat(n," and ").concat(r," are typing"):"".concat(a," people are typing")):"".concat(a," people are typing")}if(e.actions.size>=1){var l,u=Object(o.a)(e.actions.keys());try{for(u.s();!(l=u.n()).done;){var d=l.value;if(!t){t=b.a.get(d);break}}}catch(p){u.e(p)}finally{u.f()}if(!t)return"1 person is typing";if(!(t=t.first_name?t.first_name:t.second_name))return"1 person is typing";switch(e.actions.values().next().value.action["@type"]){case"chatActionRecordingVideo":return"".concat(t," is recording a video");case"chatActionRecordingVideoNote":return"".concat(t," is recording a video message");case"chatActionRecordingVoiceNote":return"".concat(t," is recording a voice message");case"chatActionStartPlayingGame":return"".concat(t," is playing a game");case"chatActionUploadingDocument":return"".concat(t," is sending a file");case"chatActionUploadingPhoto":return"".concat(t," is sending a photo");case"chatActionUploadingVideo":return"".concat(t," is sending a video");case"chatActionUploadingVideoNote":return"".concat(t," is sending a video message");case"chatActionUploadingVoiceNote":return"".concat(t," is sending a voice message");case"chatActionChoosingContact":case"chatActionChoosingLocation":case"chatActionTyping":default:return"".concat(t," is typing")}}return null}(a);return r?r+"...":null}return null}function U(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return e?Object(h.b)(e)?null:e.sender_user_id?Object(c.c)(e.sender_user_id,null,t):null:null}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};if(!e)return null;if(Object(h.b)(e))return null;var a=u.a.get(e.chat_id);return a&&"chatTypeBasicGroup"!==a.type["@type"]&&"chatTypeSupergroup"!==a.type["@type"]?null:Object(c.e)(e.sender_user_id,t)}function M(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return e?w(e.last_message,t):null}function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};if(!e)return null;var a=e.last_message;return a?Object(p.i)(a,t):null}function j(e){var t=u.a.get(e);return!!t&&t.unread_mention_count>0}function _(e){var t=u.a.get(e);if(!t)return!1;var a=t.is_marked_as_unread,n=t.unread_count,r=t.unread_mention_count;return n>1||1===n&&0===r||a&&0===n&&0===r}function x(e){var t=u.a.get(e);if(!t)return!1;var a=t.is_marked_as_unread,n=t.unread_count;t.unread_mention_count;return a||n>0}function T(e){return function(e){var t=u.a.get(e);if(!t)return 0;var a=t.notification_settings;if(!a)return 0;var n=a.use_default_mute_for,r=a.mute_for;if(n){var i=function(e){var t=u.a.get(e);if(!t)return null;switch(t.type["@type"]){case"chatTypePrivate":case"chatTypeSecret":return v.a.settings.get("notificationSettingsScopePrivateChats");case"chatTypeBasicGroup":case"chatTypeSupergroup":return G(e)?v.a.settings.get("notificationSettingsScopeChannelChats"):v.a.settings.get("notificationSettingsScopeGroupChats")}return null}(e);return!!i&&i.mute_for}return r}(e)>0}function L(e){var t=new Date(1e3*e.date),a=new Date;if(a.setHours(0,0,0,0),t>a)return Object(s.a)(t,"H:MM");var n=new Date,r=n.getDay(),i=n.getDate()-r+(0===r?-6:1);return t>new Date(n.setDate(i))?Object(s.a)(t,"ddd"):Object(s.a)(t,"d.mm.yyyy")}function P(e){return e&&e.last_message&&e.last_message.date?de(e.id)?null:L(e.last_message):null}function N(e){var t=u.a.get(e);if(!t)return null;var a=t.type;if(!a)return null;switch(a["@type"]){case"chatTypeBasicGroup":var n=g.a.get(a.basic_group_id);if(n)return function(e,t){if(!e)return null;var a=e.status,n=e.member_count;if(a&&("chatMemberStatusBanned"===a["@type"]||"chatMemberStatusLeft"===a["@type"]||"chatMemberStatusCreator"===a["@type"]&&!a.is_member))return"group is inaccessible";if(!n)return"0 members";if(1===n)return"1 member";var r=u.a.getOnlineMemberCount(t);return r>1?"".concat(n," members, ").concat(r," online"):"".concat(n," members")}(n,e);break;case"chatTypePrivate":case"chatTypeSecret":var r=b.a.get(a.user_id);if(r)return Object(c.f)(r);break;case"chatTypeSupergroup":var i=l.a.get(a.supergroup_id);if(i)return i.is_channel?function(e,t){if(!e)return"";var a=e.status,n=e.is_channel,r=e.member_count;if(!n)return"";if(a&&"chatMemberStatusBanned"===a["@type"])return"channel is inaccessible";if(!r){var i=l.a.getFullInfo(e.id);i&&(r=i.member_count)}if(!r)return"0 subscribers";if(1===r)return"1 subscriber";var o=u.a.getOnlineMemberCount(t);return o>1?"".concat(r," subscribers, ").concat(o," online"):"".concat(r," subscribers")}(i,e):function(e,t){if(!e)return null;var a=e.status,n=e.is_channel,r=e.member_count;if(a&&"chatMemberStatusBanned"===a["@type"])return n?"channel is inaccessible":"group is inaccessible";if(!r){var i=l.a.getFullInfo(e.id);i&&(r=i.member_count)}if(!r)return"0 members";if(1===r)return"1 member";var o=u.a.getOnlineMemberCount(t);return o>1?"".concat(r," members, ").concat(o," online"):"".concat(r," members")}(i,e)}return null}function D(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(J(e)&&t)return null;var a=O(e);return a||N(e)}function R(e,t){if(!e)return null;var a=e.title||t("HiddenName");if(0===a.length)return null;var n=Object(d.i)(a);return n&&n.length>0?n:e.title.charAt(0)}function B(e){var t=u.a.get(e);if(!t)return!1;if(!t.type)return!1;switch(t.type["@type"]){case"chatTypeBasicGroup":return!1;case"chatTypePrivate":case"chatTypeSecret":var a=b.a.get(t.type.user_id);if(a)return Object(c.j)(a);break;case"chatTypeSupergroup":return!1}return!1}function A(e){return!O(e)&&B(e)}function F(e){var t=u.a.get(e);if(!t)return null;if(!t.type)return null;switch(t.type["@type"]){case"chatTypeBasicGroup":return null;case"chatTypePrivate":case"chatTypeSecret":var a=b.a.get(t.type.user_id);if(a)return a.username;break;case"chatTypeSupergroup":var n=l.a.get(t.type.supergroup_id);if(n)return n.username}return null}function V(e){var t=u.a.get(e);if(!t)return null;if(!t.type)return null;switch(t.type["@type"]){case"chatTypeBasicGroup":return null;case"chatTypePrivate":case"chatTypeSecret":var a=b.a.get(t.type.user_id);if(a)return Object(m.a)(a.phone_number);break;case"chatTypeSupergroup":return null}return null}function z(e){var t=u.a.get(e);if(!t)return null;if(!t.type)return null;switch(t.type["@type"]){case"chatTypeBasicGroup":var a=g.a.getFullInfo(t.type.basic_group_id);if(a)return a.description;break;case"chatTypePrivate":case"chatTypeSecret":var n=b.a.getFullInfo(t.type.user_id);if(n)return n.bio;break;case"chatTypeSupergroup":var r=l.a.getFullInfo(t.type.supergroup_id);if(r)return r.description}return null}function H(e){var t=u.a.get(e);if(!t)return!1;if(!t.type)return!1;switch(t.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":return!1;case"chatTypePrivate":case"chatTypeSecret":return!0}return!1}function W(e){var t=u.a.get(e);if(!t)return!1;if(!t.type)return!1;switch(t.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":return!0;case"chatTypePrivate":case"chatTypeSecret":return!1}return!1}function G(e){var t=u.a.get(e);if(!t)return!1;if(!t.type)return!1;switch(t.type["@type"]){case"chatTypeSupergroup":var a=l.a.get(t.type.supergroup_id);return a&&a.is_channel;case"chatTypeBasicGroup":case"chatTypePrivate":case"chatTypeSecret":return!1}return!1}function Z(e){var t=u.a.get(e);if(!t)return!1;var a=t.type;if(!a)return!1;switch(a["@type"]){case"chatTypeSupergroup":var n=l.a.get(a.supergroup_id);if(n&&n.status)switch(n.status["@type"]){case"chatMemberStatusAdministrator":return!0;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return n.status.is_member;case"chatMemberStatusLeft":return!1;case"chatMemberStatusMember":return!0;case"chatMemberStatusRestricted":return n.status.is_member}break;case"chatTypeBasicGroup":var r=g.a.get(a.basic_group_id);if(r&&r.status)switch(r.status["@type"]){case"chatMemberStatusAdministrator":return!0;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return r.status.is_member;case"chatMemberStatusLeft":return!1;case"chatMemberStatusMember":return!0;case"chatMemberStatusRestricted":return r.status.is_member}break;case"chatTypePrivate":case"chatTypeSecret":return!0}return!1}function q(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e},n=u.a.get(e);return n?J(e)&&t?a("SavedMessages"):n.title||a("HiddenName"):null}function K(e){var t=u.a.get(e);if(!t)return!1;switch(t.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":return!1;case"chatTypeSecret":case"chatTypePrivate":var a=b.a.get(t.type.user_id);return a&&"userTypeDeleted"===a.type["@type"]}return!1}function J(e){var t=u.a.get(e);if(!t)return!1;switch(t.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":return!1;case"chatTypeSecret":case"chatTypePrivate":return b.a.getMyId()===t.type.user_id}return!1}function Y(e){var t=[],a=u.a.get(e);if(!a)return t;switch(a.type["@type"]){case"chatTypeBasicGroup":var n=g.a.getFullInfo(a.type.basic_group_id);if(n)return n.members||t}return t}function Q(e){return X.apply(this,arguments)}function X(){return(X=Object(i.a)(r.a.mark((function e(t){var a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=u.a.get(t)){e.next=3;break}return e.abrupt("return",null);case 3:if(n=a.type){e.next=6;break}return e.abrupt("return",null);case 6:e.t0=n["@type"],e.next="chatTypePrivate"===e.t0?9:"chatTypeSecret"===e.t0?12:"chatTypeBasicGroup"===e.t0?15:"chatTypeSupergroup"===e.t0?18:21;break;case 9:return e.next=11,C.a.send({"@type":"getUserFullInfo",user_id:n.user_id});case 11:return e.abrupt("return",e.sent);case 12:return e.next=14,C.a.send({"@type":"getUserFullInfo",user_id:n.user_id});case 14:return e.abrupt("return",e.sent);case 15:return e.next=17,C.a.send({"@type":"getBasicGroupFullInfo",basic_group_id:n.basic_group_id});case 17:return e.abrupt("return",e.sent);case 18:return e.next=20,C.a.send({"@type":"getSupergroupFullInfo",supergroup_id:n.supergroup_id});case 20:return e.abrupt("return",e.sent);case 21:return e.abrupt("return",null);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(e,t){var a=u.a.get(e);if(!a)return!1;var n=a.type;return n&&"chatTypeBasicGroup"===n["@type"]&&n.basic_group_id===t}function ee(e){var t=u.a.get(e);if(!t)return!1;var a=t.type;return a&&"chatTypeSupergroup"===a["@type"]}function te(e){var t=u.a.get(e);if(!t)return!1;var a=t.type;return a&&"chatTypeSupergroup"===a["@type"]?a.supergroup_id:0}function ae(e,t){var a=u.a.get(e);if(!a)return!1;var n=a.type;return ee(e)&&n.supergroup_id===t}function ne(e){var t=u.a.get(e);if(!t)return 0;var a=t.type;return!a||"chatTypePrivate"!==a["@type"]&&"chatTypeSecret"!==a["@type"]?0:a.user_id}function re(e){var t=u.a.get(e);if(!t)return null;if(H(e)){var a=b.a.get(ne(e));if(a)return a.profile_photo}return t.photo}function ie(e){var t=u.a.get(e);if(!t)return!1;var a=t.type,n=t.permissions;if(!a)return!1;if(!n)return!1;var r=n.can_send_media_messages;switch(a["@type"]){case"chatTypeBasicGroup":var i=g.a.get(a.basic_group_id);if(!i)return!1;var o=i.status;if(!o)return!1;var s=o.is_member,c=o.permissions;switch(o["@type"]){case"chatMemberStatusAdministrator":return!0;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return s;case"chatMemberStatusLeft":return!1;case"chatMemberStatusMember":return!0;case"chatMemberStatusRestricted":return s&&c&&c.can_send_media_messages}break;case"chatTypePrivate":case"chatTypeSecret":return r;case"chatTypeSupergroup":var d=l.a.get(t.type.supergroup_id);if(!d)return!1;var p=d.status;if(!p)return!1;var h=p.is_member,m=p.permissions;switch(p["@type"]){case"chatMemberStatusAdministrator":return!0;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return h;case"chatMemberStatusLeft":return!1;case"chatMemberStatusMember":return r&&!d.is_channel;case"chatMemberStatusRestricted":return r&&h&&m&&m.can_send_media_messages}}return!1}function oe(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e};if(J(e)&&t)return a("SavedMessages");var n=u.a.get(e);if(!n)return null;if(!n.type)return null;switch(n.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":return n.title;case"chatTypePrivate":case"chatTypeSecret":return Object(c.e)(n.type.user_id,a)}return null}function se(e){var t=u.a.get(e);if(!t)return!1;if(!t.type)return!1;switch(t.type["@type"]){case"chatTypeBasicGroup":return!0;case"chatTypeSupergroup":var a=l.a.get(t.type.supergroup_id);return!a||!Boolean(a.username);case"chatTypePrivate":case"chatTypeSecret":return!0}return!1}function ce(e){return!J(e)}function le(e){var t=u.a.get(e);if(!t)return!1;var a=t.type,n=t.permissions;if(!a)return!1;if(!n)return!1;var r=n.can_send_polls;switch(a["@type"]){case"chatTypeBasicGroup":var i=g.a.get(a.basic_group_id);if(!i)return!1;var o=i.status;if(!o)return!1;var s=o.is_member,c=o.permissions;switch(o["@type"]){case"chatMemberStatusAdministrator":return!0;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return s;case"chatMemberStatusLeft":return!1;case"chatMemberStatusMember":return!0;case"chatMemberStatusRestricted":return s&&c&&c.can_send_polls}break;case"chatTypePrivate":case"chatTypeSecret":return r;case"chatTypeSupergroup":var d=l.a.get(a.supergroup_id);if(!d)return!1;var p=d.status;if(!p)return!1;var h=p.is_member,m=p.permissions;switch(p["@type"]){case"chatMemberStatusAdministrator":return!0;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return h;case"chatMemberStatusLeft":return!1;case"chatMemberStatusMember":return r&&!d.is_channel;case"chatMemberStatusRestricted":return r&&h&&m&&m.can_send_polls}}return!1}function ue(e){var t=u.a.get(e);if(!t)return!1;var a=t.type,n=t.permissions;if(!a)return!1;if(!n)return!1;var r=n.can_send_messages;switch(a["@type"]){case"chatTypeBasicGroup":var i=g.a.get(a.basic_group_id);if(!i)return!1;var o=i.status;if(!o)return!1;var s=o.is_member,c=o.permissions;switch(o["@type"]){case"chatMemberStatusAdministrator":return!0;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return s;case"chatMemberStatusLeft":return!1;case"chatMemberStatusMember":return!0;case"chatMemberStatusRestricted":return s&&c&&c.can_send_messages}break;case"chatTypePrivate":case"chatTypeSecret":return r;case"chatTypeSupergroup":var d=l.a.get(a.supergroup_id);if(!d)return!1;var p=d.status;if(!p)return!1;var h=p.is_member,m=p.permissions;switch(p["@type"]){case"chatMemberStatusAdministrator":return!0;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return h;case"chatMemberStatusLeft":return!1;case"chatMemberStatusMember":return r&&!d.is_channel;case"chatMemberStatusRestricted":return r&&h&&m&&m.can_send_messages}}return!1}function de(e){var t=u.a.get(e);return pe(e)&&0===t.unread_count&&0===t.unread_mention_count}function pe(e){var t=u.a.get(e);if(t){var a=t.draft_message;if(a){var n=a.input_message_text;if(n)return n.text}}return null}function he(e){var t=0,a=u.a.get(e);if(a){var n=a.draft_message;n&&(t=n.reply_to_message_id)}return t}function me(e){var t=u.a.get(e);if(!t)return!1;var a=t.type,n=t.permissions;if(!a)return!1;if(!n)return!1;var r=n.can_pin_messages;switch(a["@type"]){case"chatTypeBasicGroup":var i=g.a.get(a.basic_group_id);if(!i)return!1;var o=i.status;if(!o)return!1;var s=o.is_member,c=o.permissions;switch(o["@type"]){case"chatMemberStatusAdministrator":return o.can_pin_messages;case"chatMemberStatusBanned":case"chatMemberStatusCreator":case"chatMemberStatusLeft":case"chatMemberStatusMember":return!1;case"chatMemberStatusRestricted":return s&&c&&c.can_pin_messages}break;case"chatTypePrivate":case"chatTypeSecret":return r;case"chatTypeSupergroup":var d=l.a.get(a.supergroup_id);if(!d)return!1;var p=d.status;if(!p)return!1;var h=p.is_member,m=p.permissions;switch(p["@type"]){case"chatMemberStatusAdministrator":return r||p.can_pin_messages;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return h;case"chatMemberStatusLeft":case"chatMemberStatusMember":return!1;case"chatMemberStatusRestricted":return r&&h&&m&&m.can_pin_messages}}return!1}function fe(e){var t=u.a.get(e);if(!t)return!1;var a=t.type;if(!a)return!1;switch(t.type["@type"]){case"chatTypeBasicGroup":return!1;case"chatTypePrivate":case"chatTypeSecret":var n=b.a.get(a.user_id);return n&&n.is_verified;case"chatTypeSupergroup":var r=l.a.get(a.supergroup_id);return r&&r.is_verified}return!1}function ge(e){var t=u.a.get(e);if(!t)return!1;if(!t.type)return!1;switch(t.type["@type"]){case"chatTypeBasicGroup":case"chatTypePrivate":return!1;case"chatTypeSecret":return!0;case"chatTypeSupergroup":return!1}return!1}function ve(e){var t=u.a.get(e);if(!t)return!1;var a=t.type;if(!a)return!1;switch(a["@type"]){case"chatTypeBasicGroup":var n=a.basic_group_id,r=g.a.get(n);if(!r)return!1;var i=r.status;return!i&&"chatMemberStatusCreator"===i["@type"];case"chatTypePrivate":case"chatTypeSecret":return!1;case"chatTypeSupergroup":var o=a.supergroup_id,s=l.a.get(o);if(!s)return!1;var c=s.status;return!!c&&"chatMemberStatusCreator"===c["@type"]}return!1}},function(e,t,a){"use strict";a.d(t,"K",(function(){return V})),a.d(t,"J",(function(){return z})),a.d(t,"t",(function(){return je})),a.d(t,"s",(function(){return Fe})),a.d(t,"m",(function(){return Ve})),a.d(t,"h",(function(){return ze})),a.d(t,"c",(function(){return He})),a.d(t,"P",(function(){return We})),a.d(t,"L",(function(){return Ge})),a.d(t,"I",(function(){return Ze})),a.d(t,"e",(function(){return qe})),a.d(t,"a",(function(){return Ke})),a.d(t,"d",(function(){return Je})),a.d(t,"b",(function(){return Ye})),a.d(t,"r",(function(){return Qe})),a.d(t,"y",(function(){return W})),a.d(t,"x",(function(){return J})),a.d(t,"n",(function(){return K})),a.d(t,"z",(function(){return Y})),a.d(t,"i",(function(){return re})),a.d(t,"j",(function(){return Q})),a.d(t,"k",(function(){return X})),a.d(t,"F",(function(){return $})),a.d(t,"o",(function(){return ee})),a.d(t,"w",(function(){return te})),a.d(t,"f",(function(){return ae})),a.d(t,"g",(function(){return ne})),a.d(t,"H",(function(){return ie})),a.d(t,"E",(function(){return Ie})),a.d(t,"M",(function(){return se})),a.d(t,"C",(function(){return le})),a.d(t,"G",(function(){return ce})),a.d(t,"p",(function(){return oe})),a.d(t,"D",(function(){return ue})),a.d(t,"q",(function(){return de})),a.d(t,"A",(function(){return pe})),a.d(t,"B",(function(){return he})),a.d(t,"v",(function(){return me})),a.d(t,"O",(function(){return Me})),a.d(t,"u",(function(){return _e})),a.d(t,"l",(function(){return xe})),a.d(t,"N",(function(){return Te})),a.d(t,"Q",(function(){return G}));var n=a(7),r=a.n(n),i=a(13),o=a(60),s=a(0),c=a.n(s),l=a(397),u=a.n(l),d=a(8),p=a(9),h=a(11),m=a(10),f=a(31),g=a(320),v=a(332),b=a(323),C=a(324),y=a(325),k=a(326),E=a(128),S=a(2),O=(a(441),a(338)),U=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).handleClick=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,i,o,s,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stopPropagation(),t.preventDefault(),a=n.props,i=a.userId,o=a.username,s=a.popup,!i){e.next=7;break}Object(E.k)(i,s),e.next=12;break;case 7:if(!o){e.next=12;break}return e.next=10,S.a.send({"@type":"searchPublicChat",username:o}).catch((function(){n.setState({error:!0})}));case 10:(c=e.sent)&&(Object(O.S)(c.id)?Object(E.i)(c.id,null,!1):Object(E.i)(c.id,null,s));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleClose=function(){n.setState({error:!1})},n.handleDialogClick=function(e){e.preventDefault(),e.stopPropagation()},n.state={},n}return Object(p.a)(a,[{key:"render",value:function(){var e=this.props,t=e.children,a=e.t,n=e.title,r=e.username,i=this.state.error;return c.a.createElement(c.a.Fragment,null,c.a.createElement("a",{title:n,onClick:this.handleClick},t),i&&c.a.createElement(v.a,{transitionDuration:0,open:!0,onClose:this.handleClose,onClick:this.handleDialogClick,"aria-labelledby":"confirm-dialog-title"},c.a.createElement(b.a,{id:"confirm-dialog-title"},a("Error")),c.a.createElement(C.a,{classes:{root:"safe-link-content-root"}},c.a.createElement(y.a,null,"Can't find username ".concat(r,"."))),c.a.createElement(k.a,null,c.a.createElement(g.a,{onClick:this.handleClose},a("Ok")))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.userId,n=e.username;return t.prevUserId!==a||t.prevUsername!==n?{prevUserId:a,prevUsername:n,error:!1}:null}}]),a}(c.a.Component);U.defaultProps={popup:!0};var w=Object(f.d)()(U),M=(a(422),a(367)),I=a(366),j=a(22),_=a(337),x=a(343),T=a(378),L=a(375),P=a(344),N=a(16),D=a(14),R=a(38),B=a(336),A=a(129),F=a(77);function V(e,t){var a=A.a.get(e,t);if(!a)return!1;var n=a.content;if(!n)return!1;var r=n.caption;if(r&&r.text&&r.text.length>0)return!1;switch(n["@type"]){case"messageAnimation":case"messageLocation":case"messagePhoto":case"messageSticker":case"messageVideo":case"messageVideoNote":return!0}return!1}function z(e,t){var a=R.a.get(e);if(!a)return!1;var n=a.last_read_inbox_message_id,r=a.last_read_outbox_message_id,i=A.a.get(e,t);if(!i)return!1;var o=i.id,s=i.is_outgoing,c=Object(O.T)(e);return(!s||!c)&&(s?o>r:o>n)}function H(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};if(!e)return null;var a=e.forward_info;if(a)switch(a["@type"]){case"messageForwardedFromUser":if(a.sender_user_id>0){var n=F.a.get(a.sender_user_id);if(n)return Object(P.c)(a.sender_user_id,null,t)}break;case"messageForwardedPost":var r=R.a.get(a.chat_id);if(r)return r.title}return W(e,t)}function W(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};if(!e)return null;var a=e.sender_user_id,n=e.chat_id;if(a){var r=F.a.get(a);if(r)return Object(P.c)(a,null,t)}if(n){var i=R.a.get(n);if(i)return i.title}return null}function G(e,t,a){return t<0&&(t=0),t>e.length-1&&(t=e.length-1),a<t&&(a=t),a>e.length&&(a=e.length),e.substring(t,a)}function Z(e){e.stopPropagation()}function q(e,t){e.stopPropagation(),e.preventDefault();var a=D.a.chatId;Object(E.m)(a,t)}function K(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};if("formattedText"!==e["@type"])return null;var a=e.text,n=e.entities;if(!a)return null;if(!n)return a;for(var r=!1,i=[],o=0,s=function(e){var s=n[e],l=s.offset,u=s.length,d=s.type;if(o>l)return"continue";var p=G(a,o,l),h=p.length;p&&(r&&p.length>0&&"\n"===p[0]&&(p=p.substr(1),r=!1),p&&i.push(p));var m=l,f=G(a,l,l+u);switch(r&&f.length>0&&"\n"===f[0]&&(f=f.substr(1),r=!1),d["@type"]){case"textEntityTypeBold":i.push(c.a.createElement("strong",{key:m},f));break;case"textEntityTypeBotCommand":var g=f.length>0&&"/"===f[0]?G(f,1):f;i.push(c.a.createElement("a",{key:m,onClick:Z,href:"tg://bot_command?command=".concat(g,"&bot=")},f));break;case"textEntityTypeCashtag":i.push(c.a.createElement("a",{key:m,onClick:function(e){return q(e,f)}},f));break;case"textEntityTypeCode":i.push(c.a.createElement("code",{key:m},f));break;case"textEntityTypeEmailAddress":i.push(c.a.createElement("a",{key:m,href:"mailto:".concat(f),onClick:Z,target:"_blank",rel:"noopener noreferrer"},f));break;case"textEntityTypeHashtag":i.push(c.a.createElement("a",{key:m,onClick:function(e){return q(e,f)}},f));break;case"textEntityTypeItalic":i.push(c.a.createElement("em",{key:m},f));break;case"textEntityTypeMentionName":i.push(c.a.createElement(w,{key:m,userId:d.user_id,title:Object(P.c)(d.user_id,null,t)},f));break;case"textEntityTypeMention":i.push(c.a.createElement(w,{key:m,username:f},f));break;case"textEntityTypePhoneNumber":i.push(c.a.createElement("a",{key:m,href:"tel:".concat(f),onClick:Z},f));break;case"textEntityTypePre":i.push(c.a.createElement("pre",{key:m},f)),r=!0;break;case"textEntityTypePreCode":i.push(c.a.createElement("pre",{key:m},c.a.createElement("code",null,f))),r=!0;break;case"textEntityTypeTextUrl":var v=d.url?d.url:f;i.push(c.a.createElement(M.a,{key:m,url:v},f));break;case"textEntityTypeUrl":i.push(c.a.createElement(M.a,{key:m,url:f},f));break;default:i.push(f)}o+=h+s.length},l=0;l<n.length;l++)s(l);if(o<a.length){var u=a.substring(o);r&&u.length>0&&"\n"===u[0]&&(u=u.substr(1)),u&&i.push(u)}return i}function J(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e};if(!e)return null;var n=[],r=e.content;if(!r)return[].concat(Object(o.a)(n),[t]);var i=r.text,s=r.caption;if(i&&"formattedText"===i["@type"]&&i.text)n=K(i,a);else if(s&&"formattedText"===s["@type"]&&s.text){var c=K(s,a);c&&(n=n.concat(c))}return n&&n.length>0?[].concat(Object(o.a)(n),[t]):[]}function Y(e){return e&&e.content?e.content.web_page:null}function Q(e){if(!e)return null;var t=new Date(1e3*e);return Object(I.a)(t,"H:MM")}function X(e){if(!e)return null;var t=new Date(1e3*e);return Object(I.a)(t,"H:MM:ss d.mm.yyyy")}function $(e){if(!e)return!1;var t=e.origin;if(!t)return!1;switch(t["@type"]){case"messageForwardOriginUser":return!1;case"messageForwardOriginHiddenUser":return!0;case"messageForwardOriginChannel":return!1}return!1}function ee(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};if(!e)return"";var a=e.origin;if(!a)return"";switch(a["@type"]){case"messageForwardOriginUser":var n=a.sender_user_id;return Object(P.c)(n,null,t);case"messageForwardOriginHiddenUser":var r=a.sender_name;return r;case"messageForwardOriginChannel":var i=a.chat_id,o=a.author_signature;return Object(O.s)(i,!1,t)+(o?" (".concat(o,")"):"")}return""}function te(e){return e?e.sender_user_id:null}function ae(e,t){if(0!==e.messages.length&&0!==t.length){var a=t.reduce((function(e,t){return e.set(t.id,t.id),e}),new Map);e.messages=e.messages.filter((function(e){return!a.has(e.id)}))}}function ne(e){return e.filter((function(e){return"messageChatUpgradeTo"!==e.content["@type"]}))}function re(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};if(!e)return null;var a=e.content;if(!a)return null;var n="";if(a.caption&&a.caption.text&&(n=", ".concat(a.caption.text)),e.ttl>0)return Object(L.a)(e);switch(a["@type"]){case"messageAnimation":return t("AttachGif")+n;case"messageAudio":return t("AttachMusic")+n;case"messageBasicGroupChatCreate":return Object(L.a)(e);case"messageCall":return t("Call")+n;case"messageChatAddMembers":case"messageChatChangePhoto":case"messageChatChangeTitle":case"messageChatDeleteMember":case"messageChatDeletePhoto":case"messageChatJoinByLink":case"messageChatSetTtl":case"messageChatUpgradeFrom":case"messageChatUpgradeTo":return Object(L.a)(e);case"messageContact":return t("AttachContact")+n;case"messageContactRegistered":case"messageCustomServiceAction":return Object(L.a)(e);case"messageDocument":var r=a.document;return r&&r.file_name?r.file_name+n:t("AttachDocument")+n;case"messageExpiredPhoto":return t("AttachPhoto")+n;case"messageExpiredVideo":return t("AttachVideo")+n;case"messageGame":return t("AttachGame")+n;case"messageGameScore":case"messageInvoice":return Object(L.a)(e);case"messageLocation":return t("AttachLocation")+n;case"messagePassportDataReceived":case"messagePassportDataSent":case"messagePaymentSuccessful":case"messagePaymentSuccessfulBot":return Object(L.a)(e);case"messagePhoto":return t("AttachPhoto")+n;case"messagePoll":var i=a.poll;return"\ud83d\udcca "+(i.question||t("Poll"))+n;case"messagePinMessage":case"messageScreenshotTaken":return Object(L.a)(e);case"messageSticker":var o=a.sticker,s="";return o&&o.emoji&&(s=o.emoji),t("AttachSticker")+(s?" ".concat(s):"")+n;case"messageSupergroupChatCreate":return Object(L.a)(e);case"messageText":return a.text.text+n;case"messageUnsupported":return Object(L.a)(e);case"messageVenue":return t("AttachLocation")+n;case"messageVideo":return t("AttachVideo")+n;case"messageVideoNote":return t("AttachRound")+n;case"messageVoiceNote":return t("AttachAudio")+n;case"messageWebsiteConnected":return Object(L.a)(e);default:return t("UnsupportedAttachment")}}function ie(e){return!!e&&"messagePhoto"===e["@type"]}function oe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:N.o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:N.m,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:N.p,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:N.n;if(!e)return null;var i=e.longitude,o=e.latitude;return"loc=".concat(o,",").concat(i,"&size=").concat(t,",").concat(a,"&scale=").concat(r,"&zoom=").concat(n)}function se(e,t){var a=A.a.get(e,t);if(!a)return!1;var n=a.content;if(!n)return!1;switch(n["@type"]){case"messageVideo":return!0;case"messageText":var r=n.web_page;return Boolean(r.video);default:return!1}}function ce(e,t){var a=A.a.get(e,t);if(!a)return!1;var n=a.content;if(!n)return!1;switch(n["@type"]){case"messageDocument":var r=n.document;if(!r)return!1;var i=r.file_name;return i&&i.toLowerCase().endsWith(".json");case"messageText":var o=n.web_page;if(!o)return!1;var s=o.document;if(!s)return!1;var c=s.file_name;return c&&c.toLowerCase().endsWith(".json");default:return!1}}function le(e,t){var a=A.a.get(e,t);if(!a)return!1;var n=a.content;if(!n)return!1;switch(n["@type"]){case"messageAnimation":return!0;case"messageText":var r=n.web_page;return Boolean(r.animation);default:return!1}}function ue(e,t){var a=A.a.get(e,t);if(!a)return!0;var n=a.content;if(!n)return!0;switch(n["@type"]){case"messageVoiceNote":return n.is_listened;case"messageVideoNote":return n.is_viewed;default:return!0}}function de(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};if(!e)return null;var a=e.content;if(!a)return null;switch(a["@type"]){case"messageAudio":var n=a.audio;if(n)return Object(x.c)(n);break;case"messageText":var r=a.web_page;if(r){var i=r.audio;if(i)return Object(x.c)(i);break}}return H(e,t)}function pe(e,t){var a=A.a.get(e,t);if(!a)return!1;var n=a.content;if(!n)return!1;switch(n["@type"]){case"messageAudio":if(n.audio)return!0;break;case"messageText":var r=n.web_page;if(r)if(r.audio)return!0}return!1}function he(e,t){var a=A.a.get(e,t);if(!a)return!1;var n=a.content;if(!n)return!1;switch(n["@type"]){case"messageVideoNote":if(n.video_note)return!0;break;case"messageText":var r=n.web_page;if(r)if(r.video_note)return!0}return!1}function me(e,t){var a=A.a.get(e,t);if(!a)return null;var n=a.content;if(!n)return null;switch(n["@type"]){case"messageAudio":if(n.audio)return{"@type":"searchMessagesFilterAudio"};break;case"messageVoiceNote":if(n.voice_note)return{"@type":"searchMessagesFilterVoiceNote"};break;case"messageVideoNote":if(n.video_note)return null;break;case"messageText":var r=n.web_page;if(r){var i=r.audio,o=r.voice_note,s=r.video_note;if(i)return null;if(o)return null;if(s)return null;break}}return null}function fe(e,t,a){if(e&&t){var n=t.chat_id,r=t.id,i=e.animation;i&&(i=B.a.get(i.id)||i,a&&i.local.is_downloading_active?B.a.cancelGetRemoteFile(i.id,t):a&&i.remote.is_uploading_active?B.a.cancelUploadFile(i.id,t):(S.a.clientUpdate({"@type":"clientUpdateActiveAnimation",chatId:n,messageId:r}),S.a.send({"@type":"openMessageContent",chat_id:n,message_id:r}),Object(E.q)({chatId:n,messageId:r})))}}function ge(e,t,a){if(e&&t){var n=t.chat_id,r=t.id,i=e.audio;i&&(i=B.a.get(i.id)||i,a&&i.local.is_downloading_active?B.a.cancelGetRemoteFile(i.id,t):a&&i.remote.is_uploading_active?B.a.cancelUploadFile(i.id,t):(Object(_.c)(i,t,(function(){return B.a.updateAudioBlob(n,r,i.id)})),S.a.send({"@type":"openMessageContent",chat_id:n,message_id:r}),S.a.clientUpdate({"@type":"clientUpdateMediaActive",chatId:n,messageId:r})))}}function ve(e,t,a){if(e&&t){var n=t.chat_id,r=t.id,i=Object(j.k)(e.sizes);if(i){var o=i.photo;o&&(o=B.a.get(o.id)||o,a&&o.local.is_downloading_active?B.a.cancelGetRemoteFile(o.id,t):a&&o.remote.is_uploading_active?B.a.cancelUploadFile(o.id,t):(Object(_.c)(o,t,(function(){return B.a.updatePhotoBlob(n,r,o.id)})),S.a.send({"@type":"openMessageContent",chat_id:n,message_id:r}),Object(E.q)({chatId:n,messageId:r})))}}}function be(e,t,a){if(e&&t){var n=t.chat_id,r=t.id;S.a.send({"@type":"openMessageContent",chat_id:n,message_id:r}),Object(E.k)(e.user_id,!0)}}function Ce(e,t,a){if(e&&t){var n=t.chat_id,r=t.id,i=e.document;i&&(i=B.a.get(i.id)||i,a&&i.local.is_downloading_active?B.a.cancelGetRemoteFile(i.id,t):a&&i.remote.is_uploading_active?B.a.cancelUploadFile(i.id,t):(S.a.send({"@type":"openMessageContent",chat_id:n,message_id:r}),ce(n,r)?(S.a.send({"@type":"openMessageContent",chat_id:n,message_id:r}),Object(E.q)({chatId:n,messageId:r})):Object(_.K)(i,e.file_name,t)))}}function ye(e,t,a){if(e&&t){var n=t.chat_id,r=t.id,i=e.animation;if(i){var o=i.animation;if(!o)return;if(o=B.a.get(o.id)||o,a&&o.local.is_downloading_active)return void B.a.cancelGetRemoteFile(o.id,t);if(a&&o.remote.is_uploading_active)return void B.a.cancelUploadFile(o.id,t);Object(_.c)(o,t,(function(){return B.a.updateAnimationBlob(n,r,o.id)}))}S.a.send({"@type":"openMessageContent",chat_id:n,message_id:r}),S.a.clientUpdate({"@type":"clientUpdateActiveAnimation",chatId:n,messageId:r})}}function ke(e,t,a){if(e&&t){var n=t.chat_id,r=t.id,i=Object(j.k)(e.sizes);if(i){var o=i.photo;o&&(o=B.a.get(o.id)||o,a&&o.local.is_downloading_active?B.a.cancelGetRemoteFile(o.id,t):a&&o.remote.is_uploading_active?B.a.cancelUploadFile(o.id,t):(Object(_.c)(o,t,(function(){return B.a.updatePhotoBlob(n,r,o.id)})),S.a.send({"@type":"openMessageContent",chat_id:n,message_id:r}),Object(E.q)({chatId:n,messageId:r})))}}}function Ee(e,t,a){return Se.apply(this,arguments)}function Se(){return(Se=Object(i.a)(r.a.mark((function e(t,a,n){var i,o,s,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(a){e.next=4;break}return e.abrupt("return");case 4:if(i=a.chat_id,o=a.id,S.a.send({"@type":"openMessageContent",chat_id:i,message_id:o}),s=t.set_id){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,S.a.send({"@type":"getStickerSet",set_id:s});case 11:if(c=e.sent){e.next=14;break}return e.abrupt("return");case 14:S.a.clientUpdate({"@type":"clientUpdateStickerSet",stickerSet:c});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oe(e,t,a){if(e&&t){var n=t.chat_id,r=t.id,i=e.video;i&&(i=B.a.get(i.id)||i,a&&i.local.is_downloading_active?B.a.cancelGetRemoteFile(i.id,t):a&&i.remote.is_uploading_active?B.a.cancelUploadFile(i.id,t):(S.a.send({"@type":"openMessageContent",chat_id:n,message_id:r}),Object(E.q)({chatId:n,messageId:r})))}}function Ue(e,t,a){if(e&&t){var n=t.chat_id,r=t.id,i=e.video;i&&(i=B.a.get(i.id)||i,a&&i.local.is_downloading_active?B.a.cancelGetRemoteFile(i.id,t):a&&i.remote.is_uploading_active?B.a.cancelUploadFile(i.id,t):(Object(_.c)(i,t,(function(){return B.a.updateVideoNoteBlob(n,r,i.id)})),S.a.send({"@type":"openMessageContent",chat_id:n,message_id:r}),S.a.clientUpdate({"@type":"clientUpdateMediaActive",chatId:n,messageId:r})))}}function we(e,t,a){if(e&&t){var n=t.chat_id,r=t.id,i=e.voice;i&&(i=B.a.get(i.id)||i,a&&i.local.is_downloading_active?B.a.cancelGetRemoteFile(i.id,t):a&&i.remote.is_uploading_active?B.a.cancelUploadFile(i.id,t):(Object(_.c)(i,t,(function(){return B.a.updateVoiceNoteBlob(n,r,i.id)})),S.a.send({"@type":"openMessageContent",chat_id:n,message_id:r}),S.a.clientUpdate({"@type":"clientUpdateMediaActive",chatId:n,messageId:r})))}}function Me(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=A.a.get(e,t);if(n){var r=n.content;if(!r)return null;switch(r["@type"]){case"messageAnimation":var i=r.animation;i&&fe(i,n,a);break;case"messageAudio":var o=r.audio;o&&ge(o,n,a);break;case"messageChatChangePhoto":var s=r.photo;s&&ve(s,n,a);break;case"messageContact":var c=r.contact;c&&be(c,n);break;case"messageDocument":var l=r.document;l&&Ce(l,n,a);break;case"messageGame":var u=r.game;u&&ye(u,n,a);break;case"messagePhoto":var d=r.photo;d&&ke(d,n,a);break;case"messageSticker":var p=r.sticker;p&&Ee(p,n,a);break;case"messageText":var h=r.web_page;if(h){var m=h.animation,f=h.audio,g=h.document,v=h.photo,b=h.sticker,C=h.video,y=h.video_note,k=h.voice_note;m&&fe(m,n,a),f&&ge(f,n,a),g&&Ce(g,n,a),b&&Ee(b,n,a),C&&Oe(C,n,a),y&&Ue(y,n,a),k&&we(k,n,a),v&&ke(v,n,a)}break;case"messageVideo":var E=r.video;E&&Oe(E,n,a);break;case"messageVideoNote":var S=r.video_note;S&&Ue(S,n,a);break;case"messageVoiceNote":var O=r.voice_note;O&&we(O,n,a)}}}function Ie(e){return e&&"deletedMessage"===e["@type"]}function je(e,t){var a=A.a.get(e,t);if(a){var n=a.content;if(!n)return null;switch(n["@type"]){case"messageAnimation":var r=n.animation;return r&&r.minithumbnail||null;case"messageAudio":return null;case"messageChatChangePhoto":var i=n.photo;return i&&i.minithumbnail||null;case"messageDocument":var o=n.document;return o&&o.minithumbnail||null;case"messageGame":var s=n.game;if(!s)return null;var c=s.animation,l=s.photo;if(c){var u=c.minithumbnail;if(u)return u}return l&&l.minithumbnail||null;case"messagePhoto":var d=n.photo;return d&&d.minithumbnail||null;case"messageSticker":return null;case"messageText":var p=n.web_page;if(p){var h=p.animation,m=p.audio,f=p.document,g=p.photo,v=p.sticker,b=p.video,C=p.video_note;if(g)return g.minithumbnail||null;if(h)return h.minithumbnail||null;if(m)return null;if(f)return f.minithumbnail||null;if(v)return null;if(b)return b.minithumbnail||null;if(C)return C.minithumbnail||null}break;case"messageVideo":var y=n.video;return y&&y.minithumbnail||null;case"messageVideoNote":var k=n.video_note;return k&&k.minithumbnail||null}return null}}function _e(e,t){var a=A.a.get(e,t);if(a){var n=a.content;if(!n)return null;switch(n["@type"]){case"messageAnimation":var r=n.animation;return r&&r.thumbnail||null;case"messageAudio":var i=n.audio;return i&&i.album_cover_thumbnail||null;case"messageChatChangePhoto":var o=n.photo;return o?Object(j.k)(o.sizes):null;case"messageDocument":var s=n.document;return s&&s.thumbnail||null;case"messageGame":var c=n.game;if(!c)return null;var l=c.animation,u=c.photo;if(l){var d=l.thumbnail;if(d)return d}return u?Object(j.k)(u.sizes):null;case"messagePhoto":var p=n.photo;return p?Object(j.k)(p.sizes):null;case"messageSticker":var h=n.sticker;return h&&h.thumbnail||null;case"messageText":var m=n.web_page;if(m){var f=m.animation,g=m.audio,v=m.document,b=m.photo,C=m.sticker,y=m.video,k=m.video_note;if(b)return Object(j.k)(b.sizes);if(f)return f.thumbnail||null;if(g)return g.album_cover_thumbnail||null;if(v)return v.thumbnail||null;if(C)return C.thumbnail||null;if(y)return y.thumbnail||null;if(k)return k.thumbnail||null}break;case"messageVideo":var E=n.video;return E&&E.thumbnail||null;case"messageVideoNote":var S=n.video_note;return S&&S.thumbnail||null}return null}}function xe(e,t){var a=A.a.get(e,t);if(!a)return 0;var n=a.content;if(!n)return 0;if("messageText"!==n["@type"])return 0;var r=n.text;if(r){if("formattedText"!==r["@type"])return 0;var i=r.text,o=r.entities;if(!i)return 0;if(o&&o.length>0)return 0;var s,c=0,l=0,d=u()();do{if(s=d.exec(i)){if(l+=1,c!==s.index){l=0;break}if(l>3){l=0;break}c=d.lastIndex}if(!s&&c!==i.length){l=0;break}}while(s);return l}}function Te(e,t){return e.id-t.id}function Le(e,t){if(!t)return!1;if(!t.length)return!1;for(var a=0;a<t.length;a++)if(e>=t[a].offset&&e<t[a].offset+t[a].length)return!0;return!1}function Pe(e,t,a){if(!a)return!1;if(!a.length)return!1;for(var n=0;n<a.length;n++)if(e<=a[n].offset&&a[n].offset+a[n].length-1<=t)return!0;return!1}function Ne(e,t,a){return!Le(e,a)&&!Le(t,a)&&!Pe(e,t,a)}function De(e,t,a){a&&a.length&&a.forEach((function(a){a.offset>e&&(a.offset-=t)}))}function Re(e,t,a){a&&a.length&&a.forEach((function(a){a.offset>e&&(a.offset+=t)}))}function Be(e,t,a){if(a&&a.length)for(var n=0;n<a.length;n++){var r=a[n],i=r.offset,o=r.offset+r.length-1;(e<=i&&i<=t||e<=o&&o<=t||i<e&&t>o)&&a.splice(n--,1)}}function Ae(e,t,a,n){var r=document.createTextNode(a.substr(e,t));n.push(r)}function Fe(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e};if(!e)return[];t=(t||[]).sort((function(e,t){return e.offset-t.offset!==0?e.offset-t.offset:t.length-e.length}));var n=[],r=0,i=null;return t.forEach((function(t){if(t.offset-r>0&&(Ae(r,t.offset-r,e,n),r=t.offset),!i||!Le(t.offset,[i])){switch(t.type["@type"]){case"textEntityTypeBold":var o=document.createElement("b");o.innerText=e.substr(t.offset,t.length),n.push(o);break;case"textEntityTypeBotCommand":case"textEntityTypeCashtag":Ae(t.offset,t.length,e,n);break;case"textEntityTypeCode":var s=document.createTextNode("`"+e.substr(t.offset,t.length)+"`");n.push(s);break;case"textEntityTypeEmailAddress":case"textEntityTypeHashtag":Ae(t.offset,t.length,e,n);break;case"textEntityTypeItalic":var c=document.createElement("i");c.innerText=e.substr(t.offset,t.length),n.push(c);break;case"textEntityTypeMention":Ae(t.offset,t.length,e,n);break;case"textEntityTypeMentionName":try{var l=t.type.user_id;if(F.a.get(l)){var u=document.createElement("a");u.title=Object(P.c)(l,null,a),u.dataset.userId=l,u.innerText=e.substr(t.offset,t.length),n.push(u)}else Ae(t.offset,t.length,e,n)}catch(f){Ae(t.offset,t.length,e,n)}break;case"textEntityTypePhoneNumber":Ae(t.offset,t.length,e,n);break;case"textEntityTypePre":var d=document.createTextNode("```"+e.substr(t.offset,t.length)+"```");n.push(d);break;case"textEntityTypePreCode":var p=document.createTextNode("```"+e.substr(t.offset,t.length)+"```");n.push(p);break;case"textEntityTypeTextUrl":try{var h=t.type.url,m=document.createElement("a");m.href=Object(T.a)(h,!1),m.title=Object(T.a)(h,!1),m.target="_blank",m.rel="noopener noreferrer",m.innerText=e.substr(t.offset,t.length),n.push(m)}catch(g){Ae(t.offset,t.length,e,n)}break;case"textEntityTypeUrl":default:Ae(t.offset,t.length,e,n)}i=t,r+=t.length}})),r<e.length&&Ae(r,e.length-r,e,n),n}function Ve(e){var t=[];return e?{text:e=ze(e=function(e,t){var a=!1,n=-1,r=0,i=-1,o=0,s=0;for(;-1!==(n=e.indexOf(a?"```":"`",r));)if(-1===i)a=e.length-n>2&&"`"===e[n+1]&&"`"===e[n+2],i=n,r=n+(a?3:1);else{for(var c=n+(a?3:1);c<e.length&&"`"===e[c];c++)n++;if(r=n+(a?3:1),a){var l=e.substring(0,i),u=e.substring(i+3,n),d=e.substring(n+3,e.length);if(u.length>0){var p={"@type":"textEntity",offset:o=i,length:s=n-i-3,language:"",type:{"@type":"textEntityTypePre"},textContent:(e=l+u+d).substring(o,o+s)};if(Be(o,o+s-1+6),De(o+s,6,t),t.push(p),r-=6,l.length>0){var h=l[l.length-1];"\n"!==h&&(" "===h||"\xa0"===h?(l=l.substr(0,l.length-1)+"\n",e=l+u+d):(e=(l+="\n")+u+d,Re(o-1,1,t),r+=1))}if(d.length>0){var m=d[0];"\n"!==m&&(" "===m||"\xa0"===m?(d="\n"+d.substr(1),e=l+u+d):(e=l+u+(d="\n"+d),Re(o+s-1,1,t),r+=1))}u.length>2&&"\n"===u[0]&&(u=u.substring(1),e=l+u+d,p.length-=1,p.textContent=u,De(p.offset+p.length-1,1,t),r-=1),u.length>2&&"\n"===u[u.length-1]&&(u=u.substring(0,u.length-1),e=l+u+d,p.length-=1,p.textContent=u,De(p.offset+p.length-1,1,t),r-=1)}}else if(i+1!==n){o=i,s=n-i-1,e=e.substring(0,i)+e.substring(i+1,n)+e.substring(n+1,e.length);var f={"@type":"textEntity",offset:o,length:s,type:{"@type":"textEntityTypeCode"},textContent:e.substring(o,o+s)};Be(o,o+s-1+2),De(o+s,2,t),t.push(f),r-=2}i=-1,a=!1}if(-1!==i&&a&&Ne(o=i,o+(s=1)+2-1,t)){e=e.substring(0,i)+e.substring(i+2,e.length);var g={"@type":"textEntity",offset:o,length:s,type:{"@type":"textEntityTypeCode"},textContent:e.substring(o,o+s)};Be(o,o+s-1+2),De(o+s,2,t),t.push(g)}return e}(e=function(e,t){var a=(new DOMParser).parseFromString(e,"text/html"),n=0,r=0,i="";return a.body.childNodes.forEach((function(e){var a=e.textContent,o=e.nodeName;if(r=a.length,i+=a,Ne(n,n+r-1,t))switch(o){case"#text":n+=r;break;case"A":e.dataset.userId?t.push({"@type":"textEntity",offset:n,length:r,type:{"@type":"textEntityTypeMentionName",user_id:e.dataset.userId},textContent:i.substring(n,n+r)}):e.href&&t.push({"@type":"textEntity",offset:n,length:r,type:{"@type":"textEntityTypeTextUrl",url:e.href},textContent:i.substring(n,n+r)}),n+=r;break;case"B":case"STRONG":t.push({"@type":"textEntity",offset:n,length:r,type:{"@type":"textEntityTypeBold"},textContent:i.substring(n,n+r)}),n+=r;break;case"BR":break;case"CODE":t.push({"@type":"textEntity",offset:n,length:r,type:{"@type":"textEntityTypeCode"},textContent:i.substring(n,n+r)}),n+=r;break;case"I":case"EM":t.push({"@type":"textEntity",offset:n,length:r,type:{"@type":"textEntityTypeItalic"},textContent:i.substring(n,n+r)}),n+=r;break;case"PRE":t.push({"@type":"textEntity",offset:n,length:r,type:{"@type":"textEntityTypePre"},textContent:i.substring(n,n+r)}),n+=r;break;default:n+=r}})),e=i}(e=(e=(e=(e=e.replace(/<div><br><\/div>/gi,"<br>")).replace(/<div>/gi,"<br>")).replace(/<\/div>/gi,"")).split("<br>").join("\n"),t),t),t),entities:t}:{text:e,entities:t}}function ze(e,t){for(var a=-1,n=0,r=-1,i=0,o=0,s=0;s<2;s++){n=0,r=-1;for(var c=0===s?"**":"__",l=0===s?"*":"_";-1!==(a=e.indexOf(c,n));)if(-1===r){var u=0===a?" ":e[a-1];Le(a,t)||" "!==u&&"\xa0"!==u&&"\n"!==u||(r=a),n=a+2}else{for(var d=a+2;d<e.length&&e[d]===l;d++)a++;if(n=a+2,Le(a,t)||Pe(r,a,t)){r=-1;continue}if(r+2!==a){var p={"@type":"textEntity",offset:i=r,length:o=a-r-2,language:"",type:{"@type":0===s?"textEntityTypeBold":"textEntityTypeItalic"},textContent:(e=e.substring(0,r)+e.substring(r+2,a)+e.substring(a+2,e.length)).substring(i,i+o)};De(i+o,4,t),t.push(p),n-=4}r=-1}}return e}function He(e,t){var a=A.a.get(e,t);return!!a&&a.can_be_edited}function We(e,t){var a=A.a.get(e,t);if(!a)return!1;var n=a.forward_info,r=a.content;return n&&r&&"messageSticker"!==r["@type"]&&"messageAudio"!==r["@type"]}function Ge(e,t){var a=A.a.get(e,t);if(!a)return!1;var n=a.content;return n&&"messageText"===n["@type"]}function Ze(e,t){var a=R.a.get(e);return!!a&&a.pinned_message_id===t}function qe(e,t){var a=A.a.get(e,t);if(!a)return!1;var n=a.content;if(n&&"messagePoll"===n["@type"]){var r=n.poll;if(!r)return!1;var i=r.type,o=r.is_closed,s=r.options;return!!i&&("pollTypeRegular"===i["@type"]&&(!o&&s.some((function(e){return e.is_chosen||e.is_being_chosen}))))}}function Ke(e,t){var a=A.a.get(e,t);if(!a)return!1;var n=a.content,r=a.can_be_edited;return n&&"messagePoll"===n["@type"]?r:void 0}function Je(e,t){var a=A.a.get(e,t);return a&&a.can_be_forwarded}function Ye(e,t){var a=A.a.get(e,t);return a&&(a.can_be_deleted_only_for_self||a.can_be_deleted_for_all_users)}function Qe(e,t){var a=A.a.get(e,t);if(!a)return null;var n=a.content;if(!n)return null;switch(n["@type"]){case"messageAnimation":var r=n.animation;if(!r)return null;var i=r.width,o=r.height,s=r.thumbnail,c={width:i,height:o}||s;if(!c)return null;var l=Object(j.h)(c,N.D,!1);return l?{width:l.width}:null;case"messagePhoto":var u=n.photo;if(!u)return null;var d=Object(j.n)(u.sizes,N.F);if(!d)return null;var p=Object(j.h)(d,N.D,!1);return p?{width:p.width}:null;case"messageVideo":var h=n.video;if(!h)return null;var m=h.thumbnail,f={width:h.width,height:h.height}||m;if(!f)return null;var g=Object(j.h)(f,N.D);return g?{width:g.width}:null}return null}},function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(37);t.a=Object(i.a)(r.a.createElement("path",{d:"M5.29289322,5.29289322 C5.68341751,4.90236893 6.31658249,4.90236893 6.70710678,5.29289322 L6.70710678,5.29289322 L12,10.585 L17.2928932,5.29289322 C17.6834175,4.90236893 18.3165825,4.90236893 18.7071068,5.29289322 C19.0976311,5.68341751 19.0976311,6.31658249 18.7071068,6.70710678 L13.415,12 L18.7071068,17.2928932 C19.0675907,17.6533772 19.0953203,18.2206082 18.7902954,18.6128994 L18.7071068,18.7071068 C18.3165825,19.0976311 17.6834175,19.0976311 17.2928932,18.7071068 L17.2928932,18.7071068 L12,13.415 L6.70710678,18.7071068 C6.31658249,19.0976311 5.68341751,19.0976311 5.29289322,18.7071068 C4.90236893,18.3165825 4.90236893,17.6834175 5.29289322,17.2928932 L10.585,12 L5.29289322,6.70710678 C4.93240926,6.34662282 4.90467972,5.77939176 5.20970461,5.38710056 Z"}),"Close")},,,function(e,t,a){"use strict";a.d(t,"d",(function(){return pe})),a.d(t,"l",(function(){return he})),a.d(t,"m",(function(){return me})),a.d(t,"k",(function(){return fe})),a.d(t,"c",(function(){return ge})),a.d(t,"a",(function(){return ve})),a.d(t,"b",(function(){return be})),a.d(t,"j",(function(){return Ce})),a.d(t,"i",(function(){return ye})),a.d(t,"e",(function(){return Oe})),a.d(t,"f",(function(){return Ue})),a.d(t,"g",(function(){return Ie})),a.d(t,"h",(function(){return _e}));var n=a(7),r=a.n(n),i=a(13),o=a(27),s=a(16),c=a(129),l=a(373),u=a(379),d=a(8),p=a(9),h=a(11),m=a(10),f=a(0),g=a.n(f),v=a(127),b=a.n(v),C=a(286),y=a(406),k=a.n(y),E=a(22),S=(a(461),function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.messageId,n=e.duration,r=(e.openMedia,e.title),i=e.meta,o=pe(t,a),s=Object(E.f)(Math.floor(n||0));return g.a.createElement("div",{className:b()("document",{"media-title":r})},g.a.createElement(C.a,{color:"primary","aria-label":"Call"},g.a.createElement(k.a,{fontSize:"large"})),g.a.createElement("div",{className:"document-content"},g.a.createElement("div",{className:"document-title"},o),g.a.createElement("div",{className:"document-action"},s,i)))}}]),a}(g.a.Component)),O=a(31),U=a(356),w=a(90),M=a(344),I=a(77),j=(a(462),function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"render",value:function(){var e=this.props,t=e.contact,a=e.title,n=e.openMedia,r=e.meta,i=e.caption,o=e.t;if(!t)return null;var s=t.user_id,c=t.first_name,l=t.last_name,u=t.phone_number,d=I.a.get(s)||{"@type":"user",type:{"@type":"userTypeRegular"},id:s,first_name:c,last_name:l},p=Object(M.c)(s,d,o),h=Object(w.a)(u);return g.a.createElement("div",{className:b()("contact",{"media-title":a})},g.a.createElement("div",{className:"contact-tile"},g.a.createElement(U.a,{userId:s,firstName:c,lastName:l})),g.a.createElement("div",{className:"contact-content"},g.a.createElement("div",{className:"contact-name"},s>0?g.a.createElement("a",{onClick:n},p):g.a.createElement("span",null,p)),g.a.createElement("div",{className:"contact-phone"},h,!i&&r)))}}]),a}(g.a.Component)),_=Object(O.d)()(j),x=a(423),T=a(362),L=a(339),P=a(337),N=(a(466),function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).getContent=function(){var t=e.props,a=t.chatId,n=t.messageId,r=t.game,i=t.size,o=t.displaySize,s=t.openMedia;if(!r)return null;var c=r.photo,u=r.animation;if(u&&(Object(P.l)(u.animation)||u.thumbnail))return g.a.createElement(l.a,{chatId:a,messageId:n,animation:u,openMedia:s});if(c){var d={width:0,height:0},p=Object(E.n)(c.sizes,i);if(p){var h=Object(E.h)(p,o);h&&(d.width=h.width,d.height=h.height)}return g.a.createElement(T.a,{chatId:a,messageId:n,photo:c,style:d,openMedia:s})}return null},e}return Object(p.a)(a,[{key:"render",value:function(){var e=this.props,t=e.game,a=e.t;if(!t)return null;var n=t.title,r=t.text,i=t.description,o=Object(L.n)(r,a);return g.a.createElement("div",{className:"game"},g.a.createElement("div",{className:"border"}),g.a.createElement("div",{className:"game-wrapper"},n&&g.a.createElement("div",{className:"game-title"},n),o&&g.a.createElement("div",{className:"game-text"},o),i&&g.a.createElement("div",{className:"game-description"},i),this.getContent()))}}]),a}(g.a.Component));N.defaultProps={size:s.F,displaySize:s.D};var D=Object(O.d)()(N),R=a(383),B=a(422),A=a(355),F=(a(471),function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.messageId,n=e.venue,r=e.openMedia,i=e.meta,o=e.title,s=e.caption;if(!n)return null;var c=n.title,l=n.address,u=n.location;if(!u)return null;var d=u.longitude,p=u.latitude,h="https://maps.google.com/?q=".concat(p,",").concat(d);return g.a.createElement("div",{className:"venue"},g.a.createElement(R.a,{type:"venue",chatId:t,messageId:a,location:u,openMedia:r,title:o,caption:s}),g.a.createElement("div",{className:"venue-content"},g.a.createElement("a",{href:h,target:"_blank",rel:"noopener noreferrer"},g.a.createElement("div",{className:"venue-title"},c)),g.a.createElement("div",{className:"venue-subtitle"},l,!s&&i)))}}]),a}(g.a.Component)),V=a(384),z=a(407),H=a(409),W=a(336);var G=function(e,t,a){return 0!==(e[t]&1<<a)};function Z(e,t){if(255===e[0]&&254===e[1]&&254===e[2]&&255===e[3]&&(e=e.slice(2)),"utf16le"===t||"utf16"===t)return function(e){var t=2,a="utf-16";return 254===e[0]&&255===e[1]?(t=2,a="utf-16be"):255===e[0]&&254===e[1]&&(t=2,a="utf-16le"),new TextDecoder(a).decode(e.slice(t))}(e);if("utf8"===t)return function(e){return new TextDecoder("utf-8").decode(e)}(e);if("iso-8859-1"===t)return function(e){return new TextDecoder("iso-8859-1").decode(e)}(e);throw Error(t+" encoding is not supported!")}var q=function(e,t){return 127&e[t+3]|e[t+2]<<7|e[t+1]<<14|e[t]<<21},K=function(e,t){return e[t]},J=function(e,t){return e[t+3]|e[t+2]<<8|e[t+1]<<16|e[t]<<24},Y=function(e,t){return e[t+2]|e[t+1]<<8|e[t]<<16},Q=function(e,t){return e[t+1]|e[t]<<8},X=function(e,t,a){return new TextDecoder("ascii").decode(e.slice(t,t+a))},$=function(e,t,a){var n=new TextDecoder("ascii").decode(e.slice(t,t+a));return(n=(n=function(e){var t=e.indexOf("\0");return-1===t?e:e.substr(0,t)}(n)).trim()).length>0?n:void 0},ee=128,te=function(e,t){var a=$(e,t,3);return"TAG"===a?{header:a,title:$(e,t+3,30),artist:$(e,t+33,30),album:$(e,t+63,30),year:$(e,t+93,4),comment:$(e,t+97,28),zeroByte:K(e,t+127),track:K(e,t+126),genre:K(e,t+127)}:null},ae=function(){function e(){Object(d.a)(this,e)}return Object(p.a)(e,[{key:"parse",value:function(e){return e.length<128?(console.log("[ID3v1Parser] Skip checking for ID3v1 because the file-size is less than 128 bytes"),null):te(e,e.length-ee)}}]),e}();function ne(e){return e.length>=128&&"TAG"===$(e,e.length-128,3)}var re=function(e,t){return{fileIdentifier:X(e,t,3),version:{major:e[t+3],revision:e[t+4]},flags:{raw:e[t+5],unsynchronisation:G(e,t+5,7),isExtendedHeader:G(e,t+5,6),expIndicator:G(e,t+5,5),footer:G(e,t+5,4)},size:q(e,t+6)}},ie=10,oe=function(e,t){var a=J(e,t),n=Q(e,t+4),r=J(e,t+6),i=G(e,t+4,31);return{size:a,extendedFlags:n,sizeOfPadding:r,crcDataPresent:i,crcData:i?J(e,t+10):null}},se=function(e,t){switch(e[t]){case 0:return{encoding:"iso-8859-1"};case 1:return{encoding:"utf16",bom:!0};case 2:return{encoding:"utf16",bom:!1};case 3:default:return{encoding:"utf8",bom:!1}}},ce=function(){function e(t){Object(d.a)(this,e),this.major=t}return Object(p.a)(e,[{key:"readData",value:function(e,t){if(0!==e.length){var a=se(e,0),n=a.encoding,r=a.bom,i=[];switch(console.debug("Parsing tag type=".concat(t,", encoding=").concat(n,", bom=").concat(r)),t){case"TPE1":case"TIT2":var o=Z(e.slice(1),n).replace(/\x00+$/,"");i=this.major>=4?this.splitValue(t,o):[o]}return i}console.log("id3v2.".concat(this.major," header has empty tag type=").concat(t))}},{key:"splitValue",value:function(t,a){var n;return this.major<4?(n=a.split(/\x00/g)).length>1?console.log("ID3v2.".concat(this.major," ").concat(t," uses non standard null-separator.")):n=a.split(/\//g):n=a.split(/\x00/g),e.trimArray(n)}}],[{key:"trimArray",value:function(e){return e.map((function(e){return e.replace(/\x00+$/,"").trim()}))}}]),e}(),le=function(){function e(){Object(d.a)(this,e)}return Object(p.a)(e,[{key:"parseMetadata",value:function(t){for(var a=0,n=[];a!==t.length;){var r=e.getFrameHeaderLength(this.id3Header.version.major);if(a+r>t.length){console.log("Illegal ID3v2 tag length");break}var i=t.slice(a,a+=r),o=e.readFrameHeader(i,this.id3Header.version.major);if(""===o.id||"\0\0\0\0"===o.id||-1==="ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(o.id[0])){console.log("Illegal ID3v2 tag header",i,o.id);break}var s=t.slice(a,a+=o.length),c=e.readFrameData(s,o,this.id3Header.version.major,!0,[]);console.log("[ID3v2Parser] parseMetadata",a,o.length,o.id,c),n.push({id:o.id,value:c})}return n}},{key:"parseExtendedHeader",value:function(e){var t=oe(e,10);return this.parseId3Data(e,this.id3Header.size+t.size+4,this.id3Header.size)}},{key:"parseId3Data",value:function(e,t,a){var n=e.slice(t,t+a);return this.parseMetadata(n)}},{key:"parse",value:function(e){var t=re(e,0);if(this.id3Header=t,"ID3"!==t.fileIdentifier)throw new Error("expected ID3-header file-identifier 'ID3' was not found");return t.flags.isExtendedHeader?this.parseExtendedHeader(e):this.parseId3Data(e,ie,t.size)}}],[{key:"removeUnsyncBytes",value:function(e){for(var t=0,a=0;t<e.length-1;)t!==a&&(e[a]=e[t]),t+=255===e[t]&&0===e[t+1]?2:1,a++;return t<e.length&&(e[a++]=e[t]),e.slice(0,a)}},{key:"readFrameData",value:function(t,a,n,r,i){var o=new ce(n,i);switch(n){case 2:return o.readData(t,a.id,r);case 3:case 4:return a.flags.format.unsynchronisation&&(t=e.removeUnsyncBytes(t)),a.flags.format.data_length_indicator&&(t=t.slice(4,t.length)),o.readData(t,a.id,r);default:throw new Error("Unexpected majorVer: "+n)}}},{key:"readFrameFlags",value:function(e){return{status:{tag_alter_preservation:G(e,0,6),file_alter_preservation:G(e,0,5),read_only:G(e,0,4)},format:{grouping_identity:G(e,1,7),compression:G(e,1,3),encryption:G(e,1,2),unsynchronisation:G(e,1,1),data_length_indicator:G(e,1,0)}}}},{key:"readFrameHeader",value:function(t,a){var n;switch(a){case 2:n={id:X(t,0,3),length:Y(t,3)};break;case 3:n={id:X(t,0,4),length:J(t,4),flags:e.readFrameFlags(t.slice(8,10))};break;case 4:n={id:X(t,0,4),length:q(t,4),flags:e.readFrameFlags(t.slice(8,10))};break;default:throw new Error("Unexpected majorVer: "+a)}return n}},{key:"getFrameHeaderLength",value:function(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw new Error("header versionIndex is incorrect")}}}]),e}();function ue(e){return e.length>10&&"ID3"===X(e,0,3)}var de=function(){function e(){Object(d.a)(this,e)}return Object(p.a)(e,[{key:"getArrayBuffer",value:function(e){return new Promise((function(t){var a=new FileReader;a.onload=function(){t(a.result)},a.readAsArrayBuffer(e)}))}},{key:"parse",value:function(){var e=Object(i.a)(r.a.mark((function e(t){var a,n,i,o,s,c,l,u;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={tags:a={artist:"",title:""}},t){e.next=4;break}return e.abrupt("return",n);case 4:return e.next=6,this.getArrayBuffer(t);case 6:if(i=e.sent){e.next=9;break}return e.abrupt("return",n);case 9:if(o=new Uint8Array(i)){e.next=12;break}return e.abrupt("return",n);case 12:return ue(o)?(s=(new le).parse(o))&&((c=s.find((function(e){return"TPE1"===e.id})))&&c.value.length>0&&(a.artist=c.value[0]),(l=s.find((function(e){return"TIT2"===e.id})))&&l.value.length>0&&(a.title=l.value[0])):ne(o)&&(u=(new ae).parse(o))&&(a.artist=u.artist,a.title=u.title),e.abrupt("return",n);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function pe(e,t){var a=c.a.get(e,t);if(!a)return null;var n=a.content,r=a.is_outgoing;if("messageCall"!==n["@type"])return null;var i=n.discard_reason;n.duration;return r?"callDiscardReasonMissed"===i["@type"]?"Cancelled Call":"Outgoing Call":"callDiscardReasonMissed"===i["@type"]?"Missed Call":"callDiscardReasonDeclined"===i["@type"]?"Declined Call":"Incoming Call"}function he(e,t){var a=c.a.get(e,t);if(a){switch(a.content["@type"]){case"messageAnimation":case"messageAudio":case"messageDocument":case"messagePhoto":case"messageVideo":return!0}return!1}}function me(e,t,a){if(!e)return!1;if(!e.is_animated)return!1;var n=c.a.get(t,a);if(n&&(n.sending_state&&!e.set_id))return!1;return!0}function fe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.nb;return!!e&&Math.max(e.width,e.height)<t}function ge(e){if(!e)return null;var t=e.file_name,a=e.title,n=e.performer,r=a?a.trim():"",i=n?n.trim():"";return r||i?"".concat(i||"Unknown Artist"," \u2014 ").concat(r||"Unknown Track"):t}function ve(e){if(!e)return null;var t=e.file_name,a=e.title,n=e.performer,r=a?a.trim():"",i=n?n.trim():"";return r||i?"".concat(i||"Unknown Artist"):t}function be(e){if(!e)return null;var t=e.title;return(t?t.trim():"")||"Unknown Track"}function Ce(e){return e.reduce((function(e,t){return e.concat(t.stickers)}),[])}function ye(e,t,a){var n=[],r=function(e,t,a){var n=t.findIndex((function(t){return t.id===e.set_id}));if(-1===n)return[-1,-1];var r=t[n].stickers.findIndex((function(t){return t.sticker.id===e.sticker.id}));if(-1===r)return[-1,-1];for(var i=0,o=0;o<n;o++)i+=Math.ceil(t[o].stickers.length/a);return[i+Math.floor(r/a),r%a]}(e,t,a),i=Object(o.a)(r,2),s=i[0],c=i[1];if(-1===s)return[];if(-1===c)return[];var l=s-2,u=s-1,d=s+1,p=s+2,h=c-1,m=c+1,f=u<0,g=l<0;if(!f){if(h>=0){var v=ke(u,h,t,a);-1===v&&(f=!0,g=-1===(v=g?-1:ke(l,h,t,a))),-1!==v&&n.push(v)}var b=f?-1:ke(u,c,t,a);if(-1===b&&(f=!0,g=-1===(b=g?-1:ke(l,c,t,a))),-1!==b&&n.push(b),m<a){var C=f?-1:ke(u,m,t,a);-1===C&&(C=g?-1:ke(l,m,t,a)),-1!==C&&n.push(C)}}if(h>=0){var y=ke(s,h,t,a);-1!==y&&n.push(y)}if(m<a){var k=ke(s,m,t,a);-1!==k&&n.push(k)}var E=t.reduce((function(e,t){return e+Math.ceil(t.stickers.length/a)}),0),S=d>=E,O=d>=E;if(!S){if(h>=0){var U=ke(d,h,t,a);-1===U&&(S=!0,O=-1===(U=O?-1:ke(p,h,t,a))),-1!==U&&n.push(U)}var w=S?-1:ke(d,c,t,a);if(-1===w&&(S=!0,O=-1===(w=O?-1:ke(p,c,t,a))),-1!==w&&n.push(w),m<a){var M=S?-1:ke(d,m,t,a);-1===M&&(M=O?-1:ke(p,m,t,a)),-1!==M&&n.push(M)}}var I=Ce(t);return n.map((function(e){return I[e]}))}function ke(e,t,a,n){for(var r=-1,i=0,o=-1,s=0;s<a.length;s++){if((i+=Math.ceil(a[s].stickers.length/n))>e){o=s;break}}if(-1===o)return r;for(var c=e,l=t,u=0;u<o;u++){c-=Math.ceil(a[u].stickers.length/n)}if((r=n*c+l)>=a[o].stickers.length)return-1;for(var d=0;d<o;d++)r+=a[d].stickers.length;return r}function Ee(e){if(!e)return null;var t=e.photo,a=e.width,n=e.height;return t?{"@type":"inputThumbnail",thumbnail:{"@type":"inputFileId",id:t.id},width:a,height:n}:null}function Se(e){return e?{"@type":"formattedText",text:e,entities:null}:null}function Oe(e,t){if(!e)return null;switch(e["@type"]){case"animation":var a=e.animation,n=e.thumbnail,r=e.width,i=e.height,o=e.duration;return{"@type":"inputMessageAnimation",animation:{"@type":"inputFileId",id:a.id},thumbnail:Ee(n),duration:o,width:r,height:i,caption:Se(t)};case"audio":var s=e.audio,c=e.album_cover_thumbnail,l=e.title,u=e.performer,d=e.duration;return{"@type":"inputMessageAudio",audio:{"@type":"inputFileId",id:s.id},album_cover_thumbnail:Ee(c),duration:d,title:l,performer:u,caption:Se(t)};case"contact":return{"@type":"inputMessageContact",contact:e};case"document":var p=e.document,h=e.thumbnail;return{"@type":"inputMessageDocument",document:{"@type":"inputFileId",id:p.id},thumbnail:Ee(h),caption:Se(t)};case"game":case"invoice":return null;case"location":return{"@type":"inputMessageLocation",location:e,live_period:0};case"photo":var m=e.sizes;if(!m.length)return null;var f=m[0],g=m[m.length-1];if(!g)return null;var v=g.photo,b=g.width,C=g.height;return{"@type":"inputMessagePhoto",photo:{"@type":"inputFileId",id:v.id},thumbnail:Ee(f),added_sticker_file_ids:[],width:b,height:C,caption:Se(t),ttl:0};case"poll":return null;case"sticker":var y=e.sticker,k=e.thumbnail,E=e.width,S=e.height;return{"@type":"inputMessageSticker",sticker:{"@type":"inputFileId",id:y.id},thumbnail:Ee(k),width:E,height:S,caption:Se(t)};case"venue":return{"@type":"inputMessageVenue",venue:e};case"video":var O=e.video,U=e.thumbnail,w=e.width,M=e.height,I=e.duration,j=e.supports_streaming;return{"@type":"inputMessageVideo",video:{"@type":"inputFileId",id:O.id},thumbnail:Ee(U),added_sticker_file_ids:[],duration:I,width:w,height:M,supports_streaming:j,caption:Se(t),ttl:0};case"videoNote":var _=e.video,x=e.thumbnail,T=e.duration,L=e.length;return{"@type":"inputMessageVideoNote",video:{"@type":"inputFileId",id:_.id},thumbnail:Ee(x),duration:T,length:L,ttl:0};case"voiceNote":var P=e.voice,N=e.duration,D=e.waveform;return{"@type":"inputMessageVideoNote",voice_note:{"@type":"inputFileId",id:P.id},duration:N,waveform:D}}return null}function Ue(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(!e)return null;var i=e.chat_id,o=e.id,s=e.content;if(!s)return null;switch(s["@type"]){case"messageAnimation":return g.a.createElement(l.a,{type:"message",title:a,caption:n,chatId:i,messageId:o,animation:s.animation,openMedia:t});case"messageAudio":return g.a.createElement(u.a,{title:a,caption:n,chatId:i,messageId:o,audio:s.audio,openMedia:t,meta:r});case"messageCall":return g.a.createElement(S,{title:a,caption:n,chatId:i,messageId:o,duraton:s.duration,discardReason:s.discard_reason,openMedia:t,meta:r});case"messageContact":return g.a.createElement(_,{title:a,caption:n,chatId:i,messageId:o,contact:s.contact,openMedia:t,meta:r});case"messageDocument":return g.a.createElement(x.a,{title:a,caption:n,chatId:i,messageId:o,document:s.document,openMedia:t,meta:r});case"messageGame":return g.a.createElement(D,{chatId:i,messageId:o,game:s.game,openMedia:t});case"messageLocation":return g.a.createElement(R.a,{type:"message",title:a,caption:n,chatId:i,messageId:o,location:s.location,openMedia:t});case"messagePhoto":return g.a.createElement(T.a,{type:"message",title:a,caption:n,chatId:i,messageId:o,photo:s.photo,openMedia:t});case"messagePoll":return g.a.createElement(B.a,{chatId:i,messageId:o,poll:s.poll,openMedia:t,meta:r});case"messageSticker":return g.a.createElement(A.b,{chatId:i,messageId:o,sticker:s.sticker,source:A.a.MESSAGE,openMedia:t});case"messageText":return null;case"messageVenue":return g.a.createElement(F,{type:"message",title:a,caption:n,chatId:i,messageId:o,venue:s.venue,openMedia:t,meta:r});case"messageVideo":return g.a.createElement(V.a,{type:"message",title:a,caption:n,chatId:i,messageId:o,video:s.video,openMedia:t});case"messageVideoNote":return g.a.createElement(z.a,{type:"message",title:a,caption:n,chatId:i,messageId:o,videoNote:s.video_note,openMedia:t});case"messageVoiceNote":return g.a.createElement(H.a,{type:"message",title:a,caption:n,chatId:i,messageId:o,voiceNote:s.voice_note,openMedia:t,meta:r});default:return["[".concat(s["@type"],"]"),r]}}function we(e){return Me.apply(this,arguments)}function Me(){return(Me=Object(i.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(i.a)(r.a.mark((function e(a){var n,i,o,s,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new de).parse(t);case 2:n=e.sent,i=n.tags,o=i.artist,s=i.title,c=document.createElement("audio"),l=URL.createObjectURL(t),c.src=l,c.addEventListener("loadedmetadata",(function(){URL.revokeObjectURL(l);var e=c.duration;c.src=null,a({title:s,performer:o,duration:Math.trunc(e)})}),!1),c.addEventListener("error",(function(){a(null)}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ie(e){return je.apply(this,arguments)}function je(){return(je=Object(i.a)(r.a.mark((function e(t){var a,n,i,o,s,c,l,u;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:if(a=-Object(E.m)(1,1e6),W.a.setBlob(a,t),n=t.name,i=t.type,o=t.size,"audio/mp3"!==i){e.next=12;break}return e.next=8,we(t);case 8:if(!(s=e.sent)){e.next=12;break}return c=s.title,l=s.performer,u=s.duration,e.abrupt("return",{"@type":"messageAudio",audio:{"@type":"audio",duration:u,title:c,performer:l,file_name:n,mime_type:i,album_cover_minithumbnail:null,album_cover_thumbnail:null,audio:{"@type":"file",id:a,size:o,expected_size:o,local:{is_downloading_completed:!0}}}});case 12:return e.abrupt("return",{"@type":"messageDocument",document:{"@type":"document",file_name:n,mime_type:i,minithumbnail:null,thumbnail:null,document:{"@type":"file",id:a,size:o,expected_size:o,local:{is_downloading_completed:!0}}}});case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _e(e){return xe.apply(this,arguments)}function xe(){return(xe=Object(i.a)(r.a.mark((function e(t){var a,n,i,s,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:if(!t.type.startsWith("image")){e.next=15;break}return e.next=5,Object(E.x)(t);case 5:return a=e.sent,n=Object(o.a)(a,2),i=n[0],s=n[1],c=-Object(E.m)(1,1e6),W.a.setBlob(c,t),l={"@type":"photoSize",photo:{"@type":"file",id:c,size:t.size,expected_size:t.expected_size,local:{is_downloading_completed:!0}},width:i,height:s},e.abrupt("return",{"@type":"messagePhoto",photo:{"@type":"photo",has_stickers:!1,minithumbnail:null,sizes:[l]}});case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},function(e,t,a){"use strict";a.d(t,"h",(function(){return g})),a.d(t,"f",(function(){return s})),a.d(t,"j",(function(){return c})),a.d(t,"c",(function(){return l})),a.d(t,"i",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"g",(function(){return h})),a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return f})),a.d(t,"e",(function(){return u}));var n=a(366),r=a(22),i=a(16),o=a(77);function s(e){if(!e)return null;if(!e.status)return null;if(e.id===i.hb)return"service notifications";if(e.type&&"userTypeBot"===e.type["@type"])return"bot";switch(e.status["@type"]){case"userStatusEmpty":return"last seen a long time ago";case"userStatusLastMonth":return"last seen within a month";case"userStatusLastWeek":return"last seen within a week";case"userStatusOffline":var t=e.status.was_online;if(!t)return"offline";var a=new Date,r=new Date(1e3*t);if(r>a)return"last seen just now";var o=new Date(a-r);if(o.getTime()/1e3<60)return"last seen just now";if(o.getTime()/1e3<3600){var s=Math.floor(o.getTime()/1e3/60);return"last seen ".concat(1===s?"1 minute":s+" minutes"," ago")}var c=new Date;if(c.setHours(0,0,0,0),r>c){if(o.getTime()/1e3<21600){var l=Math.floor(o.getTime()/1e3/60/60);return"last seen ".concat(1===l?"1 hour":l+" hours"," ago")}return"last seen today at ".concat(Object(n.a)(r,"H:MM"))}var u=new Date;return u.setDate(a.getDate()-1),c.setHours(0,0,0,0),r>u?"last seen yesterday at ".concat(Object(n.a)(r,"H:MM")):"last seen ".concat(Object(n.a)(r,"dd.mm.yyyy"));case"userStatusOnline":return"online";case"userStatusRecently":return"last seen recently"}return null}function c(e){if(!e)return!1;var t=e.id,a=e.status,n=e.type;return!!a&&(!!n&&(t!==i.hb&&("userStatusOnline"===a["@type"]&&"userTypeBot"!==n["@type"])))}function l(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e};if(!(t=o.a.get(e)||t))return null;var n=t,r=n.type,i=n.first_name,s=n.last_name;if(!r)return null;switch(r["@type"]){case"userTypeBot":case"userTypeRegular":if(i&&s)return"".concat(i," ").concat(s);if(i)return i;if(s)return s;case"userTypeDeleted":case"userTypeUnknown":return a("HiddenName")}return null}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e},a=o.a.get(e);if(!a)return null;var n=a.type,r=a.first_name,i=a.last_name;if(!n)return null;switch(n["@type"]){case"userTypeBot":case"userTypeRegular":if(r)return r;if(i)return i;case"userTypeDeleted":case"userTypeUnknown":return t("HiddenName")}return null}function d(e){var t=o.a.getFullInfo(e);return!!t&&t.is_blocked}function p(e,t,a,n){var i=o.a.get(e);if(!i&&!t&&!a)return null;var s=l(e,null,n)||"".concat(t," ").concat(a).trim(),c=Object(r.i)(s);if(c&&c.length>0)return c;i&&(t=i.first_name,a=i.last_name);var u=Object(r.g)(t)||t.charAt(0);if(u)return u;var d=Object(r.g)(a)||a.charAt(0);return d||""}function h(e){if(!e)return 0;if(!e.status)return 0;if("userTypeBot"===e.type["@type"])return 0;switch(e.status["@type"]){case"userStatusEmpty":return 1;case"userStatusLastMonth":return 10;case"userStatusLastWeek":return 100;case"userStatusOffline":return e.status.was_online;case"userStatusOnline":return e.status.expires;case"userStatusRecently":return 1e3}}function m(e){if(!e)return null;var t=e.id,a=e.sizes;return a&&a.length?{"@type":"profilePhoto",id:t,small:Object(r.n)(a,i.eb).photo,big:Object(r.n)(a,i.db).photo}:null}function f(e){if(!e)return null;var t=e.added_date;if(!t)return null;var a=new Date(1e3*t);return Object(n.a)(a,"H:MM:ss d.mm.yyyy")}function g(e){var t=o.a.get(e);return t&&"userTypeDeleted"===t.type["@type"]}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n=a(7),r=a.n(n),i=a(13),o=a(8),s=a(9),c=a(25),l=a(11),u=a(10),d=a(21),p=a(339),h=a(16),m=a(129),f=a(2),g=a(22),v=Object.freeze({NONE:"NONE",REPEAT:"REPEAT",REPEAT_ONE:"REPEAT_ONE"}),b=new(function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a),(e=t.call(this)).reset=function(){e.playlist=null,e.message=null,e.time=null,e.videoStream=null,e.instantView=null,e.pageBlock=null},e.addTdLibListener=function(){f.a.on("update",e.onUpdate),f.a.on("clientUpdate",e.onClientUpdate)},e.removeTdLibListener=function(){f.a.off("update",e.onUpdate),f.a.off("clientUpdate",e.onClientUpdate)},e.onUpdate=function(){var t=Object(i.a)(r.a.mark((function t(a){var n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=a["@type"],t.next="updateAuthorizationState"===t.t0?3:12;break;case 3:if(n=a.authorization_state){t.next=6;break}return t.abrupt("break",13);case 6:t.t1=n["@type"],t.next="authorizationStateClosed"===t.t1?9:11;break;case 9:return e.reset(),t.abrupt("break",11);case 11:case 12:return t.abrupt("break",13);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.close=function(){f.a.clientUpdate({"@type":"clientUpdateMediaClose"})},e.onClientUpdate=function(t){switch(t["@type"]){case"clientUpdateMediaClose":e.reset(),e.emit(t["@type"],t);break;case"clientUpdateMediaActive":var a=t.chatId,n=t.messageId,r=t.instantView,i=t.pageBlock,o=m.a.get(a,n);if(o)return e.message=o,e.emit(t["@type"],t),void e.getPlaylist(a,n);r&&i&&(e.instantView=r,e.pageBlock=i,e.emit(t["@type"],t));break;case"clientUpdateMediaVolume":var s=t.volume;e.volume=s,e.savePlayerSettings(),e.emit(t["@type"],t);break;case"clientUpdateMediaRepeat":var c=t.repeat;e.repeat=c,e.emit(t["@type"],t);break;case"clientUpdateMediaShuffle":var l=t.shuffle;e.shuffle=l,e.emit(t["@type"],t);break;case"clientUpdateMediaPlaybackRate":var u=t.playbackRate;e.playbackRate=u,e.savePlayerSettings(),e.emit(t["@type"],t);break;case"clientUpdateMediaPlay":e.playing=!0,e.emit(t["@type"],t);break;case"clientUpdateMediaTitleMouseOver":e.emit(t["@type"],t);break;case"clientUpdateMediaPause":e.playing=!1,e.emit(t["@type"],t);break;case"clientUpdateMediaSeek":case"clientUpdateMediaSeeking":case"clientUpdateMediaStop":e.emit(t["@type"],t);break;case"clientUpdateMediaNext":e.emit(t["@type"],t),e.moveToNextMedia(!1);break;case"clientUpdateMediaPrev":e.emit(t["@type"],t),e.moveToPrevMedia();break;case"clientUpdateMediaEnding":e.emit(t["@type"],t);break;case"clientUpdateMediaEnd":e.emit(t["@type"],t),t.moveNext&&e.moveToNextMedia(!0)||e.close();break;case"clientUpdateMediaTime":var d=t.duration,p=t.currentTime,h=t.timestamp;e.time={currentTime:p,duration:d,timestamp:h},e.emit(t["@type"],t);break;case"clientUpdateMediaCaptureStream":e.videoStream=t.stream,e.emit(t["@type"],t);break;case"clientUpdateMediaViewerPlay":case"clientUpdateMediaViewerPause":case"clientUpdateMediaViewerEnded":case"clientUpdateMediaPlaylistLoading":case"clientUpdateMediaPlaylistPrev":case"clientUpdateMediaPlaylist":case"clientUpdateMediaPlaylistNext":e.emit(t["@type"],t)}},e.moveToPrevMedia=function(){if(e.playlist&&e.message){var t=e.message,a=t.chat_id,n=t.id,r=e.playlist.messages;if(r){var i=r.findIndex((function(e){return e.chat_id===a&&e.id===n}));if(-1!==i&&i+1<r.length){var o=r[i+1];Object(p.O)(o.chat_id,o.id,!1)}}}},e.moveToNextMedia=function(t){if(!e.playlist)return!1;if(!e.message)return!1;var a=e.message,n=a.chat_id,r=a.id,i=e.playlist.messages;if(!i)return!1;var o=i.findIndex((function(e){return e.chat_id===n&&e.id===r}));if(-1===o)return!1;var s=-1;if(t)switch(e.repeat){case v.NONE:s=e.shuffle?Object(g.m)(0,i.length):o-1;break;case v.REPEAT_ONE:s=o;break;case v.REPEAT:s=e.shuffle?Object(g.m)(0,i.length):o-1>=0?o-1:i.length-1}else s=o-1;if(s>=0){var c=i[s];return Object(p.O)(c.chat_id,c.id,!1),!0}return!1},e.getPlaylist=function(){var t=Object(i.a)(r.a.mark((function t(a,n){var i,o,s,l,u,d,h;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=Object(c.a)(e),!(o=i.playlist)){t.next=5;break}if(!(s=o.messages)||-1===s.findIndex((function(e){return e.chat_id===a&&e.id===n}))){t.next=5;break}return t.abrupt("return");case 5:if(f.a.clientUpdate({"@type":"clientUpdateMediaPlaylistLoading",chatId:a,messageId:n}),l=Object(p.v)(a,n)){t.next=11;break}return e.playlist={chatId:a,messageId:n,totalCount:1,messages:[m.a.get(a,n)]},f.a.clientUpdate({"@type":"clientUpdateMediaPlaylist",playlist:e.playlist}),t.abrupt("return");case 11:return t.next=13,f.a.send({"@type":"searchChatMessages",chat_id:a,query:"",sender_user_id:0,from_message_id:n,offset:-50,limit:100,filter:l});case 13:u=t.sent,m.a.setItems(u.messages),d=u.total_count,h=u.messages,e.playlist={chatId:a,messageId:n,totalCount:d,messages:h},f.a.clientUpdate({"@type":"clientUpdateMediaPlaylist",playlist:e.playlist});case 18:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}();var n=e.loadPlayerSettings(),s=n.playbackRate,l=n.volume;return e.playbackRate=s,e.volume=l,e.repeat=v.NONE,e.shuffle=!1,e.reset(),e.addTdLibListener(),e}return Object(s.a)(a,[{key:"loadPlayerSettings",value:function(){var e=localStorage.getItem("player")||{},t=e.playbackRate,a=e.volume;return{playbackRate:t=t&&Number(t)>=1&&Number(t)<=2?Number(t):h.I,volume:a=a&&Number(a)>=0&&Number(a)<=1?Number(a):h.L}}},{key:"savePlayerSettings",value:function(){var e=this.volume,t=this.playbackRate;localStorage.setItem("player",JSON.stringify({volume:e,playbackRate:t}))}}]),a}(d.a));window.player=b,t.b=b},,,,,,,function(e,t,a){"use strict";var n=a(8),r=a(9),i=a(11),o=a(10),s=a(0),c=a.n(s),l=a(31),u=a(356),d=a(401),p=a(344),h=a(77),m=(a(449),function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).handleClick=function(){var e=r.props,t=e.userId,a=e.onSelect;a&&a(t)},r.state={user:h.a.get(e.userId)},r}return Object(r.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){return e.userId!==this.props.userId}},{key:"render",value:function(){var e=this.props,t=e.userId,a=e.t,n=e.showStatus,r=Object(p.c)(t,null,a),i=h.a.get(t),o=i.is_contact,s=i.username;return c.a.createElement("div",{className:"user",onClick:this.handleClick},c.a.createElement("div",{className:"user-wrapper"},c.a.createElement(u.a,{userId:t}),c.a.createElement("div",{className:"user-inner-wrapper"},c.a.createElement("div",{className:"tile-first-row"},c.a.createElement("div",{className:"user-title"},r)),n&&c.a.createElement("div",{className:"tile-second-row"},!o&&s?c.a.createElement("div",{className:"user-content dialog-content"},"@"+s):c.a.createElement(d.a,{userId:t})))))}}]),a}(c.a.Component));m.defaultProps={showStatus:!0},t.a=Object(l.d)()(m)},function(e,t,a){"use strict";var n=a(27),r=a(8),i=a(9),o=a(11),s=a(10),c=a(0),l=a.n(c),u=a(127),d=a.n(u),p=a(642),h=a(340),m=a(16),f=a(336),g=(a(455),function(e){Object(o.a)(a,e);var t=Object(s.a)(a);function a(e){var n;Object(r.a)(this,a),(n=t.call(this,e)).onUpdateFile=function(e){var t=n.state.file,a=e.file;t&&t.id===a.id&&(n.fileEquals(a,t)||n.setState({file:a,prevFile:t}))},n.isDownloading=function(e,t){if(!n.props.download)return!1;var a=t&&t.local&&t.local.is_downloading_active,r=e&&e.local&&e.local.is_downloading_active;return a||r},n.isUploading=function(e,t){if(!n.props.upload)return!1;var a=t&&t.remote&&t.remote.is_uploading_active,r=e&&e.remote&&e.remote.is_uploading_active;return a||r},n.getProgressParams=function(e,t){var a=e.local,r=e.remote,i=!1,o=!1,s=!1,c=0,l=0;return n.isDownloading(e,t)?(i=t&&t.local&&t.local.is_downloading_active,o=a.is_downloading_active,s=a.is_downloading_completed,c=a.downloaded_size,l=e.size):n.isUploading(e,t)&&(i=t&&t.remote&&t.remote.is_uploading_active,o=r.is_uploading_active,s=r.is_uploading_completed,c=r.uploaded_size,l=e.size),[i,o,s,c,l]},n.completeAnimation=!1;var i=n.props.file;return n.state={prevPropsFile:i,prevFile:null,file:f.a.get(i.id)||i},n}return Object(i.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props,n=a.download,r=a.upload,i=a.icon,o=a.thumbnailSrc;if(e.thumbnailSrc!==o)return!0;if(e.icon!==i)return!0;if(this.isDownloading(t.file,t.prevFile)&&!n)return!1;if(this.isUploading(t.file,t.prevFile)&&!r)return!1;var s=t.file?t.file.local:null,c=t.file?t.file.idb_key:null,l=this.state.prevFile?this.state.prevFile.local:null,u=this.state.prevFile?this.state.prevFile.idb_key:null,d=l&&s&&!l.is_downloading_completed&&s.is_downloading_completed,p=c&&!u;return(t.file.id!==this.state.file.id||!d||!p)&&(t.file!==this.state.file||t.prevFile!==this.state.prevFile)}},{key:"componentDidMount",value:function(){this.mount=!0,f.a.on("updateFile",this.onUpdateFile)}},{key:"componentWillUnmount",value:function(){this.mount=!1,f.a.off("updateFile",this.onUpdateFile)}},{key:"fileEquals",value:function(e,t){if(e===t&&null===e)return!0;if(null!==e&&null===t)return!1;if(null===e&&null!==t)return!1;var a=e.local,n=e.remote,r=t.local,i=t.remote;return a.can_be_deleted===r.can_be_deleted&&(a.can_be_downloaded===r.can_be_downloaded&&(a.download_offset===r.download_offset&&(a.downloaded_prefix_size===r.downloaded_prefix_size&&(a.downloaded_size===r.downloaded_size&&(a.is_downloading_active===r.is_downloading_active&&(a.is_downloading_completed===r.is_downloading_completed&&(a.path===r.path&&(n.id===i.id&&(n.is_uploading_active===i.is_uploading_active&&(n.is_uploading_completed===i.is_uploading_completed&&n.uploaded_size===i.uploaded_size))))))))))}},{key:"render",value:function(){var e=this,t=this.props,a=t.thumbnailSrc,r=t.cancelButton,i=t.zIndex,o=t.icon,s=t.completeIcon,c=this.state,u=c.file,f=c.prevFile;if(!u)return null;var g=this.getProgressParams(u,f),v=Object(n.a)(g,5),b=v[0],C=v[1],y=v[2],k=v[3],E=v[4],S=C,O=0;C&&(O=k&&E?100-(E-k)/E*100:1),b&&!C&&(this.completeAnimation=!0,O=y?100:0,S=!0,setTimeout((function(){e.completeAnimation=!1,e.mount&&e.setState({prevFile:null})}),m.b));var U={zIndex:i,background:a||"undefined"===typeof a?"rgba(0, 0, 0, 0.25)":null};return u&&u.local&&(u.local.is_downloading_completed||u.idb_key||u.local.is_uploading_completed)&&!this.completeAnimation&&!C?s?l.a.createElement("div",{className:d()("file-progress","file-progress-complete"),style:U},s):null:S||this.completeAnimation?l.a.createElement("div",{className:"file-progress",style:U},l.a.createElement(p.a,{className:"file-progress-indicator",classes:{circle:"file-progress-circle"},variant:"static",value:O,size:48,thickness:2}),r&&l.a.createElement(h.a,null)):o?l.a.createElement("div",{className:"file-progress",style:U},o):null}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.file,n=t.prevPropsFile;return a&&n&&a.id!==n.id?{prevPropsFile:a,prevFile:null,file:f.a.get(a.id)||a}:null}}]),a}(l.a.Component));g.defaultProps={cancelButton:!1,download:!0,upload:!1},t.a=g},function(e,t,a){"use strict";a.d(t,"a",(function(){return T}));var n=a(44),r=a(7),i=a.n(r),o=a(13),s=a(8),c=a(9),l=a(25),u=a(11),d=a(10),p=a(0),h=a.n(p),m=a(127),f=a.n(m),g=a(343),v=a(22),b=a(337);function C(){return"$"+Math.random().toString(36).slice(2,10)}var y=a(469),k=new(a.n(y).a),E=new Map;function S(e){return O.apply(this,arguments)}function O(){return(O=Object(o.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=C(),e.abrupt("return",new Promise((function(e,n){E.set(a,{resolve:e,reject:n}),k.postMessage({key:a,blob:t})})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}k.onmessage=function(e){var t=e.data;if(t){var a=t.key,n=t.error,r=t.result,i=t.msg,o=E.get(a),s=o.resolve,c=o.reject;E.delete(a),n?c(i):s(r)}};var U=a(16),w=a(14),M=a(336),I=a(368),j=a(129),_=a(357),x=(a(470),h.a.lazy((function(){return Promise.all([a.e(1),a.e(0)]).then(a.bind(null,657))}))),T=Object.freeze({HINTS:"HINTS",MESSAGE:"MESSAGE",PICKER_HEADER:"PICKER_HEADER",PICKER:"PICKER",PREVIEW:"PREVIEW",STICKER_SET:"STICKER_SET",UNKNOWN:"UNKNOWN"}),L=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onClientUpdateInstantViewContent=function(e){n.openIV=Boolean(I.a.getCurrent()),n.startStopAnimation()},n.onClientUpdateDialogChatId=function(e){n.dialogChatId=w.a.dialogChatId,n.startStopAnimation()},n.onClientUpdateMediaViewerContent=function(e){n.openMediaViewer=Boolean(w.a.mediaViewerContent),n.startStopAnimation()},n.onClientUpdateProfileMediaViewerContent=function(e){n.openProfileMediaViewer=Boolean(w.a.profileMediaViewerContent),n.startStopAnimation()},n.onClientUpdateStickerPreview=function(e){n.stickerPreview=e.sticker,n.startStopAnimation()},n.onClientUpdateMessagesInView=function(e){var t=n.props,a=t.chatId,r=t.messageId,i="".concat(a,"_").concat(r);n.inView=e.messages.has(i),n.startStopAnimation()},n.onClientUpdateStickerSet=function(e){var t=e.stickerSet;n.openedStickerSet=t,n.startStopAnimation()},n.onClientUpdateFocusWindow=function(e){var t=e.focused,a=n.props,r=a.chatId,i=a.messageId,o=a.sticker;Object(g.m)(o,r,i)&&(n.windowFocused=t,n.startStopAnimation())},n.onClientUpdateStickerBlob=function(e){var t=n.props.sticker,a=t.sticker,r=t.is_animated,i=e.fileId;a&&a.id===i&&(r?n.loadContent():n.forceUpdate())},n.onClientUpdateStickerThumbnailBlob=function(e){var t=n.props.sticker.thumbnail;if(t){var a=e.fileId;t.photo&&t.photo.id===a&&n.forceUpdate()}},n.loadContent=Object(o.a)(i.a.mark((function e(){var t,a,r,o,s,c,l,u,d,p,h,m;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props,a=t.chatId,r=t.messageId,o=t.sticker,s=t.autoplay,c=t.play,l=o.is_animated,u=o.sticker,d=Object(g.m)(o,a,r),l){e.next=5;break}return e.abrupt("return");case 5:if(d){e.next=7;break}return e.abrupt("return");case 7:if(c){e.next=9;break}return e.abrupt("return");case 9:if(p=Object(b.e)(u)){e.next=12;break}return e.abrupt("return");case 12:return h=null,e.prev=13,e.next=16,S(p);case 16:if(m=e.sent){e.next=19;break}return e.abrupt("return");case 19:h=JSON.parse(m),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(13),console.log("[Sticker] loadContent error",e.t0);case 25:if(h){e.next=27;break}return e.abrupt("return");case 27:s?n.setState({animationData:h}):n.animationData=h;case 28:case"end":return e.stop()}}),e,null,[[13,22]])}))),n.handleMouseEnter=function(e){var t=Object(l.a)(n).animationData;t&&n.setState({animationData:t},(function(){n.handleAnimationMouseEnter()}))},n.handleAnimationMouseEnter=function(){n.props.autoplay||(n.entered=!0,n.lottieRef.current&&(n.loopCount=0,n.startStopAnimation()))},n.handleAnimationLoopComplete=function(){n.props.autoplay||n.lottieRef.current&&(n.entered||(n.loopCount+=1),n.loopCount>2&&n.state.animationData&&n.setState({animationData:null}))},n.handleAnimationMouseOut=function(){n.entered=!1},n.lottieRef=h.a.createRef(),n.windowFocused=window.hasFocus,n.inView=!1,n.stickerPreview=_.a.stickerPreview,n.openMediaViewer=Boolean(w.a.mediaViewerContent),n.openProfileMediaViewer=Boolean(w.a.profileMediaViewerContent),n.openIV=Boolean(I.a.getCurrent()),n.dialogChatId=w.a.dialogChatId,n.state={animationDate:null,hasError:!1},n}return Object(c.a)(a,[{key:"componentDidCatch",value:function(e,t){console.log("[Sticker] render error",e,t)}},{key:"shouldComponentUpdate",value:function(e,t,a){var n=this.props,r=n.chatId,i=n.messageId,o=n.sticker,s=n.blur,c=n.displaySize;return this.state.animationData!==t.animationData||(r!==e.chatId||(i!==e.messageId||(o!==e.sticker||(s!==e.blur||c!==e.displaySize))))}},{key:"componentDidUpdate",value:function(e,t,a){e.sticker!==this.props.sticker&&this.loadContent()}},{key:"componentDidMount",value:function(){this.loadContent(),w.a.on("clientUpdateDialogChatId",this.onClientUpdateDialogChatId),w.a.on("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),w.a.on("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent),w.a.on("clientUpdateProfileMediaViewerContent",this.onClientUpdateProfileMediaViewerContent),I.a.on("clientUpdateInstantViewContent",this.onClientUpdateInstantViewContent),M.a.on("clientUpdateStickerThumbnailBlob",this.onClientUpdateStickerThumbnailBlob),M.a.on("clientUpdateStickerBlob",this.onClientUpdateStickerBlob),j.a.on("clientUpdateMessagesInView",this.onClientUpdateMessagesInView),_.a.on("clientUpdateStickerPreview",this.onClientUpdateStickerPreview),_.a.on("clientUpdateStickerSet",this.onClientUpdateStickerSet)}},{key:"componentWillUnmount",value:function(){w.a.off("clientUpdateDialogChatId",this.onClientUpdateDialogChatId),w.a.off("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),w.a.off("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent),w.a.off("clientUpdateProfileMediaViewerContent",this.onClientUpdateProfileMediaViewerContent),I.a.off("clientUpdateInstantViewContent",this.onClientUpdateInstantViewContent),M.a.off("clientUpdateStickerThumbnailBlob",this.onClientUpdateStickerThumbnailBlob),M.a.off("clientUpdateStickerBlob",this.onClientUpdateStickerBlob),j.a.off("clientUpdateMessagesInView",this.onClientUpdateMessagesInView),_.a.off("clientUpdateStickerPreview",this.onClientUpdateStickerPreview),_.a.off("clientUpdateStickerSet",this.onClientUpdateStickerSet)}},{key:"startStopAnimation",value:function(){var e=this.props.autoplay,t=this.lottieRef.current;if(t){if(this.windowFocused&&!this.stickerPreview&&!this.openMediaViewer&&!this.openProfileMediaViewer&&!this.openIV&&!this.dialogChatId){if(this.entered)return t.play(),void(this.pause=!1);if(!this.openedStickerSet){if(this.paused)return t.play(),void(this.paused=!1);if(e&&this.inView)return t.play(),void(this.paused=!1)}}this.paused=t.pause()}}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.messageId,r=e.autoplay,i=e.className,o=e.displaySize,s=e.blur,c=e.sticker,l=e.style,u=e.openMedia,d=e.preview,p=c.thumbnail,m=c.sticker,C=c.width,y=c.height,k=this.state,E=k.animationData,S=k.hasError,O=Object(g.m)(c,t,a),U=Object(b.l)(p?p.photo:null),w=Object(b.l)(m),M=Object(g.k)(p);if(S){var I={width:o,height:o};return h.a.createElement("div",{className:f()("sticker",i),style:I,onClick:u},U&&h.a.createElement("img",{className:f()("sticker-image",{"media-blurred":M&&s}),draggable:!1,src:U,alt:""}))}var j=null,_=Object(v.h)({width:C,height:y},o);_&&(j=O?h.a.createElement(h.a.Fragment,null,E?h.a.createElement(h.a.Suspense,{fallback:null},h.a.createElement(x,{ref:this.lottieRef,options:{autoplay:r,loop:!0,animationData:E,renderer:"svg",rendererSettings:{preserveAspectRatio:"xMinYMin slice",clearCanvas:!1,progressiveLoad:!0,hideOnTransparent:!0,className:"lottie-svg"}},eventListeners:[{eventName:"loopComplete",callback:this.handleAnimationLoopComplete}],onMouseOut:this.handleAnimationMouseOut})):h.a.createElement(h.a.Fragment,null,U&&h.a.createElement("img",{className:f()("sticker-image",{"media-blurred":M&&s}),draggable:!1,src:U,alt:""}))):h.a.createElement(h.a.Fragment,null,w&&!d?h.a.createElement("img",{className:"sticker-image",draggable:!1,src:w,alt:""}):h.a.createElement(h.a.Fragment,null,U&&h.a.createElement("img",{className:f()("sticker-image",{"media-blurred":M&&s}),draggable:!1,src:U,alt:""}))));var T=Object(n.a)({width:_?_.width:0,height:_?_.height:0},l);return h.a.createElement("div",{className:f()("sticker",i),style:T,onClick:u,onMouseEnter:this.handleMouseEnter},j)}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),a}(h.a.Component);L.defaultProps={chatId:0,messageId:0,openMedia:function(){},autoplay:!0,play:!0,blur:!0,displaySize:U.jb,preview:!1,source:T.UNKNOWN};t.b=L},function(e,t,a){"use strict";var n=a(8),r=a(9),i=a(11),o=a(10),s=a(0),c=a.n(s),l=a(127),u=a.n(l),d=a(31),p=a(344),h=a(337),m=a(77),f=a(38),g=a(336),v=(a(446),a(396)),b=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).onClientUpdateUserBlob=function(e){r.props.userId===e.userId&&(r.state.loaded?r.setState({loaded:!1}):r.forceUpdate())},r.onClientUpdateChatBlob=function(e){var t=r.props.userId,a=e.chatId,n=f.a.get(a);if(n&&n.type)switch(n.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":return;case"chatTypePrivate":case"chatTypeSecret":if(n.type.user_id!==t)return;r.state.loaded?r.setState({loaded:!1}):r.forceUpdate()}},r.onUpdateChatPhoto=function(e){var t=r.props.userId,a=e.chat_id,n=e.photo,i=f.a.get(a);if(i&&i.type)switch(i.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":return;case"chatTypePrivate":case"chatTypeSecret":if(i.type.user_id!==t)return;if(r.state.loaded?r.setState({loaded:!1}):r.forceUpdate(),n){var o=g.a.getStore();Object(h.t)(o,i)}}},r.onUpdateChatTitle=function(e){var t=r.props.userId,a=f.a.get(e.chat_id);if(a&&a.type)switch(a.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":return;case"chatTypePrivate":case"chatTypeSecret":if(a.type.user_id!==t&&!a.photo)return;r.forceUpdate()}},r.handleSelect=function(e){var t=r.props,a=t.userId,n=t.onSelect;n&&(e.stopPropagation(),n(a))},r.handleLoad=function(){r.setState({loaded:!0})},r.state={loaded:!1},r}return Object(r.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){return e.userId!==this.props.userId||t.loaded!==this.state.loaded}},{key:"componentDidMount",value:function(){g.a.on("clientUpdateUserBlob",this.onClientUpdateUserBlob),g.a.on("clientUpdateChatBlob",this.onClientUpdateChatBlob),f.a.on("updateChatPhoto",this.onUpdateChatPhoto),f.a.on("updateChatTitle",this.onUpdateChatTitle)}},{key:"componentWillUnmount",value:function(){g.a.off("clientUpdateUserBlob",this.onClientUpdateUserBlob),g.a.off("clientUpdateChatBlob",this.onClientUpdateChatBlob),f.a.off("updateChatPhoto",this.onUpdateChatPhoto),f.a.off("updateChatTitle",this.onUpdateChatTitle)}},{key:"render",value:function(){var e=this.props,t=e.className,a=e.userId,n=e.fistName,r=e.lastName,i=e.onSelect,o=e.small,s=e.dialog,l=e.poll,d=e.t,f=this.state.loaded,g=m.a.get(a);if(!g&&!n&&!r)return null;if(Object(p.h)(a))return c.a.createElement("div",{className:u()(t,"user-tile","tile_color_0",{pointer:i},{"tile-dialog":s},{"tile-small":o},{"tile-poll":l}),onClick:this.handleSelect},c.a.createElement("div",{className:"tile-photo"},c.a.createElement("div",{className:"tile-saved-messages"},c.a.createElement(v.a,{fontSize:"default"}))));var b=Object(p.d)(a,n,r,d),C=Object(h.l)(g&&g.profile_photo?g.profile_photo.small:null),y=C&&f,k="tile_color_".concat(Math.abs(a)%8+1);return c.a.createElement("div",{className:u()(t,"user-tile",{[k]:!y},{pointer:i},{"tile-dialog":s},{"tile-small":o},{"tile-poll":l}),onClick:this.handleSelect},!y&&c.a.createElement("div",{className:"tile-photo"},c.a.createElement("span",{className:"tile-text"},b)),C&&c.a.createElement("img",{className:"tile-photo",src:C,onLoad:this.handleLoad,draggable:!1,alt:""}))}}]),a}(s.Component);t.a=Object(d.d)()(b)},function(e,t,a){"use strict";var n=a(8),r=a(9),i=a(11),o=a(10),s=a(21),c=a(2),l=new(function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(){var e;return Object(n.a)(this,a),(e=t.call(this)).reset=function(){e.stickerSet=null,e.hint=null,e.animationData=new WeakMap},e.onUpdate=function(t){switch(t["@type"]){case"updateAuthorizationState":var a=t.authorization_state;if(!a)break;switch(a["@type"]){case"authorizationStateClosed":e.reset()}break;case"updateInstalledStickerSets":var n=t.sticker_set_ids;if(e.stickerSet){var r=e.stickerSet,i=r.id,o=r.is_installed;o!==n.some((function(e){return e===i}))&&(e.stickerSet=Object.assign({},e.stickerSet,{is_installed:!o}))}e.emit("updateInstalledStickerSets",t);break;case"updateRecentStickers":e.emit("updateRecentStickers",t)}},e.onClientUpdate=function(t){switch(t["@type"]){case"clientUpdateStickerSend":e.emit("clientUpdateStickerSend",t);break;case"clientUpdateLocalStickersHint":var a=t.hint;e.hint=a,e.emit("clientUpdateLocalStickersHint",t);break;case"clientUpdateRemoteStickersHint":var n=t.hint;e.hint&&e.hint.timestamp===n.timestamp&&(e.hint=Object.assign({},e.hint,{foundStickers:n.stickers})),e.emit("clientUpdateRemoteStickersHint",t);break;case"clientUpdateStickerSet":var r=t.stickerSet;e.stickerSet=r,e.emit("clientUpdateStickerSet",t);break;case"clientUpdateStickerSetPosition":e.emit("clientUpdateStickerSetPosition",t);break;case"clientUpdateStickerPreview":e.emit("clientUpdateStickerPreview",t)}},e.addTdLibListener=function(){c.a.on("update",e.onUpdate),c.a.on("clientUpdate",e.onClientUpdate)},e.removeTdLibListener=function(){c.a.off("update",e.onUpdate),c.a.off("clientUpdate",e.onClientUpdate)},e.reset(),e.addTdLibListener(),e}return Object(r.a)(a,[{key:"getAnimationData",value:function(e){return this.animationData.get(e)}},{key:"setAnimationData",value:function(e,t){this.animationData.set(e,t)}}]),a}(s.a));window.sticker=l,t.a=l},,,,function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(37);t.a=Object(i.a)(r.a.createElement("path",{d:"M5,19 L19,19 C19.5522847,19 20,19.4477153 20,20 C20,20.5128358 19.6139598,20.9355072 19.1166211,20.9932723 L19,21 L5,21 C4.44771525,21 4,20.5522847 4,20 C4,19.4871642 4.38604019,19.0644928 4.88337887,19.0067277 L5,19 L19,19 L5,19 Z M11.8833789,3.00672773 L12,3 C12.5128358,3 12.9355072,3.38604019 12.9932723,3.88337887 L13,4 L13,13.585 L16.2928932,10.2928932 C16.6533772,9.93240926 17.2206082,9.90467972 17.6128994,10.2097046 L17.7071068,10.2928932 C18.0675907,10.6533772 18.0953203,11.2206082 17.7902954,11.6128994 L17.7071068,11.7071068 L12.7071068,16.7071068 C12.3466228,17.0675907 11.7793918,17.0953203 11.3871006,16.7902954 L11.2928932,16.7071068 L6.29289322,11.7071068 C5.90236893,11.3165825 5.90236893,10.6834175 6.29289322,10.2928932 C6.65337718,9.93240926 7.22060824,9.90467972 7.61289944,10.2097046 L7.70710678,10.2928932 L11,13.585 L11,4 C11,3.48716416 11.3860402,3.06449284 11.8833789,3.00672773 L12,3 L11.8833789,3.00672773 Z"}),"Download")},function(e,t,a){"use strict";var n=a(44),r=a(8),i=a(9),o=a(11),s=a(10),c=a(0),l=a.n(c),u=a(127),d=a.n(u),p=a(354),h=a(22),m=a(337),f=a(343),g=a(16),v=a(336),b=(a(465),function(e){Object(o.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).onClientUpdatePhotoBlob=function(e){var t=n.state,a=t.photoSize,r=t.thumbSize,i=e.fileId;(a&&a.photo&&a.photo.id===i||r&&r.photo&&r.photo.id===i)&&n.forceUpdate()},n.state={},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){v.a.on("clientUpdatePhotoBlob",this.onClientUpdatePhotoBlob)}},{key:"componentWillUnmount",value:function(){v.a.off("clientUpdatePhotoBlob",this.onClientUpdatePhotoBlob)}},{key:"render",value:function(){var e=this.props,t=e.className,a=e.displaySize,r=e.openMedia,i=e.showProgress,o=e.title,s=e.caption,c=e.type,u=e.style,g=this.state,v=g.thumbSize,b=g.photoSize,C=g.minithumbnail;if(!b)return null;var y=C?"data:image/jpeg;base64, "+C.data:null,k=Object(m.l)(v?v.photo:null),E=Object(m.l)(b.photo),S=!k&&y||Object(f.k)(v),O=Object(h.h)(b,a,!1);if(!O)return null;var U=Object(n.a)({width:O.width,height:O.height},u),w=Boolean(E||k||y);return l.a.createElement("div",{className:d()(t,"photo",{"photo-big":"message"===c,"photo-title":o,"photo-caption":s,pointer:r}),style:U,onClick:r},w&&l.a.createElement("img",{className:d()("photo-image",{"media-blurred":!E&&S,"media-mini-blurred":!E&&!k&&S}),draggable:!1,src:E||k||y,alt:""}),i&&l.a.createElement(p.a,{file:b.photo,download:!0,upload:!0,cancelButton:!0}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.photo,n=e.size,r=e.thumbnailSize;return a!==t.prevPhoto?{prevPhoto:a,photoSize:Object(h.n)(a.sizes,n),thumbSize:Object(h.n)(a.sizes,r),minithumbnail:a?a.minithumbnail:null}:null}}]),a}(l.a.Component));b.defaultProps={size:g.F,thumbnailSize:g.G,displaySize:g.D,showProgress:!0},t.a=b},function(e,t,a){"use strict";var n=a(8),r=a(9),i=a(11),o=a(10),s=a(21),c=a(2),l=new(function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(){var e;return Object(n.a)(this,a),(e=t.call(this)).reset=function(){e.items=new Map,e.fullInfoItems=new Map},e.onUpdate=function(t){switch(t["@type"]){case"updateAuthorizationState":var a=t.authorization_state;if(!a)break;switch(a["@type"]){case"authorizationStateClosed":e.reset()}break;case"updateBasicGroup":e.set(t.basic_group),e.emit(t["@type"],t);break;case"updateBasicGroupFullInfo":e.setFullInfo(t.basic_group_id,t.basic_group_full_info),e.emit(t["@type"],t)}},e.onClientUpdate=function(e){},e.addTdLibListener=function(){c.a.on("update",e.onUpdate),c.a.on("clientUpdate",e.onClientUpdate)},e.removeTdLibListener=function(){c.a.off("update",e.onUpdate),c.a.off("clientUpdate",e.onClientUpdate)},e.reset(),e.addTdLibListener(),e}return Object(r.a)(a,[{key:"get",value:function(e){return this.items.get(e)}},{key:"set",value:function(e){this.items.set(e.id,e)}},{key:"getFullInfo",value:function(e){return this.fullInfoItems.get(e)}},{key:"setFullInfo",value:function(e,t){this.fullInfoItems.set(e,t)}}]),a}(s.a));window.basicgroup=l,t.a=l},,,function(e,t,a){"use strict";var n=function(){var e=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZWN]|"[^"]*"|'[^']*'/g,t=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,a=/[^-+\dA-Z]/g;return function(c,l,u,d){if(1!==arguments.length||"string"!==s(c)||/\d/.test(c)||(l=c,c=void 0),(c=c||new Date)instanceof Date||(c=new Date(c)),isNaN(c))throw TypeError("Invalid date");var p=(l=String(n.masks[l]||l||n.masks.default)).slice(0,4);"UTC:"!==p&&"GMT:"!==p||(l=l.slice(4),u=!0,"GMT:"===p&&(d=!0));var h=u?"getUTC":"get",m=c[h+"Date"](),f=c[h+"Day"](),g=c[h+"Month"](),v=c[h+"FullYear"](),b=c[h+"Hours"](),C=c[h+"Minutes"](),y=c[h+"Seconds"](),k=c[h+"Milliseconds"](),E=u?0:c.getTimezoneOffset(),S=i(c),O=o(c),U={d:m,dd:r(m),ddd:n.i18n.dayNames[f],dddd:n.i18n.dayNames[f+7],m:g+1,mm:r(g+1),mmm:n.i18n.monthNames[g],mmmm:n.i18n.monthNames[g+12],yy:String(v).slice(2),yyyy:v,h:b%12||12,hh:r(b%12||12),H:b,HH:r(b),M:C,MM:r(C),s:y,ss:r(y),l:r(k,3),L:r(Math.round(k/10)),t:b<12?n.i18n.timeNames[0]:n.i18n.timeNames[1],tt:b<12?n.i18n.timeNames[2]:n.i18n.timeNames[3],T:b<12?n.i18n.timeNames[4]:n.i18n.timeNames[5],TT:b<12?n.i18n.timeNames[6]:n.i18n.timeNames[7],Z:d?"GMT":u?"UTC":(String(c).match(t)||[""]).pop().replace(a,""),o:(E>0?"-":"+")+r(100*Math.floor(Math.abs(E)/60)+Math.abs(E)%60,4),S:["th","st","nd","rd"][m%10>3?0:(m%100-m%10!=10)*m%10],W:S,N:O};return l.replace(e,(function(e){return e in U?U[e]:e.slice(1,e.length-1)}))}}();function r(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e}function i(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);var a=new Date(t.getFullYear(),0,4);a.setDate(a.getDate()-(a.getDay()+6)%7+3);var n=t.getTimezoneOffset()-a.getTimezoneOffset();t.setHours(t.getHours()-n);var r=(t-a)/6048e5;return 1+Math.floor(r)}function o(e){var t=e.getDay();return 0===t&&(t=7),t}function s(e){return null===e?"null":void 0===e?"undefined":"object"!==typeof e?typeof e:Array.isArray(e)?"array":{}.toString.call(e).slice(8,-1).toLowerCase()}n.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},n.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]},t.a=n},function(e,t,a){"use strict";var n=a(7),r=a.n(n),i=a(13),o=a(8),s=a(9),c=a(11),l=a(10),u=a(0),d=a.n(u),p=a(31),h=a(320),m=a(332),f=a(323),g=a(324),v=a(325),b=a(326),C=a(378),y=a(129),k=a(2),E=(a(454),a(128)),S=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleClick=function(e){e.preventDefault(),e.stopPropagation(),n.setState({confirm:!0})},n.handleDialogClick=function(e){e.preventDefault(),e.stopPropagation()},n.handleClose=function(){n.setState({confirm:!1})},n.handleDone=function(e){n.handleClose();var t=n.props,a=t.url,r=t.onClick;if(a)if(r)r(e);else{var i=window.open();i.opener=null,i.location=a}},n.handleSafeClick=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,i,o,s,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stopPropagation(),a=n.props,i=a.onClick,o=a.url,!n.isTelegramLink(o)){e.next=19;break}return t.preventDefault(),e.prev=4,e.next=7,k.a.send({"@type":"getMessageLinkInfo",url:o});case 7:if(s=e.sent,y.a.setItems([s.message]),c=s.chat_id,l=s.message,!c){e.next=13;break}return Object(E.i)(c,l?l.id:null),e.abrupt("return");case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(4),console.log("[safeLink] messageLinkInfo error",e.t0);case 18:i&&i(t);case 19:i&&(t.preventDefault(),i(t));case 20:case"end":return e.stop()}}),e,null,[[4,15]])})));return function(t){return e.apply(this,arguments)}}(),n.state={},n}return Object(s.a)(a,[{key:"isTelegramLink",value:function(e){if(!e)return!1;var t=e.toLowerCase().replace("https://","").replace("http://","");return t.startsWith("t.me")||t.startsWith("tg://")}},{key:"render",value:function(){var e=this.props,t=e.className,a=e.children,n=e.t,r=e.url,i=this.state,o=i.confirm,s=i.decodedUrl,c=i.href,l=i.safe;return r&&s?d.a.createElement(d.a.Fragment,null,l?d.a.createElement("a",{className:t,href:c,title:s,target:"_blank",rel:"noopener noreferrer",onClick:this.handleSafeClick},a||r):d.a.createElement(d.a.Fragment,null,d.a.createElement("a",{className:t,title:s,onClick:this.handleClick},a||r),o&&d.a.createElement(m.a,{transitionDuration:0,open:o,onClose:this.handleClose,onClick:this.handleDialogClick,"aria-labelledby":"confirm-dialog-title"},d.a.createElement(f.a,{id:"confirm-dialog-title"},n("Confirm")),d.a.createElement(g.a,{classes:{root:"safe-link-content-root"}},d.a.createElement(v.a,null,"Open this link?\n\n".concat(s))),d.a.createElement(b.a,null,d.a.createElement(h.a,{onClick:this.handleClose},n("Cancel")),d.a.createElement(h.a,{onClick:this.handleDone,color:"primary"},n("Open")))))):null}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.displayText,n=e.mail,r=e.url;return t.prevUrl!==r||t.prevDisplayText!==a?{prevUrl:r,prevDisplayText:a,safe:Object(C.c)(a,r),decodedUrl:Object(C.a)(r,n),href:Object(C.b)(r,n),confirm:!1}:null}}]),a}(d.a.Component);t.a=Object(p.d)()(S)},function(e,t,a){"use strict";var n=a(8),r=a(9),i=a(11),o=a(10),s=a(21),c=a(2),l=new(function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(){var e;return Object(n.a)(this,a),(e=t.call(this)).reset=function(){e.items=[]},e.onUpdate=function(t){switch(t["@type"]){case"updateAuthorizationState":var a=t.authorization_state;if(!a)break;switch(a["@type"]){case"authorizationStateClosed":e.reset()}}},e.onClientUpdate=function(t){switch(t["@type"]){case"clientUpdateBlocksInView":e.emit("clientUpdateBlocksInView",t);break;case"clientUpdateInstantViewContent":var a=t.content;a?e.items.push(a.instantView):e.items=[],e.emit("clientUpdateInstantViewContent",t);break;case"clientUpdateInstantViewUrl":e.emit("clientUpdateInstantViewUrl",t);break;case"clientUpdateInstantViewViewerContent":var n=t.content;e.viewerContent=n,e.emit("clientUpdateInstantViewViewerContent",t);break;case"clientUpdatePrevInstantView":if(e.items.length<=1)return;e.items.pop();var r=e.items.pop();c.a.clientUpdate({"@type":"clientUpdateInstantViewContent",content:{instantView:r}})}},e.addTdLibListener=function(){c.a.on("update",e.onUpdate),c.a.on("clientUpdate",e.onClientUpdate)},e.removeTdLibListener=function(){c.a.off("update",e.onUpdate),c.a.off("clientUpdate",e.onClientUpdate)},e.reset(),e.addTdLibListener(),e}return Object(r.a)(a,[{key:"hasPrev",value:function(){return this.items.length>1}},{key:"getCurrent",value:function(){return this.items.length>0?this.items[this.items.length-1]:null}}]),a}(s.a));window.instantView=l,t.a=l},function(e,t,a){"use strict";var n=a(8),r=a(9),i=a(11),o=a(10),s=a(0),c=a.n(s),l=a(31),u=a(127),d=a.n(u),p=a(344),h=a(338),m=a(128),f=a(77),g=a(38),v=(a(476),function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).handleSelect=function(t){var a=e.props,n=a.chatId,r=a.userId,i=a.openUser,o=a.openChat;return i&&r?(t.stopPropagation(),void Object(m.k)(r,!0)):o&&n?(t.stopPropagation(),void Object(m.i)(n,null,!0)):void 0},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.t,a=e.chatId,n=e.userId,r=e.openUser,i=e.openChat;if(f.a.get(n)){var o=Object(h.U)(a)?"message-author-color":"user_color_".concat(Math.abs(n)%8+1),s=d()([o],"message-author"),l=Object(p.c)(n,null,t);return r?c.a.createElement("a",{className:s,onClick:this.handleSelect},l):c.a.createElement(c.a.Fragment,null,l)}if(g.a.get(a)){var u=d()("message-author-color","message-author"),m=Object(h.s)(a,!1,t);return i?c.a.createElement("a",{className:u,onClick:this.handleSelect},m):c.a.createElement(c.a.Fragment,null,m)}return null}}]),a}(c.a.Component));v.defaultProps={openUser:!1,openChat:!1},t.a=Object(l.d)()(v)},,,,function(e,t,a){"use strict";var n=a(44),r=a(8),i=a(9),o=a(11),s=a(10),c=a(0),l=a.n(c),u=a(127),d=a.n(u),p=a(31),h=a(354),m=a(22),f=a(343),g=a(337),v=a(16),b=a(14),C=a(336),y=a(368),k=a(129),E=(a(456),function(e){Object(o.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).startStopPlayer=function(){var e=n.videoRef.current;e&&(n.windowFocused&&(n.inView&&!n.openMediaViewer&&!n.openProfileMediaViewer&&!n.openIV||n.ivInView&&!n.openIVMedia)?e.play():e.pause())},n.onClientUpdateInstantViewContent=function(e){n.openIV=Boolean(y.a.getCurrent()),n.startStopPlayer()},n.onClientUpdateProfileMediaViewerContent=function(e){n.openProfileMediaViewer=Boolean(b.a.profileMediaViewerContent),n.startStopPlayer()},n.onClientUpdateMediaViewerContent=function(e){n.openMediaViewer=Boolean(b.a.mediaViewerContent),n.startStopPlayer()},n.onClientUpdateInstantViewViewerContent=function(e){n.openIVMedia=Boolean(y.a.viewerContent),n.startStopPlayer()},n.onClientUpdateFocusWindow=function(e){n.windowFocused=e.focused,n.startStopPlayer()},n.onClientUpdateMessagesInView=function(e){var t=n.props,a=t.chatId,r=t.messageId,i="".concat(a,"_").concat(r);n.inView=e.messages.has(i),n.startStopPlayer()},n.onClientUpdateBlocksInView=function(e){var t=n.props.pageBlock;t&&(n.ivInView=e.blocks.has(t),n.startStopPlayer())},n.onClientUpdateAnimationBlob=function(e){var t=n.props.animation.animation,a=e.fileId;t&&t.id===a&&n.forceUpdate((function(){n.startStopPlayer()}))},n.onClientUpdateAnimationThumbnailBlob=function(e){var t=n.props.animation.thumbnail;if(t){var a=e.fileId;t.photo&&t.photo.id===a&&n.forceUpdate()}},n.videoRef=l.a.createRef(),n.setPlayerParams(),n}return Object(i.a)(a,[{key:"setPlayerParams",value:function(){this.windowFocused=window.hasFocus,this.inView=!1,this.openMediaViewer=Boolean(b.a.mediaViewerContent),this.openProfileMediaViewer=Boolean(b.a.profileMediaViewerContent),this.openIV=Boolean(y.a.getCurrent()),this.ivInView=!1,this.openIVMedia=Boolean(y.a.viewerContent)}},{key:"componentDidUpdate",value:function(e,t,a){e.animation!==this.props.animation&&this.setPlayerParams()}},{key:"componentDidMount",value:function(){C.a.on("clientUpdateAnimationThumbnailBlob",this.onClientUpdateAnimationThumbnailBlob),C.a.on("clientUpdateAnimationBlob",this.onClientUpdateAnimationBlob),b.a.on("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),b.a.on("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent),b.a.on("clientUpdateProfileMediaViewerContent",this.onClientUpdateProfileMediaViewerContent),k.a.on("clientUpdateMessagesInView",this.onClientUpdateMessagesInView),y.a.on("clientUpdateInstantViewContent",this.onClientUpdateInstantViewContent),y.a.on("clientUpdateInstantViewViewerContent",this.onClientUpdateInstantViewViewerContent),y.a.on("clientUpdateBlocksInView",this.onClientUpdateBlocksInView)}},{key:"componentWillUnmount",value:function(){C.a.off("clientUpdateAnimationThumbnailBlob",this.onClientUpdateAnimationThumbnailBlob),C.a.off("clientUpdateAnimationBlob",this.onClientUpdateAnimationBlob),b.a.off("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),b.a.off("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent),b.a.off("clientUpdateProfileMediaViewerContent",this.onClientUpdateProfileMediaViewerContent),k.a.off("clientUpdateMessagesInView",this.onClientUpdateMessagesInView),y.a.off("clientUpdateInstantViewContent",this.onClientUpdateInstantViewContent),y.a.off("clientUpdateInstantViewViewerContent",this.onClientUpdateInstantViewViewerContent),y.a.off("clientUpdateBlocksInView",this.onClientUpdateBlocksInView)}},{key:"render",value:function(){var e=this.props,t=e.displaySize,a=e.openMedia,r=e.t,i=e.title,o=e.caption,s=e.type,c=e.style,u=this.props.animation,p=u.minithumbnail,v=u.thumbnail,b=u.animation,C=u.mime_type,y=u.width,k=u.height,E=Object(m.h)({width:y,height:k}||v,t,!1);if(!E)return null;var S=Object(n.a)({width:E.width,height:E.height},c),O=p?"data:image/jpeg;base64, "+p.data:null,U=Object(g.l)(v?v.photo:null),w=Object(g.l)(b),M=U?Object(f.k)(v):Boolean(O),I=Object(g.q)(C),j=w?l.a.createElement("source",{src:w,type:C}):null;return l.a.createElement("div",{className:d()("animation",{"animation-big":"message"===s,"animation-title":i,"media-title":i,"animation-caption":o,pointer:a}),style:S,onClick:a},w?I?l.a.createElement("img",{className:"animation-preview",src:w,alt:""}):l.a.createElement("video",{ref:this.videoRef,className:"media-viewer-content-animation",poster:U||O,muted:!0,autoPlay:!0,loop:!0,playsInline:!0,width:S.width,height:S.height},j):l.a.createElement(l.a.Fragment,null,l.a.createElement("img",{className:d()("animation-preview",{"media-blurred":M,"media-mini-blurred":!w&&!U&&M}),src:U||O,alt:""}),l.a.createElement("div",{className:"animation-meta"},Object(g.h)(b))),l.a.createElement(h.a,{file:b,download:!0,upload:!0,cancelButton:!0,icon:l.a.createElement("div",{className:"animation-play"},r("AttachGif"))}))}}]),a}(l.a.Component));E.defaultProps={size:v.F,displaySize:v.D,iv:!1},t.a=Object(p.d)()(E)},function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(37);t.a=Object(i.a)(r.a.createElement("path",{transform:"translate(-12.000000, -12.000000)",d:"M19.3717789,13.8876217 L33.8466511,23.2537154 C34.2588127,23.5204082 34.3767385,24.0707284 34.1100457,24.48289 C34.0418356,24.5883056 33.9520666,24.6780745 33.8466511,24.7462846 L19.3717789,34.1123783 C18.9596173,34.3790711 18.4092971,34.2611454 18.1426043,33.8489838 C18.0495218,33.705129 18,33.5374371 18,33.3660938 L18,14.6339062 C18,14.1429865 18.3979691,13.7450173 18.8888889,13.7450173 C19.0602323,13.7450173 19.2279241,13.7945391 19.3717789,13.8876217 Z"}),"PlayArrow")},function(e,t,a){"use strict";a.d(t,"b",(function(){return m})),a.d(t,"a",(function(){return b}));var n=a(60),r=a(0),i=a.n(r),o=a(8),s=a(9),c=new(function(){function e(){Object(o.a)(this,e),this.list=new Map([["AED","\u062f.\u0625"],["AFN","\u060b"],["ARS","$"],["AUD","$"],["AZN","\u20bc"],["BND","B$"],["BRL","R$"],["CAD","$"],["CHF","Fr"],["CLP","$"],["CNY","\xa5"],["COP","$"],["EGP","E\xa3"],["EUR","\u20ac"],["GBP","\xa3"],["HKD","$"],["IDR","Rp"],["ILS","\u20aa"],["INR","\u20b9"],["ISK","kr"],["JPY","\xa5"],["KRW","\u20a9"],["KZT","\u20b8"],["MXN","$"],["MYR","RM"],["NOK","kr"],["NZD","$"],["PHP","\u20b1"],["RUB","\u20bd"],["SAR","SR"],["SEK","kr"],["SGD","$"],["TRY","\u20ba"],["TTD","$"],["TWD","$"],["TZS","TSh"],["UAH","\u20b4"],["UGX","USh"],["USD","$"],["UYU","$"],["VND","\u20ab"],["YER","\ufdfc"],["ZAR","R"],["IRR","\ufdfc"],["IQD","\u0639.\u062f"],["VEF","Bs.F."]])}return Object(s.a)(e,[{key:"get",value:function(e){return this.list.get(e)}},{key:"set",value:function(e,t){this.list.set(e,t)}},{key:"getPow",value:function(e){return"CLF"===e?4:["BHD","IQD","JOD","KWD","LYD","OMR","TND"].includes(e)?3:["BIF","BYR","CLP","CVE","DJF","GNF","ISK","JPY","KMF","KRW","MGA","PYG","RWF","UGX","UYI","VND","VUV","XAF","XOF","XPF"].includes(e)?0:"MRO"===e?1:2}},{key:"getString",value:function(e,t){var a=(e/Math.pow(10,this.getPow(t))).toFixed(2);return"".concat(a," ").concat(this.get(t))}}]),e}()),l=a(369),u=a(38),d=a(77),p=a(129),h=new Map;function m(e){return!!e&&(!!e.content&&(h.has(e.content["@type"])||e.ttl>0))}function f(e){if(e<60){var t=1===e?"second":"seconds";return"".concat(e," ").concat(t)}if(e<3600){var a=1===Math.floor(e/60)?"minute":"minutes";return"".concat(e," ").concat(a)}if(e<86400){var n=1===Math.floor(e/60/60)?"hour":"hours";return"".concat(e," ").concat(n)}if(e<604800){var r=1===Math.floor(e/60/60/24)?"day":"days";return"".concat(e," ").concat(r)}return 604800===e?"1 week":"".concat(e," seconds")}function g(e){switch(e["@type"]){case"passportElementTypeAddress":return"Address";case"passportElementTypeBankStatement":return"Bank Statement";case"passportElementTypeDriverLicense":return"Driver Licence";case"passportElementTypeEmailAddress":return"Email";case"passportElementTypeIdentityCard":return"Identity Card";case"passportElementTypeInternalPassport":return"Internal Passport";case"passportElementTypePassport":return"Passport";case"passportElementTypePassportRegistration":return"Passport Registration";case"passportElementTypePersonalDetails":return"Personal details";case"passportElementTypePhoneNumber":return"Phone Number";case"passportElementTypeRentalAgreement":return"Tenancy Agreement";case"passportElementTypeTemporaryRegistration":return"Temporary Registration";case"passportElementTypeUtilityBill":return"Utility Bill"}return""}function v(e,t){if(!e)return null;var a=e.chat_id,n=e.sender_user_id;if(0!==n)return i.a.createElement(l.a,{userId:n,openUser:t});var r=u.a.get(a);return r?r.title:null}function b(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return null;if(!e.content)return null;var a=e.sender_user_id===d.a.getMyId(),r=u.a.get(e.chat_id),o="chatTypeSupergroup"===r.type["@type"]&&r.type.is_channel,s=e.ttl,h=e.sender_user_id,b=e.content;if(s>0)switch(b["@type"]){case"messagePhoto":return a?"You sent a self-destructing photo. Please view it on your mobile":i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,{userId:h,openUser:t})," sent a self-destructing photo. Please view it on your mobile");case"messageVideo":return a?"You sent a self-destructing video. Please view it on your mobile":i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,{userId:h,openUser:t})," sent a self-destructing video. Please view it on your mobile");default:return a?"You sent a self-destructing message. Please view it on your mobile":i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,{userId:h,openUser:t})," sent a self-destructing message. Please view it on your mobile")}switch(b["@type"]){case"messageBasicGroupChatCreate":var C=u.a.get(e.chat_id),y=C.title;return a?"You created group \xab".concat(y,"\xbb"):i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,{userId:h,openUser:t})," created group \xab".concat(y,"\xbb"));case"messageChatAddMembers":var k=b.member_user_ids.map((function(e){return i.a.createElement(l.a,{key:e,userId:e,openUser:t})})).reduce((function(e,t,a,r){var i=a===r.length-1?" and ":", ";return null===e?[t]:[].concat(Object(n.a)(e),[i,t])}),null);return a?1===b.member_user_ids.length&&b.member_user_ids[0]===d.a.getMyId()?"You joined the group":i.a.createElement(i.a.Fragment,null,"You added ",k):1===b.member_user_ids.length&&b.member_user_ids[0]===e.sender_user_id?i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,{userId:h,openUser:t})," joined the group"):i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,{userId:h,openUser:t})," added ",k);case"messageChatChangePhoto":return o?"Channel photo updated":a?"You updated group photo":i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,{userId:h,openUser:t})," updated group photo");case"messageChatChangeTitle":var E=b.title;return o?"Channel name was changed to \xab".concat(E,"\xbb"):a?"You changed group name to \xab".concat(E,"\xbb"):i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,{userId:h,openUser:t})," changed group name to \xab".concat(E,"\xbb"));case"messageChatDeleteMember":return a?b.user_id===d.a.getMyId()?"You left the group":i.a.createElement(i.a.Fragment,null,"You removed ",i.a.createElement(l.a,{userId:b.user_id,openUser:t})):b.user_id===h?i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,{userId:h,openUser:t})," left the group"):i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,{userId:h,openUser:t})," removed ",i.a.createElement(l.a,{userId:b.user_id,openUser:t}));case"messageChatDeletePhoto":return o?"Channel photo removed":a?"You removed group photo":i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,{userId:h,openUser:t})," removed group photo");case"messageChatJoinByLink":return a?"You joined the group via invite link":i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,{userId:h,openUser:t})," joined the group via invite link");case"messageChatSetTtl":var S=b.ttl,O=f(S);return S<=0?a?"You disabled the self-destruct timer":i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,{userId:h,openUser:t})," disabled the self-destruct timer"):a?"You set the self-destruct timer to ".concat(O):i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,{userId:h,openUser:t})," set the self-destruct timer to ".concat(O));case"messageChatUpgradeFrom":return"The group was upgraded to a supergroup";case"messageChatUpgradeTo":return"Group migrated to a supergroup";case"messageContactRegistered":return i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,{userId:h,openUser:t})," just joined Telegram");case"messageCustomServiceAction":return b.text;case"messageGameScore":var U=p.a.get(e.chat_id,b.game_message_id);if(U&&U.content&&"messageGame"===U.content["@type"]&&U.content.game){var w=U.content.game;return a?"You scored ".concat(b.score," in \xab").concat(w.title,"\xbb"):i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,{userId:U.sender_user_id,openUser:t})," scored ".concat(b.score," in \xab").concat(w.title,"\xbb"))}return a?"You scored ".concat(b.score):i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,{userId:h,openUser:t})," scored ".concat(b.score));case"messagePassportDataReceived":return"Telegram Passport data received";case"messagePassportDataSent":var M=u.a.get(e.chat_id),I=b.types.map((function(e){return g(e)})).reduce((function(e,t){return null===e?[t]:[].concat(Object(n.a)(e),[", ",t])}),null);return i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,{userId:M.type.user_id,openUser:t})," received the following documents: ",I);case"messagePaymentSuccessful":var j=u.a.get(e.chat_id),_=p.a.get(e.chat_id,b.invoice_message_id);if(_&&_.content&&"messageInvoice"===_.content["@type"]&&_.content.invoice){var x=_.content.invoice;return i.a.createElement(i.a.Fragment,null,"You have just successfully transferred ".concat(c.getString(b.total_amount,b.currency)," to "),i.a.createElement(l.a,{userId:j.type.user_id,openUser:t})," for ".concat(x.title))}return i.a.createElement(i.a.Fragment,null,"You have just successfully transferred ".concat(c.getString(b.total_amount,b.currency)," to "),i.a.createElement(l.a,{userId:j.type.user_id,openUser:t}));case"messagePaymentSuccessfulBot":return"Payment successful";case"messagePinMessage":var T=v(e,t),L=p.a.get(e.chat_id,b.message_id);if(!L||!L.content)return i.a.createElement(i.a.Fragment,null,T," pinned a message");var P=" pinned a message";if(m(L))P=" pinned a service message";else switch(L.content["@type"]){case"messageAnimation":P=" pinned a GIF";break;case"messageAudio":P=" pinned a track";break;case"messageCall":P=" pinned a call";break;case"messageContact":P=" pinned a contact";break;case"messageDocument":P=" pinned a file";break;case"messageExpiredPhoto":P=" pinned a photo";break;case"messageExpiredVideo":P=" pinned a video";break;case"messageGame":P=" pinned a game";break;case"messageInvoice":P=" pinned an invoice";break;case"messageLocation":P=" pinned a map";break;case"messagePhoto":P=" pinned a photo";break;case"messagePoll":P=" pinned a poll";break;case"messageSticker":P=" pinned a sticker";break;case"messageText":var N=16,D=L.content.text.text;P=D.length<=N?" pinned \xab".concat(D,"\xbb"):" pinned \xab".concat(D.substring(0,N),"...\xbb");break;case"messageUnsupported":P=" pinned unsupported message";break;case"messageVenue":P=" pinned a venue";break;case"messageVideo":P=" pinned a video";break;case"messageVideoNote":P=" pinned a video message";break;case"messageVoiceNote":P=" pinned a voice message"}return i.a.createElement(i.a.Fragment,null,T,P);case"messageScreenshotTaken":return a?"You took a screenshot!":i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,{userId:h,openUser:t})," took a screenshot!");case"messageSupergroupChatCreate":var R=b.title;return o?"Channel created":a?"You created group \xab".concat(R,"\xbb"):i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,{userId:h,openUser:t})," created group \xab".concat(R,"\xbb"));case"messageUnsupported":return"Unsupported message";case"messageWebsiteConnected":return"You allowed this bot to message you when you logged in on ".concat(b.domain_name,".")}return"[".concat(e.content["@type"],"]")}h.set("messageBasicGroupChatCreate","messageBasicGroupChatCreate"),h.set("messageChatAddMembers","messageChatAddMembers"),h.set("messageChatChangePhoto","messageChatChangePhoto"),h.set("messageChatChangeTitle","messageChatChangeTitle"),h.set("messageChatDeleteMember","messageChatDeleteMember"),h.set("messageChatDeletePhoto","messageChatDeletePhoto"),h.set("messageChatJoinByLink","messageChatJoinByLink"),h.set("messageChatSetTtl","messageChatSetTtl"),h.set("messageChatUpgradeFrom","messageChatUpgradeFrom"),h.set("messageChatUpgradeTo","messageChatUpgradeTo"),h.set("messageContactRegistered","messageContactRegistered"),h.set("messageCustomServiceAction","messageCustomServiceAction"),h.set("messageGameScore","messageGameScore"),h.set("messagePassportDataReceived","messagePassportDataReceived"),h.set("messagePassportDataSent","messagePassportDataSent"),h.set("messagePaymentSuccessful","messagePaymentSuccessful"),h.set("messagePaymentSuccessfulBot","messagePaymentSuccessfulBot"),h.set("messagePinMessage","messagePinMessage"),h.set("messageScreenshotTaken","messageScreenshotTaken"),h.set("messageSupergroupChatCreate","messageSupergroupChatCreate"),h.set("messageUnsupported","messageUnsupported"),h.set("messageWebsiteConnected","messageWebsiteConnected")},,,function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"d",(function(){return d}));var n=a(404);function r(e,t){return e?t?e.startsWith("mailto:")?e:"mailto:"+e:e.startsWith("http")?e:"http://"+e:null}function i(e,t){return(!e||e===t)&&!function(e){return!!e&&s.test(e)}(t)}function o(e,t){if(!e)return null;var a=r(e,t);try{var i=decodeURI(a),o=i.match(/^https?:\/\/([^\/:?#]+)(?:[\/:?#]|$)/i)[1];return i=i.replace(o,n.a.ToUnicode(o))}catch(s){console.log("SafeLink.getDecodedUrl error ",e,s)}return null}var s=/\u202e/;var c=new RegExp("(?:([a-zA-Z]+):\\/\\/)((?:[A-Za-z\xd0\x90-\xd0\xaf\xd0\x81\xd0\xb0-\xd1\x8f\xd1\x910-9\\-\\_]+\\.){0,10}([A-Za-z\xd1\x80\xd1\x84\\-\\d]{2,22})(\\:\\d+)?)"),l=new RegExp("(?:([a-zA-Z]+):\\/\\/)?((?:[A-Za-z\xd0\x90-\xd0\xaf\xd0\x81\xd0\xb0-\xd1\x8f\xd1\x910-9\\-\\_]+\\.){1,10}([A-Za-z\xd1\x80\xd1\x84\\-\\d]{2,22})(\\:\\d+)?)"),u=new RegExp("^([a-zA-Z]+):\\/\\/");function d(e){var t=e.trim();if(!t)return null;var a=t.match(c);if(!a){var n=t.match(l);return n&&0===n.index?"http://"+t:null}if(0!==a.index)return null;var r=t.match(u);return r&&function(e){return["http","https","tg"].some((function(t){return 0===e.toLowerCase().indexOf(t)}))}(r[0])?t:null}},function(e,t,a){"use strict";var n=a(8),r=a(9),i=a(11),o=a(10),s=a(0),c=a.n(s),l=a(127),u=a.n(l),d=a(361),p=a(374),h=a(380),m=a(381),f=a(382),g=a(405),v=a(343),b=a(346),C=(a(460),function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var r;Object(n.a)(this,a),(r=t.call(this,e)).onClientUpdateMediaEnd=function(e){var t=r.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId&&r.setState({active:!1,playing:!1,currentTime:0})},r.onClientUpdateMediaPlay=function(e){var t=r.props,a=t.chatId,n=t.messageId;t.playing;a===e.chatId&&n===e.messageId?r.setState({playing:!0}):r.setState({playing:!1})},r.onClientUpdateMediaPause=function(e){var t=r.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId&&r.setState({playing:!1})},r.onClientUpdateMediaActive=function(e){var t=r.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId?r.state.active||r.setState({active:!0,currentTime:0,playing:!0}):r.state.active&&r.setState({active:!1,currentTime:0,playing:!1})};var i=e.chatId,o=e.messageId,s=b.b.time,c=b.b.message,l=b.b.playing,u=c&&c.chat_id===i&&c.id===o;return r.state={active:u,playing:!!u&&l,currentTime:u&&s?s.currentTime:0,duration:u&&s?s.duration:0},r}return Object(r.a)(a,[{key:"shouldComponentUpdate",value:function(e,t,a){var n=this.state,r=n.active,i=n.playing,o=n.currentTime,s=n.duration;return t.active!==r||(t.playing!==i||(t.currentTime!==o||t.duration!==s))}},{key:"componentDidMount",value:function(){b.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),b.b.on("clientUpdateMediaPlay",this.onClientUpdateMediaPlay),b.b.on("clientUpdateMediaPause",this.onClientUpdateMediaPause),b.b.on("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}},{key:"componentWillUnmount",value:function(){b.b.off("clientUpdateMediaActive",this.onClientUpdateMediaActive),b.b.off("clientUpdateMediaPlay",this.onClientUpdateMediaPlay),b.b.off("clientUpdateMediaPause",this.onClientUpdateMediaPause),b.b.off("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.messageId,n=e.audio,r=e.openMedia,i=e.title,o=e.meta,s=e.caption,l=this.state,b=l.playing,C=l.active;if(!n)return null;var y=n.album_cover_thumbnail,k=n.duration,E=n.audio,S=Object(v.b)(n),O=Object(v.a)(n);return c.a.createElement("div",{className:u()("audio","document",{"media-title":i})},c.a.createElement(m.a,{thumbnail:y,file:E,openMedia:r,icon:c.a.createElement(d.a,null),completeIcon:b?c.a.createElement(h.a,null):c.a.createElement(p.a,null)}),c.a.createElement("div",{className:"audio-content"},c.a.createElement("div",{className:"document-title"},c.a.createElement("a",{className:"document-name",onClick:r,title:S},S)),c.a.createElement("div",{className:"audio-action",style:{opacity:C?0:1}},O),c.a.createElement(g.a,{className:"audio-slider",chatId:t,messageId:a,duration:k,style:{opacity:C?1:0}}),c.a.createElement(f.a,{chatId:t,messageId:a,duration:k,file:E,meta:s?null:o})))}}]),a}(c.a.Component));t.a=C},function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(37);t.a=Object(i.a)(r.a.createElement("path",{transform:"translate(-15.000000, -15.000000)",d:"M23,16 C23.5522847,16 24,16.4477153 24,17 L24,37 C24,37.5522847 23.5522847,38 23,38 L18,38 C17.4477153,38 17,37.5522847 17,37 L17,17 C17,16.4477153 17.4477153,16 18,16 L23,16 Z M36,16 C36.5522847,16 37,16.4477153 37,17 L37,37 C37,37.5522847 36.5522847,38 36,38 L31,38 C30.4477153,38 30,37.5522847 30,37 L30,17 C30,16.4477153 30.4477153,16 31,16 L36,16 Z"}),"Pause")},function(e,t,a){"use strict";var n=a(8),r=a(9),i=a(11),o=a(10),s=a(0),c=a.n(s),l=a(127),u=a.n(l),d=a(354),p=a(337),h=a(336),m=(a(457),function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={loaded:!1},e.onClientUpdateDocumentThumbnailBlob=function(t){var a=e.props.thumbnail;if(a){var n=a.photo;if(n){var r=t.fileId;n.id===r&&e.forceUpdate()}}},e.handleLoad=function(){e.setState({loaded:!0})},e}return Object(r.a)(a,[{key:"componentDidMount",value:function(){h.a.on("clientUpdateDocumentThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob),h.a.on("clientUpdateAudioThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob)}},{key:"componentWillUnmount",value:function(){h.a.off("clientUpdateDocumentThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob),h.a.off("clientUpdateAudioThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob)}},{key:"render",value:function(){var e=this.props,t=e.minithumbnail,a=e.thumbnail,n=e.file,r=e.icon,i=e.completeIcon,o=e.openMedia,s=this.state.loaded,l=t?"data:image/jpeg;base64, "+t.data:null,h=Object(p.l)(a?a.photo:null),m=h&&s,f=h||l;return c.a.createElement("div",{className:u()("document-tile",{"document-tile-image":!f},{pointer:o}),onClick:o},n&&c.a.createElement(d.a,{file:n,thumbnailSrc:f,download:!0,upload:!0,cancelButton:!0,zIndex:1,icon:r,completeIcon:"function"===typeof i?i(f):i}),f&&c.a.createElement("img",{className:"tile-photo",src:f,onLoad:this.handleLoad,draggable:!1,alt:""}),!m&&c.a.createElement("div",{className:"document-tile-background"}))}}]),a}(c.a.Component));t.a=m},function(e,t,a){"use strict";var n=a(8),r=a(9),i=a(11),o=a(10),s=a(0),c=a.n(s),l=a(337),u=a(22),d=a(336),p=a(346),h=(a(458),function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var r;Object(n.a)(this,a),(r=t.call(this,e)).onClientUpdateMediaSeeking=function(e){var t=r.props,a=t.chatId,n=t.messageId,i=t.duration,o=r.state,s=o.duration,c=o.active,l=o.file;if(a===e.chatId&&n===e.messageId){var u=s||i;r.setState({seekProgress:e.value,seeking:!0,timeString:r.getTimeString(u*e.value,u,c,l)})}},r.onClientUpdateMediaSeek=function(e){var t=r.props,a=t.chatId,n=t.messageId,i=t.duration,o=r.state,s=o.duration,c=o.active,l=o.file;if(a===e.chatId&&n===e.messageId){var u=s||i;r.setState({seekProgress:0,seeking:!1,timeString:r.getTimeString(u*e.value,u,c,l)})}},r.onClientUpdateMediaEnd=function(e){var t=r.props,a=t.chatId,n=t.messageId,i=t.duration,o=r.state,s=(o.active,o.file);if(a===e.chatId&&n===e.messageId){var c=e.duration>=0&&e.duration<1/0?e.duration:i;r.setState({active:!1,currentTime:0,timeString:r.getTimeString(0,c,!1,s)})}},r.onClientUpdateMediaTime=function(e){var t=r.props,a=t.chatId,n=t.messageId,i=t.duration,o=r.state,s=o.active,c=o.file,l=o.seekProgress,u=o.seeking;if(a===e.chatId&&n===e.messageId){var d=e.duration>=0&&e.duration<1/0?e.duration:i,p=u?l*d:e.currentTime;r.setState({currentTime:e.currentTime,duration:d,timeString:r.getTimeString(p,d,s,c)})}},r.onClientUpdateMediaActive=function(e){var t=r.props,a=t.chatId,n=t.messageId,i=t.duration,o=r.state,s=o.active,c=o.currentTime,l=o.file;a===e.chatId&&n===e.messageId?r.setState({active:!0,currentTime:s?c:0,timeString:s?r.state.timeString:r.getTimeString(0,i,!0,l)}):s&&r.setState({active:!1,currentTime:0,timeString:r.getTimeString(0,i,!1,l)})},r.onUpdateFile=function(e){var t=r.state.file,a=e.file;t&&t.id===a.id&&r.setState({file:a,prevFile:t})},r.getTimeString=function(e,t,a,n){var r=n.local&&n.local.is_downloading_completed,i=(n.remote&&n.remote.is_uploading_completed,Object(u.f)(Math.floor(t||0))),o=Object(u.f)(Math.floor(e||0));return a&&r?"".concat(o," / ").concat(i):"".concat(i)};var i=p.b.message,o=p.b.time,s=r.props,c=s.chatId,l=s.messageId,h=s.duration,m=s.file,f=i&&i.chat_id===c&&i.id===l,g=f&&o?o.currentTime:0,v=f&&o&&o.duration?o.duration:h,b=d.a.get(m.id)||m;return r.state={active:f,currentTime:g,seekProgress:0,duration:v,timeString:r.getTimeString(g,h,f,b),prevFile:null,file:b},r}return Object(r.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props.theme,n=this.state,r=n.active,i=n.timeString,o=n.file,s=n.prevFile;return e.theme!==a||(t.timeString!==i||(t.active!==r||(t.file!==o||t.prevFile!==s)))}},{key:"componentDidMount",value:function(){d.a.on("updateFile",this.onUpdateFile),p.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),p.b.on("clientUpdateMediaTime",this.onClientUpdateMediaTime),p.b.on("clientUpdateMediaEnd",this.onClientUpdateMediaEnd),p.b.on("clientUpdateMediaSeeking",this.onClientUpdateMediaSeeking),p.b.on("clientUpdateMediaSeek",this.onClientUpdateMediaSeek)}},{key:"componentWillUnmount",value:function(){d.a.off("updateFile",this.onUpdateFile),p.b.off("clientUpdateMediaActive",this.onClientUpdateMediaActive),p.b.off("clientUpdateMediaTime",this.onClientUpdateMediaTime),p.b.off("clientUpdateMediaEnd",this.onClientUpdateMediaEnd),p.b.off("clientUpdateMediaSeeking",this.onClientUpdateMediaSeeking),p.b.off("clientUpdateMediaSeek",this.onClientUpdateMediaSeek)}},{key:"render",value:function(){var e=this.props,t=e.title,a=e.meta,n=this.state,r=n.active,i=n.file,o=n.timeString;if(!i)return null;var s=i.local&&i.local.is_downloading_active,u=i.remote&&i.remote.is_uploading_active,d=i.local&&i.local.is_downloading_completed,p=(i.remote&&i.remote.is_uploading_completed,Object(l.h)(i)),h=null;s?h=Object(l.f)(i):u&&(h=Object(l.m)(i));var m=h?"".concat(h," / ").concat(p):"".concat(p),f=[];return d||f.push(m),s||f.push(o),c.a.createElement("div",{className:"audio-action"},!r&&c.a.createElement("span",null,t),c.a.createElement("span",null,f.join(", ")),a)}}]),a}(c.a.Component));t.a=h},function(e,t,a){"use strict";var n=a(44),r=a(8),i=a(9),o=a(11),s=a(10),c=a(0),l=a.n(c),u=a(127),d=a.n(u),p=a(468),h=a.n(p),m=a(339),f=a(337),g=a(16),v=a(336),b=(a(467),function(e){Object(o.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(r.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).onClientUpdateLocationBlob=function(t){var a=t.fileId,n=e.props,r=n.location,i=n.width,o=n.height,s=n.zoom,c=n.scale,l=Object(m.p)(r,i,o,s,c),u=v.a.getLocationFile(l);u&&u.id===a&&e.forceUpdate()},e.handleClick=function(e){e.stopPropagation()},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){v.a.on("clientUpdateLocationBlob",this.onClientUpdateLocationBlob)}},{key:"componentWillUnmount",value:function(){v.a.off("clientUpdateLocationBlob",this.onClientUpdateLocationBlob)}},{key:"render",value:function(){var e=this.props,t=e.location,a=e.width,r=e.height,i=e.zoom,o=e.scale,s=e.type,c=e.style,u=e.title,p=e.caption;if(!t)return null;var g=Object(m.p)(t,a,r,i,o),b=v.a.getLocationFile(g),C=Object(f.l)(b),y=t.longitude,k=t.latitude,E="https://maps.google.com/?q=".concat(k,",").concat(y),S=Object(n.a)({width:a,height:r},c);return l.a.createElement("div",{className:d()("location",{"location-message":"message"===s,"location-venue":"venue"===s,"location-title":u,"location-caption":p}),style:S},l.a.createElement("a",{href:E,target:"_blank",rel:"noopener noreferrer",onClick:this.handleClick},l.a.createElement("div",{className:"location-wrapper"},l.a.createElement("img",{className:"location-image",draggable:!1,alt:E,src:C}),l.a.createElement("div",{className:"location-icon"},l.a.createElement(h.a,{fontSize:"large",color:"primary"})))))}}]),a}(l.a.Component));b.defaultProps={width:g.o,height:g.m,zoom:g.p,scale:g.n},t.a=b},function(e,t,a){"use strict";var n=a(44),r=a(8),i=a(9),o=a(11),s=a(10),c=a(0),l=a.n(c),u=a(127),d=a.n(u),p=a(374),h=a(22),m=a(337),f=a(343),g=a(16),v=a(336),b=(a(472),function(e){Object(o.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(r.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).onClientUpdateVideoThumbnailBlob=function(t){var a=e.props.video.thumbnail,n=t.fileId;a&&a.photo&&a.photo.id===n&&e.forceUpdate()},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){v.a.on("clientUpdateVideoThumbnailBlob",this.onClientUpdateVideoThumbnailBlob)}},{key:"componentWillUnmount",value:function(){v.a.off("clientUpdateVideoThumbnailBlob",this.onClientUpdateVideoThumbnailBlob)}},{key:"render",value:function(){var e=this.props,t=e.displaySize,a=e.openMedia,r=e.title,i=e.caption,o=e.type,s=e.style,c=this.props.video,u=c.minithumbnail,g=c.thumbnail,v=c.video,b=c.width,C=c.height,y=c.duration,k=Object(h.h)({width:b,height:C}||g,t);if(!k)return null;var E=Object(n.a)({width:k.width,height:k.height},s),S=u?"data:image/jpeg;base64, "+u.data:null,O=Object(m.l)(g?g.photo:null),U=O?Object(f.k)(g):Boolean(S);return l.a.createElement("div",{className:d()("video",{"video-big":"message"===o,"video-title":r,"video-caption":i,pointer:a}),style:E,onClick:a},l.a.createElement("img",{className:d()("video-preview",{"media-blurred":U,"media-mini-blurred":!O&&U}),src:O||S,alt:""}),l.a.createElement("div",{className:"video-play"},l.a.createElement(p.a,null)),l.a.createElement("div",{className:"video-meta"},Object(h.f)(y)+" "+Object(m.h)(v)))}}]),a}(l.a.Component));b.defaultProps={size:g.F,displaySize:g.D},t.a=b},function(e,t,a){"use strict";var n=a(8),r=a(9),i=a(11),o=a(10),s=a(0),c=a.n(s),l=a(339),u=a(129),d=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var r;Object(n.a)(this,a),(r=t.call(this,e)).onUpdateMessageContentOpened=function(e){var t=r.props,a=t.chatId,n=t.messageId;a===e.chat_id&&n===e.message_id&&r.setState({isOpened:Object(l.D)(a,n)})};var i=r.props,o=i.chatId,s=i.messageId;return r.state={isOpened:Object(l.D)(o,s)},r}return Object(r.a)(a,[{key:"componentDidMount",value:function(){u.a.on("updateMessageContentOpened",this.onUpdateMessageContentOpened)}},{key:"componentWillUnmount",value:function(){u.a.off("updateMessageContentOpened",this.onUpdateMessageContentOpened)}},{key:"render",value:function(){var e=this.props,t=e.icon,a=e.openedIcon;return this.state.isOpened?a:t}}]),a}(c.a.Component);d.defaultProps={icon:null,openedIcon:null},t.a=d},,function(e,t,a){"use strict";var n=a(8),r=a(9),i=a(11),o=a(10),s=a(0),c=a.n(s),l=a(355),u=a(16),d=a(2),p=(a(604),function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={emoji:null,prevPropsSticker:null},e.loadStickerEmojis=function(t){var a=t.sticker.id;d.a.send({"@type":"getStickerEmojis",sticker:{"@type":"inputFileId",id:a}}).then((function(a){e.props.sticker===t&&e.setState({emoji:a.emojis.join(" ")})}))},e}return Object(r.a)(a,[{key:"componentDidUpdate",value:function(e,t,a){var n=this.props.sticker;n&&n!==e.sticker&&this.loadStickerEmojis(n)}},{key:"componentDidMount",value:function(){var e=this.props.sticker;e&&this.loadStickerEmojis(e)}},{key:"render",value:function(){var e=this.props.sticker,t=this.state.emoji;return e?c.a.createElement("div",{className:"sticker-preview"},c.a.createElement("div",{className:"sticker-preview-emoji"},t),c.a.createElement(l.b,{sticker:e,displaySize:u.lb,source:l.a.PREVIEW})):null}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.sticker,n=t.prevPropsSticker;return a&&n?{prevPropsSticker:a,emoji:null}:null}}]),a}(c.a.Component));t.a=p},,,,,,,,,function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(37);t.a=Object(i.a)(r.a.createElement("g",{transform:"translate(3.000000, 0.600000)"},r.a.createElement("path",{d:"M9,0 C13.9705627,-9.13077564e-16 18,4.02943725 18,9 L18,23 L18,23 L15,20 L12,23 L9,20 L6,23 L3,20 L0,23 L0,9 C-6.08718376e-16,4.02943725 4.02943725,9.13077564e-16 9,0 Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round",fill:"none"}),r.a.createElement("circle",{cx:"5",cy:"9",r:"2"}),r.a.createElement("circle",{cx:"13",cy:"9",r:"2"})),"DeletedAccount")},,function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(37);t.a=Object(i.a)(r.a.createElement("path",{d:"M4.70710678,12.2928932 C4.31658249,11.9023689 3.68341751,11.9023689 3.29289322,12.2928932 C2.90236893,12.6834175 2.90236893,13.3165825 3.29289322,13.7071068 L8.29289322,18.7071068 C8.68341751,19.0976311 9.31658249,19.0976311 9.70710678,18.7071068 L20.7071068,7.70710678 C21.0976311,7.31658249 21.0976311,6.68341751 20.7071068,6.29289322 C20.3165825,5.90236893 19.6834175,5.90236893 19.2928932,6.29289322 L9,16.5857864 L4.70710678,12.2928932 Z"}),"Check")},,function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return o}));var n=a(2);function r(e,t,a){n.a.send({"@type":"setPollAnswer",chat_id:e,message_id:t,option_ids:a})}function i(e,t){n.a.send({"@type":"setPollAnswer",chat_id:e,message_id:t,option_ids:[]})}function o(e,t){n.a.send({"@type":"stopPoll",chat_id:e,message_id:t,reply_markup:null})}},function(e,t,a){"use strict";var n=a(8),r=a(9),i=a(11),o=a(10),s=a(0),c=a.n(s),l=a(127),u=a.n(l),d=a(344),p=a(77),h=(a(448),function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var r;Object(n.a)(this,a),(r=t.call(this,e)).onUpdateUserStatus=function(e){var t=r.props.userId,a=p.a.get(t);t===e.user_id&&r.setState({status:Object(d.f)(a),isAccent:Object(d.j)(a)})};var i=r.props.userId,o=p.a.get(i);return r.state={prevUserId:i,status:Object(d.f)(o),isAccent:Object(d.j)(o)},r}return Object(r.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props.userId,n=this.state,r=n.status,i=n.isAccent;return e.userId!==a||(t.status!==r||t.isAccent!==i)}},{key:"componentDidMount",value:function(){p.a.on("updateUserStatus",this.onUpdateUserStatus)}},{key:"componentWillUnmount",value:function(){p.a.off("updateUserStatus",this.onUpdateUserStatus)}},{key:"render",value:function(){var e=this.state,t=e.status,a=e.isAccent;return c.a.createElement("div",{className:u()("user-content","dialog-content",{"user-status-accent":a})},t)}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.userId!==t.prevUserId){var a=e.userId,n=p.a.get(a);return{prevUserId:a,status:Object(d.f)(n),isAccent:Object(d.j)(n)}}return null}}]),a}(c.a.Component));t.a=h},function(e,t,a){"use strict";var n=a(60),r=a(44),i=a(8),o=a(9),s=a(25),c=a(11),l=a(10),u=a(21),d=a(2),p=a(403),h=new(function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).reset=function(){e.poll=null},e.onUpdate=function(t){switch(t["@type"]){case"updateAuthorizationState":var a=t.authorization_state;if(!a)break;switch(a["@type"]){case"authorizationStateClosed":e.reset()}}},e.onClientUpdate=function(t){switch(t["@type"]){case"clientUpdateClosePollResults":e.emit("clientUpdateClosePollResults",t);break;case"clientUpdateNewPoll":e.set({type:{"@type":"pollTypeRegular",allow_multiple_answers:!1},id:Date.now(),question:"",options:[],is_anonymous:!0}),e.emit("clientUpdateNewPoll",t);break;case"clientUpdatePollChangeAnonymous":var a=Object(s.a)(e).poll,i=a&&a.is_anonymous;e.assign(e.poll,{is_anonymous:!i}),e.emit("clientUpdatePollChangeAnonymous",t);break;case"clientUpdatePollChangeAllowMultipleAnswers":var o=Object(s.a)(e).poll,c=o.type;if("pollTypeRegular"===c["@type"]){var l=o&&o.type.allow_multiple_answers,u=Object(r.a)(Object(r.a)({},c),{},{allow_multiple_answers:!l});e.assign(e.poll,{type:u})}e.emit("clientUpdatePollChangeAllowMultipleAnswers",t);break;case"clientUpdatePollChangeType":if("pollTypeRegular"===Object(s.a)(e).poll.type["@type"]){e.assign(e.poll,{type:{"@type":"pollTypeQuiz",correct_option_id:-1}})}else{e.assign(e.poll,{type:{"@type":"pollTypeRegular",allow_multiple_answers:!1}})}e.emit("clientUpdatePollChangeType",t);break;case"clientUpdatePollChooseOption":var d=t.id,p=e.poll.options;e.assign(e.poll,{options:p.map((function(e){return e.id===d?Object(r.a)(Object(r.a)({},e),{},{is_chosen:!0}):Object(r.a)(Object(r.a)({},e),{},{is_chosen:!1})}))}),e.emit("clientUpdatePollChooseOption",t);break;case"clientUpdatePollQuestion":var h=t.question;e.assign(e.poll,{question:h}),e.emit("clientUpdatePollQuestion",t);break;case"clientUpdatePollOption":var m=t.id,f=t.text,g=e.poll.options;e.assign(e.poll,{options:g.map((function(e){return e.id===m?Object(r.a)(Object(r.a)({},e),{},{text:f}):Object(r.a)({},e)}))}),e.emit("clientUpdatePollOption",t);break;case"clientUpdateNewPollOption":var v=t.option,b=e.poll.options;e.assign(e.poll,{options:[].concat(Object(n.a)(b),[v])}),e.emit("clientUpdateNewPollOption",t);break;case"clientUpdateDeletePollOption":var C=t.id,y=e.poll.options;e.assign(e.poll,{options:y.filter((function(e){return e.id!==C}))}),e.emit("clientUpdateDeletePollOption",t);break;case"clientUpdateDeletePoll":e.set(null),e.emit("clientUpdateDeletePoll",t)}},e.addTdLibListener=function(){d.a.on("update",e.onUpdate),d.a.on("clientUpdate",e.onClientUpdate)},e.removeTdLibListener=function(){d.a.off("update",e.onUpdate),d.a.off("clientUpdate",e.onClientUpdate)},e.reset(),e.addTdLibListener(),e}return Object(o.a)(a,[{key:"assign",value:function(e,t){this.set(Object.assign({},e,t))}},{key:"set",value:function(e){this.poll=e}},{key:"getInputMessagePoll",value:function(){if(!this.poll)return null;if(!Object(p.b)(this.poll))return null;var e=this.poll,t=e.question,a=e.options,n=e.type,r=e.is_anonymous;return"pollTypeQuiz"===n["@type"]&&(n.correct_option_id=a.findIndex((function(e){return e.is_chosen})),-1===n.correct_option_id)?null:{"@type":"inputMessagePoll",question:t,options:a.filter((function(e){return Boolean(e.text)})).map((function(e){return e.text})),is_anonymous:r,type:n,is_closed:!1}}}]),a}(u.a));window.poll=h,t.a=h},function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return o}));var n=a(16);function r(e){if(!e)return!1;var t=e.question,a=e.options;if(!function(e){return!!e&&e.length<=n.R}(t))return!1;var r=a.filter((function(e){return Boolean(e.text)}));return!(r.length<=1)&&r.every(i)}function i(e){return!!e&&(!!e.text&&e.text.length<=n.O)}function o(e){if(!e)return!1;var t=e.question,a=e.options;return!!t||a.some((function(e){return Boolean(e.text)}))}},function(e,t,a){"use strict";var n=new function(){this.utf16={decode:function(e){for(var t,a,n=[],r=0,i=e.length;r<i;){if(55296===(63488&(t=e.charCodeAt(r++)))){if(a=e.charCodeAt(r++),55296!==(64512&t)||56320!==(64512&a))throw new RangeError("UTF-16(decode): Illegal UTF-16 sequence");t=((1023&t)<<10)+(1023&a)+65536}n.push(t)}return n},encode:function(e){for(var t,a=[],n=0,r=e.length;n<r;){if(55296===(63488&(t=e[n++])))throw new RangeError("UTF-16(encode): Illegal UTF-16 value");t>65535&&(t-=65536,a.push(String.fromCharCode(t>>>10&1023|55296)),t=56320|1023&t),a.push(String.fromCharCode(t))}return a.join("")}};var e=2147483647;function t(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function a(e,t,a){var n;for(e=a?Math.floor(e/700):e>>1,e+=Math.floor(e/t),n=0;e>455;n+=36)e=Math.floor(e/35);return Math.floor(n+36*e/(e+38))}this.decode=function(t,n){var r,i,o,s,c,l,u,d,p,h,m,f,g,v,b=[],C=[],y=t.length;for(r=128,o=0,s=72,(c=t.lastIndexOf("-"))<0&&(c=0),l=0;l<c;++l){if(n&&(C[b.length]=t.charCodeAt(l)-65<26),t.charCodeAt(l)>=128)throw new RangeError("Illegal input >= 0x80");b.push(t.charCodeAt(l))}for(u=c>0?c+1:0;u<y;){for(d=o,p=1,h=36;;h+=36){if(u>=y)throw RangeError("punycode_bad_input(1)");if((m=(v=t.charCodeAt(u++))-48<10?v-22:v-65<26?v-65:v-97<26?v-97:36)>=36)throw RangeError("punycode_bad_input(2)");if(m>Math.floor((e-o)/p))throw RangeError("punycode_overflow(1)");if(o+=m*p,m<(f=h<=s?1:h>=s+26?26:h-s))break;if(p>Math.floor(e/(36-f)))throw RangeError("punycode_overflow(2)");p*=36-f}if(s=a(o-d,i=b.length+1,0===d),Math.floor(o/i)>e-r)throw RangeError("punycode_overflow(3)");r+=Math.floor(o/i),o%=i,n&&C.splice(o,0,t.charCodeAt(u-1)-65<26),b.splice(o,0,r),o++}if(n)for(o=0,g=b.length;o<g;o++)C[o]&&(b[o]=String.fromCharCode(b[o]).toUpperCase().charCodeAt(0));return this.utf16.encode(b)},this.encode=function(n,r){var i,o,s,c,l,u,d,p,h,m,f,g;r&&(g=this.utf16.decode(n));var v=(n=this.utf16.decode(n.toLowerCase())).length;if(r)for(u=0;u<v;u++)g[u]=n[u]!=g[u];var b,C,y=[];for(i=128,o=0,l=72,u=0;u<v;++u)n[u]<128&&y.push(String.fromCharCode(g?(b=n[u],C=g[u],(b-=(b-97<26)<<5)+((!C&&b-65<26)<<5)):n[u]));for(s=c=y.length,c>0&&y.push("-");s<v;){for(d=e,u=0;u<v;++u)(f=n[u])>=i&&f<d&&(d=f);if(d-i>Math.floor((e-o)/(s+1)))throw RangeError("punycode_overflow (1)");for(o+=(d-i)*(s+1),i=d,u=0;u<v;++u){if((f=n[u])<i&&++o>e)return Error("punycode_overflow(2)");if(f==i){for(p=o,h=36;!(p<(m=h<=l?1:h>=l+26?26:h-l));h+=36)y.push(String.fromCharCode(t(m+(p-m)%(36-m),0))),p=Math.floor((p-m)/(36-m));y.push(String.fromCharCode(t(p,r&&g[u]?1:0))),l=a(o,s+1,s==c),o=0,++s}}++o,++i}return y.join("")},this.ToASCII=function(e){for(var t=e.split("."),a=[],r=0;r<t.length;++r){var i=t[r];a.push(i.match(/[^A-Za-z0-9-]/)?"xn--"+n.encode(i):i)}return a.join(".")},this.ToUnicode=function(e){for(var t=e.split("."),a=[],r=0;r<t.length;++r){var i=t[r];a.push(i.match(/^xn--/)?n.decode(i.slice(4)):i)}return a.join(".")}};t.a=n},function(e,t,a){"use strict";var n=a(8),r=a(9),i=a(11),o=a(10),s=a(0),c=a.n(s),l=a(127),u=a.n(l),d=a(662),p=a(16),h=a(346),m=a(2),f=(a(459),function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var r;Object(n.a)(this,a),(r=t.call(this,e)).reset=function(){var e=r.props.duration;1===r.state.value?(r.setState({active:!1,currentTime:0}),setTimeout((function(){r.state.currentTime||r.setState({value:r.getValue(0,e,!1)})}),p.J)):r.setState({active:!1,currentTime:0,value:r.getValue(0,e,!1)})},r.onClientUpdateMediaEnd=function(e){var t=r.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId&&r.reset()},r.onClientUpdateMediaTime=function(e){var t=r.props,a=t.chatId,n=t.messageId,i=t.duration,o=r.state,s=o.active,c=o.dragging;if(a===e.chatId&&n===e.messageId){var l=e.duration>=0&&e.duration<1/0?e.duration:i,u=r.getValue(e.currentTime,l,s);c?r.setState({currentTime:e.currentTime,duration:l}):r.setState({currentTime:e.currentTime,duration:l,value:u})}},r.onClientUpdateMediaActive=function(e){var t=r.props,a=t.chatId,n=t.messageId,i=t.duration,o=r.state,s=o.active,c=o.currentTime,l=o.dragging;if(a===e.chatId&&n===e.messageId){var u=e.duration>=0&&e.duration<1/0?e.duration:i,d=r.state.value;l||(d=r.getValue(s?c:0,u,!0)),r.setState({active:!0,currentTime:s?c:0,value:d})}else s&&r.reset()},r.getValue=function(e,t,a){return a?e/t:0},r.handleMouseDown=function(e){e.stopPropagation(),r.setState({dragging:!0})},r.handleChangeCommitted=function(){var e=r.props,t=e.chatId,a=e.messageId,n=r.state,i=n.value;n.active&&(m.a.clientUpdate({"@type":"clientUpdateMediaSeek",chatId:t,messageId:a,value:i}),r.setState({dragging:!1}))},r.handleChange=function(e,t){var a=r.props,n=a.chatId,i=a.messageId,o=r.state,s=o.active,c=o.dragging;s&&(c&&m.a.clientUpdate({"@type":"clientUpdateMediaSeeking",chatId:n,messageId:i,value:t}),r.setState({value:t}))};var i=h.b.message,o=h.b.time,s=r.props,c=s.chatId,l=s.messageId,u=s.duration,d=i&&i.chat_id===c&&i.id===l,f=d&&o?o.currentTime:0,g=d&&o&&o.duration?o.duration:u;return r.state={active:d,currentTime:f,duration:g,value:r.getValue(f,g,d)},r}return Object(r.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.state,n=a.active,r=a.value;return t.value!==r||t.active!==n}},{key:"componentDidMount",value:function(){h.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),h.b.on("clientUpdateMediaTime",this.onClientUpdateMediaTime),h.b.on("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}},{key:"componentWillUnmount",value:function(){h.b.off("clientUpdateMediaActive",this.onClientUpdateMediaActive),h.b.off("clientUpdateMediaTime",this.onClientUpdateMediaTime),h.b.off("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}},{key:"render",value:function(){var e=this.props,t=e.className,a=e.style,n=this.state.value;return c.a.createElement("div",{className:u()("voice-note-slider",t),style:a},c.a.createElement(d.a,{className:"voice-note-slider-component",classes:{track:"voice-note-slider-track",thumb:"voice-note-slider-thumb",active:"voice-note-slider-active"},min:0,max:1,step:.01,value:n,onChange:this.handleChange,onChangeCommitted:this.handleChangeCommitted,onMouseDown:this.handleMouseDown}))}}]),a}(c.a.Component));t.a=f},,function(e,t,a){"use strict";var n=a(8),r=a(9),i=a(11),o=a(10),s=a(0),c=a.n(s),l=a(127),u=a.n(l),d=a(408),p=a.n(d),h=a(361),m=a(642),f=a(354),g=a(385),v=a(337),b=a(343),C=a(22),y=a(16),k=a(346),E=a(336),S=a(129),O=a(14),U=(a(473),a(368)),w={circle:"video-note-progress-circle"},M=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var r;Object(n.a)(this,a),(r=t.call(this,e)).startStopPlayer=function(){var e=r.videoRef.current;if(e)if(!r.inView||!r.windowFocused||r.openMediaViewer||r.openProfileMediaViewer||r.openIV){if(r.state.active)return;e.pause()}else e.play()},r.onClientUpdateInstantViewContent=function(e){r.openIV=Boolean(U.a.getCurrent()),r.startStopPlayer()},r.onClientUpdateProfileMediaViewerContent=function(e){r.openProfileMediaViewer=Boolean(O.a.profileMediaViewerContent),r.startStopPlayer()},r.onClientUpdateMediaViewerContent=function(e){r.openMediaViewer=Boolean(O.a.mediaViewerContent),r.startStopPlayer()},r.onClientUpdateFocusWindow=function(e){r.windowFocused=e.focused,r.startStopPlayer()},r.onClientUpdateMessagesInView=function(e){var t=r.props,a=t.chatId,n=t.messageId,i="".concat(a,"_").concat(n);r.inView=e.messages.has(i),r.startStopPlayer()},r.onClientUpdateMediaCaptureStream=function(e){var t=r.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId&&(r.videoRef.current&&r.setState({srcObject:e.stream},(function(){r.updateVideoSrc()})))},r.onClientUpdateMediaTime=function(e){var t=r.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId&&(r.videoRef.current&&r.setState({currentTime:e.currentTime,videoDuration:e.duration}))},r.onClientUpdateMediaEnd=function(e){var t=r.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId&&r.setState({active:!1,srcObject:null,currentTime:0},(function(){var e=r.videoRef.current;e&&(r.updateVideoSrc(),window.hasFocus||e.pause())}))},r.onClientUpdateMediaActive=function(e){var t=r.props,a=t.chatId,n=t.messageId;r.props.videoNote.video;a===e.chatId&&n===e.messageId?r.state.active||r.setState({active:!0,currentTime:null}):r.state.active&&r.setState({active:!1,srcObject:null,currentTime:0},(function(){var e=r.videoRef.current;e&&(r.updateVideoSrc(),window.hasFocus||e.pause())}))},r.onClientUpdateVideoNoteBlob=function(e){var t=r.props.videoNote.video,a=e.fileId;t&&t.id===a&&r.setState({src:Object(v.l)(t)},(function(){r.updateVideoSrc()}))},r.onClientUpdateVideoNoteThumbnailBlob=function(e){var t=r.props.videoNote.thumbnail;if(t){var a=e.fileId;t.photo&&t.photo.id===a&&r.forceUpdate()}},r.handleCanPlay=function(){},r.videoRef=c.a.createRef(),r.sourceRef=c.a.createRef();var i=e.chatId,o=e.messageId,s=e.videoNote.video,l=k.b.time,u=k.b.message,d=k.b.videoStream,p=u&&u.chat_id===i&&u.id===o;return r.state={active:p,srcObject:p?d:null,src:Object(v.l)(s),currentTime:p&&l?l.currentTime:0,videoDuration:p&&l?l.duration:0},r.windowFocused=window.hasFocus,r.inView=!1,r.openMediaViewer=Boolean(O.a.mediaViewerContent),r.openProfileMediaViewer=Boolean(O.a.profileMediaViewerContent),r.openIV=Boolean(U.a.getCurrent()),r}return Object(r.a)(a,[{key:"updateVideoSrc",value:function(){var e=this.state,t=e.srcObject,a=e.src,n=this.videoRef.current;if(n)if(t)n.srcObject=t;else{var r=n.srcObject;if(r)r.getTracks().forEach((function(e){e.stop()}));n.srcObject&&(n.srcObject=null);var i=this.sourceRef.current;i&&i.src!==a&&(i.src=a,n.load())}}},{key:"componentDidMount",value:function(){this.updateVideoSrc(),E.a.on("clientUpdateVideoNoteThumbnailBlob",this.onClientUpdateVideoNoteThumbnailBlob),E.a.on("clientUpdateVideoNoteBlob",this.onClientUpdateVideoNoteBlob),S.a.on("clientUpdateMessagesInView",this.onClientUpdateMessagesInView),O.a.on("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),O.a.on("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent),O.a.on("clientUpdateProfileMediaViewerContent",this.onClientUpdateProfileMediaViewerContent),U.a.on("clientUpdateInstantViewContent",this.onClientUpdateInstantViewContent),k.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),k.b.on("clientUpdateMediaCaptureStream",this.onClientUpdateMediaCaptureStream),k.b.on("clientUpdateMediaTime",this.onClientUpdateMediaTime),k.b.on("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}},{key:"componentWillUnmount",value:function(){E.a.off("clientUpdateVideoNoteThumbnailBlob",this.onClientUpdateVideoNoteThumbnailBlob),E.a.off("clientUpdateVideoNoteBlob",this.onClientUpdateVideoNoteBlob),S.a.off("clientUpdateMessagesInView",this.onClientUpdateMessagesInView),O.a.off("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),O.a.off("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent),O.a.off("clientUpdateProfileMediaViewerContent",this.onClientUpdateProfileMediaViewerContent),U.a.off("clientUpdateInstantViewContent",this.onClientUpdateInstantViewContent),k.b.off("clientUpdateMediaActive",this.onClientUpdateMediaActive),k.b.off("clientUpdateMediaCaptureStream",this.onClientUpdateMediaCaptureStream),k.b.off("clientUpdateMediaTime",this.onClientUpdateMediaTime),k.b.off("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}},{key:"render",value:function(){var e=this.props,t=(e.displaySize,e.chatId),a=e.messageId,n=e.openMedia,r=this.state,i=r.active,o=r.currentTime,s=r.videoDuration,l=this.props.videoNote,d=l.minithumbnail,y=l.thumbnail,k=l.video,E=l.duration;if(!S.a.get(t,a))return null;var O={width:200,height:200};if(!O)return null;var U=d?"data:image/jpeg;base64, "+d.data:null,M=Object(v.l)(y?y.photo:null),I=Object(v.l)(k),j=M?Object(b.k)(y):Boolean(U),_=0;if(s&&o){var x=o+.25;_=Object(C.c)(x/s*100,0,100)}return c.a.createElement("div",{className:u()("video-note",{"video-note-playing":i}),style:O,onClick:n},I?c.a.createElement(c.a.Fragment,null,c.a.createElement("video",{ref:this.videoRef,className:u()("media-viewer-content-image","video-note-round"),poster:M||U,muted:!0,autoPlay:!0,loop:!0,playsInline:!0,width:O.width,height:O.height,onCanPlay:this.handleCanPlay},c.a.createElement("source",{ref:this.sourceRef,src:null,type:"video/mp4"})),c.a.createElement("div",{className:"video-note-player"},c.a.createElement("div",{className:"video-note-progress"},c.a.createElement(m.a,{classes:w,variant:"static",value:_,size:200,thickness:1})),c.a.createElement("div",{className:"animation-meta"},Object(C.f)(i?Math.floor(o):E),c.a.createElement(g.a,{chatId:t,messageId:a,icon:"\xa0\u2022"})),c.a.createElement("div",{className:"video-note-muted"},c.a.createElement(p.a,null)))):c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"video-note-round"},c.a.createElement("img",{className:u()("animation-preview",{"media-blurred":j,"media-mini-blurred":!I&&!M&&j}),style:O,src:M||U,alt:""})),c.a.createElement("div",{className:"animation-meta"},Object(C.f)(E)+" "+Object(v.h)(k),c.a.createElement(g.a,{chatId:t,messageId:a,icon:"\xa0\u2022"})),c.a.createElement("div",{className:"video-note-muted"},c.a.createElement(p.a,null))),c.a.createElement(f.a,{file:k,download:!0,upload:!0,cancelButton:!0,icon:c.a.createElement(h.a,null)}))}}]),a}(c.a.Component);M.defaultProps={size:y.F,displaySize:y.D},t.a=M},,function(e,t,a){"use strict";var n=a(8),r=a(9),i=a(11),o=a(10),s=a(0),c=a.n(s),l=a(127),u=a.n(l),d=a(382),p=a(410),h=a(385),m=a(405),f=(a(475),function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.messageId,n=e.voiceNote,r=e.openMedia,i=e.title,o=e.meta,s=e.caption;if(!n)return null;var l=n.duration,f=n.voice;return c.a.createElement("div",{className:u()("voice-note","document",{"media-title":i})},c.a.createElement(p.a,{chatId:t,messageId:a,file:f,openMedia:r}),c.a.createElement("div",{className:"voice-note-content"},c.a.createElement(m.a,{chatId:t,messageId:a,duration:l}),c.a.createElement("div",{className:"voice-note-meta"},c.a.createElement(d.a,{chatId:t,messageId:a,duration:l,file:f}),c.a.createElement(h.a,{chatId:t,messageId:a,icon:"\xa0\u2022"}),!s&&o)))}}]),a}(c.a.Component));t.a=f},function(e,t,a){"use strict";var n=a(8),r=a(9),i=a(11),o=a(10),s=a(0),c=a.n(s),l=a(361),u=a(374),d=a(380),p=a(381),h=a(346),m=(a(474),function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var r;Object(n.a)(this,a),(r=t.call(this,e)).onClientUpdateMediaEnd=function(e){var t=r.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId&&r.setState({active:!1,playing:!1,currentTime:0})},r.onClientUpdateMediaPlay=function(e){var t=r.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId?r.setState({playing:!0}):r.setState({playing:!1})},r.onClientUpdateMediaPause=function(e){var t=r.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId&&r.setState({playing:!1})},r.onClientUpdateMediaActive=function(e){var t=r.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId?r.state.active||r.setState({active:!0,currentTime:0,playing:!0}):r.state.active&&r.setState({active:!1,currentTime:0,playing:!1})};var i=e.chatId,o=e.messageId,s=h.b.time,c=h.b.message,l=h.b.playing,u=c&&c.chat_id===i&&c.id===o;return r.state={active:u,playing:!!u&&l,currentTime:u&&s?s.currentTime:0,duration:u&&s?s.duration:0},r}return Object(r.a)(a,[{key:"componentDidMount",value:function(){h.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),h.b.on("clientUpdateMediaPlay",this.onClientUpdateMediaPlay),h.b.on("clientUpdateMediaPause",this.onClientUpdateMediaPause),h.b.on("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}},{key:"componentWillUnmount",value:function(){h.b.off("clientUpdateMediaActive",this.onClientUpdateMediaActive),h.b.off("clientUpdateMediaPlay",this.onClientUpdateMediaPlay),h.b.off("clientUpdateMediaPause",this.onClientUpdateMediaPause),h.b.off("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}},{key:"render",value:function(){var e=this.props,t=e.file,a=e.openMedia,n=this.state.playing;return c.a.createElement(p.a,{thumbnail:null,file:t,openMedia:a,icon:c.a.createElement(l.a,null),completeIcon:n?c.a.createElement(d.a,null):c.a.createElement(u.a,null)})}}]),a}(c.a.Component));t.a=m},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(37);t.a=Object(i.a)(r.a.createElement("path",{d:"M12,1 C18.0751322,1 23,5.92486775 23,12 C23,18.0751322 18.0751322,23 12,23 C5.92486775,23 1,18.0751322 1,12 C1,5.92486775 5.92486775,1 12,1 Z M12,3 C7.02943725,3 3,7.02943725 3,12 C3,16.9705627 7.02943725,21 12,21 C16.9705627,21 21,16.9705627 21,12 C21,7.02943725 16.9705627,3 12,3 Z M6.66607426,13.6501686 C7.13342047,13.4117012 7.7055954,13.5972442 7.94406273,14.0645904 C8.71613228,15.5776856 10.2710663,16.5499921 12,16.5499921 C13.7262991,16.5499921 15.2792455,15.5806677 16.0525854,14.0711462 C16.2918118,13.6041881 16.8642875,13.419575 17.3312456,13.6588014 C17.7982037,13.8980278 17.9828168,14.4705034 17.7435904,14.9374615 C16.6482438,17.0755242 14.4462205,18.4499921 12,18.4499921 C9.55003677,18.4499921 7.34521255,17.0713067 6.2516524,14.928157 C6.01318507,14.4608108 6.19872805,13.8886359 6.66607426,13.6501686 Z M8.75,8 C9.44035594,8 10,8.67157288 10,9.5 C10,10.3284271 9.44035594,11 8.75,11 C8.05964406,11 7.5,10.3284271 7.5,9.5 C7.5,8.67157288 8.05964406,8 8.75,8 Z M15.25,8 C15.9403559,8 16.5,8.67157288 16.5,9.5 C16.5,10.3284271 15.9403559,11 15.25,11 C14.5596441,11 14,10.3284271 14,9.5 C14,8.67157288 14.5596441,8 15.25,8 Z"}),"Smile")},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,function(e,t,a){"use strict";var n=a(60),r=a(8),i=a(9),o=a(11),s=a(10),c=a(0),l=a.n(c),u=a(31),d=a(320);var p=function(){function e(t){Object(r.a)(this,e),this.fireworks=t,this.type=0,this.colorType=0,this.side=0,this.typeSize=4,this.xFinished=!1,this.finishedStart=!1,this.x=0,this.y=0,this.rotation=0,this.moveX=0,this.moveY=0}return Object(i.a)(e,[{key:"draw",value:function(e){e.fillStyle=this.colorType,0===this.type?(e.beginPath(),e.arc(this.x,this.y,this.typeSize,0,2*Math.PI,!1),e.fill()):(e.save(),e.translate(this.x,this.y),e.rotate(this.rotation*Math.PI/180),function(e,t,a,n,r,i,o,s){if("undefined"===typeof s&&(s=!0),"undefined"===typeof i&&(i=5),"number"===typeof i)i={tl:i,tr:i,br:i,bl:i};else{var c={tl:0,tr:0,br:0,bl:0};for(var l in c)i[l]=i[l]||c[l]}e.beginPath(),e.moveTo(t+i.tl,a),e.lineTo(t+n-i.tr,a),e.quadraticCurveTo(t+n,a,t+n,a+i.tr),e.lineTo(t+n,a+r-i.br),e.quadraticCurveTo(t+n,a+r,t+n-i.br,a+r),e.lineTo(t+i.bl,a+r),e.quadraticCurveTo(t,a+r,t,a+r-i.bl),e.lineTo(t,a+i.tl),e.quadraticCurveTo(t,a,t+i.tl,a),e.closePath(),o&&e.fill(),s&&e.stroke()}(e,-this.typeSize,-2,2*this.typeSize,4,2,!0,!1),e.restore())}},{key:"update",value:function(e){var t=e/16;if(this.x+=this.moveX*t,this.y+=this.moveY*t,0!==this.xFinished){1===this.xFinished?(this.moveX+=.5*t*.05,this.moveX>=.5&&(this.xFinished=2)):(this.moveX-=.5*t*.05,this.moveX<=-.5&&(this.xFinished=1))}else 0===this.side?this.moveX>0&&(this.moveX-=.05*t,this.moveX<=0&&(this.moveX=0,this.xFinished=this.finishedStart)):this.moveX<0&&(this.moveX+=.05*t,this.moveX>=0&&(this.moveX=0,this.xFinished=this.finishedStart));var a=this.moveY<-.5;return this.moveY>-.5?this.moveY+=1/3*t*this.fireworks.speedCoef:this.moveY+=1/3*t,a&&this.moveY>-.5&&this.fireworks.fallingDownCount++,1===this.type&&(this.rotation+=10*t,this.rotation>360&&(this.rotation-=360)),this.y>=this.fireworks.getMeasuredHeight()}}]),e}();function h(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e}var m=function(){function e(t){Object(r.a)(this,e),this.context=t,this.particlesCount=60,this.fallParticlesCount=30,this.particles=[],this.speedCoef=1,this.fallingDownCount=0}return Object(i.a)(e,[{key:"getMeasuredHeight",value:function(){return this.context.canvas.clientHeight}},{key:"getMeasuredWidth",value:function(){return this.context.canvas.clientWidth}},{key:"createParticle",value:function(t){var a=new p(this);if(a.colorType=e.colors[h(0,e.colors.length)],a.type=h(0,2),a.side=h(0,2),a.finishedStart=1+h(0,2),0===a.type?a.typeSize=4+2*Math.random():a.typeSize=4+4*Math.random(),t)a.y=-Math.random()*this.getMeasuredHeight()*1.2,a.x=5+h(0,this.getMeasuredWidth()-10),a.xFinished=a.finishedStart;else{var n=4+h(0,10),r=this.getMeasuredHeight()/4;0===a.side?a.x=-n:a.x=this.getMeasuredWidth()+n,a.rotation=360*Math.random(),a.moveX=(0===a.side?1:-1)*(1.2+4*Math.random()),a.moveY=-(4+4*Math.random()),a.y=r/2+h(0,2*r)}return a}},{key:"start",value:function(){if(!this.started){this.particles=[],this.started=!0,this.startedFall=!1,this.fallingDownCount=0,this.speedCoef=1,this.lastUpdateTime=0;for(var e=0;e<this.particlesCount;e++)this.particles.push(this.createParticle(!1));this.draw()}}},{key:"startFall",value:function(){if(!this.startedFall){this.startedFall=!0;for(var e=0;e<this.fallParticlesCount;e++)this.particles.push(this.createParticle(!0))}}},{key:"draw",value:function(){var e=this,t=Date.now(),a=t-this.lastUpdateTime;this.lastUpdateTime=t,a>18&&(a=16),this.context.clearRect(0,0,this.getMeasuredWidth(),this.getMeasuredHeight());for(var n=0,r=this.particles.length;n<r;n++){var i=this.particles[n];i.draw(this.context),i.update(a)&&(this.particles.splice(n,1),n--,r--)}this.fallingDownCount>=this.particlesCount/2&&this.speedCoef>.2&&(this.startFall(),this.speedCoef-=a/16*.15,this.speedCoef<.2&&(this.speedCoef=.2)),this.particles.length?window.requestAnimationFrame((function(){return e.draw()})):(this.started=!1,this.context.clearRect(0,0,this.getMeasuredWidth(),this.getMeasuredHeight()))}}]),e}();m.colors=["#E8BC2C","#D0049E","#02CBFE","#5723FD","#FE8C27","#6CB859"];var f=function(e){Object(o.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).onResize=function(){var e=n.canvasRef.current;e&&(e.setAttribute("width",n.parentNode.clientWidth+18),e.setAttribute("height",n.parentNode.clientHeight+12))},n.canvasRef=l.a.createRef(),n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.attachToParent()}},{key:"componentWillUnmount",value:function(){this.detachFromParent()}},{key:"attachToParent",value:function(){var e=this.canvasRef.current;if(e){var t=e.parentNode;t&&(this.parentNode=t,e.setAttribute("width",this.parentNode.clientWidth+18),e.setAttribute("height",this.parentNode.clientHeight+12),window.addEventListener("resize",this.onResize))}}},{key:"detachFromParent",value:function(){var e=this.canvasRef.current;e&&(e.parentNode&&(this.parentNode=null,window.removeEventListener("resize",this.onResize)))}},{key:"start",value:function(){var e=this.canvasRef.current.getContext("2d");new m(e).start()}},{key:"render",value:function(){return l.a.createElement("canvas",{ref:this.canvasRef,style:{zIndex:2,position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none"}})}}]),a}(l.a.Component),g=a(127),v=a.n(g),b=a(643),C=a(398),y=a(340),k=a(661),E=a(642),S=a(443),O=a.n(S),U=(a(442),function(e){Object(o.a)(a,e);var t=Object(s.a)(a);function a(){return Object(r.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.chosen,a=e.beingChosen,n=e.hidden,r=e.onChange;return l.a.createElement("div",{className:v()("poll-radio",{"poll-radio-hidden":n})},l.a.createElement(k.a,{color:"primary",classes:{root:"poll-radio-root",colorPrimary:"message-control",disabled:"message-control-disabled"},TouchRippleProps:{classes:{child:"touch-ripple-current-color"}},checked:t||a,onChange:r,checkedIcon:l.a.createElement(O.a,{classes:{root:a?"poll-radio-icon":null}})}),a&&l.a.createElement(E.a,{size:20,thickness:4.4,classes:{root:"poll-radio-progress-root",colorPrimary:"message-control"}}))}}]),a}(l.a.Component)),w=a(16),M=(a(444),function(e){Object(o.a)(a,e);var t=Object(s.a)(a);function a(e){var n;Object(r.a)(this,a),(n=t.call(this,e)).updateAnimation=function(){n.stopAnimation(),n.handle=requestAnimationFrame(n.onAnimationFrame)},n.stopAnimation=function(){n.handle&&(cancelAnimationFrame(n.handle),n.handle=null)},n.onAnimationFrame=function(){var e=n.state,t=e.startTime,a=e.from,r=e.to,i=Date.now()-t;if(i>=w.a)n.setState({animated:r}),n.stopAnimation();else{var o=a+Math.floor((r-a)*i/w.a);n.setState({animated:o}),n.handle=requestAnimationFrame(n.onAnimationFrame)}},n.handle=null;var i=e.value;return n.state={from:i,to:i,animated:i,prevPropsValue:i},n}return Object(i.a)(a,[{key:"shouldComponentUpdate",value:function(e,t,a){var n=this.props,r=n.closed,i=n.theme,o=n.value,s=this.state.animated;return r!==e.closed||(i!==e.theme||(o!==e.value||s!==t.animated))}},{key:"componentDidUpdate",value:function(e,t,a){e.value!==this.props.value&&this.updateAnimation()}},{key:"componentWillUnmount",value:function(){this.stopAnimation()}},{key:"render",value:function(){var e=this.props,t=(e.chosen,e.closed,e.onClick,this.state.animated);return l.a.createElement("div",{className:"poll-percentage"},l.a.createElement(l.a.Fragment,null,t+"%"))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.value!==t.prevPropsValue?{startTime:Date.now(),from:t.animated,to:e.value,prevPropsValue:e.value}:null}}]),a}(l.a.Component)),I=(a(445),function(e){Object(o.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(r.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).getTitleString=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e},n=e.props.canBeSelected;return n?null:t?1===t?"1 vote":t+" votes":a("NoVotes").toLowerCase()},e.handleClick=function(t){var a=e.props,n=a.canBeSelected,r=a.onVote;n&&(t.stopPropagation(),r())},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.option,a=e.onChange,n=e.canBeSelected,r=e.closed,i=e.maxVoterCount,o=e.t,s=e.type,c=e.isCorrect;if(!t)return null;var u=t.text,d=t.voter_count,p=t.vote_percentage,h=t.is_chosen,m=t.isMultiChoosen,f=t.is_being_chosen,g=1.5;return d&&(g=d/i*100),l.a.createElement("div",{className:"poll-option",onClick:this.handleClick},l.a.createElement("div",{className:v()("poll-option-wrapper",n?"poll-option-unselected":"poll-option-selected")},l.a.createElement("div",{className:"poll-option-text-wrapper",title:this.getTitleString(d,o)},l.a.createElement(M,{value:p,chosen:h,closed:r}),l.a.createElement(U,{hidden:!n,chosen:h||m,beingChosen:f,onChange:a}),(h||c)&&l.a.createElement("div",{className:v()("poll-option-mark",{"poll-option-mark-correct":"correct"===s},{"poll-option-mark-incorrect":"incorrect"===s})},"incorrect"===s?l.a.createElement(y.a,{className:"poll-option-mark-icon"}):l.a.createElement(C.a,{className:"poll-option-mark-icon"})),l.a.createElement("div",{className:"poll-option-text"},u))),l.a.createElement(b.a,{classes:{root:"poll-option-progress-root",bar:v()("poll-option-progress-bar",{"poll-option-progress-bar-correct":"correct"===s},{"poll-option-progress-bar-incorrect":"incorrect"===s})},color:"primary",variant:"determinate",value:n?0:Math.max(1.5,g)}))}}]),a}(l.a.Component)),j=Object(u.d)()(I),_=a(356),x=a(400),T=a(129),L=a(2),P=(a(447),a(332)),N=a(323),D=a(324),R=a(7),B=a.n(R),A=a(13),F=a(644),V=a(353),z=(a(450),a(401),function(e){Object(o.a)(a,e);var t=Object(s.a)(a);function a(){return Object(r.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.index,a=e.showStatus,n="".concat(20+10*Math.sin(t),"%"),r="".concat(30+10*Math.cos(t),"%");return l.a.createElement("div",{className:"user-placeholder"},l.a.createElement("div",{className:"user-wrapper"},l.a.createElement("div",{className:"user-placeholder-tile"}),l.a.createElement("div",{className:"user-placeholder-inner-wrapper"},l.a.createElement("div",{className:"tile-first-row"},l.a.createElement("div",{className:"dialog-placeholder-title",style:{width:n}}),l.a.createElement("div",{className:"dialog-placeholder-title",style:{width:r,marginLeft:8}})),a&&l.a.createElement("div",{className:"tile-second-row"},l.a.createElement("div",{className:"dialog-placeholder-content",style:{width:r}})))))}}]),a}(l.a.Component));z.defaultProps={showStatus:!0};var H=z,W=a(128),G=(a(451),function(e){Object(o.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(r.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).onClick=function(){var t=e.props.userId;t&&(Object(W.k)(t,!0),setTimeout((function(){L.a.clientUpdate({"@type":"clientUpdateClosePollResults"})}),0))},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.index,a=e.userId,n=a?l.a.createElement(V.a,{userId:a,showStatus:!1}):l.a.createElement(H,{index:t,showStatus:!1});return l.a.createElement(F.a,{button:!0,className:"user-list-item",onClick:this.onClick},n)}}]),a}(l.a.Component)),Z=a(337),q=a(336),K=(a(77),a(452),function(e){Object(o.a)(a,e);var t=Object(s.a)(a);function a(e){var n;Object(r.a)(this,a),(n=t.call(this,e)).handleShowMore=function(){var e=n.props.option,t=n.state.count,a=t,r=Math.min(e.voter_count,t+w.V);n.setState({offset:a,count:r},(function(){n.updateVoters(a,r,!0)}))},n.handleCollapse=function(e){e.preventDefault(),e.stopPropagation();var t=n.props.option,a=t&&t.voter_count<=w.T?t.voter_count:w.T-w.U;n.setState({voters:n.state.voters.slice(0,a),offset:0,count:a})};var i=n.props.option,o=i&&i.voter_count<=w.T?i.voter_count:w.T-w.U;return n.state={voters:[],offset:0,count:o},n}return Object(i.a)(a,[{key:"updateVoters",value:function(){var e=Object(A.a)(B.a.mark((function e(t,a,r){var i,o,s,c,l,u,d,p,h,m=this;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.props,o=i.chatId,s=i.messageId,c=i.optionId,l=i.option,u=this.state.voters,!(a<=0)){e.next=4;break}return e.abrupt("return");case 4:return d=a-t,e.next=7,L.a.send({"@type":"getPollVoters",chat_id:o,message_id:s,option_id:c,offset:t,limit:d});case 7:if(p=e.sent,this.props.option===l){e.next=10;break}return e.abrupt("return");case 10:h=q.a.getStore(),Object(Z.F)(h,p.user_ids),this.setState({voters:[].concat(Object(n.a)(u),Object(n.a)(p.user_ids))},Object(A.a)(B.a.mark((function e(){var n;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p.user_ids.length<d&&r&&(n=t+p.user_ids.length,m.updateVoters(n,a,!1));case 1:case"end":return e.stop()}}),e)}))));case 13:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=this.state,t=e.offset,a=e.count;this.updateVoters(t,a,!0)}},{key:"render",value:function(){var e=this.props,t=e.option,a=e.isQuiz,n=e.t,r=this.state,i=r.voters,o=r.count,s=t.text,c=t.voter_count,u=t.vote_percentage;if(0===c)return null;for(var p=[],h=0;h<o;h++){var m=h<i.length?i[h]:null;p.push(l.a.createElement(G,{key:"".concat(h,"_userId=").concat(m),index:h,userId:m}))}var f="".concat(c,a?1!==c?" answers":" answer":1!==c?" votes":" vote"),g=null,v=c-o;if(v>0){var b="".concat(v,a?1!==v?" answers":" answer":1!==v?" votes":" vote");g=l.a.createElement(d.a,{classes:{root:"poll-option-results-button"},color:"primary",fullWidth:!0,onClick:this.handleShowMore},n("ShowVotesOT").replace("%1$d",b))}var C=o>w.T-w.U&&c>w.T;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"poll-option-results-caption"},l.a.createElement("div",{className:"poll-option-results-answer"},"".concat(s," \u2014 ").concat(u,"%")),C?l.a.createElement("a",{onClick:this.handleCollapse},n("PollCollapse")):l.a.createElement("div",{className:"poll-option-results-count"},f)),p,g)}}]),a}(l.a.Component)),J=Object(u.d)()(K),Y=a(402),Q=(a(453),function(e){Object(o.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(r.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).onClientUpdateClosePollResults=function(t){(0,e.props.onClose)()},e.handleClose=function(t){t.preventDefault(),t.stopPropagation(),(0,e.props.onClose)()},e.handleClick=function(e){e.preventDefault(),e.stopPropagation()},e.handleContextMenu=function(e){e.preventDefault(),e.stopPropagation()},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){Y.a.on("clientUpdateClosePollResults",this.onClientUpdateClosePollResults)}},{key:"componentWillUnmount",value:function(){Y.a.off("clientUpdateClosePollResults",this.onClientUpdateClosePollResults)}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.messageId,n=e.poll,r=e.t;if(n){var i=n.options,o=n.type,s=n.question,c=o&&"pollTypeQuiz"===o["@type"];return l.a.createElement(P.a,{classes:{root:"chat-info-dialog-root",container:"chat-info-dialog-container",paper:"chat-info-dialog-paper"},transitionDuration:0,open:!0,onClick:this.handleClick,onContextMenu:this.handleContextMenu,onClose:this.handleClose,"aria-labelledby":"poll-results-title"},l.a.createElement(N.a,{id:"poll-results-title"},r(c?"QuizAnswers":"PollResults")),l.a.createElement(D.a,{classes:{root:"poll-results-content"}},l.a.createElement("div",{className:"poll-results-question"},s),i.map((function(e,n){return l.a.createElement(J,{key:n,isQuiz:c,chatId:t,messageId:a,optionId:n,option:e})}))))}}}]),a}(l.a.Component)),X=Object(u.d)()(Q),$=function(e){Object(o.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).getTotalVoterCountString=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return e?1===e?"1 answer":e+" answers":t("NoVotes")},n.handleSubmit=function(e){e.preventDefault(),e.stopPropagation();var t=n.props,a=t.chatId,r=t.messageId,i=t.poll;if(i){var o=i.type;if(o&&!n.viewResults(i)&&o.allow_multiple_answers){var s=[];i.options.forEach((function(e,t){e.isMultiChoosen&&s.push(t)})),s.length&&Object(x.b)(a,r,s)}}},n.handleVote=function(e){var t=n.props,a=t.chatId,r=t.messageId,i=t.poll;if(i){var o=i.type;o&&("pollTypeRegular"===o["@type"]&&o.allow_multiple_answers?(i.options[e].isMultiChoosen=!i.options[e].isMultiChoosen,n.forceUpdate()):Object(x.b)(a,r,[e]))}},n.handleOpenResults=function(e){e.preventDefault(),e.stopPropagation();var t=n.props.poll;n.setState({viewResultsPoll:t})},n.handleCloseResults=function(){n.setState({viewResultsPoll:null})},n.fireworksRef=l.a.createRef(),n.state={},n}return Object(i.a)(a,[{key:"componentDidUpdate",value:function(e,t,a){var n=this.props,r=n.chatId,i=n.messageId,o=n.poll;if(o&&"pollTypeQuiz"===o.type["@type"]&&(-1===e.poll.type.correct_option_id&&-1!==o.type.correct_option_id)){var s=this.fireworksRef.current;if(!s)return;o.options[o.type.correct_option_id].is_chosen?s.start():L.a.clientUpdate({"@type":"clientUpdateMessageShake",chatId:r,messageId:i})}}},{key:"viewResults",value:function(e){if(!e)return!1;var t=e.options,a=e.is_closed;return!e.is_anonymous&&(a||t.some((function(e){return e.is_chosen})))}},{key:"getOptionType",value:function(e,t){var a=["regular","correct","incorrect"];if(!t)return a[0];var n=t.options[e];if(!n)return a[0];if(!n.is_chosen)return a[0];var r=t.type;if(!r)return a[0];if("pollTypeQuiz"!==r["@type"])return a[0];var i=r.correct_option_id;return-1===i?a[0]:i===e?a[1]:a[2]}},{key:"getOptionIsCorrect",value:function(e,t){if(!t)return!1;if(!t.options[e])return!1;var a=t.type;if(!a)return!1;if("pollTypeQuiz"!==a["@type"])return!1;var n=a.correct_option_id;return-1!==n&&n===e}},{key:"render",value:function(){var e=this,t=this.props,a=t.chatId,r=t.messageId,i=t.poll,o=t.t,s=t.meta,c=this.state.viewResultsPoll,u=i.question,p=i.options,h=i.total_voter_count,m=i.type,g=i.is_closed,v=i.is_anonymous,b=i.recent_voter_user_ids,C=o("FinalResults");if(!g)switch(m["@type"]){case"pollTypeRegular":C=o(v?"AnonymousPoll":"PublicPoll");break;case"pollTypeQuiz":C=o(v?"AnonymousQuizPoll":"QuizPoll")}if(!T.a.get(a,r))return null;var y=m&&"pollTypeQuiz"===m["@type"],k=!g&&p.every((function(e){return!e.is_chosen})),E=!g&&p.some((function(e){return e.is_chosen})),S=Math.max.apply(Math,Object(n.a)(p.map((function(e){return e.voter_count})))),O=this.viewResults(i),U=m.allow_multiple_answers&&!E||O,w=O||p.some((function(e){return e.isMultiChoosen})),M=[];return b&&(M=b.map((function(e){return l.a.createElement(_.a,{key:e,poll:!0,userId:e})}))),l.a.createElement("div",{className:"poll"},y&&l.a.createElement(f,{ref:this.fireworksRef}),l.a.createElement("div",{className:"poll-question"},l.a.createElement("div",{className:"poll-question-title"},u),l.a.createElement("div",{className:"poll-question-subtitle"},l.a.createElement("span",{style:{marginRight:6}},C),M)),l.a.createElement("div",{className:"poll-options"},p.map((function(t,a){return l.a.createElement(j,{key:a,type:e.getOptionType(a,i),isCorrect:e.getOptionIsCorrect(a,i),option:t,canBeSelected:k,closed:g,maxVoterCount:S,onVote:function(){return e.handleVote(a)}})}))),U?l.a.createElement(d.a,{fullWidth:!0,color:"primary",classes:{root:"poll-button",textPrimary:"message-control",disabled:"message-control-disabled"},TouchRippleProps:{classes:{child:"touch-ripple-current-color"}},disabled:!w,onClick:O?this.handleOpenResults:this.handleSubmit},o(O?"PollViewResults":"PollSubmitVotes")):l.a.createElement("div",{className:"poll-total-count"},this.getTotalVoterCountString(h,o),s),Boolean(c)&&l.a.createElement(X,{chatId:a,messageId:r,poll:c,onClose:this.handleCloseResults}))}}]),a}(l.a.Component);t.a=Object(u.d)()($)},function(e,t,a){"use strict";var n=a(8),r=a(9),i=a(11),o=a(10),s=a(0),c=a.n(s),l=a(127),u=a.n(l),d=a(361),p=a(37),h=Object(p.a)(c.a.createElement("g",{fillRule:"evenodd"},c.a.createElement("path",{d:"M6,0 L33.5147186,0 C35.1060176,6.45011102e-15 36.632141,0.632141042 37.7573593,1.75735931 L52.2426407,16.2426407 C53.367859,17.367859 54,18.8939824 54,20.4852814 L54,48 C54,51.3137085 51.3137085,54 48,54 L6,54 C2.6862915,54 4.05812251e-16,51.3137085 0,48 L0,6 C-4.05812251e-16,2.6862915 2.6862915,6.08718376e-16 6,0 Z"}),c.a.createElement("path",{d:"M33.5147186,0 C35.1060176,6.45011102e-15 36.632141,0.632141042 37.7573593,1.75735931 L52.2426407,16.2426407 C53.367859,17.367859 54,18.8939824 54,20.4852814 L54,22 C54,19.790861 52.209139,18 50,18 L40,18 C37.790861,18 36,16.209139 36,14 L36,4 C36,1.790861 34.209139,-3.88578059e-16 32,0 L33.5147186,0 Z",fill:"#000000",style:{mixBlendMode:"normal"},opacity:"0.15"})),"Document"),m=a(381),f=a(337),g=a(336),v=(a(463),function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var r;Object(n.a)(this,a),(r=t.call(this,e)).onUpdateFile=function(e){var t=r.state.file,a=e.file;t&&t.id===a.id&&r.setState({file:a,prevFile:t})};var i=r.props.file;return r.state={prevPropsFile:i,prevFile:null,file:g.a.get(i.id)||i},r}return Object(r.a)(a,[{key:"componentDidMount",value:function(){g.a.on("updateFile",this.onUpdateFile)}},{key:"componentWillUnmount",value:function(){g.a.off("updateFile",this.onUpdateFile)}},{key:"shouldComponentUpdate",value:function(e,t){var a=this.props.theme,n=this.state,r=n.file,i=n.prevFile;return e.theme!==a||(t.file!==r||t.prevFile!==i)}},{key:"render",value:function(){var e=this.props.meta,t=this.state.file;if(!t)return null;var a=t.local&&t.local.is_downloading_active,n=t.remote&&t.remote.is_uploading_active,r=Object(f.h)(t),i=null;a?i=Object(f.f)(t):n&&(i=Object(f.m)(t));var o=i?"".concat(i,"/").concat(r):"".concat(r);return c.a.createElement("div",{className:"document-action"},c.a.createElement("span",null,o),e)}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.file,n=t.prevPropsFile;return a&&n&&a.id!==n.id?{prevPropsFile:a,prevFile:null,file:g.a.get(a.id)||a}:null}}]),a}(c.a.Component)),b=(a(464),function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.document,a=e.openMedia,n=e.width,r=e.height,i=e.meta,o=e.title,s=e.caption;if(!t)return null;var l=t.minithumbnail,p=t.thumbnail,g=t.file_name,b=t.document,C=n&&r?{width:n,height:r}:null;return c.a.createElement("div",{className:u()("document",{"media-title":o}),style:C},c.a.createElement(m.a,{minithumbnail:l,thumbnail:p,file:b,openMedia:a,icon:c.a.createElement(d.a,null),completeIcon:function(e){return e?null:c.a.createElement("div",{className:"document-tile-complete-icon"},c.a.createElement(h,{className:"document-tile-icon-fill",viewBox:"0 0 54 54"}),c.a.createElement("div",{className:"document-tile-file-ext"},Object(f.g)(g)))}}),c.a.createElement("div",{className:"document-content"},c.a.createElement("div",{className:"document-title"},c.a.createElement("a",{className:"document-name",onClick:a,title:g,"data-name":g,"data-ext":"."+Object(f.g)(g)},g)),c.a.createElement(v,{file:b,meta:s?null:i})))}}]),a}(c.a.Component));t.a=b},,,,,,,,,,,,,,,,,,function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){e.exports=function(){return new Worker(a.p+"ebc9db11cd3500eeab4f.worker.js")}},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,function(e,t,a){},,,,function(e,t,a){},,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,,,,function(e,t,a){},function(e,t,a){},,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,function(e,t,a){},function(e,t,a){},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a.r(t);var n=a(7),r=a.n(n),i=a(13),o=a(8),s=a(9),c=a(11),l=a(10),u=a(0),d=a.n(u),p=a(127),h=a.n(p),m=a(59),f=a(151),g=a(360),v=a(16);var b=function(e){var t=function(t){Object(c.a)(n,t);var a=Object(l.a)(n);function n(){return Object(o.a)(this,n),a.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return d.a.createElement(g.SnackbarProvider,{maxSnack:v.q},d.a.createElement(e,this.props))}}]),n}(d.a.Component);return t.displayName="WithSnackbarNotifications(".concat(Object(m.b)(e),")"),t},C=a(27),y=a(31),k=a(320),E=a(286),S=a(332),O=a(326),U=a(323),w=a(340),M=a(37),I=Object(M.a)(d.a.createElement("path",{d:"M17,2 C19.209139,2 21,3.790861 21,6 L21,20.2543508 C21,21.3589203 20.1045695,22.2543871 19,22.2543871 C18.5225775,22.2543871 18.0609035,22.0835665 17.6984173,21.772864 L12,16.8885064 L6.30158275,21.772864 C5.46293106,22.4917083 4.2003311,22.3945852 3.4814868,21.5559335 C3.17078432,21.1934473 3,20.7317733 3,20.2543508 L3,6 C3,3.790861 4.790861,2 7,2 L17,2 Z M17,4 L7,4 C5.8954305,4 5,4.8954305 5,6 L5,20.2543508 L10.6984173,15.3699931 C11.4473967,14.7280108 12.5526033,14.7280108 13.3015827,15.3699931 L19,20.2543508 L19,6 C19,4.8954305 18.1045695,4 17,4 Z"}),"Saved"),j=a(396),_=a(344),x=a(338),T=a(77),L=(a(477),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).onUpdateUserStatus=function(e){var t=n.state.userId;if(e.user_id===t){var a=T.a.get(t);a&&n.setState({online:Object(_.j)(a)})}};var r=Object(x.u)(e.chatId),i=T.a.get(r);return n.state={userId:r,online:Object(_.j)(i)},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){T.a.on("updateUserStatus",this.onUpdateUserStatus)}},{key:"componentWillUnmount",value:function(){T.a.off("updateUserStatus",this.onUpdateUserStatus)}},{key:"render",value:function(){var e=this.props,t=e.size,a=e.borderSize;return this.state.online?d.a.createElement("div",{className:"online-status",style:{width:t,height:t}},d.a.createElement("div",{className:"online-status-icon",style:{padding:a}},d.a.createElement("div",{className:"online-status-indicator"}))):null}}]),a}(d.a.Component));L.defaultProps={size:14,borderSize:2};var P=L,N=a(337),D=a(38),R=a(336),B=(a(478),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onFastUpdatingComplete=function(e){n.forceUpdate()},n.onClientUpdateChatBlob=function(e){n.props.chatId===e.chatId&&(n.state.loaded?n.setState({loaded:!1}):n.forceUpdate())},n.onUpdateChatPhoto=function(e){var t=n.props.chatId,a=e.chat_id,r=e.photo;if(a===t&&(n.state.loaded?n.setState({loaded:!1}):n.forceUpdate(),r)){var i=R.a.getStore();Object(N.t)(i,t)}},n.onUpdateChatTitle=function(e){var t=n.props.chatId;e.chat_id===t&&n.forceUpdate()},n.handleSelect=function(e){var t=n.props,a=t.chatId,r=t.onSelect;r&&(e.stopPropagation(),r(a))},n.handleLoad=function(){n.setState({loaded:!0})},n.state={loaded:!1},n}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props.chatId,n=this.state.loaded;return e.chatId!==a||t.loaded!==n}},{key:"componentDidMount",value:function(){D.a.on("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),D.a.on("updateChatPhoto",this.onUpdateChatPhoto),D.a.on("updateChatTitle",this.onUpdateChatTitle),R.a.on("clientUpdateChatBlob",this.onClientUpdateChatBlob)}},{key:"componentWillUnmount",value:function(){D.a.off("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),D.a.off("updateChatPhoto",this.onUpdateChatPhoto),D.a.off("updateChatTitle",this.onUpdateChatTitle),R.a.off("clientUpdateChatBlob",this.onClientUpdateChatBlob)}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.showOnline,n=e.showSavedMessages,r=e.onSelect,i=e.small,o=e.dialog,s=e.big,c=e.size,l=e.t,u=this.state.loaded,p=null;if(c&&(p={width:c,height:c}),Object(x.R)(t))return d.a.createElement("div",{className:h()("chat-tile",{"tile-small":i},{"tile-dialog":o},{"tile-big":s}),style:p,onClick:this.handleSelect},d.a.createElement("div",{className:h()("tile-photo","tile_color_0",{pointer:r})},d.a.createElement("div",{className:"tile-saved-messages"},d.a.createElement(j.a,{fontSize:s?"large":"default"}))));if(Object(x.T)(t)&&n)return d.a.createElement("div",{className:h()("chat-tile",{"tile-small":i},{"tile-dialog":o},{"tile-big":s}),style:p,onClick:this.handleSelect},d.a.createElement("div",{className:h()("tile-photo","tile_color_4",{pointer:r})},d.a.createElement("div",{className:"tile-saved-messages"},d.a.createElement(I,{fontSize:s?"large":"default"}))));var m=D.a.get(t);if(!m)return null;var f=m.photo,g=Object(x.n)(m,l),v=Object(N.l)(f?f.small:null),b=v&&u,C="tile_color_".concat(Math.abs(t)%8+1);return d.a.createElement("div",{className:h()("chat-tile",{[C]:!b},{pointer:r},{"tile-dialog":o},{"tile-small":i},{"tile-big":s}),style:p,onClick:this.handleSelect},!b&&d.a.createElement("div",{className:"tile-photo"},d.a.createElement("span",{className:"tile-text"},g)),v&&d.a.createElement("img",{className:"tile-photo",src:v,onLoad:this.handleLoad,draggable:!1,alt:""}),a&&Object(x.U)(t)&&d.a.createElement(P,{chatId:t}))}}]),a}(u.Component));B.defaultProps={showSavedMessages:!0,showOnline:!1};var A=Object(y.d)()(B),F=(a(479),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.selected,n=e.onSelect,r=e.t,i=Object(x.p)(t,!0,r);return d.a.createElement("div",{className:h()("forward-target-chat",{"forward-target-chat-selected":a}),onClick:n},d.a.createElement("div",{className:"forward-target-chat-tile"},d.a.createElement("div",{className:"forward-target-chat-tile-wrapper"},d.a.createElement(A,{chatId:t})),a&&d.a.createElement("div",{className:"forward-target-chat-selection"}),d.a.createElement("div",{className:h()("forward-target-chat-mark",a?"forward-target-chat-mark-selected":"forward-target-chat-mark-unselected")}),d.a.createElement("div",{className:"forward-target-chat-mark-icon"})),d.a.createElement("div",{className:"forward-target-chat-title"},i))}}]),a}(d.a.Component)),V=Object(y.d)()(F);function z(e){return H.apply(this,arguments)}function H(){return(H=Object(i.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!navigator.clipboard){e.next=5;break}return e.next=4,navigator.clipboard.writeText(t);case 4:return e.abrupt("return",!0);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("[clipboard] unable to copy with clipboard.writeText",e.t0);case 10:return e.abrupt("return",W(t));case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function W(e){var t,a;try{if((t=document.createElement("textarea")).contentEditable=!0,t.readOnly=!0,t.value=e,t.style.all="unset",t.style.position="fixed",t.style.top=0,t.style.clip="rect(0, 0, 0, 0)",t.style.whiteSpace="pre",t.style.webkitUserSelect="text",t.style.MozUserSelect="text",t.style.msUserSelect="text",t.style.userSelect="text",document.body.appendChild(t),t.focus(),t.select(),!(a=document.execCommand("copy")))throw new Error;return!0}catch(n){console.error("[clipboard] unable to copy with document.execCommand",a)}finally{t&&document.body.removeChild(t)}return!1}var G=a(62),Z=null;function q(e){if(!e)return!1;var t=e.value;return!!t&&"ru"===t.value}function K(e){if(!e)return null;if(!e.length)return null;var t=G.a.get("language_pack_id"),a=G.a.get("suggested_language_pack_id");if(!(q(t)||q(a)))return null;Z=Z||new Map([["q","\u0439"],["w","\u0446"],["e","\u0443"],["r","\u043a"],["t","\u0435"],["y","\u043d"],["u","\u0433"],["i","\u0448"],["o","\u0449"],["p","\u0437"],["[","\u0445"],["]","\u044a"],["a","\u0444"],["s","\u044b"],["d","\u0432"],["f","\u0430"],["g","\u043f"],["h","\u0440"],["j","\u043e"],["k","\u043b"],["l","\u0434"],[";","\u0436"],["'","\u044d"],["\\","\u0451"],["z","\u044f"],["x","\u0447"],["c","\u0441"],["v","\u043c"],["b","\u0438"],["n","\u0442"],["m","\u044c"],[",","\u0431"],[".","\u044e"]]);for(var n="",r=0;r<e.length;r++){if(!Z.has(e[r]))return null;n+=Z.get(e[r])}return""===n?null:n}var J=null;function Y(e){if(!e)return null;if(!e.length)return null;J=J||new Map([["\u0439","q"],["\u0446","w"],["\u0443","e"],["\u043a","r"],["\u0435","t"],["\u043d","y"],["\u0433","u"],["\u0448","i"],["\u0449","o"],["\u0437","p"],["\u0445","["],["\u044a","]"],["\u0444","a"],["\u044b","s"],["\u0432","d"],["\u0430","f"],["\u043f","g"],["\u0440","h"],["\u043e","j"],["\u043b","k"],["\u0434","l"],["\u0436",";"],["\u044d","'"],["\u0451","\\"],["\u044f","z"],["\u0447","x"],["\u0441","c"],["\u043c","v"],["\u0438","b"],["\u0442","n"],["\u044c","m"],["\u0431",","],["\u044e","."]]);for(var t="",a=0;a<e.length;a++){if(!J.has(e[a]))return null;t+=J.get(e[a])}return""===t?null:t}var Q=a(128),X=a(129),$=a(2),ee=(a(480),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).loadContent=Object(i.a)(r.a.mark((function e(){var t,a,i,o,s,c,l,u;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.getPublicMessageLink(),t=[],a=$.a.send({"@type":"getChats",offset_order:"9223372036854775807",offset_chat_id:0,limit:100}),t.push(a),i=$.a.send({"@type":"createPrivateChat",user_id:T.a.getMyId(),force:!0}),t.push(i),e.next=8,Promise.all(t.map((function(e){return e.catch((function(e){return null}))})));case 8:o=e.sent,s=Object(C.a)(o,2),c=s[0],l=s[1],n.setState({chatIds:c.chat_ids,savedMessages:l}),u=R.a.getStore(),Object(N.u)(u,c.chat_ids);case 15:case"end":return e.stop()}}),e)}))),n.getPublicMessageLink=Object(i.a)(r.a.mark((function e(){var t,a,i,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props,a=t.chatId,i=t.messageIds,a){e.next=3;break}return e.abrupt("return");case 3:if(i){e.next=5;break}return e.abrupt("return");case 5:if(!(i.length>1)){e.next=7;break}return e.abrupt("return");case 7:if(Object(x.V)(a)){e.next=9;break}return e.abrupt("return");case 9:if(Object(x.v)(a)){e.next=11;break}return e.abrupt("return");case 11:return e.next=13,$.a.send({"@type":"getPublicMessageLink",chat_id:a,message_id:i[0],for_album:!1});case 13:o=e.sent,n.setState({publicMessageLink:o});case 15:case"end":return e.stop()}}),e)}))),n.handleClose=function(){Object(Q.e)(null)},n.handleCopyLink=function(){var e=n.props.t,t=n.state.publicMessageLink;t&&t.link&&(z(t.link),n.handleScheduledAction(e("LinkCopied")))},n.handleScheduledAction=function(e){var t=n.props,a=t.enqueueSnackbar,r=t.closeSnackbar,i=a(e,{autoHideDuration:v.x,preventDuplicate:!0,action:[d.a.createElement(E.a,{key:"close","aria-label":"Close",color:"inherit",className:"notification-close-button",onClick:function(){return r(i)}},d.a.createElement(w.a,null))]})},n.getForwardPhotoSize=function(e,t){if(1!==t.length)return null;var a=X.a.get(e,t[0]);if(!a)return null;var n=a.can_be_forwarded,r=a.content;if(!n&&"messageChatChangePhoto"===r["@type"]){var i=r.photo;if(!i)return null;var o=i.sizes;if(o&&o.length)return o[o.length-1]}return null},n.handleSend=function(){n.handleClose(),Object(Q.a)();var e=n.props,t=e.chatId,a=e.messageIds,r=e.inputMessageContent;if(t||a||r){var i=n.getInnerText(n.messageRef.current);n.targetChats.forEach((function(e){if(r)return i&&("caption"in r?r.caption={"@type":"formattedText",text:i,entities:null}:$.a.send({"@type":"sendMessage",chat_id:e,reply_to_message_id:0,disable_notifications:!1,from_background:!1,reply_markup:null,input_message_content:{"@type":"inputMessageText",text:{"@type":"formattedText",text:i,entities:null},disable_web_page_preview:!1,clear_draft:!1}})),void $.a.send({"@type":"sendMessage",chat_id:e,reply_to_message_id:0,disable_notifications:!1,from_background:!1,reply_markup:null,input_message_content:r});var o=n.getForwardPhotoSize(t,a);if(o){var s=o.width,c=o.height,l=o.photo;$.a.send({"@type":"sendMessage",chat_id:e,reply_to_message_id:0,disable_notifications:!1,from_background:!1,reply_markup:null,input_message_content:{"@type":"inputMessagePhoto",photo:{"@type":"inputFileId",id:l.id},thumbnail:null,added_sticker_file_ids:[],width:s,height:c,caption:{"@type":"formattedText",text:i,entities:null},ttl:0}})}else i&&$.a.send({"@type":"sendMessage",chat_id:e,reply_to_message_id:0,disable_notifications:!1,from_background:!1,reply_markup:null,input_message_content:{"@type":"inputMessageText",text:{"@type":"formattedText",text:i,entities:null},disable_web_page_preview:!1,clear_draft:!1}}),$.a.send({"@type":"forwardMessages",chat_id:e,from_chat_id:t,message_ids:a,disable_notifications:!1,from_background:!1,as_album:!1})}))}},n.handleChangeSelection=function(e){n.targetChats.has(e)?n.targetChats.delete(e):n.targetChats.set(e,e),n.forceUpdate()},n.getInnerText=function(e){var t=e.innerHTML;return"<br>"!==t&&"<div><br></div>"!==t||(e.innerHTML=null),e.innerText},n.handleSearchKeyDown=function(e){13===e.keyCode&&e.preventDefault()},n.handleSearchKeyUp=Object(i.a)(r.a.mark((function e(){var t,a,i,o,s,c,l,u,d,p,h;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state,a=t.chatIds,i=t.savedMessages,o=n.searchRef.current){e.next=4;break}return e.abrupt("return");case 4:if("<br>"!==(s=o.innerHTML)&&"<div><br></div>"!==s||(o.innerHTML=null),c=n.getInnerText(o).trim()){e.next=10;break}return n.setState({searchText:null,searchResults:[],globalSearchResults:[]}),e.abrupt("return");case 10:return l=Y(c),u=K(c),d=i?[i.id].concat(a.filter((function(e){return e!==i.id&&Object(x.e)(e)}))):a,p=d.filter((function(e){return n.hasSearchText(e,c)||l&&n.hasSearchText(e,l)||u&&n.hasSearchText(e,u)})),n.setState({searchText:c,searchResults:p}),e.next=17,$.a.send({"@type":"searchChatsOnServer",query:c,limit:100});case 17:if(h=e.sent,n.state.searchText===c){e.next=20;break}return e.abrupt("return");case 20:n.setState({globalSearchResults:h.chat_ids});case 21:case"end":return e.stop()}}),e)}))),n.handleSearchPaste=function(e){var t=e.clipboardData.getData("text/plain");t&&(e.preventDefault(),document.execCommand("insertText",!1,t))},n.handleMessageKeyUp=function(){var e=n.messageRef.current;if(e){var t=e.innerHTML;"<br>"!==t&&"<div><br></div>"!==t||(e.innerHTML=null)}},n.handleMessagePaste=function(e){var t=e.clipboardData.getData("text/plain");t&&(e.preventDefault(),document.execCommand("insertText",!1,t))},n.hasSearchText=function(e,t){var a=n.props.t,r=n.state.savedMessages;if(r&&e===r.id&&-1!==(Object(x.s)(e,!0,a)||"").toLocaleLowerCase().indexOf(t.toLowerCase()))return!0;return-1!==(Object(x.s)(e,!1,a)||"").toLocaleLowerCase().indexOf(t.toLowerCase())||-1!==(Object(x.v)(e)||"").toLocaleLowerCase().indexOf(t.toLowerCase())},n.setSearchFocus=function(){setTimeout((function(){n.searchRef.current&&n.searchRef.current.focus()}),100)},n.state={chatIds:[],savedMessages:null},n.searchRef=d.a.createRef(),n.messageRef=d.a.createRef(),n.targetChats=new Map,n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.loadContent(),this.setSearchFocus()}},{key:"render",value:function(){var e=this,t=this.props.t,a=this.state,n=a.chatIds,r=a.searchText,i=a.searchResults,o=a.globalSearchResults,s=a.savedMessages,c=a.publicMessageLink,l=(s?[s.id].concat(n.filter((function(e){return e!==s.id&&Object(x.e)(e)}))):n).map((function(t){return d.a.createElement(V,{key:t,chatId:t,selected:e.targetChats.has(t),onSelect:function(){return e.handleChangeSelection(t)}})})),u=new Map((i||[]).map((function(e){return[e,e]}))),p=(o||[]).filter((function(e){return e!==s.id&&Object(x.e)(e)&&!u.has(e)})),h=(i||[]).concat(p).map((function(t){return d.a.createElement(V,{key:t,chatId:t,selected:e.targetChats.has(t),onSelect:function(){return e.handleChangeSelection(t)}})}));return d.a.createElement(S.a,{open:!0,onClose:this.handleClose,"aria-labelledby":"forward-dialog-title","aria-describedby":"forward-dialog-description",className:"forward-dialog"},d.a.createElement(U.a,{id:"forward-dialog-title"},t("ShareSendTo")),d.a.createElement("div",{ref:this.searchRef,id:"forward-dialog-search",contentEditable:!0,suppressContentEditableWarning:!0,placeholder:t("Search"),onKeyDown:this.handleSearchKeyDown,onKeyUp:this.handleSearchKeyUp,onPaste:this.handleSearchPaste}),d.a.createElement("div",{className:"forward-dialog-content"},d.a.createElement("div",{className:"forward-dialog-list"},l),r&&d.a.createElement("div",{className:"forward-dialog-search-list"},h)),this.targetChats.size>0&&d.a.createElement("div",{ref:this.messageRef,id:"forward-dialog-message",contentEditable:!0,suppressContentEditableWarning:!0,placeholder:t("ShareComment"),onKeyUp:this.handleMessageKeyUp,onPaste:this.handleMessagePaste}),d.a.createElement(O.a,null,d.a.createElement(k.a,{onClick:this.handleClose,color:"primary"},t("Cancel")),this.targetChats.size>0&&d.a.createElement(k.a,{onClick:this.handleSend,color:"primary",autoFocus:!0},t("Send")),!this.targetChats.size&&c&&d.a.createElement(k.a,{onClick:this.handleCopyLink,color:"primary"},t("CopyLink"))))}}]),a}(d.a.Component)),te=Object(m.a)(Object(y.d)(),g.withSnackbar)(ee),ae=a(492),ne=a.n(ae),re=a(498),ie=a.n(re),oe=a(406),se=a.n(oe),ce=a(649),le=a(493),ue=a.n(le),de=a(495),pe=a.n(de),he=Object(M.a)(d.a.createElement("path",{d:"M12.1715729,2 C12.9672223,2 13.7302841,2.31607052 14.2928932,2.87867966 L21.1213203,9.70710678 C21.6839295,10.2697159 22,11.0327777 22,11.8284271 L22,19 C22,20.6568542 20.6568542,22 19,22 L5,22 C3.34314575,22 2,20.6568542 2,19 L2,5 C2,3.34314575 3.34314575,2 5,2 L12.1715729,2 Z M11,4 L5,4 C4.44771525,4 4,4.44771525 4,5 L4,19 C4,19.5522847 4.44771525,20 5,20 L19,20 C19.5522847,20 20,19.5522847 20,19 L20,13 L14,13 C12.4023191,13 11.0963391,11.75108 11.0050927,10.1762728 L11,10 L11,4 Z M19.586,11 L13,4.414 L13,10 C13,10.5128358 13.3860402,10.9355072 13.8833789,10.9932723 L14,11 L19.586,11 Z"}),"Document2"),me=a(496),fe=a.n(me),ge=a(291),ve=a(644),be=a(645),Ce=a(646),ye=a(497),ke=a.n(ye),Ee=Object(M.a)(d.a.createElement("path",{d:"M19,2 C20.6568542,2 22,3.34314575 22,5 L22,19 C22,20.6568542 20.6568542,22 19,22 L5,22 C3.34314575,22 2,20.6568542 2,19 L2,5 C2,3.34314575 3.34314575,2 5,2 L19,2 Z M8.95903938,14.4653367 L8.89694708,14.4202095 C8.68789701,14.291568 8.42133316,14.3352159 8.26303498,14.5116789 L8.2090719,14.5840012 L4.88033327,19.9929138 L4.93969424,19.9982115 L4.93969424,19.9982115 L12.446,20 L9.05890452,14.5810435 C9.0316623,14.5374559 8.99794603,14.4984621 8.95903938,14.4653367 L8.89694708,14.4202095 L8.95903938,14.4653367 Z M15.6580762,12.1926572 C15.4476303,12.0663122 15.1815603,12.1128758 15.0252035,12.2910614 L14.9720355,12.3639701 L12.551,16.396 L14.803,20 L19,20 C19.5410622,20 19.9817615,19.5702952 19.9994483,19.0335352 L15.8247114,12.3563345 C15.7828678,12.2893847 15.7257647,12.2332952 15.6580762,12.1926572 Z M19,4 L5,4 C4.44771525,4 4,4.44771525 4,5 L4,17.606 L6.50573804,13.5358344 C7.19919591,12.4089238 8.64230264,12.0252274 9.79631538,12.6320827 L9.94511393,12.7168756 C10.2187146,12.885239 10.4567799,13.1044297 10.6467737,13.3619985 L10.7549011,13.5210456 L11.361,14.492 L13.2573282,11.3345145 C13.9384069,10.2000794 15.3772263,9.80060652 16.5378139,10.3947912 L16.6875318,10.4779499 C16.9695672,10.6472749 17.2148477,10.8702509 17.409849,11.1335934 L17.5207081,11.2963367 L20,15.264 L20,5 C20,4.44771525 19.5522847,4 19,4 Z"}),"SharedMedia"),Se=a(112),Oe=a(494),Ue=a.n(Oe),we=a(353),Me=Object(M.a)(d.a.createElement("path",{d:"M23,12L20.56,9.22L20.9,5.54L17.29,4.72L15.4,1.54L12,3L8.6,1.54L6.71,4.72L3.1,5.53L3.44,9.21L1,12L3.44,14.78L3.1,18.47L6.71,19.29L8.6,22.47L12,21L15.4,22.46L17.29,19.28L20.9,18.46L20.56,14.78L23,12M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9L10,17Z"}),"Verified"),Ie=(a(481),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).onFastUpdatingComplete=function(t){e.forceUpdate()},e.onUpdateChatTitle=function(t){var a=e.props.chatId;t.chat_id===a&&e.forceUpdate()},e}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props,n=a.chatId,r=a.t;return e.chatId!==n||e.t!==r}},{key:"componentDidMount",value:function(){D.a.on("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),D.a.on("updateChatTitle",this.onUpdateChatTitle)}},{key:"componentWillUnmount",value:function(){D.a.off("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),D.a.off("updateChatTitle",this.onUpdateChatTitle)}},{key:"render",value:function(){var e=this.props,t=e.t,a=e.chatId,n=e.showSavedMessages,r=Object(x.P)(a),i=Object(x.s)(a,n,t);return d.a.createElement("div",{className:"dialog-title"},d.a.createElement("span",{className:"dialog-title-span"},i),r&&d.a.createElement(Me,{className:"dialog-title-icon"}))}}]),a}(d.a.Component));Ie.defaultProps={showSavedMessages:!0};var je=Object(y.d)()(Ie),_e=a(363),xe=a(130),Te=(a(482),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).onUpdateUserStatus=function(e){var t=n.props.chatId,a=D.a.get(t);if(a&&a.type){var r=!1;switch(a.type["@type"]){case"chatTypeBasicGroup":var i=_e.a.getFullInfo(a.type.basic_group_id);if(i&&i.members)i.members.find((function(t){return t.user_id===e.user_id}))&&(r=!0);break;case"chatTypePrivate":case"chatTypeSecret":a.type.user_id===e.user_id&&(r=!0)}r&&n.updateSubtitle(t)}},n.updateSubtitle=function(e){n.setState({subtitle:Object(x.r)(e),isAccent:Object(x.I)(e)})},n.onUpdateUserFullInfo=function(e){var t=n.props.chatId,a=D.a.get(t);if(a){var r=a.type;r&&(!r||"chatTypePrivate"!==r["@type"]&&"chatTypeSecret"!==r["@type"]||r.user_id!==e.user_id||n.updateSubtitle(t))}},n.onUpdateBasicGroupFullInfo=function(e){var t=n.props.chatId,a=D.a.get(t);if(a){var r=a.type;r&&r&&"chatTypeBasicGroup"===r["@type"]&&r.basic_group_id===e.basic_group_id&&n.updateSubtitle(t)}},n.onUpdateSupergroupFullInfo=function(e){var t=n.props.chatId,a=D.a.get(t);if(a){var r=a.type;r&&r&&"chatTypeSupergroup"===r["@type"]&&r.supergroup_id===e.supergroup_id&&n.updateSubtitle(t)}},n.onUpdateBasicGroup=function(e){var t=n.props.chatId,a=D.a.get(t);if(a){var r=a.type;r&&r&&"chatTypeBasicGroup"===r["@type"]&&r.basic_group_id===e.basic_group.id&&n.updateSubtitle(t)}},n.onUpdateSupergroup=function(e){var t=n.props.chatId,a=D.a.get(t);if(a){var r=a.type;r&&r&&"chatTypeSupergroup"===r["@type"]&&r.supergroup_id===e.supergroup.id&&n.updateSubtitle(t)}};var r=n.props.chatId;return n.state={prevChatId:r,subtitle:Object(x.r)(r),isAccent:Object(x.I)(r)},n}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props.chatId,n=this.state,r=n.subtitle,i=n.isAccent;return e.chatId!==a||(t.subtitle!==r||t.isAccent!==i)}},{key:"componentDidMount",value:function(){T.a.on("updateUserStatus",this.onUpdateUserStatus),_e.a.on("updateBasicGroup",this.onUpdateBasicGroup),xe.a.on("updateSupergroup",this.onUpdateSupergroup),T.a.on("updateUserFullInfo",this.onUpdateUserFullInfo),_e.a.on("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),xe.a.on("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo)}},{key:"componentWillUnmount",value:function(){T.a.off("updateUserStatus",this.onUpdateUserStatus),_e.a.off("updateBasicGroup",this.onUpdateBasicGroup),xe.a.off("updateSupergroup",this.onUpdateSupergroup),T.a.off("updateUserFullInfo",this.onUpdateUserFullInfo),_e.a.off("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),xe.a.off("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo)}},{key:"render",value:function(){var e=this.props.subtitle,t=this.state,a=t.subtitle,n=t.isAccent;return d.a.createElement("div",{className:h()("dialog-status",{"dialog-status-accent":n})},e?e+", ":null,a)}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.chatId!==t.prevChatId){var a=e.chatId;return{prevChatId:a,subtitle:Object(x.r)(a),isAccent:Object(x.I)(a)}}return null}}]),a}(d.a.Component)),Le=(a(483),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).handleClick=function(){var e=n.props,t=e.chatId,a=e.onSelect;a&&a(t)};var r=n.props.chatId;return n.state={chat:D.a.get(r)},n}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){return e.chatId!==this.props.chatId}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.subtitle,n=e.onTileSelect,r=e.showStatus,i=e.showSavedMessages,o=e.big,s=e.showTitle,c=Object(x.T)(t);return d.a.createElement("div",{className:h()("chat",{"chat-big":o}),onClick:this.handleClick},d.a.createElement("div",{className:"chat-wrapper"},d.a.createElement(A,{big:o,chatId:t,onSelect:n,showSavedMessages:i}),s&&d.a.createElement("div",{className:"chat-inner-wrapper"},d.a.createElement("div",{className:"tile-first-row"},d.a.createElement(je,{chatId:t,showSavedMessages:i})),r&&(!c||!i)&&d.a.createElement("div",{className:"tile-second-row"},d.a.createElement(Te,{chatId:t,subtitle:a})))))}}]),a}(d.a.Component));Le.defaultProps={showSavedMessages:!0,showStatus:!0,showTitle:!0};var Pe=Le,Ne=Object(M.a)(d.a.createElement("path",{d:"M4.29289322,11.2928932 L11.2928932,4.29289322 C11.6834175,3.90236893 12.3165825,3.90236893 12.7071068,4.29289322 C13.0675907,4.65337718 13.0953203,5.22060824 12.7902954,5.61289944 L12.7071068,5.70710678 L7.414,11 L19,11 C19.5128358,11 19.9355072,11.3860402 19.9932723,11.8833789 L20,12 C20,12.5128358 19.6139598,12.9355072 19.1166211,12.9932723 L19,13 L7.414,13 L12.7071068,18.2928932 C13.0675907,18.6533772 13.0953203,19.2206082 12.7902954,19.6128994 L12.7071068,19.7071068 C12.3466228,20.0675907 11.7793918,20.0953203 11.3871006,19.7902954 L11.2928932,19.7071068 L4.29289322,12.7071068 C3.93240926,12.3466228 3.90467972,11.7793918 4.20970461,11.3871006 L4.29289322,11.2928932 L11.2928932,4.29289322 L4.29289322,11.2928932 Z"}),"Back"),De=(a(484),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){return Object(o.a)(this,a),t.call(this,e)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.t,n=e.backButton,r=e.onClick,i=e.onClose,o=a("ChatInfo");return Object(x.U)(t)?o=a("Info"):Object(x.J)(t)&&(o=a("ChannelInfo")),d.a.createElement("div",{className:"header-master"},n&&d.a.createElement(E.a,{className:"header-left-button",onClick:i},d.a.createElement(Ne,null)),d.a.createElement("div",{className:"header-status grow cursor-pointer",onClick:r},d.a.createElement("span",{className:"header-status-content"},o)),!n&&d.a.createElement(E.a,{className:"header-right-button",onClick:i},d.a.createElement(w.a,null)))}}]),a}(d.a.Component)),Re=Object(y.d)()(De),Be=a(647),Ae=a(486),Fe=a.n(Ae),Ve=a(485),ze=a.n(Ve),He=a(648),We=a(22),Ge=a(44);function Ze(e,t){$.a.send({"@type":"setChatChatList",chat_id:e,chat_list:t})}function qe(e,t){$.a.send({"@type":"toggleChatIsPinned",chat_id:e,is_pinned:t})}function Ke(e,t){$.a.send({"@type":"toggleChatIsMarkedAsUnread",chat_id:e,is_marked_as_unread:t})}function Je(e,t){var a=D.a.get(e);if(a&&(a.notification_settings&&Object(x.M)(e)!==t)){var n=t?v.u:v.v,r=Object(Ge.a)(Object(Ge.a)({},a.notification_settings),{},{use_default_mute_for:!1,mute_for:n});$.a.send({"@type":"setChatNotificationSettings",chat_id:e,notification_settings:r})}}function Ye(e){return Qe.apply(this,arguments)}function Qe(){return(Qe=Object(i.a)(r.a.mark((function e(t){var a,n,i,o,s,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D.a.get(t)){e.next=3;break}return e.abrupt("return");case 3:return a=[],n=$.a.send({"@type":"getChatMessageCount",chat_id:t,filter:{"@type":"searchMessagesFilterPhoto"},return_local:!1}).then((function(e){return e?e.count:0})).catch((function(){return 0})),a.push(n),i=$.a.send({"@type":"getChatMessageCount",chat_id:t,filter:{"@type":"searchMessagesFilterVideo"},return_local:!1}).then((function(e){return e?e.count:0})).catch((function(){return 0})),a.push(i),o=$.a.send({"@type":"getChatMessageCount",chat_id:t,filter:{"@type":"searchMessagesFilterDocument"},return_local:!1}).then((function(e){return e?e.count:0})).catch((function(){return 0})),a.push(o),s=$.a.send({"@type":"getChatMessageCount",chat_id:t,filter:{"@type":"searchMessagesFilterAudio"},return_local:!1}).then((function(e){return e?e.count:0})).catch((function(){return 0})),a.push(s),c=$.a.send({"@type":"getChatMessageCount",chat_id:t,filter:{"@type":"searchMessagesFilterUrl"},return_local:!1}).then((function(e){return e?e.count:0})).catch((function(){return 0})),a.push(c),l=$.a.send({"@type":"getChatMessageCount",chat_id:t,filter:{"@type":"searchMessagesFilterVoiceNote"},return_local:!1}).then((function(e){return e?e.count:0})).catch((function(){return 0})),a.push(l),e.next=18,Promise.all(a);case 18:return e.abrupt("return",e.sent);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Xe=a(134),$e=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).onUpdateChatNotificationSettings=function(e){var t=e.chat_id,a=n.props.chatId;t&&t===a&&n.setState({isMuted:Object(x.M)(a)})},n.onUpdateScopeNotificationSettings=function(e){var t=n.props.chatId,a=D.a.get(t);switch(e.scope["@type"]){case"notificationSettingsScopeGroupChats":"chatTypeBasicGroup"!==a.type["@type"]&&"chatTypeSupergroup"!==a.type["@type"]||n.setState({isMuted:Object(x.M)(t)});break;case"notificationSettingsScopePrivateChats":"chatTypePrivate"!==a.type["@type"]&&"chatTypeSecret"!==a.type["@type"]||n.setState({isMuted:Object(x.M)(t)})}},n.handleSetChatNotifications=function(){n.setState({isMuted:!n.state.isMuted}),n.debouncedSetChatNotificationSettings()},n.setChatNotificationSettings=function(){Je(n.props.chatId,n.state.isMuted)};var r=e.chatId;return n.state={prevChatId:r,isMuted:Object(x.M)(r)},n.debouncedSetChatNotificationSettings=Object(We.d)(n.setChatNotificationSettings,v.y),n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){D.a.on("updateChatNotificationSettings",this.onUpdateChatNotificationSettings),Xe.a.on("updateScopeNotificationSettings",this.onUpdateScopeNotificationSettings)}},{key:"componentWillUnmount",value:function(){D.a.off("updateChatNotificationSettings",this.onUpdateChatNotificationSettings),Xe.a.off("updateScopeNotificationSettings",this.onUpdateScopeNotificationSettings)}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.chatId!==t.prevChatId){var a=e.chatId;return{prevChatId:a,isMuted:Object(x.M)(a)}}return null}}]),a}(d.a.Component),et=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.t,t=this.state.isMuted;return d.a.createElement(ve.a,{button:!0,className:"list-item",onClick:this.handleSetChatNotifications},d.a.createElement(be.a,null,t?d.a.createElement(Fe.a,null):d.a.createElement(ze.a,null)),d.a.createElement(Ce.a,{primary:d.a.createElement(Se.a,{variant:"inherit",noWrap:!0},e("Notifications"))}),d.a.createElement(Be.a,null,d.a.createElement(He.a,{color:"primary",onChange:this.handleSetChatNotifications,checked:!t})))}}]),a}($e),tt=Object(y.d)()(et),at=a(488),nt=a.n(at),rt=a(489),it=a.n(rt),ot=a(490),st=a.n(ot),ct=a(394),lt=a(14),ut=(a(487),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).handleMoreClick=function(){n.setState({openMore:!n.state.openMore})},n.handleSendMessage=function(){var e=lt.a.getChatId(),t=n.props.chatId;e===t||$.a.setChatId(t)},n.handleBlock=function(){var e=n.state.chatId,t=D.a.get(e);if(t&&t.type){var a=t.type.user_id;a&&$.a.send({"@type":Object(_.i)(a)?"unblockUser":"blockUser",user_id:a})}};var r=n.props.chatId;return n.state={prevChatId:r,openMore:!1},n}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.t,a=e.chatId,n=this.state.openMore,r=D.a.get(a);if(!r)return null;var i=Object(x.S)(a),o=!1;!i&&r.type&&(o=Object(_.i)(r.type.user_id));var s=Object(x.L)(a),c=Object(x.J)(a);return d.a.createElement(d.a.Fragment,null,d.a.createElement(ve.a,{button:!0,className:"list-item",onClick:this.handleMoreClick},d.a.createElement(be.a,null,d.a.createElement(nt.a,null)),d.a.createElement(Ce.a,{primary:d.a.createElement(Se.a,{variant:"inherit",noWrap:!0},t("More"))}),n?d.a.createElement(it.a,null):d.a.createElement(st.a,null)),d.a.createElement(ct.a,{in:n,timeout:"auto",unmountOnExit:!0},d.a.createElement(ge.a,{component:"div",disablePadding:!0},!i&&d.a.createElement(d.a.Fragment,null,d.a.createElement(ve.a,{button:!0,className:"list-item",onClick:this.handleSendMessage},d.a.createElement(Ce.a,{inset:!0,primary:d.a.createElement(Se.a,{variant:"inherit",noWrap:!0},t("SendMessage"))})),d.a.createElement(ve.a,{button:!0,className:"list-item",onClick:this.handleBlock},d.a.createElement(Ce.a,{inset:!0,primary:d.a.createElement(Se.a,{color:"secondary",variant:"inherit",noWrap:!0},t(o?"Unblock":"BlockContact"))}))),i&&s&&d.a.createElement(ve.a,{button:!0,className:"list-item"},d.a.createElement(Ce.a,{inset:!0,primary:d.a.createElement(Se.a,{color:"secondary",variant:"inherit",noWrap:!0},t(c?"LeaveChannel":"DeleteChat"))})),i&&!s&&d.a.createElement(ve.a,{button:!0,className:"list-item"},d.a.createElement(Ce.a,{inset:!0,primary:d.a.createElement(Se.a,{color:"secondary",variant:"inherit",noWrap:!0},t("ReportChat"))})))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.chatId!==t.prevChatId?{prevChatId:e.chatId,openMore:!1}:null}}]),a}(d.a.Component)),dt=(Object(y.d)()(ut),a(90)),pt=(a(491),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).onUpdateBasicGroupFullInfo=function(e){var t=D.a.get(n.props.chatId);t&&t.type&&"chatTypeBasicGroup"===t.type["@type"]&&t.type.basic_group_id===e.basic_group_id&&n.forceUpdate()},n.onUpdateSupergroupFullInfo=function(e){var t=D.a.get(n.props.chatId);t&&t.type&&"chatTypeSupergroup"===t.type["@type"]&&t.type.supergroup_id===e.supergroup_id&&n.forceUpdate()},n.onUpdateUserFullInfo=function(e){var t=D.a.get(n.props.chatId);t&&(!t.type||"chatTypePrivate"!==t.type["@type"]&&"chatTypeSecret"!==t.type["@type"]||t.type.user_id!==e.user_id||n.forceUpdate())},n.onUpdateUserStatus=function(e){n.members.has(e.user_id)&&n.forceUpdate()},n.loadContent=function(){n.loadChatContents()},n.loadChatContents=function(){var e=n.props,t=e.chatId,a=e.popup,r=R.a.getStore();Object(N.u)(r,[t]);var i=Object(x.w)(t).map((function(e){return e.user_id}));Object(N.F)(r,i),a&&Object(x.m)(t)},n.handleUsernameHint=function(){var e=n.props,t=e.t,a=e.chatId,r=Object(x.v)(a);if(r){var i=G.a.get("t_me_url");z((i?i.value:"https://telegram.org/")+r),n.handleScheduledAction(t("TextCopied"))}},n.handleScheduledAction=function(e){var t=n.props,a=t.enqueueSnackbar,r=t.closeSnackbar,i=a(e,{autoHideDuration:v.x,preventDuplicate:!0,action:[d.a.createElement(E.a,{key:"close","aria-label":"Close",color:"inherit",className:"notification-close-button",onClick:function(){r(i)}},d.a.createElement(w.a,null))]})},n.handlePhoneHint=function(){var e=n.props,t=e.t,a=e.chatId,r=Object(x.o)(a);r&&(z(Object(dt.a)(r)),n.handleScheduledAction(t("PhoneCopied")))},n.handleHeaderClick=function(){n.chatDetailsListRef.current.scrollTop=0},n.handleOpenViewer=function(){var e=n.props,t=e.chatId,a=e.popup,r=D.a.get(t);r&&r.photo&&(Object(Q.r)({chatId:t}),a&&$.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:0}))},n.handleOpenChat=function(){var e=n.props,t=e.chatId,a=e.popup;Object(Q.i)(t,null,!1),a&&$.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:0})},n.handleOpenUser=function(e){Object(Q.k)(e,!0)},n.getContentHeight=function(){return n.chatDetailsListRef?n.chatDetailsListRef.current.clientHeight:0},n.chatDetailsListRef=d.a.createRef();var r=n.props.chatId;return n.members=new Map,n.state={prevChatId:r},n}return Object(s.a)(a,[{key:"getSnapshotBeforeUpdate",value:function(e,t){this.props.chatId;var a=this.chatDetailsListRef.current;return{scrollTop:a.scrollTop,scrollHeight:a.scrollHeight,offsetHeight:a.offsetHeight}}},{key:"shouldComponentUpdate",value:function(e,t){var a=this.props,n=a.chatId,r=a.theme,i=a.counters,o=a.migratedCounters;return e.chatId!==n||(e.counters!==i||(e.migratedCounters!==o||e.theme!==r))}},{key:"componentDidUpdate",value:function(e,t,a){var n=this.props.chatId;e.chatId!==n&&this.loadContent();var r=this.chatDetailsListRef.current,i=a.scrollTop;a.scrollHeight,a.offsetHeight;e.chatId===n?r.scrollTop=i:r.scrollTop=0}},{key:"componentDidMount",value:function(){this.loadContent(),T.a.on("updateUserStatus",this.onUpdateUserStatus),T.a.on("updateUserFullInfo",this.onUpdateUserFullInfo),_e.a.on("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),xe.a.on("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo)}},{key:"componentWillUnmount",value:function(){T.a.off("updateUserStatus",this.onUpdateUserStatus),T.a.off("updateUserFullInfo",this.onUpdateUserFullInfo),_e.a.off("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),xe.a.off("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo)}},{key:"render",value:function(){var e=this,t=this.props,a=t.backButton,n=t.className,r=t.chatId,i=t.onClose,o=t.onOpenGroupInCommon,s=t.onOpenSharedAudios,c=t.onOpenSharedDocuments,l=t.onOpenSharedLinks,u=(t.onOpenSharedMedia,t.onOpenSharedPhotos),p=t.onOpenSharedVideos,m=t.onOpenSharedVoiceNotes,f=t.popup,g=t.t,v=this.props,b=v.counters,y=v.migratedCounters;y=y||[0,0,0,0,0,0];var k=(b=b||[0,0,0,0,0,0]).map((function(e,t){return e+y[t]})),E=Object(C.a)(k,6),S=E[0],O=E[1],U=E[2],w=E[3],M=E[4],I=E[5],j=D.a.get(r);if(!j)return d.a.createElement("div",{className:"chat-details"},d.a.createElement(Re,{onClose:i}),d.a.createElement("div",{ref:this.chatDetailsListRef,className:"chat-details-list"}));var L=0;if(Object(x.U)(r)){var P=T.a.getFullInfo(j.type.user_id);L=P?P.group_in_common_count:L}var N=Object(x.v)(r),R=Object(x.o)(r),B=Object(x.j)(r),A=Object(x.S)(r),F=Object(x.T)(r),V=Object(x.w)(r),z=[];this.members=new Map,V.forEach((function(t){var a=T.a.get(t.user_id);a&&(e.members.set(a.id,a.id),z.push(a))}));var H=z.sort((function(e,t){return Object(_.g)(t)-Object(_.g)(e)})).map((function(t){return d.a.createElement(ve.a,{button:!0,className:"list-item",key:t.id},d.a.createElement(we.a,{userId:t.id,onSelect:e.handleOpenUser}))})),W=j.photo,G=d.a.createElement(d.a.Fragment,null,d.a.createElement(Re,{chatId:r,backButton:a,onClose:i,onClick:this.handleHeaderClick}),d.a.createElement("div",{ref:this.chatDetailsListRef,className:"chat-details-list"},d.a.createElement("div",{className:"chat-details-info"},d.a.createElement(Pe,{chatId:r,big:!0,showStatus:!0,showSavedMessages:!f,onTileSelect:W?this.handleOpenViewer:null})),(N||R||B)&&d.a.createElement(d.a.Fragment,null,d.a.createElement(ge.a,null,N&&d.a.createElement(ve.a,{button:!0,className:"list-item",onClick:this.handleUsernameHint},d.a.createElement(be.a,null,d.a.createElement(ne.a,null)),d.a.createElement(Ce.a,{primary:d.a.createElement(Se.a,{variant:"inherit",noWrap:!0},N)})),R&&d.a.createElement(d.a.Fragment,null,d.a.createElement(ve.a,{button:!0,className:"list-item",onClick:this.handlePhoneHint},d.a.createElement(be.a,null,d.a.createElement(se.a,null)),d.a.createElement(Ce.a,{primary:d.a.createElement(Se.a,{variant:"inherit",noWrap:!0},Object(dt.a)(R))}))),B&&d.a.createElement(ve.a,{className:"list-item"},d.a.createElement(be.a,null,d.a.createElement(ue.a,{className:"chat-details-info-icon"})),d.a.createElement(Ce.a,{primary:B,style:{whiteSpace:"pre-wrap",wordWrap:"break-word"}})))),(!F||A||f&&!A)&&d.a.createElement(d.a.Fragment,null,d.a.createElement(ce.a,null),d.a.createElement(ge.a,null,!F&&d.a.createElement(tt,{chatId:r}),f&&!A&&d.a.createElement(ve.a,{button:!0,className:"list-item",onClick:this.handleOpenChat},d.a.createElement(Ce.a,{inset:!0,primary:d.a.createElement(Se.a,{color:"primary",variant:"inherit",noWrap:!0},g("SendMessage").toUpperCase())})))),(S>0||O>0||U>0||w>0||M>0||I>0||L>0)&&d.a.createElement(d.a.Fragment,null,d.a.createElement(ce.a,null),d.a.createElement(ge.a,null,S>0&&d.a.createElement(ve.a,{button:!0,className:"list-item",onClick:u},d.a.createElement(be.a,null,d.a.createElement(Ee,null)),d.a.createElement(Ce.a,{primary:d.a.createElement(Se.a,{variant:"inherit",noWrap:!0},1===S?"1 photo":"".concat(S," photos"))})),O>0&&d.a.createElement(ve.a,{button:!0,className:"list-item",onClick:p},d.a.createElement(be.a,null,d.a.createElement(Ue.a,null)),d.a.createElement(Ce.a,{primary:d.a.createElement(Se.a,{variant:"inherit",noWrap:!0},1===O?"1 video":"".concat(O," videos"))})),U>0&&d.a.createElement(ve.a,{button:!0,className:"list-item",onClick:c},d.a.createElement(be.a,null,d.a.createElement(he,null)),d.a.createElement(Ce.a,{primary:d.a.createElement(Se.a,{variant:"inherit",noWrap:!0},1===U?"1 file":"".concat(U," files"))})),w>0&&d.a.createElement(ve.a,{button:!0,className:"list-item",onClick:s},d.a.createElement(be.a,null,d.a.createElement(pe.a,null)),d.a.createElement(Ce.a,{primary:d.a.createElement(Se.a,{variant:"inherit",noWrap:!0},1===w?"1 audio file":"".concat(w," audio files"))})),M>0&&d.a.createElement(ve.a,{button:!0,className:"list-item",onClick:l},d.a.createElement(be.a,null,d.a.createElement(fe.a,null)),d.a.createElement(Ce.a,{primary:d.a.createElement(Se.a,{variant:"inherit",noWrap:!0},1===M?"1 shared link":"".concat(M," shared links"))})),I>0&&d.a.createElement(ve.a,{button:!0,className:"list-item",onClick:m},d.a.createElement(be.a,null,d.a.createElement(ke.a,null)),d.a.createElement(Ce.a,{primary:d.a.createElement(Se.a,{variant:"inherit",noWrap:!0},1===I?"1 voice message":"".concat(I," voice messages"))})),L>0&&d.a.createElement(ve.a,{button:!0,className:"list-item",onClick:o},d.a.createElement(be.a,null,d.a.createElement(ie.a,null)),d.a.createElement(Ce.a,{primary:d.a.createElement(Se.a,{variant:"inherit",noWrap:!0},1===L?"1 group in common":"".concat(L," groups in common"))})))),H.length>0&&d.a.createElement(d.a.Fragment,null,d.a.createElement(ce.a,null),d.a.createElement(ge.a,null,H))));return f?d.a.createElement(d.a.Fragment,null,G):d.a.createElement("div",{className:h()("chat-details",n)},G)}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.chatId!==t.prevChatId?{prevChatId:e.chatId}:null}}]),a}(d.a.Component)),ht=Object(m.a)(Object(m.d)(),Object(y.d)(),g.withSnackbar,Object(m.c)())(pt),mt=(a(499),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.onClose;return d.a.createElement("div",{className:"header-master"},d.a.createElement(E.a,{className:"header-left-button",onClick:e},d.a.createElement(Ne,null)),d.a.createElement("div",{className:"header-status grow cursor-pointer"},d.a.createElement("span",{className:"header-status-content"},"Groups in common")))}}]),a}(d.a.Component)),ft=(a(500),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleSelect=function(e){var t=n.props.popup;Object(Q.i)(e),t&&$.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:0})},n.state={chatIds:[]},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.chatId,a=Object(x.u)(t);a&&$.a.send({"@type":"getGroupsInCommon",user_id:a,offset_chat_id:0,limit:100}).then((function(t){var a=R.a.getStore();Object(N.u)(a,t.chat_ids),e.setState({chatIds:t.chat_ids})}))}},{key:"render",value:function(){var e=this,t=this.props,a=t.minHeight,n=t.onClose,r=t.popup,i=this.state.chatIds.map((function(t){return d.a.createElement(ve.a,{button:!0,key:t},d.a.createElement(Pe,{chatId:t,onSelect:e.handleSelect}))})),o=d.a.createElement(d.a.Fragment,null,d.a.createElement(mt,{onClose:n}),d.a.createElement("div",{className:"groups-in-common-list",style:{minHeight:a}},i));return r?d.a.createElement(d.a.Fragment,null,o):d.a.createElement("div",{className:"groups-in-common"},o)}}]),a}(d.a.Component));ft.defaultProps={popup:!1,minHeight:0};var gt=ft,vt=a(3),bt=a.n(vt),Ct=a(60),yt=a(25),kt=a(290),Et=a(650),St=a(288),Ot=(a(501),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleOpenMessage=function(t){var a=e.props,n=a.chatId,r=a.messageId;(0,a.onClose)(t),Object(Q.i)(n,r)},e.handleForward=function(t){var a=e.props,n=a.chatId,r=a.messageId;(0,a.onClose)(t),Object(Q.f)(n,[r])},e.handleDelete=function(t){var a=e.props,n=a.chatId,r=a.messageId;(0,a.onClose)(t),Object(Q.c)(n,[r])},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.t,a=e.chatId,n=e.messageId,r=e.open,i=e.onClose,o=e.anchorPosition,s=e.showOpenMessage,c=X.a.get(a,n);if(!c)return null;var l=c.can_be_forwarded,u=c.can_be_deleted_only_for_self,p=c.can_be_deleted_for_all_users;return d.a.createElement(St.a,{open:r,onClose:i,anchorReference:"anchorPosition",anchorPosition:o,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},onMouseDown:function(e){return e.stopPropagation()},onClick:function(e){return e.stopPropagation()}},d.a.createElement(kt.a,null,s&&d.a.createElement(Et.a,{onClick:this.handleOpenMessage},t("GoToMessage")),l&&d.a.createElement(Et.a,{onClick:this.handleForward},t("Forward")),(u||p)&&d.a.createElement(Et.a,{onClick:this.handleDelete},t("Delete"))))}}]),a}(d.a.Component)),Ut=Object(y.d)()(Ot),wt=a(339),Mt=a(343),It=(a(502),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).state={contextMenu:!1,left:0,top:0},e.handleOpenContextMenu=function(){var t=Object(i.a)(r.a.mark((function t(a){var n,i;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a&&(a.preventDefault(),a.stopPropagation()),e.state.contextMenu?e.setState({contextMenu:!1}):(n=a.clientX,i=a.clientY,e.setState({contextMenu:!0,left:n,top:i}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleCloseContextMenu=function(t){t&&t.stopPropagation(),e.setState({contextMenu:!1})},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.messageId,n=e.showOpenMessage,r=this.state,i=r.contextMenu,o=r.left,s=r.top,c=X.a.get(t,a);return c?d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"shared-document",onContextMenu:this.handleOpenContextMenu},Object(Mt.f)(c,(function(){return Object(wt.O)(t,a,!0)}))),d.a.createElement(Ut,{chatId:t,messageId:a,anchorPosition:{top:s,left:o},open:i,showOpenMessage:n,onClose:this.handleCloseContextMenu})):null}}]),a}(d.a.Component)),jt=Object(M.a)(d.a.createElement("path",{d:"M9.5,3 C13.0898509,3 16,5.91014913 16,9.5 C16,10.9337106 15.5358211,12.2590065 14.7495478,13.3338028 L19.7071068,18.2928932 C20.0976311,18.6834175 20.0976311,19.3165825 19.7071068,19.7071068 C19.3466228,20.0675907 18.7793918,20.0953203 18.3871006,19.7902954 L18.2928932,19.7071068 L13.3338028,14.7495478 C12.2590065,15.5358211 10.9337106,16 9.5,16 C5.91014913,16 3,13.0898509 3,9.5 C3,5.91014913 5.91014913,3 9.5,3 Z M9.5,5 C7.01471863,5 5,7.01471863 5,9.5 C5,11.9852814 7.01471863,14 9.5,14 C11.9852814,14 14,11.9852814 14,9.5 C14,7.01471863 11.9852814,5 9.5,5 Z"}),"Search"),_t=a(663),xt=(a(503),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleSearch=function(){if(n.searchInputRef.current&&n.searchInputRef.current.innerText){n.searchInputRef.current.innerText="";var e=n.props.onSearch;if(!e)return;return void e("")}var t=n.props.onCloseSearch,a=n.state.openSearch;n.setState({openSearch:!a}),t&&t()},n.handleKeyDown=function(e){13===e.keyCode&&e.preventDefault()},n.handleKeyUp=function(){var e=n.searchInputRef.current;if(e){var t=e.innerHTML;"<br>"!==t&&"<div><br></div>"!==t||(e.innerHTML=null);var a=e.innerText,r=n.props.onSearch;r&&r(a)}},n.handlePaste=function(e){var t=e.clipboardData.getData("text/plain");t&&(e.preventDefault(),document.execCommand("insertText",!1,t))},n.searchInputRef=d.a.createRef(),n.state={openSearch:!1},n}return Object(s.a)(a,[{key:"componentDidUpdate",value:function(e,t,a){var n=this,r=this.state.openSearch;r&&r!==e.openSearch&&setTimeout((function(){n.searchInputRef.current&&n.searchInputRef.current.focus()}),v.a)}},{key:"render",value:function(){var e=this.props,t=e.t,a=e.title,n=e.onClick,r=e.onClose,i=e.onSearch,o=this.state.openSearch;return d.a.createElement("div",{className:"header-master"},o?d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"header-search-input grow"},d.a.createElement("div",{id:"header-search-inputbox",ref:this.searchInputRef,placeholder:t("Search"),contentEditable:!0,suppressContentEditableWarning:!0,onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,onPaste:this.handlePaste}))):d.a.createElement(d.a.Fragment,null,d.a.createElement(E.a,{className:"header-left-button",onClick:r},d.a.createElement(Ne,null)),d.a.createElement("div",{className:"header-status grow cursor-pointer",onClick:n},d.a.createElement("span",{className:"header-status-content"},a))),Boolean(i)&&d.a.createElement(E.a,{className:"header-right-button",onMouseDown:this.handleSearch},d.a.createElement(_t.a,{open:o,icon:d.a.createElement(jt,null),openIcon:d.a.createElement(w.a,null)})))}}]),a}(d.a.Component)),Tt=Object(y.d)()(xt),Lt=(a(504),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;if(Object(o.a)(this,a),(this instanceof a?this.constructor:void 0)===a)throw new TypeError("Cannot construct SharedMediaBase instances directly");return(n=t.call(this,e)).onUpdateMessageContent=function(e){var t=n.props,a=t.chatId,r=t.migratedChatId,i=n.state,o=i.items,s=i.migratedItems,c=e.chat_id,l=e.message_id,u=(e.old_content,e.new_content),d=X.a.get(c,l);if(c===a){if(!o.length)return;if(!Object(We.b)(l,o[0].id,o[o.length-1].id,!0))return;var p=o.findIndex((function(e){return e.id===l}));n.isValidContent(u)?-1===p?n.setState({items:Object(We.p)(o,d,wt.N)}):n.setState({items:[].concat(Object(Ct.a)(o.slice(0,p)),[d],Object(Ct.a)(o.slice(p+1)))}):-1===p||n.setState({items:o.filter((function(e){return e.id!==l}))})}else if(c===r){if(!s.length)return;if(!Object(We.b)(l,s[0].id,s[s.length-1].id,!0))return;var h=s.findIndex((function(e){return e.id===l}));n.isValidContent(u)?-1===h?n.setState({migratedItems:Object(We.p)(s,d,wt.N)}):n.setState({migratedItems:[].concat(Object(Ct.a)(s.slice(0,h)),[d],Object(Ct.a)(s.slice(h+1)))}):-1===h||n.setState({migratedItems:s.filter((function(e){return e.id!==l}))})}},n.onUpdateNewMessage=function(e){var t=n.props,a=t.chatId,r=t.migratedChatId,i=n.state,o=i.items,s=i.migratedItems,c=e.message,l=c.chat_id;if(l===a&&n.isValidMessage(c)){var u=R.a.getStore();Object(N.y)(u,[c]),l===a?n.setState({items:[c].concat(o)}):l===r&&n.setState({migratedItems:[c].concat(s)})}},n.onUpdateDeleteMessages=function(e){var t=n.props,a=t.chatId,r=t.migratedChatId,i=n.state,o=i.items,s=i.migratedItems,c=e.chat_id,l=e.message_ids,u=new Map(l.map((function(e){return[e,e]}))),d=function(){n.state.items.length+n.state.migratedItems.length<v.ib&&n.onLoadNext(n.params)};c===a?n.setState({items:o.filter((function(e){return!u.has(e.id)}))},d):c===r&&n.setState({migratedItems:s.filter((function(e){return!u.has(e.id)}))},d)},n.loadContent=function(){n.params={loading:!1,completed:!1,migrateCompleted:!1,items:[],migratedItems:[],filter:n.getSearchFilter()},n.onLoadNext(n.params)},n.onLoadNext=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,i,o,s,c,l,u,d,p,h,m=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!(m.length>1&&void 0!==m[1])||m[1],i=n.props.chatId,o=t.completed,s=t.filter,c=t.items,!t.loading){e.next=5;break}return e.abrupt("return");case 5:if(!o){e.next=7;break}return e.abrupt("return");case 7:return l=c.length>0?c[c.length-1].id:0,t.loading=!0,e.next=11,$.a.send({"@type":"searchChatMessages",chat_id:i,query:"",sender_user_id:0,from_message_id:l,offset:0,limit:v.ib,filter:s}).finally((function(){t.loading=!1}));case 11:u=e.sent,$.a.send({"@type":"searchChatMessages",chat_id:i,query:"",sender_user_id:0,from_message_id:l,offset:0,limit:2*v.ib,filter:s}),d=u.messages,t.completed=0===d.length||0===d.total_count,t.items=c.concat(d.filter(n.isValidMessage)),p=a&&d.length>0&&d.length<v.ib,X.a.setItems(u.messages),h=R.a.getStore(),Object(N.y)(h,u.messages),n.setState({items:t.items}),t.completed?n.onLoadMigratedNext(t,!0):p&&n.onLoadNext(t,!1);case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onLoadMigratedNext=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,i,o,s,c,l,u,d,p,h,m,f=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!(f.length>1&&void 0!==f[1])||f[1],i=n.props.migratedChatId,o=t.filter,s=t.loading,c=t.migrateCompleted,l=t.migratedItems,i){e.next=5;break}return e.abrupt("return");case 5:if(!s){e.next=7;break}return e.abrupt("return");case 7:if(!c){e.next=9;break}return e.abrupt("return");case 9:return u=l.length>0?l[l.length-1].id:0,t.loading=!0,e.next=13,$.a.send({"@type":"searchChatMessages",chat_id:i,query:"",sender_user_id:0,from_message_id:u,offset:0,limit:v.ib,filter:o}).finally((function(){t.loading=!1}));case 13:if(d=e.sent,p=d.messages,t.migratedItems=l.concat(p.filter(n.isValidMessage)),t.migrateCompleted=0===p.length||0===p.total_count,h=a&&p.length>0&&p.length<v.ib,!t.migrateCompleted){e.next=20;break}return e.abrupt("return");case 20:X.a.setItems(p),m=R.a.getStore(),Object(N.y)(m,p),n.setState({migratedItems:t.migratedItems}),h&&n.onLoadMigratedNext(t,!1);case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleScroll=function(){if(n.listRef){var e=n.listRef.current;if(e){var t=Object(yt.a)(n).params;e.scrollTop+e.offsetHeight>=e.scrollHeight-v.gb&&(t&&!t.completed?n.onLoadNext(t):n.onLoadMigratedNext(t))}}},n.handleHeaderClick=function(){var e=n.listRef.current;e&&(e.scrollTop=0)},n.handleSearchScroll=function(){if(n.searchListRef){var e=n.searchListRef.current;if(e){var t=Object(yt.a)(n).searchParams;t&&e.scrollTop+e.offsetHeight>=e.scrollHeight-v.gb&&(t.completed?n.onSearchMigratedNext(t):n.onSearchNext(t))}}},n.onSearchNext=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,i,o,s,c,l,u,d,p,h,m,f,g=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!(g.length>1&&void 0!==g[1])||g[1],i=n.props.chatId,o=t.completed,s=t.filter,c=t.items,l=t.loading,u=t.query,!o){e.next=5;break}return e.abrupt("return");case 5:if(!l){e.next=7;break}return e.abrupt("return");case 7:return d=c.length>0?c[c.length-1].id:0,t.loading=!0,e.next=11,$.a.send({"@type":"searchChatMessages",chat_id:i,query:u,sender_user_id:0,from_message_id:d,offset:0,limit:v.ib,filter:s}).finally((function(){t.loading=!1}));case 11:if(p=e.sent,h=p.messages,t.items=c.concat(h.filter(n.isValidMessage)),t.completed=0===h.length||0===h.total_count,m=a&&h.length>0&&h.length<v.ib,n.searchParams===t){e.next=18;break}return e.abrupt("return");case 18:X.a.setItems(h),f=R.a.getStore(),Object(N.y)(f,h),n.setState({searchItems:t.items,searchMigratedItems:t.migratedItems}),t.completed?n.onSearchMigratedNext(t,!0):m&&n.onSearchNext(t,!1);case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onSearchMigratedNext=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,i,o,s,c,l,u,d,p,h,m,f,g=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!(g.length>1&&void 0!==g[1])||g[1],i=n.props.migratedChatId,o=t.filter,s=t.loading,c=t.migratedItems,l=t.migrateCompleted,u=t.query,i){e.next=5;break}return e.abrupt("return");case 5:if(!s){e.next=7;break}return e.abrupt("return");case 7:if(!l){e.next=9;break}return e.abrupt("return");case 9:return d=c.length>0?c[c.length-1].id:0,t.loading=!0,e.next=13,$.a.send({"@type":"searchChatMessages",chat_id:i,query:u,sender_user_id:0,from_message_id:d,offset:0,limit:v.ib,filter:o}).finally((function(){t.loading=!1}));case 13:if(p=e.sent,h=p.messages,t.migratedItems=c.concat(h.filter(n.isValidMessage)),t.migrateCompleted=0===h.length||0===h.total_count,m=a&&h.length>0&&h.length<v.ib,n.searchParams===t){e.next=20;break}return e.abrupt("return");case 20:X.a.setItems(h),f=R.a.getStore(),Object(N.y)(f,h),n.setState({searchItems:t.items,searchMigratedItems:t.migratedItems}),m&&n.onSearchMigratedNext(t,!1);case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleSearch=function(){var e=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t?t.trim():""){e.next=4;break}return n.handleCloseSearch(),e.abrupt("return");case 4:n.searchParams={query:a,completed:!1,migrateCompleted:!1,items:[],migratedItems:[],filter:n.getSearchFilter()},n.onSearchNext(n.searchParams,!0);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleCloseSearch=function(){n.searchParams=null,n.setState({searchItems:[],searchMigratedItems:[]})},n.isValidMessage=function(e){return!!e&&n.isValidContent(e.content)},n.listRef=d.a.createRef(),n.searchListRef=d.a.createRef(),n.state={items:[],migratedItems:[],searchItems:[],searchMigratedItems:[]},n}return Object(s.a)(a,[{key:"getListClassName",value:function(){return null}},{key:"getSearchListClassName",value:function(){return null}}]),Object(s.a)(a,[{key:"hasSearch",value:function(){return!0}},{key:"isValidContent",value:function(e){throw new Error("Virtual method isValidContent is not implemented")}},{key:"getItemTemplate",value:function(e){var t=this.props.migratedChatId,a=e.chat_id,n=e.id;return d.a.createElement(It,{key:"chat_id=".concat(a,"_message_id=").concat(n),chatId:a,messageId:n,showOpenMessage:a!==t})}},{key:"getSearchFilter",value:function(){throw new Error("Virtual method getSearchFilter is not implemented")}},{key:"getHeader",value:function(){throw new Error("Virtual method getHeader is not implemented")}},{key:"componentDidMount",value:function(){this.loadContent(),X.a.on("updateDeleteMessages",this.onUpdateDeleteMessages),X.a.on("updateMessageContent",this.onUpdateMessageContent),X.a.on("updateNewMessage",this.onUpdateNewMessage)}},{key:"componentWillUnmount",value:function(){X.a.off("updateDeleteMessages",this.onUpdateDeleteMessages),X.a.off("updateMessageContent",this.onUpdateMessageContent),X.a.off("updateNewMessage",this.onUpdateNewMessage)}},{key:"render",value:function(){var e=this,t=this.props,a=t.minHeight,n=t.onClose,r=t.popup,i=this.state,o=i.items,s=i.migratedItems,c=i.searchItems,l=i.searchMigratedItems,u=this.searchParams,p=o.concat(s).map((function(t){return e.getItemTemplate(t)})),m=c.concat(l).map((function(t){return e.getItemTemplate(t)}));return d.a.createElement(d.a.Fragment,null,d.a.createElement(Tt,{title:this.getHeader(),onClick:this.handleHeaderClick,onClose:n,onSearch:this.hasSearch()?this.handleSearch:null,onCloseSearch:this.handleCloseSearch}),d.a.createElement("div",{ref:this.listRef,className:h()("shared-media-list",this.getListClassName()),onScroll:this.handleScroll,style:{minHeight:r?a:null}},p),Boolean(u)&&d.a.createElement("div",{ref:this.searchListRef,className:h()("shared-media-search-list",this.getSearchListClassName()),onScroll:this.handleSearchScroll},m))}}]),a}(d.a.Component)),Pt=(a(505),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"isValidContent",value:function(e){return e&&"messageAudio"===e["@type"]}},{key:"getSearchFilter",value:function(){return{"@type":"searchMessagesFilterAudio"}}},{key:"getHeader",value:function(){return(0,this.props.t)("AudioTitle")}}]),a}(Lt));Pt.propTypes={chatId:bt.a.number.isRequired,migratedChatId:bt.a.number,onClose:bt.a.func.isRequired,popup:bt.a.bool,minHeight:bt.a.number},Pt.defaultProps={popup:!1,minHeight:0};var Nt=Object(y.d)()(Pt),Dt=(a(506),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"isValidContent",value:function(e){return e&&"messageDocument"===e["@type"]}},{key:"getSearchFilter",value:function(){return{"@type":"searchMessagesFilterDocument"}}},{key:"getHeader",value:function(){return(0,this.props.t)("DocumentsTitle")}}]),a}(Lt));Dt.propTypes={chatId:bt.a.number.isRequired,migratedChatId:bt.a.number,onClose:bt.a.func.isRequired,popup:bt.a.bool,minHeight:bt.a.number},Dt.defaultProps={popup:!1,minHeight:0};var Rt=Object(y.d)()(Dt),Bt=a(362),At=a(367),Ft=a(404),Vt=(a(507),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).state={contextMenu:!1,left:0,top:0},e.handleOpenContextMenu=function(){var t=Object(i.a)(r.a.mark((function t(a){var n,i;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a&&(a.preventDefault(),a.stopPropagation()),e.state.contextMenu?e.setState({contextMenu:!1}):(n=a.clientX,i=a.clientY,e.setState({contextMenu:!0,left:n,top:i}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleCloseContextMenu=function(t){t&&t.stopPropagation(),e.setState({contextMenu:!1})},e}return Object(s.a)(a,[{key:"isValidEntityType",value:function(e){return!!e&&("textEntityTypeUrl"===e.type["@type"]||"textEntityTypeTextUrl"===e.type["@type"]||"textEntityTypeEmailAddress"===e.type["@type"])}},{key:"getTitleFromUrl",value:function(e){try{e=e.startsWith("http")?e:"http://"+e;var t=decodeURI(e),a=new URL(t).hostname.split("."),n=a.length>=2?a[a.length-2]:new URL(t).hostname;return Ft.a.ToUnicode(n)}catch(r){console.error("url: "+e+"\n"+r)}return null}},{key:"render",value:function(){var e=this,t=this.props,a=t.chatId,n=t.messageId,r=t.webPage,i=t.showOpenMessage,o=this.state,s=o.contextMenu,c=o.left,l=o.top,u=X.a.get(a,n);if(!u)return null;var p=null,m=r||{title:"",description:"",photo:null,url:""},f=m.display_url,g=m.description,v=m.photo,b=m.title,C=m.url;if(r)b=b||this.getTitleFromUrl(C),p=d.a.createElement(At.a,{className:"shared-link-url",url:C},f);else{var y=u.content.text;if(y){var k=y.entities;k&&k.length>0&&(p=k.filter(this.isValidEntityType).map((function(t){var a=Object(wt.Q)(y.text,t.offset,t.offset+t.length),n=a,r=!1;switch(t.type["@type"]){case"textEntityTypeTextUrl":var i=t.type.url;i&&(n=i);break;case"textEntityTypeUrl":break;case"textEntityTypeEmailAddress":r=!0}return b=b||e.getTitleFromUrl(n)||" ",d.a.createElement(At.a,{className:"shared-link-url",url:n,mail:r},a)})))}}var E="tile_color_".concat(Math.abs(b.charCodeAt(0))%8+1);return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"shared-link",onContextMenu:this.handleOpenContextMenu},d.a.createElement("div",{className:h()("shared-link-photo",E)},Object(We.g)(b),v&&d.a.createElement(Bt.a,{displaySize:90,chatId:a,messageId:n,photo:v,openMedia:wt.O,showProgress:!1,style:{width:48,height:48,position:"absolute",top:0,left:0}})),d.a.createElement("div",{className:"shared-link-content"},b&&d.a.createElement("div",{className:"web-page-title"},b),g&&d.a.createElement("div",{className:"web-page-description"},g),p)),d.a.createElement(Ut,{chatId:a,messageId:n,anchorPosition:{top:l,left:c},open:s,showOpenMessage:i,onClose:this.handleCloseContextMenu}))}}]),a}(d.a.Component)),zt=(a(508),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"isValidContent",value:function(e){if(!e)return!1;var t=e.web_page,a=e.text;if(t)return!0;if(!a)return!1;var n=a.entities;return!!n&&n.find((function(e){return"textEntityTypeUrl"===e.type["@type"]||"textEntityTypeTextUrl"===e.type["@type"]||"textEntityTypeEmailAddress"===e.type["@type"]}))}},{key:"getSearchFilter",value:function(){return{"@type":"searchMessagesFilterUrl"}}},{key:"getHeader",value:function(){return(0,this.props.t)("LinksTitle")}},{key:"getItemTemplate",value:function(e){var t=this.props.migratedChatId,a=e.chat_id,n=e.content,r=e.id;return d.a.createElement(Vt,{key:"chat_id=".concat(a,"_message_id=").concat(r),chatId:a,messageId:r,webPage:n.web_page,openMedia:function(){return Object(wt.O)(a,r,!1)},showOpenMessage:a!==t})}}]),a}(Lt));zt.propTypes={chatId:bt.a.number.isRequired,migratedChatId:bt.a.number,onClose:bt.a.func.isRequired,popup:bt.a.bool,minHeight:bt.a.number},zt.defaultProps={popup:!1,minHeight:0};var Ht=Object(y.d)()(zt),Wt=a(659),Gt=a(651),Zt=(a(509),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){return Object(o.a)(this,a),t.call(this,e)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.close;return d.a.createElement("div",{className:"header-master"},d.a.createElement(E.a,{className:"header-left-button",onClick:e},d.a.createElement(Ne,null)),d.a.createElement("div",{className:"header-status grow cursor-pointer"},d.a.createElement("span",{className:"header-status-content"},"Shared Media")))}}]),a}(d.a.Component)),qt=(a(510),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={value:0},e.handleChange=function(t,a){e.setState({value:a})},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.onClose,a=e.popup,n=this.state.value,r=d.a.createElement(d.a.Fragment,null,d.a.createElement(Zt,{close:t}),d.a.createElement(Wt.a,{value:n,onChange:this.handleChange,indicatorColor:"primary",textColor:"primary",scrollable:!0,scrollButtons:"off",fullWidth:!0},d.a.createElement(Gt.a,{label:"Media",style:{minWidth:"40px"}}),d.a.createElement(Gt.a,{label:"Docs",style:{minWidth:"40px"}}),d.a.createElement(Gt.a,{label:"Links",style:{minWidth:"40px"}}),d.a.createElement(Gt.a,{label:"Audio",style:{minWidth:"40px"}})));return a?d.a.createElement(d.a.Fragment,null,r):d.a.createElement("div",{className:"shared-media"},r)}}]),a}(d.a.Component));qt.defaultProps={popup:!1,minHeight:0};var Kt=qt,Jt=(a(511),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdatePhotoBlob=function(e){var t=n.state,a=t.photoSize,r=t.thumbSize,i=e.fileId;(a&&a.photo&&a.photo.id===i||r&&r.photo&&r.photo.id===i)&&n.forceUpdate()},n.handleOpenContextMenu=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&(t.preventDefault(),t.stopPropagation()),n.state.contextMenu?n.setState({contextMenu:!1}):(a=t.clientX,i=t.clientY,n.setState({contextMenu:!0,left:a,top:i}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleCloseContextMenu=function(e){e&&e.stopPropagation(),n.setState({contextMenu:!1})};var s=e.photo,c=e.size,l=e.thumbnailSize;return n.state={contextMenu:!1,left:0,top:0,photoSize:Object(We.n)(s.sizes,c),thumbSize:Object(We.n)(s.sizes,l),minithumbnail:s.minithumbnail},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){R.a.on("clientUpdatePhotoBlob",this.onClientUpdatePhotoBlob)}},{key:"componentWillUnmount",value:function(){R.a.off("clientUpdatePhotoBlob",this.onClientUpdatePhotoBlob)}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.messageId,n=e.openMedia,r=e.showOpenMessage,i=e.style,o=this.state,s=o.minithumbnail,c=o.thumbSize,l=o.photoSize,u=o.contextMenu,p=o.left,h=o.top;if(!l)return null;var m=s?"data:image/jpeg;base64, "+s.data:null,f=Object(N.l)(c?c.photo:null),g=Object(N.l)(l.photo);m||Object(Mt.k)(c);return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"shared-photo",style:i,onClick:n,onContextMenu:this.handleOpenContextMenu},d.a.createElement("div",{className:"shared-photo-content",style:{backgroundImage:"url(".concat(f||m,")"),backgroundSize:"cover"}},g!==f&&d.a.createElement("div",{className:"shared-photo-main-content",style:{backgroundImage:"url(".concat(g,")")}}))),d.a.createElement(Ut,{chatId:t,messageId:a,anchorPosition:{top:h,left:p},open:u,showOpenMessage:r,onClose:this.handleCloseContextMenu}))}}]),a}(d.a.Component));Jt.defaultProps={size:v.F,thumbnailSize:v.G};var Yt=Jt,Qt=(a(512),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"getListClassName",value:function(){return"shared-photos-list"}},{key:"getSearchListClassName",value:function(){return"shared-photos-search-list"}},{key:"isValidContent",value:function(e){return e&&"messagePhoto"===e["@type"]}},{key:"getSearchFilter",value:function(){return{"@type":"searchMessagesFilterPhoto"}}},{key:"getHeader",value:function(){return(0,this.props.t)("PhotosTitle")}},{key:"getItemTemplate",value:function(e){var t=this.props.migratedChatId,a=e.chat_id,n=e.content,r=e.id;return d.a.createElement(Yt,{key:"chat_id=".concat(a,"_message_id=").concat(r),chatId:a,messageId:r,photo:n.photo,openMedia:function(){return Object(wt.O)(a,r,!1)},showOpenMessage:a!==t})}}]),a}(Lt));Qt.propTypes={chatId:bt.a.number.isRequired,migratedChatId:bt.a.number,onClose:bt.a.func.isRequired,popup:bt.a.bool,minHeight:bt.a.number},Qt.defaultProps={popup:!1,minHeight:0};var Xt=Object(y.d)()(Qt),$t=(a(513),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).state={contextMenu:!1,left:0,top:0},e.onClientUpdateVideoThumbnailBlob=function(t){var a=e.props.video.thumbnail,n=t.fileId;a&&a.photo&&a.photo.id===n&&e.forceUpdate()},e.handleOpenContextMenu=function(){var t=Object(i.a)(r.a.mark((function t(a){var n,i;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a&&(a.preventDefault(),a.stopPropagation()),e.state.contextMenu?e.setState({contextMenu:!1}):(n=a.clientX,i=a.clientY,e.setState({contextMenu:!0,left:n,top:i}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleCloseContextMenu=function(t){t&&t.stopPropagation(),e.setState({contextMenu:!1})},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){R.a.on("clientUpdateVideoThumbnailBlob",this.onClientUpdateVideoThumbnailBlob)}},{key:"componentWillUnmount",value:function(){R.a.off("clientUpdateVideoThumbnailBlob",this.onClientUpdateVideoThumbnailBlob)}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.messageId,n=e.openMedia,r=e.style,i=e.showOpenMessage,o=this.props.video,s=o.minithumbnail,c=o.thumbnail,l=o.duration,u=this.state,p=u.contextMenu,m=u.left,f=u.top,g=s?"data:image/jpeg;base64, "+s.data:null,b=Object(N.l)(c?c.photo:null),C=b?Object(Mt.k)(c,v.nb):Boolean(g);return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"shared-photo",style:r,onClick:n,onContextMenu:this.handleOpenContextMenu},d.a.createElement("div",{className:"shared-video-wrapper"},d.a.createElement("div",{className:h()("shared-video-content",{"media-blurred":C,"media-mini-blurred":!b&&C}),style:{backgroundImage:"url(".concat(b||g,")")}}),d.a.createElement("div",{className:"shared-video-meta"},Object(We.f)(l)))),d.a.createElement(Ut,{chatId:t,messageId:a,anchorPosition:{top:f,left:m},open:p,showOpenMessage:i,onClose:this.handleCloseContextMenu}))}}]),a}(d.a.Component));$t.defaultProps={size:v.F,thumbnailSize:v.G};var ea=$t,ta=(a(514),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"getListClassName",value:function(){return"shared-photos-list"}},{key:"getSearchListClassName",value:function(){return"shared-photos-search-list"}},{key:"isValidContent",value:function(e){return e&&"messageVideo"===e["@type"]}},{key:"getSearchFilter",value:function(){return{"@type":"searchMessagesFilterVideo"}}},{key:"getHeader",value:function(){return(0,this.props.t)("VideosTitle")}},{key:"getItemTemplate",value:function(e){var t=this.props.migratedChatId,a=e.chat_id,n=e.content,r=e.id;return d.a.createElement(ea,{key:"chat_id=".concat(a,"_message_id=").concat(r),chatId:a,messageId:r,video:n.video,openMedia:function(){return Object(wt.O)(a,r,!1)},showOpenMessage:a!==t})}}]),a}(Lt));ta.propTypes={chatId:bt.a.number.isRequired,migratedChatId:bt.a.number,onClose:bt.a.func.isRequired,popup:bt.a.bool,minHeight:bt.a.number},ta.defaultProps={popup:!1,minHeight:0};var aa=Object(y.d)()(ta),na=a(382),ra=a(385),ia=a(369),oa=a(410),sa=(a(515),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleOpenContextMenu=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&(t.preventDefault(),t.stopPropagation()),n.state.contextMenu?n.setState({contextMenu:!1}):(a=t.clientX,i=t.clientY,n.setState({contextMenu:!0,left:a,top:i}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleCloseContextMenu=function(e){e&&e.stopPropagation(),n.setState({contextMenu:!1})},n.state={contextMenu:!1,left:0,top:0},n}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.i18n,n=e.messageId,r=e.voiceNote,i=e.openMedia,o=e.showOpenMessage,s=this.state,c=s.contextMenu,l=s.left,u=s.top,p=X.a.get(t,n);if(!p)return null;if(!r)return null;var h=p.date,m=p.sender_user_id,f=new Date(1e3*h).toLocaleDateString([a.language],{day:"numeric",month:"short",year:"numeric",hour:"numeric",minute:"numeric",hour12:!1}),g=r.duration,v=r.voice;return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"shared-voice-note",onContextMenu:this.handleOpenContextMenu},d.a.createElement(oa.a,{chatId:t,messageId:n,file:v,openMedia:i}),d.a.createElement("div",{className:"voice-note-content"},d.a.createElement(ia.a,{chatId:t,messageId:n,userId:m}),d.a.createElement("div",{className:"voice-note-meta"},d.a.createElement(na.a,{chatId:t,messageId:n,duration:g,file:v,title:"".concat(f,", ")}),d.a.createElement(ra.a,{chatId:t,messageId:n,icon:"\xa0\u2022"})))),d.a.createElement(Ut,{chatId:t,messageId:n,anchorPosition:{top:u,left:l},open:c,showOpenMessage:o,onClose:this.handleCloseContextMenu}))}}]),a}(d.a.Component)),ca=Object(y.d)()(sa),la=(a(516),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"isValidContent",value:function(e){return e&&"messageVoiceNote"===e["@type"]}},{key:"getSearchFilter",value:function(){return{"@type":"searchMessagesFilterVoiceNote"}}},{key:"getHeader",value:function(){return(0,this.props.t)("VoiceTitle")}},{key:"hasSearch",value:function(){return!1}},{key:"getItemTemplate",value:function(e){var t=this.props.migratedChatId,a=e.chat_id,n=e.content,r=e.id;return d.a.createElement(ca,{key:"chat_id=".concat(a,"_message_id=").concat(r),chatId:a,messageId:r,voiceNote:n.voice_note,openMedia:function(){return Object(wt.O)(a,r,!1)},showOpenMessage:a!==t})}}]),a}(Lt));la.propTypes={chatId:bt.a.number.isRequired,migratedChatId:bt.a.number,onClose:bt.a.func.isRequired,popup:bt.a.bool,minHeight:bt.a.number},la.defaultProps={popup:!1,minHeight:0};var ua=Object(y.d)()(la),da=(a(517),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdatePageWidth=function(e){e.isSmallWidth&&(n.props.popup||n.handleCloseChatDetails())},n.onClientUpdateChatId=function(e){var t=n.props.popup,a=n.state.chatId;t||a!==e.nextChatId&&(n.sharedAudios=null,n.sharedDocuments=null,n.sharedLinks=null,n.sharedPhotos=null,n.sharedVideos=null,n.sharedVoiceNotes=null,n.setState({chatId:e.nextChatId,migratedChatId:0,userChatId:null,openGroupInCommon:!1,openSharedAudios:!1,openSharedDocuments:!1,openSharedLinks:!1,openSharedMedia:!1,openSharedPhotos:!1,openSharedVideos:!1,openSharedVoiceNotes:!1,counters:D.a.getCounters(e.nextChatId),migratedCounters:null}))},n.loadContent=function(e){n.loadChatCounters(e),n.loadMigratedCounters(e);var t=Object(x.D)(e);t&&Object(N.z)(e,[t])},n.loadChatCounters=function(){var e=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ye(t);case 2:if(a=e.sent,D.a.setCounters(t,a),t===n.state.chatId){e.next=6;break}return e.abrupt("return");case 6:n.setState({counters:a});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.loadMigratedCounters=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,i,o,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(x.V)(t)){e.next=2;break}return e.abrupt("return");case 2:if(a=xe.a.getFullInfo(Object(x.E)(t))){e.next=5;break}return e.abrupt("return");case 5:if(i=a.upgraded_from_basic_group_id){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,$.a.send({"@type":"createBasicGroupChat",basic_group_id:i,force:!0});case 10:if(o=e.sent){e.next=13;break}return e.abrupt("return");case 13:return e.next=15,Ye(o.id);case 15:if(s=e.sent,D.a.setCounters(o.id,s),n.state.chatId===t){e.next=19;break}return e.abrupt("return");case 19:n.setState({migratedChatId:o.id,migratedCounters:D.a.getCounters(o.id)});case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleOpenSharedMedia=function(){n.setState({openSharedMedia:!0})},n.handleCloseSharedMedia=function(){n.setState({openSharedMedia:!1})},n.handleOpenGroupInCommon=function(){n.setState({openGroupInCommon:!0})},n.handleCloseGroupsInCommon=function(){n.setState({openGroupInCommon:!1})},n.handleCloseChatDetails=function(){var e=n.props.popup;n.state.userChatId?n.setState({userChatId:null}):e?$.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:0}):lt.a.changeChatDetailsVisibility(!1)},n.handleOpenSharedDocuments=function(){n.setState({openSharedDocuments:!0})},n.handleCloseSharedDocuments=function(){n.setState({openSharedDocuments:!1})},n.handleOpenSharedAudios=function(){n.setState({openSharedAudios:!0})},n.handleCloseSharedAudios=function(){n.setState({openSharedAudios:!1})},n.handleOpenSharedVoiceNotes=function(){n.setState({openSharedVoiceNotes:!0})},n.handleCloseSharedVoiceNotes=function(){n.setState({openSharedVoiceNotes:!1})},n.handleOpenSharedLinks=function(){n.setState({openSharedLinks:!0})},n.handleCloseSharedLinks=function(){n.setState({openSharedLinks:!1})},n.handleOpenSharedPhotos=function(){n.setState({openSharedPhotos:!0})},n.handleCloseSharedPhotos=function(){n.setState({openSharedPhotos:!1})},n.handleOpenSharedVideos=function(){n.setState({openSharedVideos:!0})},n.handleCloseSharedVideos=function(){n.setState({openSharedVideos:!1})},n.detailsRef=d.a.createRef();var s=e.popup,c=lt.a.chatId,l=lt.a.dialogChatId;return n.state={chatId:s?l:c,migratedChatId:0,userChatId:null,openGroupInCommon:!1,openSharedAudios:!1,openSharedDocuments:!1,openSharedLinks:!1,openSharedMedia:!1,openSharedPhotos:!1,openSharedVideos:!1,openSharedVoiceNotes:!1,counters:null,migratedCounters:null},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.loadContent(this.state.chatId),lt.a.on("clientUpdateChatId",this.onClientUpdateChatId),lt.a.on("clientUpdatePageWidth",this.onClientUpdatePageWidth)}},{key:"componentWillUnmount",value:function(){lt.a.off("clientUpdateChatId",this.onClientUpdateChatId),lt.a.off("clientUpdatePageWidth",this.onClientUpdatePageWidth)}},{key:"componentDidUpdate",value:function(e,t,a){var n=this.state.chatId;n!==t.chatId&&this.loadContent(n)}},{key:"render",value:function(){var e=this.props,t=e.className,a=e.popup,n=this.state,r=n.chatId,i=n.counters,o=n.migratedChatId,s=n.migratedCounters,c=n.userChatId,l=n.openSharedAudios,u=n.openSharedDocuments,p=n.openSharedLinks,m=n.openSharedMedia,f=n.openSharedPhotos,g=n.openSharedVideos,v=n.openSharedVoiceNotes,b=n.openGroupInCommon,C=r||c,y=this.detailsRef&&this.detailsRef.current?this.detailsRef.current.getContentHeight():0,k=null;return m?k=d.a.createElement(Kt,{chatId:C,popup:a,minHeight:y,onClose:this.handleCloseSharedMedia}):l?(this.sharedAudios=this.sharedAudios||d.a.createElement(Nt,{chatId:C,migratedChatId:o,popup:a,minHeight:y,onClose:this.handleCloseSharedAudios}),k=this.sharedAudios):u?(this.sharedDocuments=this.sharedDocuments||d.a.createElement(Rt,{chatId:C,migratedChatId:o,popup:a,minHeight:y,onClose:this.handleCloseSharedDocuments}),k=this.sharedDocuments):p?(this.sharedLinks=this.sharedLinks||d.a.createElement(Ht,{chatId:C,migratedChatId:o,popup:a,minHeight:y,onClose:this.handleCloseSharedLinks}),k=this.sharedLinks):f?(this.sharedPhotos=this.sharedPhotos||d.a.createElement(Xt,{chatId:C,migratedChatId:o,popup:a,minHeight:y,onClose:this.handleCloseSharedPhotos}),k=this.sharedPhotos):g?(this.sharedVideos=this.sharedVideos||d.a.createElement(aa,{chatId:C,migratedChatId:o,popup:a,minHeight:y,onClose:this.handleCloseSharedVideos}),k=this.sharedVideos):v?(this.sharedVoiceNotes=this.sharedVoiceNotes||d.a.createElement(ua,{chatId:C,migratedChatId:o,popup:a,minHeight:y,onClose:this.handleCloseSharedVoiceNotes}),k=this.sharedVoiceNotes):k=b?d.a.createElement(gt,{chatId:C,popup:a,minHeight:y,onClose:this.handleCloseGroupsInCommon}):d.a.createElement(ht,{ref:this.detailsRef,chatId:C,popup:a,backButton:c===r,counters:i,migratedCounters:s,onOpenGroupInCommon:this.handleOpenGroupInCommon,onOpenSharedAudios:this.handleOpenSharedAudios,onOpenSharedDocuments:this.handleOpenSharedDocuments,onOpenSharedMedia:this.handleOpenSharedMedia,onOpenSharedLinks:this.handleOpenSharedLinks,onOpenSharedPhotos:this.handleOpenSharedPhotos,onOpenSharedVideos:this.handleOpenSharedVideos,onOpenSharedVoiceNotes:this.handleOpenSharedVoiceNotes,onClose:this.handleCloseChatDetails}),a?d.a.createElement(d.a.Fragment,null,k):d.a.createElement("div",{className:h()("chat-info",{"right-column":!a},t)},k)}}]),a}(d.a.Component));da.defaultProps={className:null,classes:null,popup:!1};var pa=da,ha=a(632),ma=(a(518),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).onClientUpdateClearHistory=function(t){e.props.chatId===t.chatId&&(e.clearHistory=t.inProgress,e.forceUpdate())},e.onFastUpdatingComplete=function(t){e.forceUpdate()},e.onUpdate=function(t){e.props.chatId===t.chat_id&&e.forceUpdate()},e}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props,n=a.chatId,r=a.t;return e.chatId!==n||e.t!==r}},{key:"componentDidMount",value:function(){D.a.on("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),D.a.on("clientUpdateClearHistory",this.onClientUpdateClearHistory),D.a.on("updateChatDraftMessage",this.onUpdate),D.a.on("updateChatLastMessage",this.onUpdate),D.a.on("updateChatReadInbox",this.onUpdate),D.a.on("updateUserChatAction",this.onUpdate)}},{key:"componentWillUnmount",value:function(){D.a.off("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),D.a.off("clientUpdateClearHistory",this.onClientUpdateClearHistory),D.a.off("updateChatDraftMessage",this.onUpdate),D.a.off("updateChatLastMessage",this.onUpdate),D.a.off("updateChatReadInbox",this.onUpdate),D.a.off("updateUserChatAction",this.onUpdate)}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.t;if(this.clearHistory)return d.a.createElement("div",{className:"dialog-content"},"\xa0");var n=D.a.get(t);if(!n)return d.a.createElement("div",{className:"dialog-content"},"\xa0");var r=null,i=Object(x.t)(t);if(i&&(r=d.a.createElement("span",{className:"dialog-content-accent"},i)),!r){var o=Object(x.k)(t);if(Object(x.W)(t)){var s=o.text||"\xa0";r=d.a.createElement(d.a.Fragment,null,d.a.createElement("span",{className:"dialog-content-draft"},a("Draft")+": "),s)}}if(!r){var c=Object(x.x)(n,a)||"\xa0",l=Object(x.z)(n,a);r=d.a.createElement(d.a.Fragment,null,l&&d.a.createElement("span",{className:"dialog-content-accent"},l,": "),c)}return d.a.createElement("div",{className:"dialog-content"},r)}}]),a}(d.a.Component)),fa=Object(y.d)()(ma),ga=Object(M.a)(d.a.createElement("g",{strokeWidth:"1",fill:"none",fillRule:"evenodd"},d.a.createElement("line",{x1:"10.5",y1:"13.5",x2:"7",y2:"17",id:"Path-51",strokeWidth:"1.66",strokeLinecap:"round"}),d.a.createElement("path",{d:"M15.2734195,6.29329584 L17.7068554,8.72673178 C18.0977149,9.11759123 18.0977149,9.7512996 17.7068554,10.142159 C17.6489915,10.200023 17.5842494,10.2505721 17.5140791,10.2926743 L15.0747102,11.7562956 C15.5465193,13.1717229 15.0755189,14.5863414 13.661709,16.0001513 L8,10.3384422 C9.41380985,8.92463237 10.8284284,8.45363199 12.2438557,8.92544107 L13.707477,6.48607217 C13.991869,6.01208547 14.6066564,5.85838861 15.0806431,6.14278063 C15.1508135,6.18488284 15.2155555,6.2354319 15.2734195,6.29329584 Z",strokeWidth:"1.66",strokeLinecap:"round",strokeLinejoin:"round"})),"Pin"),va=(a(519),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).onClientUpdateClearHistory=function(t){e.props.chatId===t.chatId&&(e.clearHistory=t.inProgress,e.forceUpdate())},e.onFastUpdatingComplete=function(t){e.forceUpdate()},e.onUpdate=function(t){var a=e.props.chatId;t.chat_id===a&&e.forceUpdate()},e.onUpdateScopeNotificationSettings=function(t){var a=e.props.chatId,n=D.a.get(a);if(n)switch(t.scope["@type"]){case"notificationSettingsScopeGroupChats":"chatTypeBasicGroup"!==n.type["@type"]&&"chatTypeSupergroup"!==n.type["@type"]||e.forceUpdate();break;case"notificationSettingsScopePrivateChats":"chatTypePrivate"!==n.type["@type"]&&"chatTypeSecret"!==n.type["@type"]||e.forceUpdate()}},e}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props.chatId;return e.chatId!==a}},{key:"componentDidMount",value:function(){D.a.on("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),D.a.on("clientUpdateClearHistory",this.onClientUpdateClearHistory),D.a.on("updateChatDraftMessage",this.onUpdate),D.a.on("updateChatIsMarkedAsUnread",this.onUpdate),D.a.on("updateChatIsPinned",this.onUpdate),D.a.on("updateChatNotificationSettings",this.onUpdate),D.a.on("updateChatReadInbox",this.onUpdate),D.a.on("updateChatLastMessage",this.onUpdate),D.a.on("updateChatReadOutbox",this.onUpdate),D.a.on("updateChatUnreadMentionCount",this.onUpdate),D.a.on("updateMessageMentionRead",this.onUpdate),Xe.a.on("updateScopeNotificationSettings",this.onUpdateScopeNotificationSettings)}},{key:"componentWillUnmount",value:function(){D.a.off("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),D.a.off("clientUpdateClearHistory",this.onClientUpdateClearHistory),D.a.off("updateChatDraftMessage",this.onUpdate),D.a.off("updateChatIsMarkedAsUnread",this.onUpdate),D.a.off("updateChatIsPinned",this.onUpdate),D.a.off("updateChatNotificationSettings",this.onUpdate),D.a.off("updateChatReadInbox",this.onUpdate),D.a.off("updateChatLastMessage",this.onUpdate),D.a.off("updateChatReadOutbox",this.onUpdate),D.a.off("updateChatUnreadMentionCount",this.onUpdate),D.a.off("updateMessageMentionRead",this.onUpdate),Xe.a.off("updateScopeNotificationSettings",this.onUpdateScopeNotificationSettings)}},{key:"render",value:function(){if(this.clearHistory)return null;var e=this.props.chatId,t=D.a.get(e);if(!t)return null;var a=t.is_pinned,n=t.unread_count,r=Object(x.Y)(e),i=Object(x.X)(e),o=Object(x.M)(e);return d.a.createElement(d.a.Fragment,null,r&&d.a.createElement("div",{className:"dialog-badge"},d.a.createElement("div",{className:"dialog-badge-mention"},"@")),i&&d.a.createElement("div",{className:h()({"dialog-badge-muted":o},"dialog-badge")},d.a.createElement("span",{className:"dialog-badge-text"},n>0?n:"")),a&&!i&&!r&&d.a.createElement("div",{className:"dialog-badge-pinned"},d.a.createElement(ga,{className:"dialog-badge-pinned-icon"})))}}]),a}(d.a.Component)),ba=Object(M.a)(d.a.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},d.a.createElement("g",{transform:"translate(-3.000000, 0.000000)",fill:"#E53935",fillRule:"nonzero"},d.a.createElement("path",{d:"M10,0.4 C13.6450793,0.4 16.6,3.35492065 16.6,7 C16.6,10.6450793 13.6450793,13.6 10,13.6 C6.35492065,13.6 3.4,10.6450793 3.4,7 C3.4,3.35492065 6.35492065,0.4 10,0.4 Z M10,9.25 C9.58578644,9.25 9.25,9.58578644 9.25,10 C9.25,10.4142136 9.58578644,10.75 10,10.75 C10.4142136,10.75 10.75,10.4142136 10.75,10 C10.75,9.58578644 10.4142136,9.25 10,9.25 Z M10,2.85 C9.64101491,2.85 9.35,3.14101491 9.35,3.5 L9.35,7.5 C9.35,7.85898509 9.64101491,8.15 10,8.15 C10.3589851,8.15 10.65,7.85898509 10.65,7.5 L10.65,3.5 C10.65,3.14101491 10.3589851,2.85 10,2.85 Z"}))),"Error"),Ca=Object(M.a)(d.a.createElement("g",{strokeWidth:"1",fill:"none",fillRule:"evenodd",strokeLinecap:"round",strokeLinejoin:"round"},d.a.createElement("g",{transform:"translate(-3.000000, 0.000000)"},d.a.createElement("circle",{strokeWidth:"1.2",cx:"10",cy:"7",r:"6"}),d.a.createElement("line",{x1:"10",y1:"3.5",x2:"10",y2:"7",strokeWidth:"1.3"}),d.a.createElement("line",{x1:"12",y1:"9",x2:"10",y2:"7",strokeWidth:"1.3"}))),"Pending"),ya=Object(M.a)(d.a.createElement("path",{transform:"translate(-4.000000, -2.000000)",d:"M7.96833846,10.0490996 L14.5108251,2.571972 C14.7472185,2.30180819 15.1578642,2.27443181 15.428028,2.51082515 C15.6711754,2.72357915 15.717665,3.07747757 15.5522007,3.34307913 L15.4891749,3.428028 L8.48917485,11.428028 C8.2663359,11.6827011 7.89144111,11.7199091 7.62486888,11.5309823 L7.54038059,11.4596194 L4.54038059,8.45961941 C4.2865398,8.20577862 4.2865398,7.79422138 4.54038059,7.54038059 C4.7688373,7.31192388 5.12504434,7.28907821 5.37905111,7.47184358 L5.45961941,7.54038059 L7.96833846,10.0490996 L14.5108251,2.571972 L7.96833846,10.0490996 Z"}),"Sent"),ka=Object(M.a)(d.a.createElement("path",{transform:"translate(-1.000000, -2.000000)",d:"M4.96833846,10.0490996 L11.5108251,2.571972 C11.7472185,2.30180819 12.1578642,2.27443181 12.428028,2.51082515 C12.6711754,2.72357915 12.717665,3.07747757 12.5522007,3.34307913 L12.4891749,3.428028 L5.48917485,11.428028 C5.2663359,11.6827011 4.89144111,11.7199091 4.62486888,11.5309823 L4.54038059,11.4596194 L1.54038059,8.45961941 C1.2865398,8.20577862 1.2865398,7.79422138 1.54038059,7.54038059 C1.7688373,7.31192388 2.12504434,7.28907821 2.37905111,7.47184358 L2.45961941,7.54038059 L4.96833846,10.0490996 L11.5108251,2.571972 L4.96833846,10.0490996 Z M9.96833846,10.0490996 L16.5108251,2.571972 C16.7472185,2.30180819 17.1578642,2.27443181 17.428028,2.51082515 C17.6711754,2.72357915 17.717665,3.07747757 17.5522007,3.34307913 L17.4891749,3.428028 L10.4891749,11.428028 C10.2663359,11.6827011 9.89144111,11.7199091 9.62486888,11.5309823 L9.54038059,11.4596194 L8.54038059,10.4596194 C8.2865398,10.2057786 8.2865398,9.79422138 8.54038059,9.54038059 C8.7688373,9.31192388 9.12504434,9.28907821 9.37905111,9.47184358 L9.45961941,9.54038059 L9.96833846,10.0490996 L16.5108251,2.571972 L9.96833846,10.0490996 Z"}),"Succeeded"),Ea=(a(520),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={},e.onUpdateMessageSend=function(t){var a=e.props,n=a.chatId,r=a.messageId,i=t.old_message_id,o=t.message;if(r===i&&o){var s=o.chat_id,c=o.id,l=o.sending_state;n===s&&(e.newMessageId=c,e.setState({sendingState:l}))}},e.onUpdateChatReadOutbox=function(t){var a=e.props,n=a.chatId,r=a.messageId,i=t.chat_id,o=t.last_read_outbox_message_id,s=Object(yt.a)(e).newMessageId;n===i&&(s&&s<=o||r<=o)&&e.setState({sendingState:null,unread:!1})},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){D.a.on("updateChatReadOutbox",this.onUpdateChatReadOutbox),X.a.on("updateMessageSendFailed",this.onUpdateMessageSend),X.a.on("updateMessageSendSucceeded",this.onUpdateMessageSend)}},{key:"componentWillUnmount",value:function(){D.a.off("updateChatReadOutbox",this.onUpdateChatReadOutbox),X.a.off("updateMessageSendFailed",this.onUpdateMessageSend),X.a.off("updateMessageSendSucceeded",this.onUpdateMessageSend)}},{key:"render",value:function(){var e=this.state,t=e.sendingState;return e.unread?t?"messageSendingStateFailed"===t["@type"]?d.a.createElement(ba,{className:"status",viewBox:"0 0 14 14",style:{width:16,height:12,transform:"translate(0, 1px)"}}):d.a.createElement(Ca,{className:"status",viewBox:"0 0 14 14",style:{width:16,height:12,transform:"translate(0, 1px)",stroke:"currentColor"}}):d.a.createElement(ya,{className:"status",viewBox:"0 0 12 10",style:{width:16,height:9}}):d.a.createElement(ka,{className:"status",viewBox:"0 0 17 10",style:{width:16,height:9}})}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.chatId,n=e.messageId,r=X.a.get(a,n),i=r?r.sending_state:null;return a!==t.prevChatId||n!==t.prevMessageId?{prevChatId:a,prevMessageId:n,sendingState:i,unread:Object(wt.J)(a,n)}:null}}]),a}(d.a.Component)),Sa=(a(521),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).onClientUpdateClearHistory=function(t){e.props.chatId===t.chatId&&(e.clearHistory=t.inProgress,e.forceUpdate())},e.onFastUpdatingComplete=function(t){e.forceUpdate()},e.onUpdate=function(t){e.props.chatId===t.chat_id&&e.forceUpdate()},e}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props.chatId;return e.chatId!==a}},{key:"componentDidMount",value:function(){D.a.on("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),D.a.on("clientUpdateClearHistory",this.onClientUpdateClearHistory),D.a.on("updateChatDraftMessage",this.onUpdate),D.a.on("updateChatLastMessage",this.onUpdate),D.a.on("updateChatReadInbox",this.onUpdate),D.a.on("updateChatUnreadMentionCount",this.onUpdate),D.a.on("updateMessageMentionRead",this.onUpdate)}},{key:"componentWillUnmount",value:function(){D.a.off("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),D.a.off("clientUpdateClearHistory",this.onClientUpdateClearHistory),D.a.off("updateChatDraftMessage",this.onUpdate),D.a.off("updateChatLastMessage",this.onUpdate),D.a.off("updateChatReadInbox",this.onUpdate),D.a.off("updateChatUnreadMentionCount",this.onUpdate),D.a.off("updateMessageMentionRead",this.onUpdate)}},{key:"render",value:function(){if(this.clearHistory)return null;var e=this.props.chatId,t=D.a.get(e);if(!t)return null;var a=Object(x.T)(e),n=t.last_message;if(!n)return null;var r=Object(x.y)(t);if(!r)return null;var i=n.id,o=n.is_outgoing;return d.a.createElement("div",{className:"dialog-meta"},o&&!a&&d.a.createElement(d.a.Fragment,null,d.a.createElement(Ea,{chatId:e,messageId:i}),d.a.createElement("span",null," ")),r)}}]),a}(d.a.Component)),Oa=Object(M.a)(d.a.createElement("path",{d:"M16.5,1 C17.7590292,1 18.9445825,1.59277663 19.7,2.6 L19.7,2.6 L21.2,4.6 C21.7192885,5.29238468 22,6.13451915 22,7 L22,7 L22,8 C22,8.11615513 21.980196,8.22768478 21.9437804,8.33139667 C21.9809544,8.54881122 22,8.77218145 22,9 L22,18 C22,20.209139 20.209139,22 18,22 L6,22 C3.790861,22 2,20.209139 2,18 L2,9 C2,8.77218145 2.01904557,8.54881122 2.05563136,8.33139468 C2.01980398,8.22768478 2,8.11615513 2,8 L2,8 L2,7 C2,6.13451915 2.28071149,5.29238468 2.8,4.6 L2.8,4.6 L4.3,2.6 C5.05541753,1.59277663 6.24097079,1 7.5,1 L7.5,1 Z M18,7 L6,7 C4.8954305,7 4,7.8954305 4,9 L4,18 C4,19.1045695 4.8954305,20 6,20 L18,20 C19.1045695,20 20,19.1045695 20,18 L20,9 C20,7.8954305 19.1045695,7 18,7 Z M8.29289322,11.2928932 C8.68341751,10.9023689 9.31658249,10.9023689 9.70710678,11.2928932 L9.70710678,11.2928932 L12,13.5857864 L14.2928932,11.2928932 C14.6834175,10.9023689 15.3165825,10.9023689 15.7071068,11.2928932 C16.0976311,11.6834175 16.0976311,12.3165825 15.7071068,12.7071068 L15.7071068,12.7071068 L12.7071068,15.7071068 C12.3165825,16.0976311 11.6834175,16.0976311 11.2928932,15.7071068 L11.2928932,15.7071068 L8.29289322,12.7071068 C7.90236893,12.3165825 7.90236893,11.6834175 8.29289322,11.2928932 Z M16.5,3 L7.5,3 C6.87048539,3 6.27770876,3.29638831 5.9,3.8 L5.9,3.8 L4.88040369,5.15879948 C5.23567546,5.05542416 5.61136523,5 6,5 L18,5 C18.3882729,5 18.7636249,5.055321 19.1186039,5.15851085 L18.1,3.8 C17.7222912,3.29638831 17.1295146,3 16.5,3 L16.5,3 Z"}),"Archive"),Ua=Object(M.a)(d.a.createElement("path",{d:"M16.5,1 C17.7590292,1 18.9445825,1.59277663 19.7,2.6 L19.7,2.6 L21.2,4.6 C21.7192885,5.29238468 22,6.13451915 22,7 L22,7 L22,8 C22,8.11615513 21.980196,8.22768478 21.9437804,8.33139667 C21.9809544,8.54881122 22,8.77218145 22,9 L22,18 C22,20.209139 20.209139,22 18,22 L6,22 C3.790861,22 2,20.209139 2,18 L2,9 C2,8.77218145 2.01904557,8.54881122 2.05563136,8.33139468 C2.01980398,8.22768478 2,8.11615513 2,8 L2,8 L2,7 C2,6.13451915 2.28071149,5.29238468 2.8,4.6 L2.8,4.6 L4.3,2.6 C5.05541753,1.59277663 6.24097079,1 7.5,1 L7.5,1 Z M18,7 L6,7 C4.8954305,7 4,7.8954305 4,9 L4,18 C4,19.1045695 4.8954305,20 6,20 L18,20 C19.1045695,20 20,19.1045695 20,18 L20,9 C20,7.8954305 19.1045695,7 18,7 Z M12.7071068,10.7928932 L15.7071068,13.7928932 C16.0976311,14.1834175 16.0976311,14.8165825 15.7071068,15.2071068 C15.3165825,15.5976311 14.6834175,15.5976311 14.2928932,15.2071068 L12,12.9142136 L9.70710678,15.2071068 C9.31658249,15.5976311 8.68341751,15.5976311 8.29289322,15.2071068 C7.90236893,14.8165825 7.90236893,14.1834175 8.29289322,13.7928932 L11.2928932,10.7928932 C11.6834175,10.4023689 12.3165825,10.4023689 12.7071068,10.7928932 Z M16.5,3 L7.5,3 C6.87048539,3 6.27770876,3.29638831 5.9,3.8 L5.9,3.8 L4.88040369,5.15879948 C5.23567546,5.05542416 5.61136523,5 6,5 L18,5 C18.3882729,5 18.7636249,5.055321 19.1186039,5.15851085 L18.1,3.8 C17.7222912,3.29638831 17.1295146,3 16.5,3 L16.5,3 Z"}),"Unarchive"),wa=Object(M.a)(d.a.createElement("path",{d:"M18.1483713,2 L18.2928313,2.00686658 C19.0534832,2.07955132 19.6483713,2.72030388 19.6483713,3.5 C19.6483713,3.93788733 19.4570272,4.35391161 19.1245584,4.6388849 L16.9591265,6.49496934 L16.5350978,11.1592857 L19.5076921,14.5034542 C20.0580691,15.1226284 20.002298,16.070737 19.3831238,16.621114 C19.1085471,16.8651821 18.7539493,17 18.3865781,17 L12.9994219,17 L13,22 C13,22.5128358 12.6139598,22.9355072 12.1166211,22.9932723 L12,23 C11.4477153,23 11,22.5522847 11,22 L11,22 L10.9994219,17 L5.61342192,17 C4.7849948,17 4.11342192,16.3284271 4.11342192,15.5 C4.11342192,15.1326288 4.24823977,14.7780309 4.49230794,14.5034542 L7.46490224,11.1592857 L7.04087348,6.49496934 L4.87544164,4.6388849 C4.24645288,4.09975168 4.17361057,3.1528017 4.7127438,2.52381294 C4.9977171,2.19134409 5.41374137,2 5.8516287,2 L18.1483713,2 Z M16.7967426,4 L7.20325741,4 L8.34245623,4.97645613 C8.73788815,5.31539777 8.98550756,5.79522213 9.0326599,6.31389784 L9.45668865,10.9782142 C9.50671685,11.5285243 9.32683472,12.0750103 8.95972088,12.4880133 L6.72684384,15 L17.2731562,15 L15.0402791,12.4880133 C14.6731653,12.0750103 14.4932831,11.5285243 14.5433113,10.9782142 L14.9673401,6.31389784 C15.0144924,5.79522213 15.2621119,5.31539777 15.6575438,4.97645613 L16.7967426,4 Z"}),"Pin2"),Ma=Object(M.a)(d.a.createElement("path",{d:"M13,20 C13.5522847,20 14,20.4477153 14,21 C14,21.5522847 13.5522847,22 13,22 L13,22 L11,22 C10.4477153,22 10,21.5522847 10,21 C10,20.4477153 10.4477153,20 11,20 L11,20 Z M3.30352462,2.28241931 C3.6998335,1.89776658 4.33292796,1.90721575 4.71758069,2.30352462 L4.71758069,2.30352462 L21.2175807,19.3035246 C21.6022334,19.6998335 21.5927842,20.332928 21.1964754,20.7175807 C20.8001665,21.1022334 20.167072,21.0927842 19.7824193,20.6964754 L19.7824193,20.6964754 L18.127874,18.9919007 C18.1241295,18.9923786 18.1203785,18.9928359 18.1166211,18.9932723 L18,19 L4,19 C3.23933773,19 2.77101468,18.1926118 3.11084891,17.5416503 L3.16794971,17.4452998 L5,14.6972244 L5,9 C5,7.98873702 5.21529462,7.00715088 5.62359521,6.10821117 L3.28241931,3.69647538 C2.89776658,3.3001665 2.90721575,2.66707204 3.30352462,2.28241931 Z M7.00817933,8.71121787 L7,9 L7,14.6972244 C7,15.0356672 6.91413188,15.3676193 6.75167088,15.6624466 L6.66410059,15.8066248 L5.86851709,17 L16.1953186,16.9999993 L7.16961011,7.7028948 C7.08210009,8.02986218 7.02771758,8.36725335 7.00817933,8.71121787 Z M12,2 C15.7854517,2 18.8690987,5.00478338 18.995941,8.75935025 L19,9 L19,12 C19,12.5522847 18.5522847,13 18,13 C17.4871642,13 17.0644928,12.6139598 17.0067277,12.1166211 L17,12 L17,9 C17,6.23857625 14.7614237,4 12,4 C11.3902636,4 10.7970241,4.10872043 10.239851,4.31831953 C9.72293204,4.51277572 9.14624852,4.25136798 8.95179232,3.734449 C8.75733613,3.21753002 9.01874387,2.6408465 9.53566285,2.4463903 C10.3171048,2.15242503 11.1488212,2 12,2 Z"}),"Mute"),Ia=Object(M.a)(d.a.createElement("path",{d:"M13,20 C13.5522847,20 14,20.4477153 14,21 C14,21.5522847 13.5522847,22 13,22 L13,22 L11,22 C10.4477153,22 10,21.5522847 10,21 C10,20.4477153 10.4477153,20 11,20 L11,20 Z M12,2 C15.8659932,2 19,5.13400675 19,9 L19,14.6972244 L20.8320503,17.4452998 C21.2750868,18.1098545 20.7986954,19 20,19 L4,19 C3.20130462,19 2.72491322,18.1098545 3.16794971,17.4452998 L5,14.6972244 L5,9 C5,5.13400675 8.13400675,2 12,2 Z M12,4 C9.23857625,4 7,6.23857625 7,9 L7,14.6972244 C7,15.0920743 6.88312395,15.4780897 6.66410059,15.8066248 L5.86851709,17 L18.1314829,17 L17.3358994,15.8066248 C17.1168761,15.4780897 17,15.0920743 17,14.6972244 L17,9 C17,6.23857625 14.7614237,4 12,4 Z"}),"Unmute"),ja=Object(M.a)(d.a.createElement("path",{d:"M12,12 C15.9072418,12 18.715318,13.0364023 20.3351717,15.1788288 C20.7665758,15.7493929 21,16.4451545 21,17.1604559 L21,18.2857143 C21,19.7847729 19.7847729,21 18.2857143,21 L5.71428571,21 C4.21522711,21 3,19.7847729 3,18.2857143 L3,17.160494 C3,16.445199 3.23340019,15.7494497 3.66478123,15.178891 C5.28463457,13.0364199 8.09272555,12 12,12 Z M12,14 C8.66170181,14 6.44476079,14.8182362 5.26012276,16.3850773 C5.09133017,16.6083279 5,16.8805766 5,17.160494 L5,18.2857143 C5,18.6802034 5.31979661,19 5.71428571,19 L18.2857143,19 C18.6802034,19 19,18.6802034 19,18.2857143 L19,17.1604559 C19,16.8805572 18.9086617,16.6083073 18.7398491,16.38504 C17.5552048,14.8182236 15.3382718,14 12,14 Z M12,2 C14.209139,2 16,3.790861 16,6 C16,8.209139 14.209139,10 12,10 C9.790861,10 8,8.209139 8,6 C8,3.790861 9.790861,2 12,2 Z M12,4 C10.8954305,4 10,4.8954305 10,6 C10,7.1045695 10.8954305,8 12,8 C13.1045695,8 14,7.1045695 14,6 C14,4.8954305 13.1045695,4 12,4 Z"}),"User"),_a=Object(M.a)(d.a.createElement("path",{d:"M8,13 C11.3229116,13 13.7530244,13.8337117 15.2223821,15.5699359 C15.724477,16.1632234 16,16.915291 16,17.6925226 L16,18.5 C16,19.8807119 14.8807119,21 13.5,21 L2.5,21 C1.11928813,21 0,19.8807119 0,18.5 L0,17.6925204 C0,16.9152876 0.275524605,16.1632192 0.777621166,15.569932 C2.24697824,13.8337108 4.67709024,13 8,13 Z M17.9515112,14.0335753 L18.0683205,14.0347288 C20.2213596,14.1802785 21.8813904,14.7876525 23.0130897,15.8958397 C23.5916808,16.4623828 23.9388003,17.2206225 23.9926356,18.0235027 L24,18.2434663 L24,18.75 C24,19.940864 23.0748384,20.9156449 21.9040488,20.9948092 L21.75,21 L19,21 C18.4477153,21 18,20.5522847 18,20 C18,19.4871642 18.3860402,19.0644928 18.8833789,19.0067277 L19,19 L21.75,19 C21.8683467,19 21.9674868,18.9177666 21.9933973,18.8073227 L22,18.75 L22,18.2434663 C22,17.8977921 21.8608093,17.5666871 21.6138154,17.3248364 C20.8641159,16.5907126 19.6490875,16.1461566 17.9334244,16.0301743 C17.3823973,15.9929238 16.9658991,15.5160306 17.0031496,14.9650035 C17.0377394,14.4533355 17.4514089,14.0576643 17.9515112,14.0335753 L17.9515112,14.0335753 Z M8,15 C5.21130036,15 3.33538166,15.6435809 2.30428673,16.861943 C2.10781409,17.0940989 2,17.3883868 2,17.6925212 L2,18.5 C2,18.7761424 2.22385763,19 2.5,19 L13.5,19 C13.7761424,19 14,18.7761424 14,18.5 L14,17.6925226 C14,17.3883883 13.8921864,17.0941004 13.6957148,16.8619448 C12.6646202,15.6435815 10.788701,15 8,15 Z M17,5 C18.9329966,5 20.5,6.56700338 20.5,8.5 C20.5,10.4329966 18.9329966,12 17,12 C15.0670034,12 13.5,10.4329966 13.5,8.5 C13.5,6.56700338 15.0670034,5 17,5 Z M8,3 C10.209139,3 12,4.790861 12,7 C12,9.209139 10.209139,11 8,11 C5.790861,11 4,9.209139 4,7 C4,4.790861 5.790861,3 8,3 Z M17,7 C16.1715729,7 15.5,7.67157288 15.5,8.5 C15.5,9.32842712 16.1715729,10 17,10 C17.8284271,10 18.5,9.32842712 18.5,8.5 C18.5,7.67157288 17.8284271,7 17,7 Z M8,5 C6.8954305,5 6,5.8954305 6,7 C6,8.1045695 6.8954305,9 8,9 C9.1045695,9 10,8.1045695 10,7 C10,5.8954305 9.1045695,5 8,5 Z"}),"Group"),xa=Object(M.a)(d.a.createElement("path",{d:"M7.41421356,19 L3.87781746,22.5363961 C3.44824074,22.9659728 2.75175926,22.9659728 2.32218254,22.5363961 C2.11589252,22.3301061 2,22.0503168 2,21.7585786 L2,6 C2,3.790861 3.790861,2 6,2 L18,2 C20.209139,2 22,3.790861 22,6 L22,15 C22,17.209139 20.209139,19 18,19 L7.41421356,19 Z M4,19.5857864 L6.20502525,17.3807612 C6.44882255,17.1369639 6.77948263,17 7.12426407,17 L18,17 C19.1045695,17 20,16.1045695 20,15 L20,6 C20,4.8954305 19.1045695,4 18,4 L6,4 C4.8954305,4 4,4.8954305 4,6 L4,19.5857864 Z"}),"Message"),Ta=Object(M.a)(d.a.createElement("path",{d:"M6,2 L18,2 C20.1421954,2 21.8910789,3.68396847 21.9951047,5.80035966 L22,6 L22,10 C22,10.5522847 21.5522847,11 21,11 C20.4871642,11 20.0644928,10.6139598 20.0067277,10.1166211 L20,10 L20,6 C20,4.9456382 19.1841222,4.08183488 18.1492623,4.00548574 L18,4 L6,4 C4.9456382,4 4.08183488,4.81587779 4.00548574,5.85073766 L4,6 L4,19.5857864 L6.20502525,17.3807612 C6.41399436,17.1717921 6.68678103,17.0413128 6.97757724,17.0082977 L7.12426407,17 L13,17 C13.5522847,17 14,17.4477153 14,18 C14,18.5128358 13.6139598,18.9355072 13.1166211,18.9932723 L13,19 L7.41421356,19 L3.87781746,22.5363961 C3.44824074,22.9659728 2.75175926,22.9659728 2.32218254,22.5363961 C2.14536253,22.3595761 2.034957,22.1287566 2.00702113,21.8826983 L2,21.7585786 L2,6 C2,3.85780461 3.68396847,2.10892112 5.80035966,2.00489531 L6,2 L18,2 L6,2 Z M19,12 C21.209139,12 23,13.790861 23,16 C23,18.209139 21.209139,20 19,20 C16.790861,20 15,18.209139 15,16 C15,13.790861 16.790861,12 19,12 Z M19,14 C17.8954305,14 17,14.8954305 17,16 C17,17.1045695 17.8954305,18 19,18 C20.1045695,18 21,17.1045695 21,16 C21,14.8954305 20.1045695,14 19,14 Z"}),"Unread");function La(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];$.a.send({"@type":"pinChatMessage",chat_id:e,message_id:t,disable_notification:a})}function Pa(e){$.a.send({"@type":"unpinChatMessage",chat_id:e})}a(522);var Na=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdateChatId=function(e){var t=n.props.chatId;t!==e.previousChatId&&t!==e.nextChatId||n.forceUpdate()},n.handleSelect=function(e){0===e.button&&Object(Q.i)(n.props.chatId)},n.handleContextMenu=function(){var e=Object(i.a)(r.a.mark((function e(t){var i,o,s,c,l,u,d,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&(t.preventDefault(),t.stopPropagation()),i=n.props.chatId,!n.state.contextMenu){e.next=7;break}n.setState({contextMenu:!1}),e.next=23;break;case 7:return o=new Date,a.contextMenuId=o,s=t.clientX,c=t.clientY,l=D.a.get(i),u=l.is_pinned,e.next=15,n.canPinChats(i);case 15:if(e.t0=e.sent,e.t0){e.next=18;break}e.t0=u;case 18:if(d=e.t0,p=Object(x.g)(i),a.contextMenuId===o){e.next=22;break}return e.abrupt("return");case 22:n.setState({contextMenu:!0,canTogglePin:d,canToggleArchive:p,left:s,top:c});case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleCloseContextMenu=function(e){e&&e.stopPropagation(),n.setState({contextMenu:!1})},n.handleMute=function(e){n.handleCloseContextMenu(e);var t=n.props.chatId;Je(t,!Object(x.M)(t))},n.canPinChats=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,n,i,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Object(x.K)(t)?G.a.get("pinned_archived_chat_count_max"):G.a.get("pinned_chat_count_max")){e.next=3;break}return e.abrupt("return",!1);case 3:return n=Object(x.N)(t),e.next=6,$.a.send({"@type":"getChats",chat_list:Object(x.K)(t)?{"@type":"chatListArchive"}:{"@type":"chatListMain"},offset_order:"9223372036854775807",offset_chat_id:0,limit:a.value+10});case 6:return i=e.sent,o=i.chat_ids.reduce((function(e,t){if(Object(x.N)(t)!==n)return e;var a=D.a.get(t);return e+(a&&a.is_pinned?1:0)}),0),e.abrupt("return",o<a.value);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handlePin=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,i,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.handleCloseContextMenu(t),a=n.props.chatId,i=D.a.get(a)){e.next=5;break}return e.abrupt("return");case 5:if((o=i.is_pinned)||n.canPinChats(a)){e.next=8;break}return e.abrupt("return");case 8:qe(a,!o);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleArchive=function(){var e=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.handleCloseContextMenu(t),a=n.props.chatId,Object(x.g)(a)){e.next=4;break}return e.abrupt("return");case 4:Ze(a,{"@type":Object(x.K)(a)?"chatListMain":"chatListArchive"});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.getViewInfoTitle=function(){var e=n.props,t=e.chatId,a=e.t,r=D.a.get(t);if(r){var i=r.type;switch(i["@type"]){case"chatTypeBasicGroup":return a("ViewGroupInfo");case"chatTypePrivate":case"chatTypeSecret":return a("ViewProfile");case"chatTypeSupergroup":return i.is_channel?a("ViewChannelInfo"):a("ViewGroupInfo")}}},n.handleViewInfo=function(e){n.handleCloseContextMenu(e);var t=n.props.chatId;Object(Q.i)(t,null,!0)},n.handleRead=function(e){n.handleCloseContextMenu(e);var t=n.props.chatId;if(Object(x.O)(t)){var a=D.a.get(t);if(!a)return;var r=a.is_marked_as_unread,i=a.last_message;a.unread_count>0&&i?function(e,t,a){$.a.send({"@type":"viewMessages",chat_id:e,message_ids:t,force_read:a})}(t,[i.id],!0):r&&Ke(t,!1)}else Ke(t,!0)},n.dialog=d.a.createRef();var s=D.a.get(n.props.chatId);return n.state={chat:s,contextMenu:!1,left:0,top:0},n}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props,n=a.chatId,r=a.t,i=a.hidden,o=a.isLastPinned,s=a.style,c=this.state.contextMenu;return e.chatId!==n||(e.t!==r||(e.hidden!==i||(e.isLastPinned!==o||(t.contextMenu!==c||!(!e.style||!s||s.top===e.style.top)))))}},{key:"componentDidMount",value:function(){lt.a.on("clientUpdateChatId",this.onClientUpdateChatId)}},{key:"componentWillUnmount",value:function(){lt.a.off("clientUpdateChatId",this.onClientUpdateChatId)}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.showSavedMessages,n=e.hidden,r=e.t,i=(e.isLastPinned,e.style),o=this.state,s=o.contextMenu,c=o.left,l=o.top,u=o.canToggleArchive,p=o.canTogglePin,m=D.a.get(t).is_pinned,f=lt.a.getChatId()===t,g=Object(x.M)(t),v=Object(x.O)(t),b=Object(x.K)(t);return d.a.createElement("div",{ref:this.dialog,className:h()("dialog",{"item-selected":f},{"dialog-hidden":n}),onMouseDown:this.handleSelect,onContextMenu:this.handleContextMenu,style:i},d.a.createElement("div",{className:"dialog-wrapper"},d.a.createElement(A,{chatId:t,dialog:!0,showSavedMessages:a,showOnline:!0}),d.a.createElement("div",{className:"dialog-inner-wrapper"},d.a.createElement("div",{className:"tile-first-row"},d.a.createElement(je,{chatId:t}),d.a.createElement(Sa,{chatId:t})),d.a.createElement("div",{className:"tile-second-row"},d.a.createElement(fa,{chatId:t}),d.a.createElement(va,{chatId:t})))),d.a.createElement(St.a,{open:s,onClose:this.handleCloseContextMenu,anchorReference:"anchorPosition",anchorPosition:{top:l,left:c},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},onMouseDown:function(e){return e.stopPropagation()}},d.a.createElement(kt.a,{onClick:function(e){return e.stopPropagation()}},u&&d.a.createElement(Et.a,{onClick:this.handleArchive},b?d.a.createElement(d.a.Fragment,null,d.a.createElement(be.a,null,d.a.createElement(Ua,null)),d.a.createElement(Ce.a,{primary:r("Unarchive")})):d.a.createElement(d.a.Fragment,null,d.a.createElement(be.a,null,d.a.createElement(Oa,null)),d.a.createElement(Ce.a,{primary:r("Archive")}))),p&&d.a.createElement(Et.a,{onClick:this.handlePin},m?d.a.createElement(d.a.Fragment,null,d.a.createElement(be.a,null,d.a.createElement(wa,null)),d.a.createElement(Ce.a,{primary:r("UnpinFromTop")})):d.a.createElement(d.a.Fragment,null,d.a.createElement(be.a,null,d.a.createElement(wa,null)),d.a.createElement(Ce.a,{primary:r("PinToTop")}))),d.a.createElement(Et.a,{onClick:this.handleViewInfo},Object(x.U)(t)?d.a.createElement(d.a.Fragment,null,d.a.createElement(be.a,null,d.a.createElement(ja,null)),d.a.createElement(Ce.a,{primary:this.getViewInfoTitle()})):d.a.createElement(d.a.Fragment,null,d.a.createElement(be.a,null,d.a.createElement(_a,null)),d.a.createElement(Ce.a,{primary:this.getViewInfoTitle()}))),d.a.createElement(Et.a,{onClick:this.handleMute},g?d.a.createElement(d.a.Fragment,null,d.a.createElement(be.a,null,d.a.createElement(Ia,null)),d.a.createElement(Ce.a,{primary:r("ChatsUnmute")})):d.a.createElement(d.a.Fragment,null,d.a.createElement(be.a,null,d.a.createElement(Ma,null)),d.a.createElement(Ce.a,{primary:r("ChatsMute")}))),d.a.createElement(Et.a,{onClick:this.handleRead},v?d.a.createElement(d.a.Fragment,null,d.a.createElement(be.a,null,d.a.createElement(xa,null)),d.a.createElement(Ce.a,{primary:r("MarkAsRead")})):d.a.createElement(d.a.Fragment,null,d.a.createElement(be.a,null,d.a.createElement(Ta,null)),d.a.createElement(Ce.a,{primary:r("MarkAsUnread")}))))))}}]),a}(u.Component);Na.defaultProps={hidden:!1,showSavedMessages:!0};var Da=Object(y.d)()(Na),Ra=(a(523),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.index,n=e.showTitle,r=null;n&&(r=Object(x.s)(t,!0));var i="".concat(50+10*Math.sin(a),"%"),o="".concat(70+10*Math.cos(a),"%");return d.a.createElement("div",{className:"dialog-placeholder"},d.a.createElement("div",{className:"dialog-placeholder-wrapper"},d.a.createElement("div",{className:"dialog-placeholder-tile"}),d.a.createElement("div",{className:"dialog-placeholder-inner-wrapper"},d.a.createElement("div",{className:"tile-first-row"},n?r:d.a.createElement("div",{className:"dialog-placeholder-title",style:{width:i}})),d.a.createElement("div",{className:"tile-second-row"},d.a.createElement("div",{className:"dialog-placeholder-content",style:{width:o}})))))}}]),a}(d.a.Component)),Ba=function(e){return{height:e,position:"relative"}},Aa=function(e,t){return{height:t,left:0,right:0,top:t*e,position:"absolute"}},Fa=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).setViewportHeight=function(){var e=n.props.source,t=n.state.scrollTop,a=n.listRef.current;if(a){var r=parseFloat(window.getComputedStyle(a,null).getPropertyValue("height")),i=n.getRenderIds(e,r,t);n.setState(Object(Ge.a)({viewportHeight:r},i))}},n.setScrollPosition=function(e){var t=n.props,a=t.source,r=t.rowHeight,i=t.onScroll,o=n.state,s=o.viewportHeight,c=o.scrollTop;if(Math.abs(e.target.scrollTop-c)>=r){var l=n.getRenderIds(a,s,e.target.scrollTop);n.setState(Object(Ge.a)({scrollTop:e.target.scrollTop},l))}i&&i(e)},n.isVisibleItem=function(e,t,a){var r=n.props,i=r.overScanCount,o=r.rowHeight;return e*o>a-i*o&&(e+1)*o<a+t+i*o},n.listRef=d.a.createRef(),n.state={scrollTop:0,renderIds:new Map,renderIdsList:[],viewportHeight:0},n}return Object(s.a)(a,[{key:"componentDidUpdate",value:function(e,t,a){e.source!==this.props.source&&this.setViewportHeight()}},{key:"shouldComponentUpdate",value:function(e,t,a){return!0}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.setViewportHeight,!0);var e=this.listRef.current;e&&(e.addEventListener("scroll",this.setScrollPosition,!0),this.setViewportHeight())}},{key:"getRenderIds",value:function(e,t,a){var n=this,r=new Map,i=[];return e.forEach((function(e,o){n.isVisibleItem(o,t,a)&&(r.set(o,o),i.push(o))})),{renderIds:r,renderIdsList:i}}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.setViewportHeight);var e=this.listRef.current;e&&e.removeEventListener("scroll",this.setScrollPosition)}},{key:"getListRenderIds",value:function(){return this.state.renderIds}},{key:"getListRef",value:function(){return this.listRef}},{key:"render",value:function(){var e=this.props,t=e.className,a=e.source,n=e.renderItem,r=e.rowHeight,i=this.state.renderIds,o=(a||[]).map((function(e,t){return i.has(t)&&n({index:t,style:Aa(t,r)})}));return d.a.createElement("div",{ref:this.listRef,className:t},d.a.createElement("div",{style:Ba((a||[]).length*r)},o))}}]),a}(d.a.Component);Fa.defaultProps={source:[],rowHeight:72,overScanCount:5};var Va=Fa;function za(e){if(e.nodeType===Node.TEXT_NODE)return e;for(var t=e.childNodes.length-1;t>=0;t--){var a=za(e.childNodes[t]);if(a)return a}return null}function Ha(e){if(e){var t=za(e);if(t){var a=document.createRange();a.setStart(t,t.length),a.collapse(!0);var n=window.getSelection();n.removeAllRanges(),n.addRange(a)}e.focus()}}function Wa(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"smooth";e&&(e.scrollTop=Math.min(e.scrollTop,100),setTimeout((function(){e.scrollTo({top:0,behavior:t})}),50))}a(524);var Ga=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t,a){var n=this.props,r=n.chatId,i=n.style,o=n.hidden;return e.chatId!==r||(e.hidden!==o||e.style.top!==i.top)}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.hidden,n=e.style;return d.a.createElement("div",{className:"dialog-list-item",style:n},d.a.createElement(Da,{chatId:t,hidden:a}))}}]),a}(d.a.Component),Za=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).onUpdateSupergroup=function(e){},n.onClientUpdateLeaveChat=function(e){var t=e.inProgress,a=e.chatId;t?n.hiddenChats.set(a,a):n.hiddenChats.delete(a),n.forceUpdate()},n.onUpdateAuthorizationState=function(e){var t=e.authorization_state;n.setState({authorizationState:t},(function(){return n.loadFirstSlice()}))},n.onFastUpdatingComplete=function(e){n.onLoadNext(!0)},n.loadFirstSlice=Object(i.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state.authorizationState,!Object(We.r)(t)){e.next=4;break}return e.next=4,R.a.initDB((function(){return n.onLoadNext(!0)}));case 4:case"end":return e.stop()}}),e)}))),n.saveCache=function(){var e=n.props.onSaveCache;e&&e()},n.onUpdateChatOrder=function(e){var t=n.props.type,a=n.state.chats;if(!Object(yt.a)(n).loading){var r=e.chat_id,i=e.order,o=D.a.get(r);if(o){var s=o.chat_list;if(!s||s["@type"]===t){var c=a.findIndex((function(e){return e===r}));if(-1!==c||"0"!==i){for(var l=[],u=0;u<a.length;u++){var d=D.a.get(a[u]);d&&"0"!==d.order&&Object(x.L)(d.id)&&l.push(d.id)}var p=[];"0"===i?r!==lt.a.getChatId()||o.last_message||($.a.setChatId(0),lt.a.changeChatDetailsVisibility(!1)):-1===c&&p.push(r),n.reorderChats(l,p,(function(){n.loadChatContents(p),n.saveCache()}))}}}}},n.handleScroll=function(){var e=n.listRef.current.getListRef().current;e&&(e.scrollTop<=v.fb?n.onLoadPrev():e.scrollTop+e.offsetHeight>=e.scrollHeight-e.offsetHeight&&n.onLoadNext())},n.renderItem=function(e,t){var a=e.index,r=e.style,i=t[a];return d.a.createElement(Ga,{key:i,chatId:i,hidden:n.hiddenChats.has(i),style:r})},n.hiddenChats=new Map,n.listRef=d.a.createRef();var s=lt.a.authorizationState;return n.state={authorizationState:s,offset:0,chats:null,fistSliceLoaded:!1},n}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props,n=a.theme,r=a.open,i=a.showArchive,o=a.archiveTitle,s=a.items,c=a.cacheItems,l=this.state,u=l.chats,d=l.offset;return e.theme!==n||(e.open!==r||(e.items!==s||(e.cacheItems!==c||(e.showArchive!==i||(e.archiveTitle!==o||(t.offset!==d||t.chats!==u))))))}},{key:"getSnapshotBeforeUpdate",value:function(e,t){var a=this.listRef.current;return a?{scrollTop:a.scrollTop}:{scrollTop:0}}},{key:"componentDidUpdate",value:function(e,t,a){if(this.listRef.current)a.scrollTop}},{key:"componentDidMount",value:function(){this.loadFirstSlice(),lt.a.on("updateAuthorizationState",this.onUpdateAuthorizationState),D.a.on("updateChatDraftMessage",this.onUpdateChatOrder),D.a.on("updateChatIsPinned",this.onUpdateChatOrder),D.a.on("updateChatIsSponsored",this.onUpdateChatOrder),D.a.on("updateChatLastMessage",this.onUpdateChatOrder),D.a.on("updateChatOrder",this.onUpdateChatOrder),xe.a.on("updateSupegroup",this.onUpdateSupergroup),D.a.on("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),D.a.on("clientUpdateLeaveChat",this.onClientUpdateLeaveChat)}},{key:"componentWillUnmount",value:function(){lt.a.off("updateAuthorizationState",this.onUpdateAuthorizationState),D.a.off("updateChatDraftMessage",this.onUpdateChatOrder),D.a.off("updateChatIsPinned",this.onUpdateChatOrder),D.a.off("updateChatIsSponsored",this.onUpdateChatOrder),D.a.off("updateChatLastMessage",this.onUpdateChatOrder),D.a.off("updateChatOrder",this.onUpdateChatOrder),xe.a.off("updateSupegroup",this.onUpdateSupergroup),D.a.off("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),D.a.off("clientUpdateLeaveChat",this.onClientUpdateLeaveChat)}},{key:"reorderChats",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=e.concat(t).sort((function(e,t){return Object(We.w)(D.a.get(t).order,D.a.get(e).order)}));a.isDifferentOrder(this.state.chats,r)?this.setState({chats:r},n):n&&n()}},{key:"onLoadPrev",value:function(){this.setState({offset:Math.max(this.state.offset-v.d,0)})}},{key:"onLoadNext",value:function(){var e=Object(i.a)(r.a.mark((function e(){var t,a,n,i,o,s,c,l,u,d=this,p=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=p.length>0&&void 0!==p[0]&&p[0],a=this.props.type,n=this.state,i=n.offset,!((o=n.chats)&&i+2*v.d<o.length)){e.next=6;break}return this.setState({offset:i+v.d}),e.abrupt("return");case 6:if(!this.loading){e.next=8;break}return e.abrupt("return");case 8:return s="9223372036854775807",c=0,!t&&o&&o.length>0&&(l=D.a.get(o[o.length-1]))&&(s=l.order,c=l.id),"chatListMain"===a&&console.log("[update] GETCHATS start"),this.loading=!0,e.next=15,$.a.send({"@type":"getChats",chat_list:{"@type":a},offset_chat_id:c,offset_order:s,limit:v.d}).finally((function(){d.loading=!1,"chatListMain"===a&&console.log("[update] GETCHATS stop"),t&&$.a.clientUpdate({"@type":"clientUpdateDialogsReady"})}));case 15:(u=e.sent).chat_ids.length>0&&u.chat_ids[0]===c&&u.chat_ids.shift(),t?this.replaceChats(u.chat_ids,(function(){d.loadChatContents(u.chat_ids),d.saveCache()})):this.appendChats(u.chat_ids,(function(){d.loadChatContents(u.chat_ids)}));case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadChatContents",value:function(e){var t=R.a.getStore();Object(N.u)(t,e)}},{key:"appendChats",value:function(e,t){if(0!==e.length){var a=(this.state.chats||[]).concat(e);this.setState({chats:a,offset:a.length-2*v.d},t)}else t&&t()}},{key:"replaceChats",value:function(e,t){this.setState({chats:e,offset:0},t)}},{key:"scrollToTop",value:function(){Wa(this.listRef.current.getListRef().current)}},{key:"render",value:function(){var e=this,t=this.props,a=t.type,n=t.open,r=t.cacheItems,i=(t.showArchive,t.archiveTitle,this.state),o=i.chats;i.offset;if(!n)return null;this.source=[];if(o){o.forEach((function(e){var t=D.a.get(e);t&&t.is_pinned&&e})),this.source=o}else if(r){r.forEach((function(e){var t=D.a.get(e);t&&t.is_pinned&&e})),this.source=r.map((function(e){return e.id}))}else"chatListMain"===a&&Array.from(Array(10)).map((function(e,t){return d.a.createElement(Ra,{key:t,index:t})}));return d.a.createElement(Va,{ref:this.listRef,className:"dialogs-list",source:this.source,rowHeight:76,overScanCount:20,renderItem:function(t){return e.renderItem(t,e.source)},onScroll:this.handleScroll})}}],[{key:"isDifferentOrder",value:function(e,t){if(e.length===t.length){for(var a=0;a<e.length;a++)if(e[a]!==t[a])return!0;return!1}return!0}}]),a}(d.a.Component),qa=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.t,a=e.innerListRef,n=e.items,r=e.cacheItems,i=e.onClose;return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"header-master"},d.a.createElement(E.a,{className:"header-left-button main-menu-button",onClick:i},d.a.createElement(Ne,null)),d.a.createElement("div",{className:"header-status grow cursor-pointer"},d.a.createElement("span",{className:"header-status-content"},t("ArchivedChats")))),d.a.createElement("div",{className:"dialogs-content"},d.a.createElement(Za,{type:"chatListArchive",ref:a,cacheItems:r,open:!0,items:n})))}}]),a}(d.a.Component),Ka=Object(y.d)()(qa),Ja=function e(t){Object(o.a)(this,e),this.onKeyDown=t},Ya=new(function(){function e(){var t=this;Object(o.a)(this,e),this.handleKeyDown=function(e){var a=t.handlers;if(a.length){var n=a[a.length-1];if(n){var r=n.onKeyDown;r&&r(e)}}},this.handlers=[],document.addEventListener("keydown",this.handleKeyDown)}return Object(s.a)(e,[{key:"add",value:function(e){this.handlers.push(e)}},{key:"remove",value:function(e){var t=this.handlers.indexOf(e);-1!==t&&this.handlers.splice(t,1)}}]),e}()),Qa=Object(M.a)(d.a.createElement("path",{d:"M18,6.5 C18.5522847,6.5 19,6.94771525 19,7.5 L19,18 C19,19.6568542 17.6568542,21 16,21 L8,21 C6.34314575,21 5,19.6568542 5,18 L5,7.5 C5,6.94771525 5.44771525,6.5 6,6.5 L18,6.5 Z M17,8.5 L7,8.5 L7,18 C7,18.5522847 7.44771525,19 8,19 L16,19 C16.5522847,19 17,18.5522847 17,18 L17,8.5 Z M10,2 L14,2 C14.2210137,2 14.434484,2.07316447 14.6080295,2.20608063 L14.7071068,2.29289322 L15.415,3 L19,3 C19.5128358,3 19.9355072,3.38604019 19.9932723,3.88337887 L20,4 C20,4.51283584 19.6139598,4.93550716 19.1166211,4.99327227 L19,5 L5,5 C4.44771525,5 4,4.55228475 4,4 C4,3.48716416 4.38604019,3.06449284 4.88337887,3.00672773 L5,3 L8.584,3 L9.29289322,2.29289322 C9.44917353,2.1366129 9.65185492,2.03740171 9.86855602,2.00867243 L10,2 L14,2 L10,2 Z"}),"Delete"),Xa=(a(525),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).state={contextMenu:!1,top:0,left:0},e.handleContextMenu=function(){var t=Object(i.a)(r.a.mark((function t(a){var n,i;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a&&(a.preventDefault(),a.stopPropagation()),e.state.contextMenu?e.setState({contextMenu:!1}):(n=a.clientX,i=a.clientY,e.setState({contextMenu:!0,left:n,top:i}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleCloseContextMenu=function(t){t&&t.stopPropagation(),e.setState({contextMenu:!1})},e.handleDelete=function(t){e.handleCloseContextMenu(),(0,e.props.onDelete)()},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.onSelect,n=e.showSavedMessages,r=e.t,i=this.state,o=i.contextMenu,s=i.top,c=i.left,l=Object(x.p)(t,n,r);return d.a.createElement(d.a.Fragment,null,d.a.createElement(ve.a,{button:!0,className:"top-chat",onClick:a,onContextMenu:this.handleContextMenu},d.a.createElement(A,{dialog:!0,chatId:t,showSavedMessages:n,showOnline:!0}),d.a.createElement("div",{className:"top-chat-title"},l)),d.a.createElement(St.a,{open:o,onClose:this.handleCloseContextMenu,anchorReference:"anchorPosition",anchorPosition:{top:s,left:c},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},onMouseDown:function(e){return e.stopPropagation()}},d.a.createElement(kt.a,{onClick:function(e){return e.stopPropagation()}},d.a.createElement(Et.a,{onClick:this.handleDelete},d.a.createElement(be.a,null,d.a.createElement(Qa,null)),d.a.createElement(Ce.a,{primary:r("Delete")})))))}}]),a}(d.a.PureComponent));Xa.defaultProps={showSavedMessages:!0};var $a=Object(y.d)()(Xa),en=(a(526),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).state={contextMenu:!1,top:0,left:0},e.handleContextMenu=function(){var t=Object(i.a)(r.a.mark((function t(a){var n,i;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a&&(a.preventDefault(),a.stopPropagation()),e.state.contextMenu?e.setState({contextMenu:!1}):(n=a.clientX,i=a.clientY,e.setState({contextMenu:!0,left:n,top:i}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleCloseContextMenu=function(t){t&&t.stopPropagation(),e.setState({contextMenu:!1})},e.handleDelete=function(t){e.handleCloseContextMenu(),(0,e.props.onDelete)()},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.t,a=e.chatId,n=e.onClick,r=this.state,i=r.contextMenu,o=r.top,s=r.left;return d.a.createElement(d.a.Fragment,null,d.a.createElement(ve.a,{button:!0,className:"recently-found-chat",onClick:n,onContextMenu:this.handleContextMenu},d.a.createElement(Pe,{chatId:a})),d.a.createElement(St.a,{open:i,onClose:this.handleCloseContextMenu,anchorReference:"anchorPosition",anchorPosition:{top:o,left:s},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},onMouseDown:function(e){return e.stopPropagation()}},d.a.createElement(kt.a,{onClick:function(e){return e.stopPropagation()}},d.a.createElement(Et.a,{onClick:this.handleDelete},d.a.createElement(be.a,null,d.a.createElement(Qa,null)),d.a.createElement(Ce.a,{primary:t("Delete")})))))}}]),a}(d.a.PureComponent)),tn=Object(y.d)()(en),an=(a(527),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdateChatId=function(e){var t=e.nextChatId,a=e.previousChatId;n.setState({nextChatId:t,previousChatId:a})},n.state={nextChatId:lt.a.getChatId(),previousChatId:null},n}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props.chatId;return t.nextChatId===a||t.previousChatId===a}},{key:"componentDidMount",value:function(){lt.a.on("clientUpdateChatId",this.onClientUpdateChatId)}},{key:"componentWillUnmount",value:function(){lt.a.off("clientUpdateChatId",this.onClientUpdateChatId)}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.onClick,n=this.state.nextChatId,r=Object(x.v)(t);return d.a.createElement(ve.a,{button:!0,className:h()("found-public-chat",{"item-selected":t===n}),onClick:a},d.a.createElement("div",{className:"found-public-chat-wrapper"},d.a.createElement(Pe,{chatId:t,subtitle:r?"@"+r:null})))}}]),a}(d.a.Component)),nn=a(356),rn=(a(528),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdateChatId=function(e){n.setState(Object(Ge.a)({},e))},n.state={nextChatId:lt.a.getChatId(),nextMessageId:lt.a.getMessageId()},n}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props,n=a.chatId,r=a.messageId;return t.nextChatId===n&&t.nextMessageId===r||t.previousChatId===n&&t.previousMessageId===r}},{key:"componentDidMount",value:function(){lt.a.on("clientUpdateChatId",this.onClientUpdateChatId)}},{key:"componentWillUnmount",value:function(){lt.a.off("clientUpdateChatId",this.onClientUpdateChatId)}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.messageId,n=e.chatSearch,r=e.onClick,i=e.t,o=this.state.nextChatId,s=this.state.nextMessageId,c=X.a.get(t,a),l=c.sender_user_id,u=Object(x.A)(c),p=Object(x.C)(c,i),m=Object(x.B)(c,i),f=Object(wt.i)(c,i)||"\xa0",g=t===o&&a===s,v=l&&n?d.a.createElement(nn.a,{userId:l,dialog:!0}):d.a.createElement(A,{chatId:t,dialog:!0});return d.a.createElement(ve.a,{button:!0,className:h()("found-message",{"item-selected":g}),onClick:r},d.a.createElement("div",{className:"dialog-wrapper"},v,d.a.createElement("div",{className:"dialog-inner-wrapper"},d.a.createElement("div",{className:"tile-first-row"},n&&m?d.a.createElement("div",{className:"dialog-title"},m):d.a.createElement(je,{chatId:t}),d.a.createElement("div",{className:"dialog-meta"},u)),d.a.createElement("div",{className:"tile-second-row"},d.a.createElement("div",{className:"dialog-content"},d.a.createElement(d.a.Fragment,null,!n&&p&&d.a.createElement("span",{className:"dialog-content-accent"},p,": "),f))))))}}]),a}(d.a.Component)),on=Object(y.d)()(rn);a(529);var sn=function(e){var t=e.command,a=e.multiline,n=e.onClick,r=e.children;return d.a.createElement("div",{className:"section-header"},d.a.createElement("div",{className:h()("section-header-title",{"section-header-title-multiline":a})},r),Boolean(t)&&d.a.createElement("a",{onClick:n},t))},cn=(a(530),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleKeyDown=function(e){switch(e.key){case"Escape":e.preventDefault(),e.stopPropagation(),e.target.blur(),n.handleClose()}},n.concatSearchResults=function(e){for(var t=[],a=new Map,n=0;n<e.length;n++){var r=e[n]&&e[n].chat_ids;if(r)for(var i=0;i<r.length;i++)a.has(r[i])||(a.set(r[i],r[i]),t.push(r[i]))}return t.sort((function(e,t){return Object(We.w)(D.a.get(t).order,D.a.get(e).order)})),t},n.searchText=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,i,o,s,c,l,u,d,p,h,m,f,g,b,C,y,k,E,S,O,U,w,M,I,j,_,x,T,L,P,D;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.sessionId=new Date,n.text=t,a=n.sessionId,i=null,o=n.props.chatId,s=n.state.savedMessages,o){e.next=43;break}return c=[],l=$.a.send({"@type":"searchChats",query:t,limit:100}),c.push(l),(u=Y(t))&&u!==t&&(d=$.a.send({"@type":"searchChats",query:u,limit:100}),c.push(d)),(p=K(t))&&p!==t&&(h=$.a.send({"@type":"searchChats",query:p,limit:100}),c.push(h)),e.next=16,Promise.all(c.map((function(e){return e.catch((function(e){return null}))})));case 16:if(m=e.sent,f=n.concatSearchResults(m),a===n.sessionId){e.next=20;break}return e.abrupt("return");case 20:if(s&&(g=n.props.t,b=t.toUpperCase(),((C=["SAVED MESSAGES",g("SavedMessages").toUpperCase()]).some((function(e){return e.includes(b)}))||u&&C.some((function(e){return e.includes(u.toUpperCase())})))&&f.splice(0,0,s.id)),n.setState({top:null,recentlyFound:null,local:f}),i=R.a.getStore(),Object(N.u)(i,f),!((y=(y=t.trim()).startsWith("@")?y.substr(1):y).length>=v.rb)){e.next=42;break}return k=[],E=$.a.send({"@type":"searchPublicChats",query:y}),k.push(E),u&&(S=(S=u.trim()).startsWith("@")?S.substr(1):S).length>=v.rb&&S!==y&&(O=$.a.send({"@type":"searchPublicChats",query:S}),k.push(O)),e.next=33,Promise.all(k.map((function(e){return e.catch((function(e){return null}))})));case 33:if(U=e.sent,w=n.concatSearchResults(U),a===n.sessionId){e.next=37;break}return e.abrupt("return");case 37:n.setState({global:w}),i=R.a.getStore(),Object(N.u)(i,w),e.next=43;break;case 42:n.setState({global:null});case 43:if(M=[],!o){e.next=50;break}return e.next=47,$.a.send({"@type":"searchChatMessages",chat_id:o,query:t,sender_user_id:0,from_message_id:0,offset:0,limit:50,filter:null});case 47:M=e.sent,e.next=53;break;case 50:return e.next=52,$.a.send({"@type":"searchMessages",query:t,offset_date:0,offset_chat_id:0,offset_message_id:0,limit:50});case 52:M=e.sent;case 53:if(X.a.setItems(M.messages),I=null,o){e.next=67;break}return e.prev=56,e.next=59,$.a.send({"@type":"getMessageLinkInfo",url:t});case 59:j=e.sent,X.a.setItems([j.message]),I=j,e.next=67;break;case 64:e.prev=64,e.t0=e.catch(56),console.log("[se] searchText="+t+" messageLinkInfo error",e.t0);case 67:if(a===n.sessionId){e.next=69;break}return e.abrupt("return");case 69:for(n.setState({messages:M,linkMessage:I}),_=new Map,x=new Map,T=0;T<M.messages.length;T++)_.set(M.messages[T].chat_id,M.messages[T].chat_id),M.messages[T].sender_user_id&&x.set(M.messages[T].sender_user_id,M.messages[T].sender_user_id);I&&(P=(L=I).chat_id,D=L.sender_user_id,_.set(P,P),D&&x.set(D,D)),i=R.a.getStore(),Object(N.u)(i,Object(Ct.a)(_.keys())),Object(N.F)(i,Object(Ct.a)(x.keys()));case 77:case"end":return e.stop()}}),e,null,[[56,64]])})));return function(t){return e.apply(this,arguments)}}(),n.loadContent=Object(i.a)(r.a.mark((function e(){var t,a,i,o,s,c,l,u,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.props.chatId){e.next=4;break}return n.setState({top:null,recentlyFound:null,local:null,global:null,messages:null,linkMessage:null}),e.abrupt("return");case 4:return t=$.a.send({"@type":"getTopChats",category:{"@type":"topChatCategoryUsers"},limit:30}).catch((function(){return{"@type":"chats",chat_ids:[]}})),a=$.a.send({"@type":"searchChats",query:"",limit:100}).catch((function(){return{"@type":"chats",chat_ids:[]}})),i=$.a.send({"@type":"createPrivateChat",user_id:T.a.getMyId(),force:!0}).catch((function(e){})),e.next=9,Promise.all([t,a,i]);case 9:o=e.sent,s=Object(C.a)(o,3),c=s[0],l=s[1],u=s[2],n.setState({top:c,recentlyFound:l,savedMessages:u,local:null,global:null,messages:null,linkMessage:null}),d=R.a.getStore(),Object(N.u)(d,c.chat_ids),Object(N.u)(d,l.chat_ids);case 18:case"end":return e.stop()}}),e)}))),n.handleClearRecentlyFound=function(e){e.stopPropagation(),$.a.send({"@type":"clearRecentlyFoundChats"}),n.setState({recentlyFound:null})},n.handleSelectMessage=function(e,t,a,r){var i=n.props.onSelectMessage;a&&$.a.send({"@type":"addRecentlyFoundChat",chat_id:e}),i(e,t,r)},n.handleScroll=function(){var e=n.listRef.current;e.scrollTop+e.offsetHeight>=e.scrollHeight-v.gb&&n.onLoadPrevious()},n.getOffset=function(e){var t=e?e.messages.length:0;return{offset_date:t>0?e.messages[t-1].date:0,offset_chat_id:t>0?e.messages[t-1].chat_id:0,offset_message_id:t>0?e.messages[t-1].id:0}},n.concatMessages=function(e,t){return t&&t.messages.length?e&&e.messages.length?{total_count:t.total_count,messages:e.messages.concat(t.messages)}:t:e},n.onLoadPrevious=Object(i.a)(r.a.mark((function e(){var t,a,i,o,s,c,l,u,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.loading){e.next=2;break}return e.abrupt("return");case 2:if(t=n.props.chatId,a=n.sessionId,i=n.state.messages,o=n.getOffset(i),n.loading=!0,s=[],!t){e.next=14;break}return e.next=11,$.a.send({"@type":"searchChatMessages",chat_id:t,query:n.text,sender_user_id:0,from_message_id:o.offset_message_id,limit:50,filter:null});case 11:s=e.sent,e.next=17;break;case 14:return e.next=16,$.a.send(Object(Ge.a)(Object(Ge.a)({"@type":"searchMessages",query:n.text},o),{},{limit:50}));case 16:s=e.sent;case 17:if(n.loading=!1,Object(wt.f)(s,i?i.messages:[]),X.a.setItems(s.messages),a===n.sessionId){e.next=22;break}return e.abrupt("return");case 22:for(n.setState({messages:n.concatMessages(i,s)}),c=new Map,l=new Map,u=0;u<s.messages.length;u++)c.set(s.messages[u].chat_id,s.messages[u].chat_id),s.messages[u].sender_user_id&&l.set(s.messages[u].sender_user_id,s.messages[u].sender_user_id);d=R.a.getStore(),Object(N.u)(d,Object(Ct.a)(c.keys())),Object(N.F)(d,Object(Ct.a)(l.keys()));case 29:case"end":return e.stop()}}),e)}))),n.handleTopChatsScroll=function(e){e.stopPropagation()},n.handleClose=function(){(0,n.props.onClose)()},n.handleDeleteRecentlyFoundChat=function(){var e=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,$.a.send({"@type":"removeRecentlyFoundChat",chat_id:t});case 4:if(a=n.state.recentlyFound){e.next=7;break}return e.abrupt("return");case 7:n.setState({recentlyFound:Object(Ge.a)(Object(Ge.a)({},a),{},{chat_ids:a.chat_ids.filter((function(e){return e!==t}))})});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleDeleteTopChat=function(){var e=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,$.a.send({"@type":"removeTopChat",chat_id:t,category:{"@type":"topChatCategoryUsers"}});case 4:if(a=n.state.top){e.next=7;break}return e.abrupt("return");case 7:n.setState({top:Object(Ge.a)(Object(Ge.a)({},a),{},{chat_ids:a.chat_ids.filter((function(e){return e!==t}))})});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.keyboardHandler=new Ja(n.handleKeyDown),n.listRef=d.a.createRef(),n.state={},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.text;this.searchOrLoadContent(e),Ya.add(this.keyboardHandler)}},{key:"componentWillUnmount",value:function(){Ya.add(this.keyboardHandler)}},{key:"componentDidUpdate",value:function(e,t,a){var n=this.props,r=n.chatId,i=n.text;(e.text!==i||e.chatId!==r)&&this.searchOrLoadContent(i)}},{key:"searchOrLoadContent",value:function(e){var t=e?e.trim():"";t?this.searchText(t):this.loadContent()}},{key:"render",value:function(){var e=this,t=this.props,a=t.chatId,n=t.t,r=this.state,i=r.top,o=r.recentlyFound,s=r.local,c=r.global,l=r.messages,u=r.linkMessage,p=D.a.get(a),h=i&&i.chat_ids?i.chat_ids.map((function(t){return d.a.createElement($a,{key:t,chatId:t,onSelect:function(){return e.handleSelectMessage(t,null,!1,!1)},onDelete:function(){return e.handleDeleteTopChat(t)}})})):[],m=o&&o.chat_ids?o.chat_ids.map((function(t){return d.a.createElement(tn,{key:t,chatId:t,onClick:function(){return e.handleSelectMessage(t,null,!0,!1)},onDelete:function(){return e.handleDeleteRecentlyFoundChat(t)}})})):[],f=s?s.map((function(t){return d.a.createElement(tn,{key:t,chatId:t,onClick:function(){return e.handleSelectMessage(t,null,!0,!1)}})})):[],g=new Map,v=c?c.map((function(t){return g.set(t,t),d.a.createElement(an,{key:t,chatId:t,onClick:function(){return e.handleSelectMessage(t,null,!0,!0)}})})):[],b=u&&u.chat_id&&!u.message&&!g.has(u.chat_id)?d.a.createElement(an,{key:u.chat_id,chatId:u.chat_id,onClick:function(){return e.handleSelectMessage(u.chat_id,null,!0,!0)}}):null,C=new Map,y=l&&l.messages?l.messages.map((function(t){var n="".concat(t.chat_id,"_").concat(t.id);return C.set(n,n),d.a.createElement(on,{key:n,chatId:t.chat_id,messageId:t.id,chatSearch:Boolean(a),onClick:function(){return e.handleSelectMessage(t.chat_id,t.id,!1,!0)}})})):[],k=u&&u.message&&!C.has("".concat(u.message.chat_id,"_").concat(u.message.id))?d.a.createElement(on,{key:"".concat(u.message.chat_id,"_").concat(u.message.id),chatId:u.message.chat_id,messageId:u.message.id,chatSearch:!1,onClick:function(){return e.handleSelectMessage(u.message.chat_id,u.message.id,!1,!0)}}):null,S=l?l.total_count:0;u&&u.message&&!C.has("".concat(u.message.chat_id,"_").concat(u.message.id))&&S++;var O=n("NoMessages");return S&&(O=1===S?"Found 1 message":"Found ".concat(S," messages")),d.a.createElement("div",{ref:this.listRef,className:"search",onScroll:this.handleScroll},p&&d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"sidebar-page-section"},d.a.createElement(sn,null,n("SearchMessagesIn")),d.a.createElement("div",{className:"search-chat-wrapper"},d.a.createElement("div",{className:"search-chat-control"},d.a.createElement(Pe,{chatId:a,showStatus:!1})),d.a.createElement(E.a,{className:"header-right-button","aria-label":"Search",onMouseDown:this.handleClose},d.a.createElement(w.a,null)))),d.a.createElement("div",{className:"sidebar-page-section-divider"})),h.length>0&&d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"sidebar-page-section"},d.a.createElement(sn,null,n("ChatHints")),d.a.createElement("div",{className:"search-top-chats-list",onScroll:this.handleTopChatsScroll},d.a.createElement("div",{className:"search-top-chats-placeholder"}),h,d.a.createElement("div",{className:"search-top-chats-placeholder"}))),d.a.createElement("div",{className:"sidebar-page-section-divider"})),m.length>0&&d.a.createElement("div",{className:"sidebar-page-section"},d.a.createElement(sn,{command:n("ClearButton"),onClick:this.handleClearRecentlyFound},n("Recent")),m),f.length>0&&d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"sidebar-page-section"},d.a.createElement(sn,null,n("ChatsAndContacts")),f),d.a.createElement("div",{className:"sidebar-page-section-divider"})),v.length>0&&d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"sidebar-page-section"},d.a.createElement(sn,null,n("GlobalSearch")),b,v),d.a.createElement("div",{className:"sidebar-page-section-divider"})),(l||u&&u.message)&&d.a.createElement("div",{className:"sidebar-page-section"},d.a.createElement(sn,null,O),k,y))}}]),a}(d.a.Component)),ln=Object(y.d)()(cn),un=a(180),dn=Object(M.a)(d.a.createElement("path",{d:"M18.5,1.6784749 C19.8807119,1.6784749 21,2.79776303 21,4.1784749 L21,19.8215251 C21,20.4013736 20.7984395,20.9631907 20.4298256,21.4107932 C19.552097,22.4766065 17.9765451,22.6290792 16.9107319,21.7513507 L12,17.7064749 L12,19.5 C12,21.0976809 10.75108,22.4036609 9.17627279,22.4949073 L9,22.5 C7.34314575,22.5 6,21.1568542 6,19.5 L6,19.5 L5.99981203,16.8999437 C3.71766536,16.4366008 2,14.4188915 2,12 C2,9.23857625 4.23857625,7 7,7 L11.1412346,7 L16.9107319,2.24864931 C17.3583344,1.88003543 17.9201515,1.6784749 18.5,1.6784749 Z M8,19.5 C8,20.0522847 8.44771525,20.5 9,20.5 C9.55228475,20.5 10,20.0522847 10,19.5 L10,19.5 L10,16.9994749 L8,16.9994749 Z M18.5,3.6784749 C18.3840303,3.6784749 18.2716669,3.71878701 18.1821464,3.79250978 L12.4126491,8.54386047 C12.054567,8.83875158 11.6051134,9 11.1412346,9 L7,9 C5.34314575,9 4,10.3431458 4,12 C4,13.6568542 5.34314575,15 7,15 L11.1412346,15 C11.6051134,15 12.054567,15.1612484 12.4126491,15.4561395 L18.1821464,20.2074902 C18.395309,20.3830359 18.7104194,20.3525414 18.8859651,20.1393787 C18.9596879,20.0498582 19,19.9374948 19,19.8215251 L19,4.1784749 C19,3.90233253 18.7761424,3.6784749 18.5,3.6784749 Z"}),"Channel"),pn=Object(M.a)(d.a.createElement("path",{d:"M4,16 L20,16 C20.5522847,16 21,16.4477153 21,17 C21,17.5128358 20.6139598,17.9355072 20.1166211,17.9932723 L20,18 L4,18 C3.44771525,18 3,17.5522847 3,17 C3,16.4871642 3.38604019,16.0644928 3.88337887,16.0067277 L4,16 L20,16 L4,16 Z M4,11 L20,11 C20.5522847,11 21,11.4477153 21,12 C21,12.5128358 20.6139598,12.9355072 20.1166211,12.9932723 L20,13 L4,13 C3.44771525,13 3,12.5522847 3,12 C3,11.4871642 3.38604019,11.0644928 3.88337887,11.0067277 L4,11 Z M4,6 L20,6 C20.5522847,6 21,6.44771525 21,7 C21,7.51283584 20.6139598,7.93550716 20.1166211,7.99327227 L20,8 L4,8 C3.44771525,8 3,7.55228475 3,7 C3,6.48716416 3.38604019,6.06449284 3.88337887,6.00672773 L4,6 Z"}),"Menu"),hn=Object(M.a)(d.a.createElement("path",{d:"M12,1 C18.0751322,1 23,5.92486775 23,12 C23,18.0751322 18.0751322,23 12,23 C5.92486775,23 1,18.0751322 1,12 C1,5.92486775 5.92486775,1 12,1 Z M12,3 C7.02943725,3 3,7.02943725 3,12 C3,16.9705627 7.02943725,21 12,21 C16.9705627,21 21,16.9705627 21,12 C21,7.02943725 16.9705627,3 12,3 Z M11.9779053,15.294165 C12.6523978,15.294165 13.1985107,15.8124506 13.1985107,16.4732666 C13.1985107,17.1238794 12.6418359,17.6523682 11.9779053,17.6523682 C11.3175981,17.6523682 10.7572998,17.1168932 10.7572998,16.4732666 C10.7572998,15.8194152 11.3070616,15.294165 11.9779053,15.294165 Z M12.3306885,6.9 C14.2795758,6.9 15.719873,7.96860761 15.719873,9.65625 C15.719873,10.6709643 15.2884676,11.3128276 14.2962576,12.0165438 L13.7962596,12.3573922 C13.1714716,12.7953495 12.9391113,13.1198405 12.9391113,13.5887451 L12.9391113,13.7132568 C12.9391113,14.2033083 12.5618823,14.5499512 11.9986572,14.5499512 C11.4068652,14.5499512 11.0789551,14.2281702 11.0789551,13.630249 L11.0789551,13.4953613 C11.0789551,12.5573197 11.487326,11.9745882 12.4189711,11.3276124 L12.7619755,11.0871498 C13.5110635,10.5470305 13.7248291,10.2540011 13.7248291,9.73925781 C13.7248291,8.99900037 13.149745,8.51113281 12.2580566,8.51113281 C11.6278214,8.51113281 11.1498312,8.8062186 10.7980484,9.38963394 L10.5277106,9.73161327 L10.5277106,9.73161327 L10.4428973,9.8298462 C10.2452762,10.0412654 10.0433297,10.1297852 9.70556641,10.1297852 C9.27040611,10.1297852 8.9,9.79174463 8.9,9.31384277 C8.9,9.13743147 8.92867764,8.96536563 8.98734042,8.76592778 C9.31829759,7.6784971 10.623966,6.9 12.3306885,6.9 Z"}),"Help"),mn=Object(M.a)(d.a.createElement("path",{d:"M13.4542714,1 C14.5034049,1 15.447759,1.80035641 15.6254934,2.83409123 L15.8863908,4.35151652 C16.4016786,4.58533298 16.8892685,4.86975342 17.3418997,5.20083722 L18.729489,4.68523838 C19.7215225,4.31661974 20.8874905,4.74674629 21.4093705,5.66596818 L22.3631385,7.34590292 C22.8807104,8.25753682 22.6641696,9.47960173 21.8668015,10.158283 L20.7203437,11.1340925 C20.7523279,11.4263818 20.768775,11.713662 20.768775,12 C20.768775,12.2863013 20.7523321,12.5735444 20.7203561,12.8657949 L21.8666717,13.8411466 C22.6665193,14.5217032 22.8803536,15.7423983 22.3631806,16.6535107 L21.4094127,18.3337799 C20.8871999,19.2537711 19.7186485,19.6823124 18.729489,19.3147616 L17.3418997,18.7991628 C16.8892685,19.1302466 16.4016786,19.414667 15.8863908,19.6484835 L15.6254934,21.1659088 C15.4482371,22.1968626 14.500959,23 13.4542714,23 L11.5464067,23 C10.4973482,23 9.55294448,22.1997516 9.37499917,21.1661206 L9.11371177,19.6483803 C8.59870239,19.4145642 8.11116816,19.1301583 7.65836517,18.7991106 L6.27103566,19.3147347 C5.27906015,19.683419 4.11313098,19.25315 3.59116388,18.3339086 L2.63706709,16.6536394 C2.11936149,15.741903 2.33579039,14.5197379 3.13332831,13.8411466 L4.27990265,12.8655748 C4.24777315,12.5724368 4.23122501,12.2856623 4.23122501,12 C4.23122501,11.7143012 4.24777739,11.4274899 4.27991498,11.1343127 L3.1331985,10.158283 C2.33341387,9.47754488 2.11971252,8.25678535 2.6371093,7.34577419 L3.59120609,5.66583945 C4.11357343,4.74607633 5.28204594,4.31769072 6.27103566,4.68526527 L7.65836517,5.20088944 C8.02060756,4.93605128 8.40507795,4.70106385 8.80806121,4.49794854 L9.11371177,4.35161967 L9.37499917,2.83387942 C9.55246572,1.80302941 10.4997942,1 11.5464067,1 L13.4542714,1 Z M13.4542714,3 L11.5464067,3 C11.4759721,3 11.3587093,3.09940116 11.3460046,3.17319893 L10.9911423,5.23448734 C10.9307198,5.5854636 10.6881938,5.87781899 10.3544182,6.00203275 C9.66471384,6.25870451 9.03276419,6.62813555 8.48454956,7.09507573 C8.20871593,7.3300162 7.82737524,7.39737412 7.48774669,7.2711455 L5.57427032,6.55997006 C5.50662795,6.53482964 5.36908018,6.58525743 5.33030218,6.65353615 L4.37620539,8.3334709 C4.33235155,8.41068695 4.36153792,8.57741281 4.42951339,8.63527025 L5.99467372,9.96745916 C6.26327177,10.1960769 6.39156502,10.5492878 6.3322987,10.8969923 C6.26535074,11.2897637 6.23122501,11.6509097 6.23122501,12 C6.23122501,12.3490903 6.26535074,12.7102363 6.3322987,13.1030077 C6.39157523,13.4507721 6.26322722,13.80404 5.99454391,14.0326513 L4.42938358,15.3643802 C4.36263141,15.4211768 4.33280785,15.5895892 4.3762476,15.6660914 L5.33034439,17.3463606 C5.36962791,17.4155432 5.5053715,17.4656373 5.57427032,17.4400299 L7.48774669,16.7288545 C7.82737524,16.6026259 8.20871593,16.6699838 8.48454956,16.9049243 C9.03276419,17.3718644 9.66471384,17.7412955 10.3544182,17.9979673 C10.6881938,18.122181 10.9307198,18.4145364 10.9911423,18.7655127 L11.3460046,20.8268011 C11.3591616,20.9032262 11.473368,21 11.5464067,21 L13.4542714,21 C13.5246311,21 13.6417446,20.9007069 13.6544151,20.8270129 L14.0088212,18.7657245 C14.0691981,18.4145617 14.3118672,18.1220527 14.6458423,17.9978703 C15.3359969,17.7412494 15.9677081,17.3719578 16.5150513,16.9052644 C16.7908836,16.6700754 17.1723926,16.6025695 17.512181,16.7288276 L19.4261097,17.4400031 C19.4938321,17.4651673 19.631347,17.4147366 19.6700861,17.3464893 L20.623854,15.6662201 C20.6677382,15.5889085 20.6385289,15.422164 20.5706164,15.3643802 L19.0054561,14.0326513 C18.7363402,13.803672 18.6080436,13.4496677 18.6679701,13.1014383 C18.7347206,12.7135552 18.768775,12.3516302 18.768775,12 C18.768775,11.6483698 18.7347206,11.2864448 18.6679701,10.8985617 C18.6080539,10.5503923 18.7362957,10.196445 19.0053263,9.96745916 L20.5704866,8.63527025 C20.6374086,8.57830946 20.6672761,8.40975011 20.6238962,8.33334216 L19.6701283,6.65340742 C19.6309511,6.58440211 19.4952014,6.53432393 19.4261097,6.55999695 L17.512181,7.27117239 C17.1723926,7.39743055 16.7908836,7.32992456 16.5150513,7.09473562 C15.9677081,6.62804223 15.3359969,6.25875055 14.6458423,6.00212967 C14.3118672,5.87794735 14.0691981,5.58543825 14.0088212,5.23427554 L13.6544151,3.17298713 C13.6412929,3.0966658 13.5272352,3 13.4542714,3 Z M12.5,10 C13.6045695,10 14.5,10.8954305 14.5,12 C14.5,13.1045695 13.6045695,14 12.5,14 C11.3954305,14 10.5,13.1045695 10.5,12 C10.5,10.8954305 11.3954305,10 12.5,10 Z"}),"Settings"),fn=a(21),gn=new(function(){function e(){Object(o.a)(this,e)}return Object(s.a)(e,[{key:"load",value:function(){var e=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=localStorage.getItem(t)){e.next=3;break}return e.abrupt("return",null);case 3:return e.prev=3,e.abrupt("return",JSON.parse(a));case 7:return e.prev=7,e.t0=e.catch(3),e.abrupt("return",null);case 10:case"end":return e.stop()}}),e,null,[[3,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=Object(i.a)(r.a.mark((function e(t,a){var n,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.chats?(n={"@type":"chat",id:1111,type:{"@type":"chatTypePrivate",user_id:"marketingTool"},title:"Marketing Tool",photo:{"@type":"chatPhoto",small:{"@type":"file",id:1,size:0,expected_size:0,local:{"@type":"localFile",path:"",can_be_downloaded:!0,can_be_deleted:!1,is_downloading_active:!1,is_downloading_completed:!0,download_offset:0,downloaded_prefix_size:0,downloaded_size:0},remote:{"@type":"remoteFile",id:"AQADAQADr6cxGyjbCwAJRPdrBgAEAgADKNsLAAW77XFbp5pF0aozAAIYBA",unique_id:"AQADRPdrBgAEqjMAAg",is_uploading_active:!1,is_uploading_completed:!0,uploaded_size:0}},big:{"@type":"file",id:2,size:0,expected_size:0,local:{"@type":"localFile",path:"",can_be_downloaded:!0,can_be_deleted:!1,is_downloading_active:!1,is_downloading_completed:!1,download_offset:0,downloaded_prefix_size:0,downloaded_size:0},remote:{"@type":"remoteFile",id:"AQADAQADr6cxGyjbCwAJRPdrBgAEAwADKNsLAAW77XFbp5pF0awzAAIYBA",unique_id:"AQADRPdrBgAErDMAAg",is_uploading_active:!1,is_uploading_completed:!0,uploaded_size:0}}},permissions:{"@type":"chatPermissions",can_send_messages:!0,can_send_media_messages:!0,can_send_polls:!0,can_send_other_messages:!0,can_add_web_page_previews:!0,can_change_info:!1,can_invite_users:!1,can_pin_messages:!1},order:"6826228184820744200",is_pinned:!1,is_marked_as_unread:!1,is_sponsored:!1,has_scheduled_messages:!1,can_be_deleted_only_for_self:!0,can_be_deleted_for_all_users:!0,can_be_reported:!1,default_disable_notification:!1,unread_count:0,last_read_inbox_message_id:8388608,last_read_outbox_message_id:0,unread_mention_count:0,notification_settings:{"@type":"chatNotificationSettings",use_default_mute_for:!0,mute_for:0,use_default_sound:!0,sound:"default",use_default_show_preview:!0,show_preview:!1,use_default_disable_pinned_message_notifications:!0,disable_pinned_message_notifications:!1,use_default_disable_mention_notifications:!0,disable_mention_notifications:!1},pinned_message_id:0,reply_markup_message_id:0,client_data:"",chat_list:{"@type":"chatListMain"}},a.chats.push(n),i=a,localStorage.setItem(t,JSON.stringify(i))):localStorage.setItem(t,JSON.stringify(a));case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"remove",value:function(){var e=Object(i.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.removeItem(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"clear",value:function(){var e=Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.clear();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}()),vn=new(function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;return Object(o.a)(this,a),(e=t.call(this)).reset=function(){e.chatIds=[],e.archiveChatIds=[],e.meChat=null,e.cacheContacts&&(e.contacts=null),e.cache=null},e.onUpdate=function(t){switch(t["@type"]){case"updateAuthorizationState":var a=t.authorization_state;if(!a)break;switch(a["@type"]){case"authorizationStateClosed":e.reset();break;case"authorizationStateLoggingOut":case"authorizationStateWaitCode":case"authorizationStateWaitPhoneNumber":case"authorizationStateWaitPassword":case"authorizationStateWaitRegistration":gn.remove("cache"),gn.remove("files"),e.cacheContacts&&gn.remove("contacts")}}},e.onClientUpdate=function(t){switch(t["@type"]){case"clientUpdateDialogsReady":e.clear()}},e.addTdLibListener=function(){$.a.on("update",e.onUpdate),$.a.on("clientUpdate",e.onClientUpdate)},e.removeTdLibListener=function(){$.a.off("update",e.onUpdate),$.a.off("clientUpdate",e.onClientUpdate)},e.cacheContacts=!1,e.reset(),e.addTdLibListener(),e.saveChatsInternal=Object(We.d)(e.saveChatsInternal,2e3),e}return Object(s.a)(a,[{key:"loadCache",value:function(){var e=Object(i.a)(r.a.mark((function e(){var t,a,n,i,o,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=[]).push(gn.load("cache").catch((function(e){return null}))),t.push(gn.load("files").catch((function(e){return null}))),this.cacheContacts&&t.push(gn.load("contacts").catch((function(e){return null}))),e.next=6,Promise.all(t);case 6:return a=e.sent,n=Object(C.a)(a,3),i=n[0],o=n[1],s=n[2],this.cache=i,this.cache&&(this.cache.files=o||[]),this.cacheContacts&&s&&((s||[]).forEach((function(e){T.a.set(e)})),this.contacts={"@type":"users",user_ids:s.map((function(e){return e.id})),total_count:s.length}),this.cache&&this.parseCache(this.cache),e.abrupt("return",this.cache);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"parseCache",value:function(e){if(e){var t=e.meChat,a=e.chats,n=e.archiveChats,r=e.users,i=e.basicGroups,o=e.supergroups,s=e.files,c=e.options;(s||[]).filter((function(e){return Boolean(e)})).forEach((function(e){var t=e.id,a=e.url;R.a.setDataUrl(t,a)})),(r||[]).forEach((function(e){T.a.set(e)})),(i||[]).forEach((function(e){_e.a.set(e)})),(o||[]).forEach((function(e){xe.a.set(e)})),(a||[]).concat(n||[]).concat([t]).forEach((function(e){e&&(delete e.OutputTypingManager,D.a.set(e),e.photo&&(e.photo.small&&R.a.set(e.photo.small),e.photo.big&&R.a.set(e.photo.big)),e.chat_list&&D.a.updateChatChatList(e.id,e.chat_list),e.last_message&&X.a.set(e.last_message))})),(c||[]).forEach((function(e){var t=Object(C.a)(e,2),a=t[0],n=t[1];G.a.set(a,n)}))}}},{key:"getCache",value:function(){var e=Object(i.a)(r.a.mark((function e(t,a){var n,i,o,s,c,l,u;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Map,i=new Map,o=new Map,s=new Map,c=this.meChat,l=t.map((function(e){return D.a.get(e)})),u=a.map((function(e){return D.a.get(e)})),l.concat(u).concat([c]).forEach((function(e){var t=e.photo,a=e.type,r=e.last_message;if(t&&t.small){var c=t.small.id;if(c){var l=R.a.getBlob(c);l&&n.set(c,l)}}switch(a["@type"]){case"chatTypeBasicGroup":var u=_e.a.get(a.basic_group_id);u&&o.set(u.id,u);case"chatTypePrivate":case"chatTypeSecret":var d=T.a.get(a.user_id);d&&i.set(d.id,d);case"chatTypeSupergroup":var p=xe.a.get(a.supergroup_id);p&&s.set(p.id,p)}if(r){var h=r.sender_user_id;if(h){var m=T.a.get(h);m&&i.set(m.id,m)}}})),e.abrupt("return",{meChat:c,chats:l,archiveChats:u,users:Object(Ct.a)(i.values()),basicGroups:Object(Ct.a)(o.values()),supergroups:Object(Ct.a)(s.values()),files:Object(Ct.a)(n.entries()),options:Object(Ct.a)(G.a.items.entries())});case 9:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"saveChats",value:function(){var e=Object(i.a)(r.a.mark((function e(t,a){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.chatIds=t,this.archiveChatIds=a,e.t0=this.meChat,e.t0){e.next=7;break}return e.next=6,$.a.send({"@type":"createPrivateChat",user_id:T.a.getMyId(),force:!1});case 6:e.t0=e.sent;case 7:if(this.meChat=e.t0,!this.cacheContacts){e.next=15;break}if(e.t1=this.contacts,e.t1){e.next=14;break}return e.next=13,$.a.send({"@type":"getContacts"});case 13:e.t1=e.sent;case 14:this.contacts=e.t1;case 15:this.saveChatsInternal();case 16:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"saveChatsInternal",value:function(){var e=Object(i.a)(r.a.mark((function e(){var t,a,n,i,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCache(this.chatIds,this.archiveChatIds);case 2:return t=e.sent,a=t.files,t.files=[],e.next=7,gn.save("cache",t);case 7:return n=[],a.forEach((function(e){var t=Object(C.a)(e,2),a=t[0],r=t[1];n.push(new Promise((function(e,t){var n=new FileReader;n.readAsDataURL(r),n.onload=function(t){e({id:a,url:t.target.result})},n.onerror=function(t){e(null)}})))})),e.next=11,Promise.all(n);case 11:return i=e.sent,e.next=14,gn.save("files",i);case 14:if(!this.cacheContacts){e.next=18;break}return o=this.contacts.user_ids.map((function(e){return T.a.get(e)})),e.next=18,gn.save("contacts",o);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"clear",value:function(){this.cache&&this.cache.files.filter((function(e){return Boolean(e)})).forEach((function(e){var t=e.id;e.url;R.a.deleteDataUrl(t)}))}}]),a}(fn.a));window.cache=vn;var bn=vn,Cn=(a(531),a(532)),yn=a.n(Cn),kn=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdatePageWidth=function(e){var t=e.isSmallWidth;n.setState({isSmallWidth:t})},n.onUpdateAuthorizationState=function(e){n.setState({authorizationState:e.authorization_state})},n.handleMenuOpen=function(e){var t=n.state.authorizationState;Object(We.r)(t)&&n.setState({anchorEl:e.currentTarget})},n.handleMenuClose=function(){n.setState({anchorEl:null})},n.handleCheckUpdates=Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.handleMenuClose();case 1:case"end":return e.stop()}}),e)}))),n.handleNewChannel=function(e){n.handleMenuClose(),$.a.clientUpdate({"@type":"clientUpdateNewChannel",open:!0})},n.handleNewGroup=function(e){n.handleMenuClose(),$.a.clientUpdate({"@type":"clientUpdateNewGroup",open:!0})},n.handleContacts=function(e){n.handleMenuClose(),$.a.clientUpdate({"@type":"clientUpdateContacts",open:!0})},n.handleArchived=function(e){n.handleMenuClose(),Object(Q.h)()},n.handleSaved=function(){var e=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.handleMenuClose(),a=bn.cache?bn.cache.meChat:null){e.next=6;break}return e.next=5,$.a.send({"@type":"createPrivateChat",user_id:T.a.getMyId(),force:!1});case 5:a=e.sent;case 6:if(a){e.next=8;break}return e.abrupt("return");case 8:Object(Q.i)(a.id);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleSettings=function(){var e=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.handleMenuClose(),a=bn.cache?bn.cache.meChat:null){e.next=6;break}return e.next=5,$.a.send({"@type":"createPrivateChat",user_id:T.a.getMyId(),force:!1});case 5:a=e.sent;case 6:if(a){e.next=8;break}return e.abrupt("return");case 8:$.a.clientUpdate({"@type":"clientUpdateSettings",open:!0,chatId:a.id});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleHelp=function(e){n.handleMenuClose()},n.handleSearch=function(){n.handleMenuClose(),Object(Q.m)(0)},n.handleCustomContacts=function(){n.handleMenuClose(),$.a.clientUpdate({"@type":"clientUpdateCustomContacts",open:!0})},n.handleMarketingTool=function(){n.handleMenuClose(),$.a.clientUpdate({"@type":"clientUpdateMarketingTool",open:!0}),$.a.setChatId(1111)},n.state={authorizationState:lt.a.getAuthorizationState(),anchorEl:null,isSmallWidth:lt.a.isSmallWidth},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){lt.a.on("updateAuthorizationState",this.onUpdateAuthorizationState),lt.a.on("clientUpdatePageWidth",this.onClientUpdatePageWidth)}},{key:"componentWillUnmount",value:function(){lt.a.off("updateAuthorizationState",this.onUpdateAuthorizationState),lt.a.off("clientUpdatePageWidth",this.onClientUpdatePageWidth)}},{key:"render",value:function(){var e=this.props,t=e.t,a=e.timeout,n=e.popup,r=e.showClose,i=e.onClose,o=this.state,s=o.anchorEl,c=o.authorizationState,l=o.isSmallWidth,u=!r&&Object(We.r)(c)?d.a.createElement(un.a,{id:"main-menu",anchorEl:s,open:Boolean(s),onClose:this.handleMenuClose,getContentAnchorEl:null,disableAutoFocusItem:!0,disableRestoreFocus:!0,anchorOrigin:{vertical:"bottom",horizontal:"left"}},d.a.createElement(Et.a,{onClick:this.handleNewChannel},d.a.createElement(be.a,null,d.a.createElement(dn,null)),d.a.createElement(Ce.a,{primary:t("NewChannel")})),d.a.createElement(Et.a,{onClick:this.handleNewGroup},d.a.createElement(be.a,null,d.a.createElement(_a,null)),d.a.createElement(Ce.a,{primary:t("NewGroup")})),l&&d.a.createElement(Et.a,{onClick:this.handleSearch},d.a.createElement(be.a,null,d.a.createElement(jt,null)),d.a.createElement(Ce.a,{primary:t("Search")})),d.a.createElement(Et.a,{onClick:this.handleContacts},d.a.createElement(be.a,null,d.a.createElement(ja,null)),d.a.createElement(Ce.a,{primary:t("Contacts")})),d.a.createElement(Et.a,{onClick:this.handleMarketingTool},d.a.createElement(be.a,null,d.a.createElement(yn.a,null)),d.a.createElement(Ce.a,{primary:t("MarketingTool")})),d.a.createElement(Et.a,{onClick:this.handleCustomContacts},d.a.createElement(be.a,null,d.a.createElement(ja,null)),d.a.createElement(Ce.a,{primary:t("CustomContacts")})),d.a.createElement(Et.a,{onClick:this.handleArchived},d.a.createElement(be.a,null,d.a.createElement(Oa,null)),d.a.createElement(Ce.a,{primary:t("Archived")})),d.a.createElement(Et.a,{onClick:this.handleSaved},d.a.createElement(be.a,null,d.a.createElement(I,null)),d.a.createElement(Ce.a,{primary:t("Saved")})),d.a.createElement(Et.a,{onClick:this.handleSettings},d.a.createElement(be.a,null,d.a.createElement(mn,null)),d.a.createElement(Ce.a,{primary:t("Settings")})),d.a.createElement(Et.a,{onClick:this.handleHelp},d.a.createElement(be.a,null,d.a.createElement(hn,null)),d.a.createElement(Ce.a,{primary:t("SettingsHelp")}))):null,p=n?d.a.createElement(w.a,null):d.a.createElement(Ne,null);return d.a.createElement(d.a.Fragment,null,d.a.createElement(E.a,{"aria-owns":s?"simple-menu":null,"aria-haspopup":"true",className:"header-left-button main-menu-button","aria-label":"Menu",onClick:r?i:this.handleMenuOpen},a?d.a.createElement(_t.a,{open:r,openIcon:d.a.createElement(Ne,null),icon:d.a.createElement(pn,null)}):d.a.createElement(d.a.Fragment,null,r?p:d.a.createElement(pn,null))),u)}}]),a}(d.a.Component),En=Object(y.d)()(kn),Sn=(a(533),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleKeyDown=function(t){if(13===t.keyCode)t.preventDefault();else if(27===t.keyCode){var a=e.props,n=a.onChange,r=a.onClose,i=t.target;if(!i)return;if(i.innerText)return t.stopPropagation(),t.nativeEvent.stopImmediatePropagation(),i.innerText=null,void(n&&n(i.innerText));r&&r(t)}else if(8===t.keyCode){var o=e.props.onBackspace,s=t.target;if(!s)return;if(s.innerText)return;o&&(t.stopPropagation(),o())}},e.handleKeyUp=function(e){var t=e.target;if(t){var a=t.innerHTML;"<br>"!==a&&"<div><br></div>"!==a||(t.innerHTML=null)}},e.handlePaste=function(e){var t=e.clipboardData.getData("text/plain");t&&(e.preventDefault(),document.execCommand("insertText",!1,t))},e.handleInput=function(t){var a=e.props.onChange,n=t.target;n&&a&&a(n.innerText)},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.inputRef,a=e.t,n=e.onFocus,r=e.hint,i=e.showIcon;return d.a.createElement("div",{className:"search-input"},d.a.createElement("div",{id:"search-inputbox",ref:t,placeholder:r||a("Search"),contentEditable:!0,suppressContentEditableWarning:!0,onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,onPaste:this.handlePaste,onInput:this.handleInput,onFocus:n}),i&&d.a.createElement(jt,{className:"search-input-icon"}))}}]),a}(d.a.Component));Sn.defaultProps={showIcon:!0};var On=Object(y.d)()(Sn),Un=(a(411),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onUpdateAuthorizationState=function(e){n.setState({authorizationState:e.authorization_state})},n.handleSearch=function(){var e=n.props,t=e.onSearch,a=e.openSearch,r=n.state.authorizationState;Object(We.r)(r)&&t(!a)},n.handleSearchTextChange=function(){var e=n.props.onSearchTextChange,t=n.searchInputRef.current;if(t){var a=t.innerHTML;"<br>"!==a&&"<div><br></div>"!==a||(t.innerHTML=null),e(t.innerText)}},n.handleCloseSearch=function(){n.handleSearch()},n.handleFocus=function(){n.handleSearch()},n.searchInputRef=d.a.createRef(),n.state={authorizationState:lt.a.getAuthorizationState(),open:!1},n}return Object(s.a)(a,[{key:"setInitQuery",value:function(e){var t=this.props.onSearchTextChange,a=this.searchInputRef.current;if(a){if(a.innerText=e,a.childNodes.length>0){var n=document.createRange();n.setStart(a.childNodes[0],a.childNodes[0].length),n.collapse(!0);var r=window.getSelection();r.removeAllRanges(),r.addRange(n)}a.focus(),t(e)}}},{key:"componentDidUpdate",value:function(e,t,a){var n=this.props.openSearch;if(n!==e.openSearch)if(n)this.focusInput();else{var r=this.searchInputRef.current;r&&(r.innerText=null)}}},{key:"focusInput",value:function(){var e=this.searchInputRef.current;e&&e.focus()}},{key:"componentDidMount",value:function(){this.props.popup&&this.focusInput(),lt.a.on("updateAuthorizationState",this.onUpdateAuthorizationState)}},{key:"componentWillUnmount",value:function(){lt.a.off("updateAuthorizationState",this.onUpdateAuthorizationState)}},{key:"render",value:function(){var e=this.props,t=e.openSearch,a=e.timeout,n=e.popup,r=null,i=!1;return t?(i=!0,r=d.a.createElement(On,{inputRef:this.searchInputRef,onChange:this.handleSearchTextChange,onClose:this.handleCloseSearch})):r=d.a.createElement(On,{inputRef:this.searchInputRef,onFocus:this.handleFocus}),d.a.createElement("div",{className:"header-master"},d.a.createElement(En,{timeout:a,showClose:i,popup:n,onClose:this.handleCloseSearch}),r)}}]),a}(d.a.Component)),wn=a(391),Mn=(a(534),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleKeyDown=function(e){switch(e.key){case"Escape":var t=n.props.onClose;t&&(e.preventDefault(),e.stopPropagation(),e.target.blur(),t())}},n.keyboardHandler=new Ja(n.handleKeyDown),n}return Object(s.a)(a,[{key:"componentDidUpdate",value:function(e,t,a){var n=this.props.open;e.open!==n&&(n?Ya.add(this.keyboardHandler):Ya.remove(this.keyboardHandler))}},{key:"render",value:function(){var e=this.props,t=e.children,a=e.open,n=e.timeout,r=e.onClose;return d.a.createElement(wn.a,{direction:"right",in:a,timeout:n,mountOnEnter:!0,unmountOnExit:!0},d.a.createElement("div",{className:"sidebar-page"},r?d.a.cloneElement(t,{onClose:r}):t))}}]),a}(d.a.Component)),In=Object(M.a)(d.a.createElement("path",{d:"M7.70710678,20.7071068 C7.5195704,20.8946432 7.26521649,21 7,21 L4,21 C3.44771525,21 3,20.5522847 3,20 L3,17 C3,16.7347835 3.10535684,16.4804296 3.29289322,16.2928932 L16.5857864,3 C17.3257272,2.26005924 18.5012114,2.22111499 19.2869988,2.88316725 L19.4142136,3 L21,4.58578644 C21.7399408,5.3257272 21.778885,6.50121136 21.1168328,7.28699879 L21,7.41421356 L7.70710678,20.7071068 Z M5,17.4142136 L5,19 L6.58578644,19 L16.5857864,9 L15,7.41421356 L5,17.4142136 Z M18,4.41421356 L16.414,5.99921356 L18,7.58521356 L19.5857864,6 L18,4.41421356 Z"}),"Edit"),jn=Object(M.a)(d.a.createElement("path",{d:"M11,2 C13.209139,2 15,3.790861 15,6 C15,6.55228475 14.5522847,7 14,7 C13.4477153,7 13,6.55228475 13,6 L13,6 L12.9945143,5.85073766 C12.9181651,4.81587779 12.0543618,4 11,4 L11,4 L6,4 C4.8954305,4 4,4.8954305 4,6 L4,6 L4,18 C4,19.1045695 4.8954305,20 6,20 L6,20 L11,20 C12.1045695,20 13,19.1045695 13,18 L13,18 L13.0067277,17.8833789 C13.0644928,17.3860402 13.4871642,17 14,17 C14.5522847,17 15,17.4477153 15,18 C15,20.209139 13.209139,22 11,22 L11,22 L6,22 C3.790861,22 2,20.209139 2,18 L2,18 L2,6 C2,3.790861 3.790861,2 6,2 L6,2 Z M18.7071068,7.29289322 L22.7071068,11.2928932 C22.7355731,11.3213595 22.7623312,11.3515341 22.787214,11.3832499 L22.7071068,11.2928932 C22.7425008,11.3282873 22.774687,11.3656744 22.8036654,11.4046934 C22.8215099,11.4288693 22.8382813,11.453725 22.8539326,11.4793398 C22.8613931,11.4913869 22.8685012,11.5036056 22.8753288,11.5159379 C22.8862061,11.5357061 22.8966234,11.5561086 22.9063462,11.5769009 C22.914321,11.5939015 22.9218036,11.6112044 22.9287745,11.628664 C22.9366843,11.6484208 22.9438775,11.6682023 22.9504533,11.6882636 C22.9552713,11.7031487 22.9599023,11.7185367 22.9641549,11.734007 C22.9701664,11.7555635 22.9753602,11.7772539 22.9798348,11.7992059 C22.9832978,11.8166247 22.9863719,11.834051 22.9889822,11.8515331 C22.9962388,11.8996379 23,11.9493797 23,12 L22.9962979,11.9137692 C22.9978436,11.9317345 22.9989053,11.9497336 22.9994829,11.9677454 L23,12 C23,12.0112225 22.9998151,12.0224019 22.9994483,12.0335352 C22.9988772,12.050591 22.997855,12.0679231 22.996384,12.0852242 C22.994564,12.1070574 22.9920941,12.1281144 22.9889807,12.1489612 C22.9863719,12.165949 22.9832978,12.1833753 22.9797599,12.2007258 C22.9753602,12.2227461 22.9701664,12.2444365 22.964279,12.2658396 C22.9599023,12.2814633 22.9552713,12.2968513 22.9502619,12.3121425 C22.9438775,12.3317977 22.9366843,12.3515792 22.928896,12.3710585 C22.9218036,12.3887956 22.914321,12.4060985 22.9063266,12.4232215 C22.8966234,12.4438914 22.8862061,12.4642939 22.8751242,12.484277 C22.8685012,12.4963944 22.8613931,12.5086131 22.8540045,12.5207088 C22.8382813,12.546275 22.8215099,12.5711307 22.8036865,12.5951593 C22.7982466,12.602603 22.7927155,12.6098424 22.7870723,12.6170223 C22.7849289,12.6196628 22.7826279,12.6225624 22.7803112,12.625449 L22.7071068,12.7071068 L22.7071068,12.7071068 L18.7071068,16.7071068 C18.3165825,17.0976311 17.6834175,17.0976311 17.2928932,16.7071068 C16.9023689,16.3165825 16.9023689,15.6834175 17.2928932,15.2928932 L19.585,13 L13,13 C12.4871642,13 12.0644928,12.6139598 12.0067277,12.1166211 L12,12 C12,11.4477153 12.4477153,11 13,11 L13,11 L19.585,11 L17.2928932,8.70710678 C16.9023689,8.31658249 16.9023689,7.68341751 17.2928932,7.29289322 C17.6834175,6.90236893 18.3165825,6.90236893 18.7071068,7.29289322 Z"}),"LogOut"),_n=Object(M.a)(d.a.createElement("path",{d:"M12,16 C13.1045695,16 14,16.8954305 14,18 C14,19.1045695 13.1045695,20 12,20 C10.8954305,20 10,19.1045695 10,18 C10,16.8954305 10.8954305,16 12,16 Z M12,10 C13.1045695,10 14,10.8954305 14,12 C14,13.1045695 13.1045695,14 12,14 C10.8954305,14 10,13.1045695 10,12 C10,10.8954305 10.8954305,10 12,10 Z M12,4 C13.1045695,4 14,4.8954305 14,6 C14,7.1045695 13.1045695,8 12,8 C10.8954305,8 10,7.1045695 10,6 C10,4.8954305 10.8954305,4 12,4 Z"}),"More"),xn=a(324),Tn=a(325),Ln=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={anchorEl:null,open:!1},e.handleMenuOpen=function(t){e.setState({anchorEl:t.currentTarget})},e.handleMenuClose=function(){e.setState({anchorEl:null})},e.handleLogOut=function(){e.handleMenuClose(),e.setState({open:!0})},e.handleDone=function(){e.handleClose(),$.a.logOut()},e.handleClose=function(){e.setState({open:!1})},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.t,t=this.state,a=t.anchorEl,n=t.open;return d.a.createElement(d.a.Fragment,null,d.a.createElement(E.a,{"aria-owns":a?"simple-menu":null,"aria-haspopup":"true",className:"header-right-button","aria-label":"Menu",onClick:this.handleMenuOpen},d.a.createElement(_n,null)),d.a.createElement(un.a,{id:"main-menu",anchorEl:a,open:Boolean(a),onClose:this.handleMenuClose,getContentAnchorEl:null,disableAutoFocusItem:!0,disableRestoreFocus:!0,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},d.a.createElement(Et.a,{onClick:this.handleLogOut},d.a.createElement(be.a,null,d.a.createElement(jn,null)),d.a.createElement(Ce.a,{primary:e("LogOut")}))),d.a.createElement(S.a,{transitionDuration:0,open:n,onClose:this.handleClose,"aria-labelledby":"form-dialog-title"},d.a.createElement(U.a,{id:"form-dialog-title"},e("Confirm")),d.a.createElement(xn.a,null,d.a.createElement(Tn.a,{style:{whiteSpace:"pre-wrap"}},e("AreYouSureLogout"))),d.a.createElement(O.a,null,d.a.createElement(k.a,{onClick:this.handleClose,color:"primary"},e("Cancel")),d.a.createElement(k.a,{onClick:this.handleDone,color:"primary"},e("Ok")))))}}]),a}(d.a.Component),Pn=Object(y.d)()(Ln),Nn=Object(M.a)(d.a.createElement("path",{d:"M12,1 C14.6887547,1 16.8818181,3.12230671 16.9953805,5.78311038 L17,6 L17,8 C18.6568542,8 20,9.34314575 20,11 L20,19 C20,20.6568542 18.6568542,22 17,22 L7,22 C5.34314575,22 4,20.6568542 4,19 L4,11 C4,9.34314575 5.34314575,8 7,8 L7,6 C7,3.23857625 9.23857625,1 12,1 Z M17,10 L7,10 C6.44771525,10 6,10.4477153 6,11 L6,19 C6,19.5522847 6.44771525,20 7,20 L17,20 C17.5522847,20 18,19.5522847 18,19 L18,11 C18,10.4477153 17.5522847,10 17,10 Z M12,13.5 C12.8284271,13.5 13.5,14.1715729 13.5,15 C13.5,15.8284271 12.8284271,16.5 12,16.5 C11.1715729,16.5 10.5,15.8284271 10.5,15 C10.5,14.1715729 11.1715729,13.5 12,13.5 Z M12.1762728,3.00509269 L12,3 C10.4023191,3 9.09633912,4.24891996 9.00509269,5.82372721 L9,6 L9,8 L15,8 L15,6 C15,4.40231912 13.75108,3.09633912 12.1762728,3.00509269 L12,3 L12.1762728,3.00509269 Z"}),"Data"),Dn=Object(M.a)(d.a.createElement("path",{d:"M12.4100787,14.6155108 L10.33,12.56 L10.33,12.56 L10.36,12.53 C12.1,10.59 13.34,8.36 14.07,6 L16,6 C16.5522847,6 17,5.55228475 17,5 C17,4.44771525 16.5522847,4 16,4 L10,4 L10,4 L10,3 C10,2.44771525 9.55228475,2 9,2 C8.44771525,2 8,2.44771525 8,3 L8,4 L8,4 L1.995,4 C1.44547667,4 1,4.44547667 1,4.995 C1,5.54452333 1.44547667,5.99 1.995,5.99 L12.17,5.99 L12.17,5.99 C11.5,7.92 10.44,9.75 9,11.35 C8.29025814,10.5639418 7.67370319,9.7196418 7.15033516,8.83487918 C7.09974701,8.74935905 7.03930045,8.64304956 6.96899548,8.51595071 C6.79288115,8.1975972 6.45776707,8 6.09394677,8 L5.69,8 C5.34408921,8 5.06367311,8.2804161 5.06367311,8.62632689 C5.06367311,8.72554854 5.08724633,8.82335055 5.13246346,8.91167013 C5.1653189,8.97586688 5.19575217,9.03408878 5.22376326,9.08633583 C5.88285067,10.3156835 6.70136504,11.4828779 7.67,12.56 L3.29489879,16.8749328 C2.90279535,17.2616439 2.89842396,17.8929978 3.28513501,18.2851012 C3.28675102,18.2867397 3.28837269,18.2883727 3.29,18.29 L3.29289322,18.2928932 C3.68341751,18.6834175 4.31658249,18.6834175 4.70710678,18.2928932 L9,14 L9,14 L11.3403247,16.3403247 C11.6133932,16.6133932 12.0561246,16.6133932 12.3291931,16.3403247 C12.4001325,16.2693853 12.4549762,16.1840114 12.49,16.09 L12.6442671,15.6759147 C12.7816472,15.3071575 12.6899849,14.8921111 12.4100787,14.6155108 Z M17.8069995,10 L17.1930005,10 C16.7761559,10 16.4030352,10.2585728 16.2566713,10.6488766 L12.3511234,21.0636708 C12.2167367,21.4220355 12.3983067,21.8214894 12.7566713,21.9558761 C12.8344793,21.9850541 12.916901,22 13,22 L13.3059169,22 C13.7232965,22 14.0967782,21.7407727 14.2427584,21.3497542 L15.12,19 L15.12,19 L19.87,19 L20.7561047,21.3524905 C20.9028501,21.74208 21.2756099,22 21.6919201,22 L22,22 C22.3827336,22 22.6930005,21.6897331 22.6930005,21.3069995 C22.6930005,21.2239005 22.6780546,21.1414789 22.6488766,21.0636708 L18.7433287,10.6488766 C18.5969648,10.2585728 18.2238441,10 17.8069995,10 Z M17.5,12.67 L19.12,17 L15.88,17 L17.5,12.67 Z"}),"Language"),Rn=(a(535),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleOpenViewer=function(){var t=e.props.chatId,a=D.a.get(t);a&&a.photo&&Object(Q.r)({chatId:t})},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.popup,n=e.t,r=e.onClose,i=e.onEditProfile,o=e.onGeneral,s=e.onNotifications,c=e.onPrivacySecurity,l=e.onLanguage,u=D.a.get(t);if(!u)return null;var p=u.photo;return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"header-master"},d.a.createElement(E.a,{className:"header-left-button",onClick:r},a?d.a.createElement(w.a,null):d.a.createElement(Ne,null)),d.a.createElement("div",{className:"header-status grow cursor-pointer"},d.a.createElement("span",{className:"header-status-content"},n("Settings"))),d.a.createElement(Pn,null)),d.a.createElement("div",{className:"sidebar-page-content"},d.a.createElement("div",{className:"chat-details-info"},d.a.createElement(Pe,{chatId:t,big:!0,showStatus:!0,showSavedMessages:!1,onTileSelect:p?this.handleOpenViewer:null})),d.a.createElement(ve.a,{className:"settings-list-item",button:!0,onClick:i},d.a.createElement(be.a,null,d.a.createElement(In,null)),d.a.createElement(Ce.a,{primary:n("EditProfile")})),d.a.createElement(ve.a,{className:"settings-list-item",button:!0,onClick:o},d.a.createElement(be.a,null,d.a.createElement(mn,null)),d.a.createElement(Ce.a,{primary:n("GeneralSettings")})),d.a.createElement(ve.a,{className:"settings-list-item",button:!0,onClick:s},d.a.createElement(be.a,null,d.a.createElement(Ia,null)),d.a.createElement(Ce.a,{primary:n("Notifications")})),d.a.createElement(ve.a,{className:"settings-list-item",button:!0,onClick:c},d.a.createElement(be.a,null,d.a.createElement(Nn,null)),d.a.createElement(Ce.a,{primary:n("PrivacySettings")})),d.a.createElement(ve.a,{autoFocus:!1,className:"settings-list-item",button:!0,onClick:l},d.a.createElement(be.a,null,d.a.createElement(Dn,null)),d.a.createElement(Ce.a,{primary:n("Language")}))))}}]),a}(d.a.Component)),Bn=Object(y.d)()(Rn),An=a(330),Fn=a(386),Vn=a(536),zn=a.n(Vn),Hn=Object(M.a)(d.a.createElement("path",{d:"M19.8833789,16.0067277 L20,16 C20.5128358,16 20.9355072,16.3860402 20.9932723,16.8833789 L21,17 L21,19 L23,19 C23.5128358,19 23.9355072,19.3860402 23.9932723,19.8833789 L24,20 C24,20.5128358 23.6139598,20.9355072 23.1166211,20.9932723 L23,21 L21,21 L21,23 C21,23.5128358 20.6139598,23.9355072 20.1166211,23.9932723 L20,24 C19.4871642,24 19.0644928,23.6139598 19.0067277,23.1166211 L19,23 L19,21 L17,21 C16.4871642,21 16.0644928,20.6139598 16.0067277,20.1166211 L16,20 C16,19.4871642 16.3860402,19.0644928 16.8833789,19.0067277 L17,19 L19,19 L19,17 C19,16.4871642 19.3860402,16.0644928 19.8833789,16.0067277 L20,16 L19.8833789,16.0067277 Z M8.41421356,2 L13.5857864,2 C14.0572824,2 14.5116128,2.16648982 14.8701798,2.46691315 L15,2.58578644 L16.4142136,4 L18,4 C19.5976809,4 20.9036609,5.24891996 20.9949073,6.82372721 L21,7 L21,12 C21,12.5522847 20.5522847,13 20,13 C19.4871642,13 19.0644928,12.6139598 19.0067277,12.1166211 L19,12 L19,7 C19,6.48716416 18.6139598,6.06449284 18.1166211,6.00672773 L18,6 L16.4142136,6 C15.9427176,6 15.4883872,5.83351018 15.1298202,5.53308685 L15,5.41421356 L13.5857864,4 L8.41421356,4 L7,5.41421356 C6.66660199,5.74761157 6.22761579,5.95114561 5.76163928,5.99225938 L5.58578644,6 L4,6 C3.48716416,6 3.06449284,6.38604019 3.00672773,6.88337887 L3,7 L3,18 C3,18.5128358 3.38604019,18.9355072 3.88337887,18.9932723 L4,19 L13,19 C13.5522847,19 14,19.4477153 14,20 C14,20.5128358 13.6139598,20.9355072 13.1166211,20.9932723 L13,21 L4,21 C2.40231912,21 1.09633912,19.75108 1.00509269,18.1762728 L1,18 L1,7 C1,5.40231912 2.24891996,4.09633912 3.82372721,4.00509269 L4,4 L5.58578644,4 L7,2.58578644 C7.33339801,2.25238843 7.77238421,2.04885439 8.23836072,2.00774062 L8.41421356,2 L13.5857864,2 L8.41421356,2 Z M11,7 C13.7614237,7 16,9.23857625 16,12 C16,14.7614237 13.7614237,17 11,17 C8.23857625,17 6,14.7614237 6,12 C6,9.23857625 8.23857625,7 11,7 Z M11,9 C9.34314575,9 8,10.3431458 8,12 C8,13.6568542 9.34314575,15 11,15 C12.6568542,15 14,13.6568542 14,12 C14,10.3431458 12.6568542,9 11,9 Z"}),"AddImage"),Wn=a(398),Gn=(a(538),a(539),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).handleCancel=function(){n.setState({open:!1})},n.handleDone=function(){var e=n.cropperRef.current;e&&(e.getCroppedCanvas().toBlob((function(e){var t=URL.createObjectURL(e);n.setState({blob:e,blobURL:t});var a=n.props.onChoose;a&&a(e,t)}),"image/jpeg"),n.handleCancel())},n.handleAttach=function(){n.attachPhotoRef.current.click()},n.handleAttachComplete=Object(i.a)(r.a.mark((function e(){var t,a,i,o,s,c,l,u;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(t=n.attachPhotoRef.current.files).length){e.next=3;break}return e.abrupt("return");case 3:if(1!==t.length){e.next=14;break}if(a=Array.from(t),i=Object(Fn.a)(a),o=i[0],i.slice(1),o){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,Object(We.x)(o);case 9:s=e.sent,c=Object(C.a)(s,2),l=c[0],u=c[1],n.setState({open:!0,file:o,fileURL:URL.createObjectURL(o),width:l,height:u});case 14:n.attachPhotoRef.current.value="";case 15:case"end":return e.stop()}}),e)}))),n.attachPhotoRef=d.a.createRef(),n.cropperRef=d.a.createRef();var s=n.props.defaultURL;return n.state={blobURL:s,open:!1},n}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.t,t=this.state,a=t.open,n=t.width,r=t.height,i=t.fileURL,o=t.blobURL,s=Object(We.h)({width:n,height:r},400,!0),c=s.width,l=s.height;return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"new-chat-photo"},o?d.a.createElement("img",{className:"new-chat-photo-image-button",alt:"",src:o,onClick:this.handleAttach}):d.a.createElement("div",{className:"new-chat-photo-image-button new-chat-photo-button",onClick:this.handleAttach},d.a.createElement(Hn,{className:"new-chat-photo-icon"}))),d.a.createElement("input",{ref:this.attachPhotoRef,className:"inputbox-attach-button",type:"file",multiple:!1,accept:"image/*",onChange:this.handleAttachComplete}),a&&d.a.createElement(S.a,{transitionDuration:0,open:!0,onClose:this.handleCancel,"aria-labelledby":"dialog-title"},d.a.createElement("div",{className:"header-master"},d.a.createElement(E.a,{className:"header-left-button",onClick:this.handleCancel},d.a.createElement(w.a,null)),d.a.createElement("div",{className:"header-status grow cursor-pointer"},d.a.createElement("span",{className:"header-status-content"},e("DragToReposition")))),d.a.createElement(xn.a,null,d.a.createElement(zn.a,{ref:this.cropperRef,src:i,style:{height:l,width:c,margin:"0 46px 62px"},aspectRatio:1,viewMode:3,guides:!1})),d.a.createElement("div",{className:"new-chat-photo-done-button ",onClick:this.handleDone},d.a.createElement(Wn.a,null))))}}]),a}(d.a.Component)),Zn=Object(y.d)()(Gn),qn=(a(540),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).handleUsernameChange=Object(i.a)(r.a.mark((function e(){var t,a,i,o,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props.chatId,a=n.state.username,(i=n.usernameRef.current.value).startsWith("@")&&i.length>1&&(i=i.substr(1)),a!==i&&""!==i){e.next=8;break}n.setState({usernameCheck:null}),e.next=14;break;case 8:return e.next=10,$.a.send({"@type":"checkChatUsername",chat_id:t,username:i});case 10:o=e.sent,(s=n.usernameRef.current.value).startsWith("@")&&s.length>1&&(s=s.substr(1)),s===i&&n.setState({usernameCheck:o});case 14:case"end":return e.stop()}}),e)}))),n.handleChoosePhoto=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props.chatId,e.next=3,$.a.send({"@type":"setProfilePhoto",photo:{"@type":"inputFileBlob",name:"profile_photo.jpg",data:t}});case 3:i=R.a.getStore(),Object(N.t)(i,a,!0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.firstNameRef=d.a.createRef(),n.lastNameRef=d.a.createRef(),n.bioRef=d.a.createRef(),n.usernameRef=d.a.createRef();var s=T.a.get(T.a.getMyId()),c=T.a.getFullInfo(T.a.getMyId());return n.state={firstName:s?s.first_name:"",lastName:s?s.last_name:"",bio:c?c.bio:"",username:s?s.username:"",usernameCheck:null},n}return Object(s.a)(a,[{key:"componentWillUnmount",value:function(){this.setName(),this.setBio(),this.setUsername()}},{key:"setUsername",value:function(){var e=this.state,t=e.username,a=e.usernameCheck,n=this.usernameRef.current.value;n.startsWith("@")&&n.length>1&&(n=n.substr(1)),t!==n&&a&&"checkChatUsernameResultOk"===a["@type"]&&$.a.send({"@type":"setUsername",username:n})}},{key:"setName",value:function(){var e=this.state,t=e.firstName,a=e.lastName,n=this.firstNameRef.current.value,r=this.lastNameRef.current.value;n===t&&r===a||$.a.send({"@type":"setName",first_name:n,last_name:r})}},{key:"setBio",value:function(){var e=this.state.bio,t=this.bioRef.current.value;t!==e&&$.a.send({"@type":"setBio",bio:t})}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.t,n=e.onClose,r=this.state,i=r.firstName,o=r.lastName,s=r.bio,c=r.username,l=r.usernameCheck,u=!1,p=a("Username");if(l)switch(l["@type"]){case"checkChatUsernameResultOk":u=!1,p="Username is available";break;case"checkChatUsernameResultPublicChatsTooMuch":case"checkChatUsernameResultPublicGroupsUnavailable":case"checkChatUsernameResultUsernameInvalid":u=!0,p="Invalid username";break;case"checkChatUsernameResultUsernameOccupied":u=!0,p="Username is already taken"}var h=D.a.get(t);if(!h)return null;var m=h.photo,f=Object(N.l)(m?m.small:null),g=[],v=Object(wt.h)(a("UsernameHelp"),g),b=Object(wt.n)({"@type":"formattedText",text:v,entities:g});return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"header-master"},d.a.createElement(E.a,{className:"header-left-button",onClick:n},d.a.createElement(Ne,null)),d.a.createElement("div",{className:"header-status grow cursor-pointer"},d.a.createElement("span",{className:"header-status-content"},a("EditProfile")))),d.a.createElement("div",{className:"sidebar-page-content"},d.a.createElement(Zn,{defaultURL:f,onChoose:this.handleChoosePhoto}),d.a.createElement("div",{className:"edit-profile-name"},d.a.createElement(An.a,{inputRef:this.firstNameRef,className:"edit-profile-input",variant:"outlined",fullWidth:!0,label:a("FirstName"),defaultValue:i}),d.a.createElement(An.a,{inputRef:this.lastNameRef,className:"edit-profile-input",variant:"outlined",fullWidth:!0,label:a("LastName"),defaultValue:o}),d.a.createElement(An.a,{inputRef:this.bioRef,className:"edit-profile-input",variant:"outlined",fullWidth:!0,label:a("Bio"),defaultValue:s}),d.a.createElement("div",{className:"edit-profile-hint"},a("BioAbout"))),d.a.createElement("div",{className:"sidebar-page-section-divider"}),d.a.createElement("div",{className:"edit-profile-username"},d.a.createElement(An.a,{inputRef:this.usernameRef,error:u,className:"edit-profile-input",variant:"outlined",fullWidth:!0,label:p,defaultValue:c,onChange:this.handleUsernameChange}),d.a.createElement("div",{className:"edit-profile-hint"},b))))}}]),a}(d.a.Component)),Kn=Object(m.a)(Object(m.d)(),Object(y.d)(),Object(m.c)())(qn),Jn=Object(M.a)(d.a.createElement("path",{d:"M19.2869988,2.88316725 L19.4142136,3 L21,4.58578644 C21.7399408,5.3257272 21.778885,6.50121136 21.1168328,7.28699879 L21,7.41421356 L17.414,10.9992136 L18.2071068,11.7928932 C18.5976311,12.1834175 18.5976311,12.8165825 18.2071068,13.2071068 C17.8466228,13.5675907 17.2793918,13.5953203 16.8871006,13.2902954 L16.7928932,13.2071068 L16,12.4142136 L7.70710678,20.7071068 C7.55082647,20.8633871 7.34814508,20.9625983 7.13144398,20.9913276 L7,21 L4,21 C3.48716416,21 3.06449284,20.6139598 3.00672773,20.1166211 L3,20 L3,17 C3,16.7789863 3.07316447,16.565516 3.20608063,16.3919705 L3.29289322,16.2928932 L11.585,7.99921356 L10.7928932,7.20710678 C10.4023689,6.81658249 10.4023689,6.18341751 10.7928932,5.79289322 C11.1533772,5.43240926 11.7206082,5.40467972 12.1128994,5.70970461 L12.2071068,5.79289322 L13,6.58521356 L16.5857864,3 C17.3257272,2.26005924 18.5012114,2.22111499 19.2869988,2.88316725 Z M13,9.415 L5,17.414 L5,18.999 L6.585,18.999 L14.585,11 L13,9.415 Z M18,4.41421356 L14.414,7.99921356 L16,9.58521356 L19.5857864,6 L18,4.41421356 Z"}),"Colorize"),Yn=(a(541),a(354)),Qn=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={loaded:!1},e.onClientUpdateDocumentThumbnailBlob=function(t){var a=e.props.wallpaper;if(a){var n=a.document;if(n){var r=n.thumbnail;if(r){var i=r.photo;if(i){var o=t.fileId;i.id===o&&e.forceUpdate()}}}}},e.handleLoad=function(){e.setState({loaded:!0})},e.handleClick=function(){var t=e.props,a=t.wallpaper,n=t.onClick;n&&n(a)},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){R.a.on("clientUpdateDocumentThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob)}},{key:"componentWillUnmount",value:function(){R.a.off("clientUpdateDocumentThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob)}},{key:"render",value:function(){var e=this.props,t=e.wallpaper,a=e.isSelected,n=(this.state.loaded,t.document),r=n.minithumbnail,i=n.thumbnail,o=r?"data:image/jpeg;base64, "+r.data:null,s=Object(N.l)(i?i.photo:null),c=s||o;return d.a.createElement("div",{className:"shared-photo",onClick:this.handleClick},d.a.createElement("div",{className:"shared-photo-content",style:{backgroundImage:"url(".concat(s||o,")"),backgroundSize:"cover",backgroundPosition:"50%"}},c!==s&&d.a.createElement("div",{className:"shared-photo-main-content",style:{backgroundImage:"url(".concat(c,")")}})),a&&d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"wallpaper-selected"}),d.a.createElement("div",{className:"wallpaper-selected-inner"})),n&&n.document&&d.a.createElement(Yn.a,{file:n.document,cancelButton:!1}))}}]),a}(d.a.Component),Xn=(a(542),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={selectedId:D.a.wallpaper?D.a.wallpaper.id:-1},e.handleClick=function(t){e.setState({selectedId:t.id});var a=t.document;if(a){a.thumbnail;var n=a.document;if(n){if(!Object(N.l)(n)){var r=R.a.getStore();Object(N.r)(r,t,!0)}$.a.clientUpdate({"@type":"clientUpdateChatBackground",wallpaper:t})}}},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.loadContent()}},{key:"loadContent",value:function(){var e=this.props.backgrounds;if(e){var t=R.a.getStore();Object(N.s)(t,e.backgrounds)}}},{key:"render",value:function(){var e=this,t=this.props,a=t.t,n=t.backgrounds,r=t.onClose,i=this.state.selectedId,o=n.backgrounds.filter((function(e){return"backgroundTypeWallpaper"===e.type["@type"]}));return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"header-master"},d.a.createElement(E.a,{className:"header-left-button",onClick:r},d.a.createElement(Ne,null)),d.a.createElement("div",{className:"header-status grow cursor-pointer"},d.a.createElement("span",{className:"header-status-content"},a("ChatBackground")))),d.a.createElement("div",{className:"sidebar-page-content shared-media-list shared-photos-list"},o.map((function(t){return d.a.createElement(Qn,{key:t.id,wallpaper:t,isSelected:t.id===i,onClick:e.handleClick})}))))}}]),a}(d.a.Component)),$n=Object(y.d)()(Xn),er=a(139),tr=a.n(er),ar=a(661),nr=a(652),rr=a(654),ir=a(317),or=a(287),sr=a(197),cr=a.n(sr),lr=a(198),ur=a.n(lr),dr=a(544),pr=a.n(dr),hr=a(199),mr=a.n(hr),fr=a(196),gr=a.n(fr),vr=a(545),br=a.n(vr),Cr=(a(543),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleChange=function(e){n.setState({type:e.target.value}),lt.a.emit("clientUpdateThemeChanging",{type:e.target.value,primary:n.getColor(n.state.color)})},n.handleAccentChange=function(e){n.setState({color:e.target.value}),lt.a.emit("clientUpdateThemeChanging",{type:n.state.type,primary:n.getColor(e.target.value)})},n.getColorString=function(e){switch(e){case cr.a[500]:return"red";case ur.a[500]:return"orange";case pr.a[500]:return"amber";case mr.a[500]:return"green";case"#50A2E9":return"blue";case gr.a[500]:return"indigo";case br.a[500]:return"deepPurple"}return null},n.getColor=function(e){switch(e){case"red":return cr.a;case"orange":return ur.a;case"amber":return pr.a;case"green":return mr.a;case"blue":return{main:"#50A2E9"};case"indigo":return gr.a;case"deepPurple":return br.a}return null},n.handleClose=function(){n.setState({open:!1})},n.open=function(){n.setState({open:!0})},n.state={open:!1,type:n.props.theme.palette.type,color:n.getColorString(n.props.theme.palette.primary.main)},n}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.t,t=this.state,a=t.type,n=t.color,r=t.open;return d.a.createElement(S.a,{transitionDuration:0,open:r,onClose:this.handleClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},d.a.createElement(U.a,{id:"alert-dialog-title"},e("Appearance")),d.a.createElement(xn.a,null,d.a.createElement(ir.a,{component:"fieldset",className:"theme-picker-form"},d.a.createElement(or.a,{focused:!0,component:"legend"},e("Theme")),d.a.createElement(nr.a,{"aria-label":"theme",name:"theme1",className:"theme-picker-group",value:a,onChange:this.handleChange},d.a.createElement(rr.a,{value:"light",control:d.a.createElement(ar.a,{color:"primary"}),label:"Light"}),d.a.createElement(rr.a,{value:"dark",control:d.a.createElement(ar.a,{color:"primary"}),label:"Dark"}))),d.a.createElement(ir.a,{component:"fieldset",className:"theme-picker-form"},d.a.createElement(or.a,{focused:!0,component:"legend"},e("Accent")),d.a.createElement(nr.a,{"aria-label":"accent",name:"accent1",className:"theme-picker-group",value:n,onChange:this.handleAccentChange},d.a.createElement(rr.a,{value:"red",control:d.a.createElement(ar.a,{color:"primary",classes:{root:"theme-picker-red"}}),label:"Red"}),d.a.createElement(rr.a,{value:"orange",control:d.a.createElement(ar.a,{color:"primary",classes:{root:"theme-picker-orange"}}),label:"Orange"}),d.a.createElement(rr.a,{value:"amber",control:d.a.createElement(ar.a,{color:"primary",classes:{root:"theme-picker-amber"}}),label:"Amber"}),d.a.createElement(rr.a,{value:"green",control:d.a.createElement(ar.a,{color:"primary",classes:{root:"theme-picker-green"}}),label:"Green"}),d.a.createElement(rr.a,{value:"blue",control:d.a.createElement(ar.a,{color:"primary",classes:{root:"theme-picker-blue"}}),label:"Blue"}),d.a.createElement(rr.a,{value:"indigo",control:d.a.createElement(ar.a,{color:"primary",classes:{root:"theme-picker-indigo"}}),label:"Indigo"}),d.a.createElement(rr.a,{value:"deepPurple",control:d.a.createElement(ar.a,{color:"primary",classes:{root:"theme-picker-deep-purple"}}),label:"Deep Purple"})))))}}]),a}(d.a.Component)),yr=Object(m.a)(Object(m.d)(),tr.a,Object(y.d)(),Object(m.c)())(Cr),kr=(a(546),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleAppearance=function(){n.themePickerRef.current.open()},n.loadContent=function(){$.a.send({"@type":"getBackgrounds",for_dark_theme:!1}).then((function(e){return n.setState({backgrounds:e})}))},n.openChatBackground=function(){n.state.backgrounds&&n.setState({openChatBackground:!0})},n.closeChatBackground=function(){n.setState({openChatBackground:!1})},n.state={backgrounds:null,openChatBackground:!1},n.themePickerRef=d.a.createRef(),n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.loadContent()}},{key:"render",value:function(){var e=this.props,t=e.t,a=e.onClose,n=this.state,r=n.backgrounds,i=n.openChatBackground;return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"header-master"},d.a.createElement(E.a,{className:"header-left-button",onClick:a},d.a.createElement(Ne,null)),d.a.createElement("div",{className:"header-status grow cursor-pointer"},d.a.createElement("span",{className:"header-status-content"},t("GeneralSettings")))),d.a.createElement("div",{className:"sidebar-page-content"},d.a.createElement("div",{className:"sidebar-page-section"},d.a.createElement(ve.a,{autoFocus:!1,className:"settings-list-item",button:!0,onClick:this.openChatBackground},d.a.createElement(be.a,null,d.a.createElement(Ee,null)),d.a.createElement(Ce.a,{primary:t("ChatBackground")})),d.a.createElement(ve.a,{autoFocus:!1,className:"settings-list-item",button:!0,onClick:this.handleAppearance},d.a.createElement(be.a,null,d.a.createElement(Jn,null)),d.a.createElement(Ce.a,{primary:t("Appearance")})))),d.a.createElement(Mn,{open:i,onClose:this.closeChatBackground},d.a.createElement($n,{backgrounds:r})),d.a.createElement(yr,{ref:this.themePickerRef}))}}]),a}(d.a.Component)),Er=Object(m.a)(Object(m.d)(),Object(y.d)(),Object(m.c)())(kr),Sr=a(66),Or=(a(547),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).handleChange=function(e){n.setState({language:e}),$.a.clientUpdate({"@type":"clientUpdateLanguageChange",language:e})};var r=e.i18n,i=r?r.language:null;return n.state={language:i||"en"},n}return Object(s.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.t,n=t.onClose,r=this.state.language,i=(Sr.a.info||{language_packs:[]}).language_packs.map((function(t){return d.a.createElement("div",{key:t.id,className:"settings-item",onClick:function(){return e.handleChange(t.id)}},d.a.createElement(ar.a,{color:"primary",className:"settings-item-control",checked:r===t.id,tabIndex:-1,inputProps:{"aria-labelledby":"label-2"}}),d.a.createElement(Ce.a,{id:"label-2",primary:t.name,secondary:t.native_name}))}));return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"header-master"},d.a.createElement(E.a,{className:"header-left-button",onClick:n},d.a.createElement(Ne,null)),d.a.createElement("div",{className:"header-status grow cursor-pointer"},d.a.createElement("span",{className:"header-status-content"},a("Language")))),d.a.createElement("div",{className:"sidebar-page-content"},i))}}]),a}(d.a.Component)),Ur=Object(m.a)(Object(m.d)(),Object(y.d)(),Object(m.c)())(Or),wr=a(331),Mr=(a(548),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).handleMuteFor=function(e){var t=n.state[e];if(t){var a=t.mute_for,r=Object(Ge.a)(Object(Ge.a)({},t),{},{mute_for:0===a?31536e3:0});n.setState({[e]:r})}},n.handleShowPreview=function(e){var t=n.state[e];if(t){var a=t.show_preview,r=Object(Ge.a)(Object(Ge.a)({},t),{},{show_preview:!a});n.setState({[e]:r})}},n.handleContactJoined=function(){n.setState({contactJoined:!n.state.contactJoined})};var r=G.a.get("disable_contact_registered_notifications");return n.state={privateChatsSettings:Xe.a.settings.get("notificationSettingsScopePrivateChats"),groupChatsSettings:Xe.a.settings.get("notificationSettingsScopeGroupChats"),channelChatsSettings:Xe.a.settings.get("notificationSettingsScopeChannelChats"),contactJoined:!r||!r.value},n}return Object(s.a)(a,[{key:"componentWillUnmount",value:function(){var e=this.state,t=e.privateChatsSettings,a=e.groupChatsSettings,n=e.channelChatsSettings,r=e.contactJoined;this.setScopeNotificationSettings("notificationSettingsScopePrivateChats",t),this.setScopeNotificationSettings("notificationSettingsScopeGroupChats",a),this.setScopeNotificationSettings("notificationSettingsScopeChannelChats",n),this.setContactJoinedOption(r)}},{key:"setContactJoinedOption",value:function(){var e=this.state.contactJoined,t=G.a.get("disable_contact_registered_notifications");(!t||!t.value)!==e&&$.a.send({"@type":"setOption",name:"disable_contact_registered_notifications",value:{"@type":"optionValueBoolean",value:!e}})}},{key:"setScopeNotificationSettings",value:function(e,t){if(e&&t){var a=Xe.a.settings.get(e);if(a){var n=t.mute_for,r=t.show_preview,i=a.mute_for,o=a.show_preview;n===i&&r===o||$.a.send({"@type":"setScopeNotificationSettings",scope:{"@type":e},notification_settings:t})}}}},{key:"isEnabled",value:function(e){return!!e&&0===e.mute_for}},{key:"showPreview",value:function(e){return!!e&&e.show_preview}},{key:"render",value:function(){var e=this,t=this.props,a=t.t,n=t.onClose,r=this.state,i=r.privateChatsSettings,o=r.groupChatsSettings,s=r.channelChatsSettings,c=r.contactJoined;return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"header-master"},d.a.createElement(E.a,{className:"header-left-button",onClick:n},d.a.createElement(Ne,null)),d.a.createElement("div",{className:"header-status grow cursor-pointer"},d.a.createElement("span",{className:"header-status-content"},a("Notifications")))),d.a.createElement("div",{className:"sidebar-page-content"},d.a.createElement("div",{className:"sidebar-page-section"},d.a.createElement(sn,null,a("NotificationsPrivateChats")),d.a.createElement("div",{className:"settings-item",onClick:function(){return e.handleMuteFor("privateChatsSettings")}},d.a.createElement(wr.a,{color:"primary",className:"settings-item-control",checked:this.isEnabled(i),tabIndex:-1,inputProps:{"aria-labelledby":"label-1"}}),d.a.createElement(Ce.a,{id:"label-1",primary:a("NotificationsForPrivateChats"),secondary:this.isEnabled(i)?a("NotificationsEnabled"):a("NotificationsDisabled")})),d.a.createElement("div",{className:"settings-item",onClick:function(){return e.handleShowPreview("privateChatsSettings")}},d.a.createElement(wr.a,{color:"primary",className:"settings-item-control",checked:this.showPreview(i),tabIndex:-1,inputProps:{"aria-labelledby":"label-2"}}),d.a.createElement(Ce.a,{id:"label-2",primary:a("MessagePreview"),secondary:this.showPreview(i)?a("PreviewEnabled"):a("PreviewDisabled")}))),d.a.createElement("div",{className:"sidebar-page-section-divider"}),d.a.createElement("div",{className:"sidebar-page-section"},d.a.createElement(sn,null,a("NotificationsGroups")),d.a.createElement("div",{className:"settings-item",onClick:function(){return e.handleMuteFor("groupChatsSettings")}},d.a.createElement(wr.a,{color:"primary",className:"settings-item-control",checked:this.isEnabled(o),tabIndex:-1,inputProps:{"aria-labelledby":"label-1"}}),d.a.createElement(Ce.a,{id:"label-1",primary:a("NotificationsForGroups"),secondary:this.isEnabled(o)?a("NotificationsEnabled"):a("NotificationsDisabled")})),d.a.createElement("div",{className:"settings-item",onClick:function(){return e.handleShowPreview("groupChatsSettings")}},d.a.createElement(wr.a,{color:"primary",className:"settings-item-control",checked:this.showPreview(o),tabIndex:-1,inputProps:{"aria-labelledby":"label-2"}}),d.a.createElement(Ce.a,{id:"label-2",primary:a("MessagePreview"),secondary:this.showPreview(o)?a("PreviewEnabled"):a("PreviewDisabled")}))),d.a.createElement("div",{className:"sidebar-page-section-divider"}),d.a.createElement("div",{className:"sidebar-page-section"},d.a.createElement(sn,null,a("NotificationsChannels")),d.a.createElement("div",{className:"settings-item",onClick:function(){return e.handleMuteFor("channelChatsSettings")}},d.a.createElement(wr.a,{color:"primary",className:"settings-item-control",checked:this.isEnabled(s),tabIndex:-1,inputProps:{"aria-labelledby":"label-1"}}),d.a.createElement(Ce.a,{id:"label-1",primary:a("NotificationsForChannels"),secondary:this.isEnabled(s)?a("NotificationsEnabled"):a("NotificationsDisabled")})),d.a.createElement("div",{className:"settings-item",onClick:function(){return e.handleShowPreview("channelChatsSettings")}},d.a.createElement(wr.a,{color:"primary",className:"settings-item-control",checked:this.showPreview(s),tabIndex:-1,inputProps:{"aria-labelledby":"label-2"}}),d.a.createElement(Ce.a,{id:"label-2",primary:a("MessagePreview"),secondary:this.showPreview(s)?a("PreviewEnabled"):a("PreviewDisabled")}))),d.a.createElement("div",{className:"sidebar-page-section-divider"}),d.a.createElement("div",{className:"sidebar-page-section"},d.a.createElement(sn,null,a("NotificationsOther")),d.a.createElement("div",{className:"settings-item",onClick:this.handleContactJoined},d.a.createElement(wr.a,{color:"primary",className:"settings-item-control",checked:c,tabIndex:-1,inputProps:{"aria-labelledby":"label-1"}}),d.a.createElement(Ce.a,{id:"label-1",primary:a("ContactJoined"),secondary:a(c?"ContactJoinedEnabled":"ContactJoinedDisabled")})))))}}]),a}(d.a.Component)),Ir=Object(m.a)(Object(m.d)(),Object(y.d)(),Object(m.c)())(Mr),jr=Object(M.a)(d.a.createElement("g",{transform:"translate(-1.000000, -1.000000)",fillRule:"nonzero"},d.a.createElement("path",{d:"M12,1 C18.0751322,1 23,5.92486775 23,12 C23,18.0751322 18.0751322,23 12,23 C5.92486775,23 1,18.0751322 1,12 C1,5.92486775 5.92486775,1 12,1 Z M12,3 C7.02943725,3 3,7.02943725 3,12 C3,16.9705627 7.02943725,21 12,21 C16.9705627,21 21,16.9705627 21,12 C21,7.02943725 16.9705627,3 12,3 Z M8,11 L16,11 C16.5522847,11 17,11.4477153 17,12 C17,12.5128358 16.6139598,12.9355072 16.1166211,12.9932723 L16,13 L8,13 C7.44771525,13 7,12.5522847 7,12 C7,11.4871642 7.38604019,11.0644928 7.88337887,11.0067277 L8,11 L16,11 L8,11 Z"})),"Stop"),_r=(a(549),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={contextMenu:!1,left:0,top:0},e.handleContextMenu=function(t){t&&(t.preventDefault(),t.stopPropagation());var a=e.props.session;if(a&&!a.is_current)if(e.state.contextMenu)e.setState({contextMenu:!1});else{var n=t.clientX,r=t.clientY;e.setState({contextMenu:!0,left:n,top:r})}},e.handleCloseContextMenu=function(t){e.setState({contextMenu:!1,left:0,top:0})},e.handleTerminate=function(t){e.handleCloseContextMenu(t);var a=e.props;(0,a.onTerminate)(a.session)},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.session,a=e.t;if(!t)return null;var n=this.state,r=n.left,i=n.top,o=n.contextMenu,s=t.is_current,c=t.application_name,l=t.application_version,u=t.device_model,p=t.platform,h=t.system_version,m=t.ip,f=t.region,g=t.country,v=t.last_active_date,b=!s;return d.a.createElement(d.a.Fragment,null,d.a.createElement(ve.a,{className:"settings-list-item",button:!0,onContextMenu:this.handleContextMenu},d.a.createElement("div",{className:"session"},d.a.createElement("div",{className:"session-title"},d.a.createElement("div",{className:"session-app"},"".concat(c," ").concat(l)),b&&d.a.createElement("div",{className:"session-date"},Object(x.A)({date:v}))),d.a.createElement("div",{className:"session-subtitle1"},"".concat(u,", ").concat(p," ").concat(h)),d.a.createElement("div",{className:"session-subtitle2"},"".concat(m," - "),f&&"".concat(f,", "),g&&"".concat(g)))),d.a.createElement(St.a,{open:o,onClose:this.handleCloseContextMenu,anchorReference:"anchorPosition",anchorPosition:{top:i,left:r},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},onMouseDown:function(e){return e.stopPropagation()}},d.a.createElement(kt.a,{onClick:function(e){return e.stopPropagation()}},d.a.createElement(Et.a,{onClick:this.handleTerminate},d.a.createElement(be.a,null,d.a.createElement(jr,null)),d.a.createElement(Ce.a,{primary:a("Terminate")})))))}}]),a}(d.a.Component)),xr=Object(y.d)()(_r),Tr=(a(550),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).state={open:!1,openAll:!1,session:null},e.handleTerminate=function(t){e.setState({open:!0,session:t})},e.handleTerminateAllOther=function(){e.setState({openAll:!0})},e.handleCloseConfirmation=function(){e.setState({open:!1,session:null})},e.handleDoneConfirmation=Object(i.a)(r.a.mark((function t(){var a,n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.props.sessions,n=e.state.session){t.next=4;break}return t.abrupt("return");case 4:return e.setState({open:!1,session:null}),t.next=7,$.a.send({"@type":"terminateSession",session_id:n.id});case 7:a.sessions=a.sessions.filter((function(e){return e.id!==n.id})),e.forceUpdate();case 9:case"end":return t.stop()}}),t)}))),e.handleCloseAllConfirmation=function(){e.setState({openAll:!1})},e.handleDoneAllConfirmation=Object(i.a)(r.a.mark((function t(){var a;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props.sessions,e.setState({openAll:!1}),t.next=4,$.a.send({"@type":"terminateAllOtherSessions"});case 4:a.sessions=a.sessions.filter((function(e){return!e.is_current})),e.forceUpdate();case 6:case"end":return t.stop()}}),t)}))),e}return Object(s.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.t,n=t.sessions,r=t.onClose,i=this.state,o=i.open,s=i.openAll,c=n.sessions.find((function(e){return e.is_current})),l=n.sessions.filter((function(e){return!e.is_current}));return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"header-master"},d.a.createElement(E.a,{className:"header-left-button",onClick:r},d.a.createElement(Ne,null)),d.a.createElement("div",{className:"header-status grow cursor-pointer"},d.a.createElement("span",{className:"header-status-content"},a("SessionsTitle")))),d.a.createElement("div",{className:"sidebar-page-content"},Boolean(c)&&d.a.createElement("div",{className:"sidebar-page-section"},d.a.createElement(sn,null,a("CurrentSession")),d.a.createElement(xr,{session:c,onTerminate:this.handleTerminate}),l.length>0&&d.a.createElement(ve.a,{className:"settings-list-item",button:!0,disableRipple:!0,onClick:this.handleTerminateAllOther},d.a.createElement(be.a,null,d.a.createElement(jr,{color:"secondary"})),d.a.createElement(Ce.a,{primaryTypographyProps:{color:"secondary"},primary:a("TerminateAllSessions")}))),l.length>0&&d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"sidebar-page-section-divider"}),d.a.createElement("div",{className:"sidebar-page-section"},d.a.createElement(sn,null,a("OtherSessions")),l.map((function(t){return d.a.createElement(xr,{key:t.id,session:t,onTerminate:e.handleTerminate})}))))),d.a.createElement(S.a,{transitionDuration:0,open:o,onClose:this.handleCloseConfirmation,"aria-labelledby":"form-dialog-title"},d.a.createElement(U.a,{id:"form-dialog-title"},a("Confirm")),d.a.createElement(xn.a,null,d.a.createElement(Tn.a,{style:{whiteSpace:"pre-wrap"}},a("TerminateSessionText"))),d.a.createElement(O.a,null,d.a.createElement(k.a,{onClick:this.handleCloseConfirmation,color:"primary"},a("Cancel")),d.a.createElement(k.a,{onClick:this.handleDoneConfirmation,color:"primary"},a("Ok")))),d.a.createElement(S.a,{transitionDuration:0,open:s,onClose:this.handleCloseAllConfirmation,"aria-labelledby":"form-dialog-title"},d.a.createElement(U.a,{id:"form-dialog-title"},a("Confirm")),d.a.createElement(xn.a,null,d.a.createElement(Tn.a,{style:{whiteSpace:"pre-wrap"}},a("AreYouSureSessions"))),d.a.createElement(O.a,null,d.a.createElement(k.a,{onClick:this.handleCloseAllConfirmation,color:"primary"},a("Cancel")),d.a.createElement(k.a,{onClick:this.handleDoneAllConfirmation,color:"primary"},a("Ok")))))}}]),a}(d.a.Component)),Lr=Object(m.a)(Object(m.d)(),Object(y.d)(),Object(m.c)())(Tr),Pr=Object(M.a)(d.a.createElement("path",{d:"M18,1 C20.6887547,1 22.8818181,3.12230671 22.9953805,5.78311038 L23,6 L23,9 C23,9.55228475 22.5522847,10 22,10 C21.4871642,10 21.0644928,9.61395981 21.0067277,9.11662113 L21,9 L21,6 C21,4.34314575 19.6568542,3 18,3 C16.4023191,3 15.0963391,4.24891996 15.0050927,5.82372721 L15,6 L15,8 C16.6568542,8 18,9.34314575 18,11 L18,19 C18,20.6568542 16.6568542,22 15,22 L5,22 C3.34314575,22 2,20.6568542 2,19 L2,11 C2,9.34314575 3.34314575,8 5,8 L13,8 L13,6 C13,3.3112453 15.1223067,1.11818189 17.7831104,1.00461951 L18,1 Z M15,10 L5,10 C4.44771525,10 4,10.4477153 4,11 L4,19 C4,19.5522847 4.44771525,20 5,20 L15,20 C15.5522847,20 16,19.5522847 16,19 L16,11 C16,10.4477153 15.5522847,10 15,10 Z M10,13.5 C10.8284271,13.5 11.5,14.1715729 11.5,15 C11.5,15.8284271 10.8284271,16.5 10,16.5 C9.17157288,16.5 8.5,15.8284271 8.5,15 C8.5,14.1715729 9.17157288,13.5 10,13.5 Z"}),"Unblock"),Nr=(a(551),d.a.memo((function(e){var t=e.userId,a=e.onClick,n=e.onUnblock,r=d.a.useState(!1),i=Object(C.a)(r,2),o=i[0],s=i[1],c=d.a.useState(0),l=Object(C.a)(c,2),u=l[0],p=l[1],h=d.a.useState(0),m=Object(C.a)(h,2),f=m[0],g=m[1],v=Object(y.c)().t,b=function(){s(!1),g(0),p(0)};return d.a.createElement(d.a.Fragment,null,d.a.createElement(ve.a,{className:"settings-list-item",button:!0,onClick:function(){a(t)},onContextMenu:function(e){if(e&&(e.preventDefault(),e.stopPropagation()),o)s(!1);else{var t=e.clientX,a=e.clientY;s(!0),g(t),p(a)}}},d.a.createElement(we.a,{userId:t})),d.a.createElement(St.a,{open:o,onClose:b,anchorReference:"anchorPosition",anchorPosition:{top:u,left:f},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},onMouseDown:function(e){return e.stopPropagation()}},d.a.createElement(kt.a,{onClick:function(e){return e.stopPropagation()}},d.a.createElement(Et.a,{onClick:function(){b(),n(t)}},d.a.createElement(be.a,null,d.a.createElement(Pr,null)),d.a.createElement(Ce.a,{primary:v("Unblock")})))))}))),Dr=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).handleUnblock=function(){var e=Object(i.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.a.send({"@type":"unblockUser",user_id:t});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.loadContent()}},{key:"loadContent",value:function(){var e=this.props.users,t=R.a.getStore();Object(N.F)(t,e.user_ids)}},{key:"render",value:function(){var e=this,t=this.props,a=t.onClose,n=t.users,r=t.t;return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"header-master"},d.a.createElement(E.a,{className:"header-left-button",onClick:a},d.a.createElement(Ne,null)),d.a.createElement("div",{className:"header-status grow cursor-pointer"},d.a.createElement("span",{className:"header-status-content"},r("BlockedUsers")))),d.a.createElement("div",{className:"sidebar-page-content"},d.a.createElement("div",{className:"sidebar-page-section"},n.user_ids.length>0?d.a.createElement(d.a.Fragment,null,d.a.createElement(sn,{multiline:!0},r("BlockedUsersInfo")),n.user_ids.map((function(t){return d.a.createElement(Nr,{key:t,userId:t,onClick:Q.k,onUnblock:e.handleUnblock})}))):d.a.createElement(sn,null,r("NoBlocked")))))}}]),a}(d.a.Component),Rr=Object(y.d)()(Dr),Br=Object(M.a)(d.a.createElement("g",{transform:"translate(0.000000, -2.000000)",fillRule:"nonzero"},d.a.createElement("path",{d:"M18,2 C20.209139,2 22,3.790861 22,6 L22,6 L22,8 C22,8.55228475 21.5522847,9 21,9 C20.4477153,9 20,8.55228475 20,8 L20,8 L20,6 C20,4.8954305 19.1045695,4 18,4 L18,4 L4,4 C2.8954305,4 2,4.8954305 2,6 L2,6 L2,14 C2,15.1045695 2.8954305,16 4,16 L4,16 L14,16 C14.5522847,16 15,16.4477153 15,17 C15,17.5522847 14.5522847,18 14,18 L14,18 L12,18 L12,20 L14,20 C14.5128358,20 14.9355072,20.3860402 14.9932723,20.8833789 L15,21 C15,21.5522847 14.5522847,22 14,22 L14,22 L8,22 C7.44771525,22 7,21.5522847 7,21 C7,20.4477153 7.44771525,20 8,20 L8,20 L10,20 L10,18 L4,18 C1.85780461,18 0.108921124,16.3160315 0.00489530723,14.1996403 L0,14 L0,6 C0,3.790861 1.790861,2 4,2 L4,2 Z M22,11 C23.1045695,11 24,11.8954305 24,13 L24,20 C24,21.1045695 23.1045695,22 22,22 L19,22 C17.8954305,22 17,21.1045695 17,20 L17,13 C17,11.8954305 17.8954305,11 19,11 L22,11 Z M22,13 L19,13 L19,20 L22,20 L22,13 Z"})),"Device"),Ar=Object(M.a)(d.a.createElement("g",{transform:"translate(-1.000000, -3.000000)",fillRule:"nonzero"},d.a.createElement("path",{d:"M9,13 C12.3229116,13 14.7530244,13.8337117 16.2223821,15.5699359 C16.724477,16.1632234 17,16.915291 17,17.6925226 L17,18.5 C17,19.8807119 15.8807119,21 14.5,21 L3.5,21 C2.11928813,21 1,19.8807119 1,18.5 L1,17.6925204 C1,16.9152876 1.2755246,16.1632192 1.77762117,15.569932 C3.24697824,13.8337108 5.67709024,13 9,13 Z M9,15 C6.21130036,15 4.33538166,15.6435809 3.30428673,16.861943 C3.10781409,17.0940989 3,17.3883868 3,17.6925212 L3,18.5 C3,18.7761424 3.22385763,19 3.5,19 L14.5,19 C14.7761424,19 15,18.7761424 15,18.5 L15,17.6925226 C15,17.3883883 14.8921864,17.0941004 14.6957148,16.8619448 C13.6646202,15.6435815 11.788701,15 9,15 Z M16,10 L22,10 C22.5522847,10 23,10.4477153 23,11 C23,11.5128358 22.6139598,11.9355072 22.1166211,11.9932723 L22,12 L16,12 C15.4477153,12 15,11.5522847 15,11 C15,10.4871642 15.3860402,10.0644928 15.8833789,10.0067277 L16,10 L22,10 L16,10 Z M9,3 C11.209139,3 13,4.790861 13,7 C13,9.209139 11.209139,11 9,11 C6.790861,11 5,9.209139 5,7 C5,4.790861 6.790861,3 9,3 Z M9,5 C7.8954305,5 7,5.8954305 7,7 C7,8.1045695 7.8954305,9 9,9 C10.1045695,9 11,8.1045695 11,7 C11,5.8954305 10.1045695,5 9,5 Z"})),"RemoveMember"),Fr=(a(552),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={sessions:null,users:null,openBlockedUsers:!1,openActiveSessions:!1},e.onUpdateUserFullInfo=function(t){var a=t.user_id,n=t.user_full_info,r=e.state.users;if(r){var i=r.total_count,o=r.user_ids,s=n.is_blocked;s!==(-1!==o.indexOf(a))&&(s?e.setState({users:Object(Ge.a)(Object(Ge.a)({},r),{},{total_count:i+1,user_ids:[a].concat(Object(Ct.a)(o))})}):e.setState({users:Object(Ge.a)(Object(Ge.a)({},r),{},{total_count:i-1,user_ids:o.filter((function(e){return e!==a}))})}))}},e.openActiveSessions=function(){e.state.sessions&&e.setState({openActiveSessions:!0})},e.closeActiveSessions=function(){e.setState({openActiveSessions:!1})},e.openBlockedUsers=function(){e.state.users&&e.setState({openBlockedUsers:!0})},e.closeBlockedUsers=function(){e.setState({openBlockedUsers:!1})},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.loadContent(),T.a.on("updateUserFullInfo",this.onUpdateUserFullInfo)}},{key:"componentWillUnmount",value:function(){T.a.off("updateUserFullInfo",this.onUpdateUserFullInfo)}},{key:"loadContent",value:function(){var e=Object(i.a)(r.a.mark((function e(){var t=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:$.a.send({"@type":"getActiveSessions"}).then((function(e){return t.setState({sessions:e})})),$.a.send({"@type":"getBlockedUsers",offset:0,limit:100}).then((function(e){return t.setState({users:e})}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.t,a=e.onClose,n=this.state,r=n.openBlockedUsers,i=n.users,o=n.openActiveSessions,s=n.sessions,c=s&&s.sessions.length>0?1===s.sessions.length?"1 session":"".concat(s.sessions.length," sessions"):"1 session",l=i&&i.total_count>0?1===i.total_count?"1 user":"".concat(i.total_count," users"):"no users";return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"header-master"},d.a.createElement(E.a,{className:"header-left-button",onClick:a},d.a.createElement(Ne,null)),d.a.createElement("div",{className:"header-status grow cursor-pointer"},d.a.createElement("span",{className:"header-status-content"},t("PrivacySettings")))),d.a.createElement("div",{className:"sidebar-page-content"},d.a.createElement("div",{className:"sidebar-page-section"},d.a.createElement(ve.a,{className:"settings-list-item2",role:void 0,button:!0,onClick:this.openBlockedUsers},d.a.createElement(be.a,{className:"settings-list-item-icon"},d.a.createElement(Ar,null)),d.a.createElement(Ce.a,{id:"label-2",className:"settings-list-item-text",primary:t("BlockedUsers"),secondary:l})),d.a.createElement(ve.a,{className:"settings-list-item2",role:void 0,button:!0,onClick:this.openActiveSessions},d.a.createElement(be.a,{className:"settings-list-item-icon"},d.a.createElement(Br,null)),d.a.createElement(Ce.a,{id:"label-2",className:"settings-list-item-text",primary:t("SessionsTitle"),secondary:c}))),d.a.createElement("div",{className:"sidebar-page-section-divider"}),d.a.createElement("div",{className:"sidebar-page-section"},d.a.createElement(sn,null,t("PrivacyTitle")),d.a.createElement(ve.a,{className:"settings-list-item2",role:void 0,button:!0},d.a.createElement(Ce.a,{className:"settings-list-item-text2",primary:t("PrivacyPhoneTitle"),secondary:t("LastSeenContacts")})),d.a.createElement(ve.a,{className:"settings-list-item2",role:void 0,button:!0},d.a.createElement(Ce.a,{className:"settings-list-item-text2",primary:t("LastSeenTitle"),secondary:t("LastSeenEverybody")})),d.a.createElement(ve.a,{className:"settings-list-item2",role:void 0,button:!0},d.a.createElement(Ce.a,{className:"settings-list-item-text2",primary:t("PrivacyProfilePhotoTitle"),secondary:t("LastSeenEverybody")})),d.a.createElement(ve.a,{className:"settings-list-item2",role:void 0,button:!0},d.a.createElement(Ce.a,{className:"settings-list-item-text2",primary:t("PrivacyForwardsTitle"),secondary:t("LastSeenEverybody")})),d.a.createElement(ve.a,{className:"settings-list-item2",role:void 0,button:!0},d.a.createElement(Ce.a,{className:"settings-list-item-text2",primary:t("WhoCanAddMe"),secondary:t("LastSeenEverybody")})))),d.a.createElement(Mn,{open:r,onClose:this.closeBlockedUsers},d.a.createElement(Rr,{users:i})),d.a.createElement(Mn,{open:o,onClose:this.closeActiveSessions},d.a.createElement(Lr,{sessions:s})))}}]),a}(d.a.Component)),Vr=Object(m.a)(Object(m.d)(),Object(y.d)(),Object(m.c)())(Fr),zr=(a(553),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onUpdateChatPhoto=function(e){var t=n.props.chatId,a=e.chat_id,r=e.photo;if(a===t&&r){var i=R.a.get();Object(N.t)(i,t,!0)}},n.openEditProfile=function(){n.setState({openEditProfile:!0})},n.closeEditProfile=function(){n.setState({openEditProfile:!1})},n.openGeneral=function(){n.setState({openGeneral:!0})},n.closeGeneral=function(){n.setState({openGeneral:!1})},n.openNotifications=function(){n.setState({openNotifications:!0})},n.closeNotifications=function(){n.setState({openNotifications:!1})},n.openPrivacySecurity=function(){n.setState({openPrivacySecurity:!0})},n.closePrivacySecurity=function(){n.setState({openPrivacySecurity:!1})},n.openLanguage=function(){n.setState({openLanguage:!0})},n.closeLanguage=function(){n.setState({openLanguage:!1})},n.handleCloseSettings=function(){$.a.clientUpdate({"@type":"clientUpdateSettings",open:!1})},n.state={openEditProfile:!1,openGeneral:!1,openNotifications:!1,openPrivacySecurity:!1,openLanguage:!1},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.loadContent(),D.a.on("updateChatPhoto",this.onUpdateChatPhoto)}},{key:"componentWillUnmount",value:function(){D.a.off("updateChatPhoto",this.onUpdateChatPhoto)}},{key:"loadContent",value:function(){var e=Object(i.a)(r.a.mark((function e(){var t,a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.chatId,a=R.a.getStore(),Object(N.t)(a,t,!0),e.next=5,$.a.send({"@type":"getUserFullInfo",user_id:T.a.getMyId()});case 5:n=e.sent,T.a.setFullInfo(T.a.getMyId(),n);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.popup,n=this.state,r=n.openEditProfile,i=n.openGeneral,o=n.openNotifications,s=n.openPrivacySecurity,c=n.openLanguage;return d.a.createElement(d.a.Fragment,null,d.a.createElement(Bn,{chatId:t,popup:a,onClose:this.handleCloseSettings,onEditProfile:this.openEditProfile,onGeneral:this.openGeneral,onNotifications:this.openNotifications,onPrivacySecurity:this.openPrivacySecurity,onLanguage:this.openLanguage}),d.a.createElement(Mn,{open:r,onClose:this.closeEditProfile},d.a.createElement(Kn,{chatId:t})),d.a.createElement(Mn,{open:i,onClose:this.closeGeneral},d.a.createElement(Er,{chatId:t})),d.a.createElement(Mn,{open:o,onClose:this.closeNotifications},d.a.createElement(Ir,{chatId:t})),d.a.createElement(Mn,{open:s,onClose:this.closePrivacySecurity},d.a.createElement(Vr,null)),d.a.createElement(Mn,{open:c,onClose:this.closeLanguage},d.a.createElement(Ur,null)))}}]),a}(d.a.Component)),Hr=Object(m.a)(Object(m.d)(),Object(y.d)(),Object(m.c)())(zr),Wr=(a(412),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t,a){var n=this.props,r=n.userId,i=n.style;return e.userId!==r||e.style.top!==i.top}},{key:"render",value:function(){var e=this.props,t=e.userId,a=e.onClick,n=e.style;return d.a.createElement(ve.a,{className:"user-list-item",onClick:function(){return a(t)},button:!0,style:n},d.a.createElement(we.a,{userId:t}))}}]),a}(d.a.Component)),Gr=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleScroll=function(e){n.handleDebounceScroll(),n.handleThrottleScroll()},n.loadRenderIdsContent=function(){var e=n.state,t=e.items,a=e.searchItems,r=a||t,i=(r===a?n.searchListRef:n.listRef).current;if(i){var o=i.getListRenderIds();if(o.size>0){var s=[];Object(Ct.a)(o.keys()).forEach((function(e){s.push(r.user_ids[e])}));var c=R.a.getStore();Object(N.F)(c,s)}}},n.handleOpenUser=function(e){Object(Q.k)(e,!1),n.handleClose()},n.renderItem=function(e,t){var a=e.index,r=e.style,i=t.user_ids[a];return d.a.createElement(Wr,{key:i,userId:i,onClick:function(){return n.handleOpenUser(i)},style:r})},n.handleSearch=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,i,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.trim()){e.next=4;break}return n.setState({searchItems:null}),e.abrupt("return");case 4:return e.next=6,$.a.send({"@type":"searchContacts",query:a,limit:1e3});case 6:(i=e.sent).user_ids=i.user_ids.sort((function(e,t){return Object(_.c)(e).localeCompare(Object(_.c)(t))})),o=R.a.getStore(),Object(N.F)(o,i.user_ids.slice(0,20)),n.setState({searchItems:i});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleClose=function(){$.a.clientUpdate({"@type":"clientUpdateContacts",open:!1})},n.searchInputRef=d.a.createRef(),n.listRef=d.a.createRef(),n.searchListRef=d.a.createRef(),n.state={items:null,searchItems:null},n.handleDebounceScroll=Object(We.d)(n.handleDebounceScroll,100,!1),n.handleThrottleScroll=Object(We.z)(n.handleThrottleScroll,200,!1),n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this.searchInputRef.current;e&&setTimeout((function(){return e.focus()}),50),this.loadContent()}},{key:"handleDebounceScroll",value:function(){this.loadRenderIdsContent()}},{key:"handleThrottleScroll",value:function(){this.loadRenderIdsContent()}},{key:"loadContent",value:function(){var e=Object(i.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=bn.contacts){e.next=7;break}return e.next=4,$.a.send({"@type":"getContacts"});case 4:(t=e.sent).user_ids=t.user_ids.sort((function(e,t){return Object(_.c)(e).localeCompare(Object(_.c)(t))})),bn.contacts=t;case 7:a=R.a.getStore(),Object(N.F)(a,t.user_ids.slice(0,20)),this.setState({items:t});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.popup,a=this.state,n=a.items,r=a.searchItems,i=t?{minHeight:800}:null;return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"header-master"},d.a.createElement(E.a,{className:"header-left-button",onClick:this.handleClose},t?d.a.createElement(w.a,null):d.a.createElement(Ne,null)),d.a.createElement(On,{inputRef:this.searchInputRef,onChange:this.handleSearch})),d.a.createElement("div",{className:"contacts-content",style:i},n&&d.a.createElement(Va,{ref:this.listRef,className:"contacts-list",source:n.user_ids,rowHeight:72,overScanCount:20,renderItem:function(t){return e.renderItem(t,n)},onScroll:this.handleScroll}),r&&d.a.createElement(Va,{ref:this.searchListRef,className:"contacts-list contacts-search-list",source:r.user_ids,rowHeight:72,overScanCount:20,renderItem:function(t){return e.renderItem(t,r)},onScroll:this.handleScroll})))}}]),a}(d.a.Component),Zr=a(361),qr=(a(554),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdatePageWidth=function(e){var t=e.isSmallWidth;n.setState({isSmallWidth:t})},n.onClientUpdateNewContentAvailable=function(){n.setState({newContentAvailable:!0})},n.handleUpdate=function(){n.handled||(n.handled=!0,setTimeout((function(){window.location.reload()}),250))};var r=lt.a.isSmallWidth;return n.state={newContentAvailable:!1,isSmallWidth:r},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){lt.a.on("clientUpdateNewContentAvailable",this.onClientUpdateNewContentAvailable),lt.a.on("clientUpdatePageWidth",this.onClientUpdatePageWidth)}},{key:"componentWillUnmount",value:function(){lt.a.off("clientUpdateNewContentAvailable",this.onClientUpdateNewContentAvailable),lt.a.off("clientUpdatePageWidth",this.onClientUpdatePageWidth)}},{key:"render",value:function(){var e=this.state,t=e.newContentAvailable,a=e.isSmallWidth,n=this.props.t;return t?d.a.createElement(k.a,{className:"update-button",variant:"contained",color:"primary",onClick:this.handleUpdate},a?d.a.createElement(Zr.a,null):n("Update")):null}}]),a}(d.a.Component)),Kr=Object(y.d)()(qr),Jr=a(30);function Yr(){var e=D.a.chatList.get("chatListArchive"),t=[],a=[];if(e){var n,r=Object(Jr.a)(e.keys());try{for(r.s();!(n=r.n()).done;){var i=n.value,o=D.a.get(i);o&&("0"!==o.order&&t.push(o),a.push({order:o.order,id:o.id,title:o.title}))}}catch(s){r.e(s)}finally{r.f()}}return t.sort((function(e,t){return Object(We.w)(t.order,e.order)})).map((function(e){return e.title})).join(", ")}var Qr=a(200),Xr=(a(555),a(413),a(414),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleClose=function(){$.a.clientUpdate({"@type":"clientUpdateNewChannel",open:!1})},n.handleDone=Object(i.a)(r.a.mark((function e(){var t,a,i,o,s,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state.error,a=n.state,i=a.defaultPhoto,o=a.defaultPhotoFile,s=n.titleRef.current.value.trim()){e.next=6;break}return n.setState({error:!0}),e.abrupt("return");case 6:return t&&n.setState({error:!1}),n.handleClose(),c=n.descriptionRef.current.value,e.next=11,$.a.send({"@type":"createNewSupergroupChat",title:s,description:c,is_channel:!0,location:null});case 11:l=e.sent,o?$.a.send({"@type":"setChatPhoto",chat_id:l.id,photo:{"@type":"inputFileId",id:o.id}}):i&&$.a.send({"@type":"setChatPhoto",chat_id:l.id,photo:{"@type":"inputFileBlob",name:"photo.jpg",data:i}}),Object(Q.i)(l.id);case 14:case"end":return e.stop()}}),e)}))),n.handleChoosePhoto=function(){var e=Object(i.a)(r.a.mark((function e(t,a){var i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({defaultPhoto:t,defaultPhotoURL:a}),e.next=3,$.a.send({"@type":"uploadFile",file:{"@type":"inputFileBlob",name:"photo.jpg",data:t},file_type:{"@type":"fileTypePhoto"},priority:v.ob});case 3:i=e.sent,n.setState({defaultPhotoFile:i});case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.titleRef=d.a.createRef(),n.descriptionRef=d.a.createRef(),n.state={error:!1,defaultPhoto:null,defaultPhotoURL:null,defaultPhotoFile:null},n}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.popup,a=e.t,n=this.state.error;return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"header-master"},d.a.createElement(E.a,{className:"header-left-button",onClick:this.handleClose},t?d.a.createElement(w.a,null):d.a.createElement(Ne,null)),d.a.createElement("div",{className:"header-status grow cursor-pointer"},d.a.createElement("span",{className:"header-status-content"},a("NewChannel")))),d.a.createElement("div",{className:"sidebar-page-content"},d.a.createElement("div",{className:"new-chat-content"},d.a.createElement(Zn,{onChoose:this.handleChoosePhoto}),d.a.createElement("div",{className:"new-chat-title"},d.a.createElement(An.a,{inputRef:this.titleRef,error:n,className:"new-chat-input",variant:"outlined",fullWidth:!0,label:a("EnterChannelName"),defaultValue:""}),d.a.createElement(An.a,{inputRef:this.descriptionRef,className:"new-chat-input",variant:"outlined",fullWidth:!0,label:a("DescriptionOptionalPlaceholder"),defaultValue:""}),d.a.createElement("div",{className:"edit-profile-hint"},a("DescriptionInfo"))))),d.a.createElement("div",{className:"new-chat-bottom-button",onClick:this.handleDone},d.a.createElement(Ne,null)))}}]),a}(d.a.Component)),$r=Object(y.d)()(Xr),ei=(a(556),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).divRef=d.a.createRef(),n}return Object(s.a)(a,[{key:"getOffset",value:function(){return{left:this.divRef.current.offsetLeft,top:this.divRef.current.offsetTop,width:this.divRef.current.offsetWidth,height:this.divRef.current.offsetHeight}}},{key:"setStyleCSSText",value:function(e){var t=this.divRef.current;t&&(t.style.cssText=e)}},{key:"render",value:function(){var e=this.props,t=e.userId,a=e.selected,n=e.onClick;return d.a.createElement("div",{ref:this.divRef,className:h()("user-chip",{"item-selected":a}),onClick:n},d.a.createElement(nn.a,{userId:t,small:!0}),d.a.createElement("div",{className:"user-chip-delete"},d.a.createElement(w.a,{className:"user-chip-delete-icon"})),d.a.createElement("div",{className:"user-chip-name"},Object(_.e)(t)))}}]),a}(d.a.Component)),ti=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t,a){var n=this.props,r=n.userId,i=n.selected,o=n.style;return e.userId!==r||(e.selected!==i||e.style.top!==o.top)}},{key:"render",value:function(){var e=this.props,t=e.userId,a=e.selected,n=e.onClick,r=e.style;return d.a.createElement(ve.a,{className:"user-list-item",onClick:function(){return n(t)},button:!0,style:r},d.a.createElement(wr.a,{className:"user-list-item-checkbox",checked:a,color:"primary"}),d.a.createElement(we.a,{userId:t}))}}]),a}(d.a.Component),ai=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleScroll=function(e){n.handleDebounceScroll(),n.handleThrottleScroll()},n.loadRenderIdsContent=function(){var e=n.state,t=e.items,a=e.searchItems,r=a||t,i=(r===a?n.searchListRef:n.listRef).current;if(i){var o=i.getListRenderIds();if(o.size>0){var s=[];Object(Ct.a)(o.keys()).forEach((function(e){s.push(r.user_ids[e])}));var c=R.a.getStore();Object(N.F)(c,s)}}},n.handleOpenUser=function(e){var t,a=n.state,r=a.selectedItems,i=a.focusedItem,o=r.map,s=r.array,c=new Map(o),l=null,u=!1;o.has(e)?(c.delete(e),t=s.filter((function(t){return t!==e})),l=i===e?null:i,u=!0):(c.set(e,e),t=s.concat([e]),l=null);var d=n.searchInputRef.current;d.focus(),u||(d.innerText="",n.handleSearch(""));var p,h=n.wrapPanelRef.current,m=h.scrollHeight,f=h.offsetHeight,g=new Map,v=Object(Jr.a)(n.itemsRef.keys());try{for(v.s();!(p=v.n()).done;){var b=p.value,C=n.itemsRef.get(b);if(C){var y=C.getOffset();g.set(b,y)}}}catch(S){v.e(S)}finally{v.f()}var k=h.style.cssText,E=h.scrollTop;u&&(h.style.cssText=null),n.setState({focusedItem:l,selectedItems:{array:t,map:c}},(function(){var e=h.scrollHeight,t=(h.offsetHeight,e<m);e>m?m<123?(h.style.cssText="max-height: ".concat(Math.min(m,123),"px;"),requestAnimationFrame((function(){h.style.cssText="max-height: ".concat(Math.min(e,123),"px;"),setTimeout((function(){n.searchInputRef.current.scrollIntoView({behavior:"auto"})}),250)}))):(h.style.cssText="max-height: ".concat(123,"px;"),n.searchInputRef.current.scrollIntoView({behavior:"smooth"})):t?e<123?(h.style.cssText="min-height: ".concat(Math.min(f,123),"px;"),requestAnimationFrame((function(){h.style.cssText="min-height: ".concat(Math.min(e,123),"px;")}))):(h.style.cssText="max-height: ".concat(123,"px;"),h.scrollTop=E):u?(h.style.cssText=k,h.scrollTop=E):n.searchInputRef.current.scrollIntoView({behavior:"smooth"}),n.animateItems(g)}))},n.renderItem=function(e,t,a){var r=e.index,i=e.style,o=t[r],s=a.has(o);return d.a.createElement(ti,{key:o,userId:o,selected:s,onClick:function(){return n.handleOpenUser(o)},style:i})},n.handleSearch=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,i,o,s,c,l,u,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.trim()){e.next=4;break}return n.setState({searchItems:null,publicItems:null,focusedItem:null}),e.abrupt("return");case 4:return(i=[]).push($.a.send({"@type":"searchContacts",query:a,limit:20})),i.push($.a.send({"@type":"searchPublicChats",query:a})),e.next=9,Promise.all(i);case 9:o=e.sent,s=Object(C.a)(o,2),c=s[0],l=s[1],c.user_ids=c.user_ids.sort((function(e,t){return Object(_.c)(e).localeCompare(Object(_.c)(t))})),u={"@type":"users",user_ids:[]},l.chat_ids.reduce((function(e,t){var a=D.a.get(t);return a&&"chatTypePrivate"===a.type["@type"]&&e.push(a.type.user_id),e}),u.user_ids),d=R.a.getStore(),Object(N.F)(d,c.user_ids),Object(N.F)(d,u.user_ids),n.setState({searchItems:c,publicItems:u,focusedItem:null});case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleClose=function(){$.a.clientUpdate({"@type":"clientUpdateNewGroup",open:!1})},n.handleSearchClose=function(e){var t=n.state,a=t.selectedItems,r=t.focusedItem;a&&(a.map.has(r)&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),n.setState({focusedItem:null})))},n.handleBackspace=function(){var e=n.state,t=e.selectedItems,a=e.focusedItem;if(t){var r=t.array,i=t.map;if(r&&r.length)if(i.has(a))n.handleOpenUser(a);else{var o=r[r.length-1];o&&n.setState({focusedItem:o})}}},n.titleRef=d.a.createRef(),n.searchInputRef=d.a.createRef(),n.listRef=d.a.createRef(),n.searchListRef=d.a.createRef(),n.wrapPanelRef=d.a.createRef(),n.itemsRef=new Map,n.state={items:null,searchItems:null,selectedItems:{array:[],map:new Map},focusedItem:null},n.handleDebounceScroll=Object(We.d)(n.handleDebounceScroll,100,!1),n.handleThrottleScroll=Object(We.z)(n.handleThrottleScroll,200,!1),n}return Object(s.a)(a,[{key:"getUserIds",value:function(){return this.state.selectedItems.array}},{key:"componentDidMount",value:function(){var e=this.searchInputRef.current;e&&setTimeout((function(){return e.focus()}),50),this.loadContent()}},{key:"handleDebounceScroll",value:function(){this.loadRenderIdsContent()}},{key:"handleThrottleScroll",value:function(){this.loadRenderIdsContent()}},{key:"loadContent",value:function(){var e=Object(i.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=bn.contacts){e.next=7;break}return e.next=4,$.a.send({"@type":"getContacts"});case 4:(t=e.sent).user_ids=t.user_ids.sort((function(e,t){return Object(_.c)(e).localeCompare(Object(_.c)(t))})),bn.contacts=t;case 7:a=R.a.getStore(),Object(N.F)(a,t.user_ids.slice(0,20)),this.setState({items:t});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"animateItems",value:function(e){var t,a=this,n=new Map,r=Object(Jr.a)(this.itemsRef.keys());try{for(r.s();!(t=r.n()).done;){var i=t.value,o=this.itemsRef.get(i);if(o){var s=o.getOffset(),c=e.has(i)?e.get(i):null;if(c){c.left<s.left&&n.set(o,{prevOffset:c,currentOffset:s});var l="transform: translate(".concat(c.left-s.left,"px, ").concat(c.top-s.top,"px)");o.setStyleCSSText(l)}}}}catch(u){r.e(u)}finally{r.f()}requestAnimationFrame((function(){var e,t=Object(Jr.a)(a.itemsRef.keys());try{for(t.s();!(e=t.n()).done;){var r=e.value,i=a.itemsRef.get(r);if(i){var o="transition: transform 0.25s ease";if(n.has(i)){var s=n.get(i),c=s.prevOffset,l=s.currentOffset;o="transform: translate(".concat(c.left-l.left-c.width,"px, ").concat(c.top-l.top,"px);")+"transition: transform 0.1s ease;"}i.setStyleCSSText(o)}}}catch(u){t.e(u)}finally{t.f()}n.size&&setTimeout((function(){var e,t=Object(Jr.a)(n.keys());try{for(t.s();!(e=t.n()).done;){var a=e.value,r=n.get(a).currentOffset,i="transform: translate(".concat(r.width,"px, 0);")+"transition: transform 0s ease;";a.setStyleCSSText(i)}}catch(u){t.e(u)}finally{t.f()}requestAnimationFrame((function(){var e,t=Object(Jr.a)(n.keys());try{for(t.s();!(e=t.n()).done;){var a=e.value;a.setStyleCSSText("transition: transform 0.15s ease")}}catch(u){t.e(u)}finally{t.f()}}))}),101)}))}},{key:"render",value:function(){var e=this,t=this.props,a=t.popup,n=t.t,r=this.state,i=r.items,o=r.searchItems,s=r.publicItems,c=r.selectedItems,l=r.focusedItem,u=a?{minHeight:800}:null;return this.itemsRef.clear(),d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"header-master"},d.a.createElement(E.a,{className:"header-left-button",onClick:this.handleClose},a?d.a.createElement(w.a,null):d.a.createElement(Ne,null)),d.a.createElement("div",{className:"header-status grow cursor-pointer"},d.a.createElement("span",{className:"header-status-content"},n("GroupAddMembers")))),d.a.createElement("div",{ref:this.wrapPanelRef,className:"animated-wrap-panel"},c.array.map((function(t){return d.a.createElement(ei,{selected:l===t,ref:function(a){e.itemsRef.set(t,a)},key:t,userId:t,onClick:function(){return e.handleOpenUser(t)}})})),d.a.createElement(On,{inputRef:this.searchInputRef,hint:n("SendMessageTo"),onClose:this.handleSearchClose,onChange:this.handleSearch,onBackspace:this.handleBackspace})),d.a.createElement("div",{className:"contacts-border"}),d.a.createElement("div",{className:"contacts-content",style:u},i&&d.a.createElement(Va,{ref:this.listRef,className:"contacts-list",source:i.user_ids,rowHeight:72,overScanCount:20,renderItem:function(t){return e.renderItem(t,i.user_ids,c.map)},onScroll:this.handleScroll}),o&&s&&d.a.createElement(Va,{ref:this.searchListRef,className:"contacts-list contacts-search-list",source:o.user_ids.concat(s.user_ids),rowHeight:72,overScanCount:20,renderItem:function(t){return e.renderItem(t,o.user_ids.concat(s.user_ids),c.map)},onScroll:this.handleScroll})))}}]),a}(d.a.Component),ni=Object(m.a)(Object(m.d)(),Object(y.d)(),Object(m.c)())(ai),ri=(a(557),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t,a){var n=this.props.userId;return e.userId!==n}},{key:"render",value:function(){var e=this.props,t=e.userId,a=e.style;return d.a.createElement(ve.a,{className:"user-list-item",button:!0,style:a},d.a.createElement(we.a,{userId:t}))}}]),a}(d.a.Component)),ii=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleClose=function(){var e=n.props.onClose;e&&e()},n.titleRef=d.a.createRef(),n.state={error:!1},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.userIds,t=R.a.getStore();Object(N.F)(t,e)}},{key:"getTitle",value:function(){var e=this.state.error,t=this.titleRef.current.value.trim();return t?(e&&this.setState({error:!1}),t):(this.setState({error:!0}),t)}},{key:"render",value:function(){var e=this.props,t=e.t,a=e.userIds,n=e.defaultPhotoURL,r=e.onChoosePhoto,i=this.state.error,o=a.map((function(e){return d.a.createElement(ri,{key:e,userId:e})})),s=1!==a.length?"".concat(a.length," members"):"".concat(a.length," member");return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"header-master"},d.a.createElement(E.a,{className:"header-left-button",onClick:this.handleClose},d.a.createElement(Ne,null)),d.a.createElement("div",{className:"header-status grow cursor-pointer"},d.a.createElement("span",{className:"header-status-content"},t("NewGroup")))),d.a.createElement("div",{className:"sidebar-page-content"},d.a.createElement("div",{className:"new-chat-content"},d.a.createElement(Zn,{defaultURL:n,onChoose:r}),d.a.createElement("div",{className:"new-chat-title"},d.a.createElement(An.a,{inputRef:this.titleRef,error:i,className:"new-chat-input",variant:"outlined",fullWidth:!0,label:t("GroupName"),defaultValue:""})),d.a.createElement(sn,null,s),o)))}}]),a}(d.a.Component),oi=Object(m.a)(Object(m.d)(),Object(y.d)(),Object(m.c)())(ii),si=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleDone=Object(i.a)(r.a.mark((function e(){var t,a,i,o,s,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.state.openParams){e.next=8;break}if((t=n.addParticipantsRef.current.getUserIds()).length){e.next=5;break}return e.abrupt("return");case 5:n.setState({openParams:!0,userIds:t}),e.next=19;break;case 8:if(a=n.state,i=a.userIds,o=a.defaultPhoto,s=a.defaultPhotoFile,c=n.newGroupParamsRef.current.getTitle()){e.next=12;break}return e.abrupt("return");case 12:return n.handleClose(),e.next=15,$.a.send({"@type":"createNewSupergroupChat",title:c,is_channel:!1,description:"",location:null});case 15:l=e.sent,s?$.a.send({"@type":"setChatPhoto",chat_id:l.id,photo:{"@type":"inputFileId",id:s.id}}):o&&$.a.send({"@type":"setChatPhoto",chat_id:l.id,photo:{"@type":"inputFileBlob",name:"photo.jpg",data:o}}),i.length>0&&$.a.send({"@type":"addChatMembers",chat_id:l.id,user_ids:i}),Object(Q.i)(l.id);case 19:case"end":return e.stop()}}),e)}))),n.handleClose=function(){$.a.clientUpdate({"@type":"clientUpdateNewGroup",open:!1})},n.handleCloseParams=function(){n.setState({openParams:!1,userIds:[]})},n.handleChoosePhoto=function(){var e=Object(i.a)(r.a.mark((function e(t,a){var i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({defaultPhoto:t,defaultPhotoURL:a}),e.next=3,$.a.send({"@type":"uploadFile",file:{"@type":"inputFileBlob",name:"photo.jpg",data:t},file_type:{"@type":"fileTypePhoto"},priority:v.ob});case 3:i=e.sent,n.setState({defaultPhotoFile:i});case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.addParticipantsRef=d.a.createRef(),n.newGroupParamsRef=d.a.createRef(),n.state={openParams:!1,userIds:[],defaultPhoto:null,defaultPhotoURL:null,defaultPhotoFile:null},n}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.popup,t=this.state,a=t.openParams,n=t.userIds,r=t.defaultPhotoURL;return d.a.createElement(d.a.Fragment,null,d.a.createElement(ni,{ref:this.addParticipantsRef,popup:e,onClose:this.handleClose}),d.a.createElement(Mn,{open:a},d.a.createElement(oi,{ref:this.newGroupParamsRef,defaultPhotoURL:r,userIds:n,onChoosePhoto:this.handleChoosePhoto,onClose:this.handleCloseParams})),d.a.createElement("div",{className:"new-chat-bottom-button",onClick:this.handleDone},d.a.createElement(Ne,null)))}}]),a}(d.a.Component),ci=Object(y.d)()(si),li=(a(558),a(120)),ui=a.n(li),di=(a(153),{headers:{"Content-Type":"application/json;charset=UTF-8","Access-Control-Allow-Origin":"*",crossdomain:"true"}}),pi=new(function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;return Object(o.a)(this,a),(e=t.call(this)).importContactToBackend=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,n,i,o,s,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(a=T.a.getMyId())){e.next=3;break}return e.abrupt("return",[]);case 3:if(n="",i="",o="",(s=T.a.get(a))||n||i){e.next=11;break}return e.abrupt("return",null);case 11:s&&(n=s.first_name,i=s.last_name,o=s.phone_number);case 12:return"http://localhost/Dropbox/telegram-api/backend/web/telegram-contact/import-contact",e.next=15,ui.a.post("http://localhost/Dropbox/telegram-api/backend/web/telegram-contact/import-contact",{telegram_user_id:a,first_name:n,last_name:i,phone:o,imported_contacts:t},di).catch((function(e){return console.log(e)})).then((function(e){return console.log("response:",e),e}));case 15:return c=e.sent,e.abrupt("return",c);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.getTelegramUserContacts=Object(i.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(t=T.a.getMyId())){e.next=3;break}return e.abrupt("return",[]);case 3:return"http://localhost/Dropbox/telegram-api/backend/web/telegram-contact/get-telegram-user-contact",e.next=6,ui.a.post("http://localhost/Dropbox/telegram-api/backend/web/telegram-contact/get-telegram-user-contact",{phone:t},di);case 6:return a=e.sent,e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)}))),e.getTelegramUserGroups=Object(i.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(t=T.a.getMyId())){e.next=3;break}return e.abrupt("return",[]);case 3:return"http://localhost/Dropbox/telegram-api/backend/web/telegram-contact/get-telegram-user-group",e.next=6,ui.a.post("http://localhost/Dropbox/telegram-api/backend/web/telegram-contact/get-telegram-user-group",{phone:t},di);case 6:return a=e.sent,e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)}))),e.postToDatabase=function(){var e=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"http://localhost/Dropbox/telegram-api/backend/web/telegram-contact/import-contact",e.next=3,ui.a.post("http://localhost/Dropbox/telegram-api/backend/web/telegram-contact/import-contact",t,di).catch((function(e){return console.log(e)})).then((function(e){return console.log("response:",e),e}));case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.addContact=function(t){if(console.log("request:",t),e.client)return e.disableLog?e.client.send(t):(console.log("send",t),e.client.send(t).then((function(e){return console.log("send result",e),e})).catch((function(e){throw console.error("send error",e),e})));console.log("send (none init)",t)},e}return a}(fn.a)),hi=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t,a){var n=this.props,r=n.userId,i=n.style;return e.userId!==r||e.style.top!==i.top}},{key:"render",value:function(){var e=this.props,t=e.userId,a=e.onClick,n=e.style;return d.a.createElement(ve.a,{className:"user-list-item",onClick:function(){return a(t)},button:!0,style:n},d.a.createElement(we.a,{userId:t}))}}]),a}(d.a.Component),mi=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleScroll=function(e){n.handleDebounceScroll(),n.handleThrottleScroll()},n.loadRenderIdsContent=function(){var e=n.state,t=e.items,a=e.searchItems,r=a||t,i=(r===a?n.searchListRef:n.listRef).current;if(i){var o=i.getListRenderIds();if(o.size>0){var s=[];Object(Ct.a)(o.keys()).forEach((function(e){s.push(r.user_ids[e])}));var c=R.a.getStore();Object(N.F)(c,s)}}},n.handleOpenUser=function(e){Object(Q.k)(e,!1),n.handleClose()},n.renderItem=function(e,t){var a=e.index,r=e.style,i=t.user_ids[a];return d.a.createElement(hi,{key:i,userId:i,onClick:function(){return n.handleOpenUser(i)},style:r})},n.handleSearch=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,i,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.trim()){e.next=4;break}return n.setState({searchItems:null}),e.abrupt("return");case 4:return e.next=6,$.a.send({"@type":"searchContacts",query:a,limit:1e3});case 6:(i=e.sent).user_ids=i.user_ids.sort((function(e,t){return Object(_.c)(e).localeCompare(Object(_.c)(t))})),o=R.a.getStore(),Object(N.F)(o,i.user_ids.slice(0,20)),n.setState({searchItems:i});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleClose=function(){$.a.clientUpdate({"@type":"clientUpdateCustomContacts",open:!1})},n.handleAddContact=function(){console.log("handle Add Multi Contact running"),$.a.addContact({"@type":"importContacts",contacts:[{phone_number:"+85592718998",first_name:"Khut",last_name:"Rathana",user_id:0},{phone_number:"+855968585789",first_name:"Kreom",last_name:"Dararith",user_id:0},{phone_number:"+85595208717",first_name:"Cellcard",last_name:"Phone Test",user_id:0},{phone_number:"+85589322588",first_name:"Pheakdey",last_name:"ACE.IT",user_id:0},{phone_number:"+85586334497",first_name:"Sela",last_name:"Tak",user_id:0}]}).catch((function(e){return console.log(e)})).then((function(e){console.log("response:",e)}))},n.handleSendBulkMessageOld=function(){var e=n.state.items;console.log("contacts:",e)},n.handleSendBulkMessage=function(){n.sendBulkMessageToAllContacts()},n.sendBulkMessageToAllContacts=function(){n.state.items.user_ids.map((function(e,t){if("777000"!=e){var a=Object(wt.m)("Hello, This message send from Testing API Telegram ReactJS APP"),n=a.text,r=a.entities;setTimeout((function(){$.a.send({"@type":"sendMessage",chat_id:e,input_message_content:{"@type":"inputMessageText",text:{"@type":"formattedText",text:n,entities:r},disable_web_page_preview:!1,clear_draft:!1}}).catch((function(t){console.log(t),"error"==t["@type"]&&5==t.code&&$.a.send({"@type":"createPrivateChat",user_id:e}).catch((function(e){return console.log(e)})).then((function(t){console.log("Successful create Private Chat"+e+" :",t),$.a.send({"@type":"sendMessage",chat_id:e,input_message_content:{"@type":"inputMessageText",text:{"@type":"formattedText",text:n,entities:r},disable_web_page_preview:!1,clear_draft:!1}}).catch((function(e){return console.log("Error Send Message After Create Private Chat",e)})).then((function(t){console.log("Successful Message send to chat"+e+" After Create Private Chat :",t)}))}))})).then((function(t){console.log("Message send to chat"+e+" :",t)}))}),1e3)}}))},n.sendBulkMessageToAllChatRooms=function(){n.state.chats.map((function(e,t){if("777000"!=e.id){var a=Object(wt.m)("Hello, This message send from Testing API Telegram ReactJS APP"),n=a.text,r=a.entities;setTimeout((function(){$.a.send({"@type":"sendMessage",chat_id:e.id,input_message_content:{"@type":"inputMessageText",text:{"@type":"formattedText",text:n,entities:r},disable_web_page_preview:!1,clear_draft:!1}}).catch((function(e){return console.log(e)})).then((function(t){console.log("get chat"+e.id+" :",t)}))}),1e3)}}))},n.handleGetContactList=Object(i.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=bn.contacts){e.next=8;break}return e.next=4,$.a.send({"@type":"getContacts"});case 4:(t=e.sent).user_ids=t.user_ids.sort((function(e,t){return console.log(Object(_.c)(e)),Object(_.c)(e).localeCompare(Object(_.c)(t))})),e.next=9;break;case 8:t.user_ids=t.user_ids.sort((function(e,t){return console.log(Object(_.c)(e)),Object(_.c)(e).localeCompare(Object(_.c)(t))}));case 9:return a=[],e.next=12,t.user_ids.forEach((function(e){var t=T.a.get(e);if(!(t||n||r))return null;var n="",r="",i="";t&&(n=t.first_name,r=t.last_name,i=t.phone_number),a.push({id:e,firstName:n,lastName:r,phone:i})}));case 12:console.log("contact info:",a);case 13:case"end":return e.stop()}}),e)}))),n.handleTestImportContact=function(){pi.postToDatabase({name:"hello world"}).catch((function(e){return console.log(e)})).then((function(e){console.log("res",e)}))},n.handleSendMessage=function(){var e=Object(wt.m)("Hello, This message send from Testing API Telegram ReactJS APP"),t=e.text,a=e.entities,n="697885318";setTimeout((function(){$.a.send({"@type":"sendMessage",chat_id:n,input_message_content:{"@type":"inputMessageText",text:{"@type":"formattedText",text:t,entities:a},disable_web_page_preview:!1,clear_draft:!1}}).catch((function(e){console.log(e),"error"==e["@type"]&&5==e.code&&$.a.send({"@type":"createPrivateChat",user_id:n}).catch((function(e){return console.log(e)})).then((function(e){console.log("Successful create Private Chat"+n+" :",e),$.a.send({"@type":"sendMessage",chat_id:n,input_message_content:{"@type":"inputMessageText",text:{"@type":"formattedText",text:t,entities:a},disable_web_page_preview:!1,clear_draft:!1}}).catch((function(e){return console.log("Error Send Message After Create Private Chat",e)})).then((function(e){console.log("Successful Message send to chat"+n+" After Create Private Chat :",e)}))})),"error"==e["@type"]&&6==e.code&&console.log("Contact no belong to this account")})).then((function(e){console.log("Message send to chat"+n+" :",e)}))}),1e3)},n.handleAddNoneExistingContact=function(){console.log("Function add none existing contact, not implement yet!")},n.searchInputRef=d.a.createRef(),n.listRef=d.a.createRef(),n.searchListRef=d.a.createRef(),n.state={items:null,searchItems:null},n.handleDebounceScroll=Object(We.d)(n.handleDebounceScroll,100,!1),n.handleThrottleScroll=Object(We.z)(n.handleThrottleScroll,200,!1),n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this.searchInputRef.current;e&&setTimeout((function(){return e.focus()}),50),this.loadContent()}},{key:"handleDebounceScroll",value:function(){this.loadRenderIdsContent()}},{key:"handleThrottleScroll",value:function(){this.loadRenderIdsContent()}},{key:"loadContent",value:function(){var e=Object(i.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=bn.contacts){e.next=7;break}return e.next=4,$.a.send({"@type":"getContacts"});case 4:(t=e.sent).user_ids=t.user_ids.sort((function(e,t){return Object(_.c)(e).localeCompare(Object(_.c)(t))})),bn.contacts=t;case 7:a=R.a.getStore(),Object(N.F)(a,t.user_ids.slice(0,20)),this.setState({items:t});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.popup,a=this.state,n=a.items,r=a.searchItems,i=t?{minHeight:800}:null;return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"header-master"},d.a.createElement(E.a,{className:"header-left-button",onClick:this.handleClose},t?d.a.createElement(w.a,null):d.a.createElement(Ne,null)),d.a.createElement(On,{inputRef:this.searchInputRef,onChange:this.handleSearch})),d.a.createElement("button",{className:"btn my-custom-button",onClick:this.handleAddContact}," Add Contact Test"),d.a.createElement("button",{className:"btn my-custom-button",onClick:this.handleSendBulkMessage}," Send Bulk Message"),d.a.createElement("button",{className:"btn my-custom-button",onClick:this.handleGetContactList}," Get Contact List"),d.a.createElement("button",{className:"btn my-custom-button",onClick:this.handleSendMessage}," Send One Message"),d.a.createElement("button",{className:"btn my-custom-button",onClick:this.handleTestImportContact}," Test Import Contact"),d.a.createElement("button",{className:"btn my-custom-button",onClick:this.handleAddNoneExistingContact}," Get User By ID"),d.a.createElement("br",null),d.a.createElement("hr",{className:"my-hr-divider"}),d.a.createElement("div",{className:"contacts-content",style:i},n&&d.a.createElement(Va,{ref:this.listRef,className:"contacts-list",source:n.user_ids,rowHeight:72,overScanCount:20,renderItem:function(t){return e.renderItem(t,n)},onScroll:this.handleScroll}),r&&d.a.createElement(Va,{ref:this.searchListRef,className:"contacts-list contacts-search-list",source:r.user_ids,rowHeight:72,overScanCount:20,renderItem:function(t){return e.renderItem(t,r)},onScroll:this.handleScroll})))}}]),a}(d.a.Component),fi=(a(559),a(655)),gi=a(653),vi=d.a.forwardRef((function(e,t){return d.a.createElement(fi.a,Object.assign({direction:"zoom",ref:t},e))})),bi=function(e){var t=e.id,a=e.firstName,n=e.lastName,r=(e.phone,e.selected),i=e.index;return d.a.createElement(d.a.Fragment,null,d.a.createElement(rr.a,{control:d.a.createElement(wr.a,{checked:r,onChange:function(){return e.handleChange(i)},name:"contacts[]",color:"primary",value:t||""}),label:"".concat(a," ").concat(n)}))},Ci=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleScroll=function(e){n.handleDebounceScroll(),n.handleThrottleScroll()},n.loadRenderIdsContent=function(){var e=n.state,t=e.items,a=e.searchItems,r=a||t,i=(r===a?n.searchListRef:n.listRef).current;if(i){var o=i.getListRenderIds();if(o.size>0){var s=[];Object(Ct.a)(o.keys()).forEach((function(e){s.push(r.user_ids[e])}));var c=R.a.getStore();Object(N.F)(c,s)}}},n.handleOpenUser=function(e){Object(Q.k)(e,!1),n.handleClose()},n.handleClose=function(){$.a.clientUpdate({"@type":"clientUpdateMarketingTool",open:!1})},n.handleSelectGroup=function(){},n.handleGetContactList=Object(i.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=bn.contacts){e.next=8;break}return e.next=4,$.a.send({"@type":"getContacts"});case 4:(t=e.sent).user_ids=t.user_ids.sort((function(e,t){return Object(_.c)(e).localeCompare(Object(_.c)(t))})),e.next=9;break;case 8:t.user_ids=t.user_ids.sort((function(e,t){return console.log(Object(_.c)(e)),Object(_.c)(e).localeCompare(Object(_.c)(t))}));case 9:return a=[],e.next=12,t.user_ids.forEach((function(e){var t=T.a.get(e);if(!(t||n||r))return null;var n="",r="",i="";t&&(n=t.first_name,r=t.last_name,i=t.phone_number),a.push({id:e,firstName:n,lastName:r,phone:i,selected:!1})}));case 12:console.log("contact info:",a),n.setState({contacts:a});case 14:case"end":return e.stop()}}),e)}))),n.handleGetGroupListFromBackend=Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),n.handleUpdateContactsToMarketingToolStore=function(){var e=n.state,t=e.selectedContacts,a=e.selectedGroups,r=[];a.map((function(e){1==e.selected&&(r=r.concat(e.contacts))}));var i=(r=r.concat(t)).filter((function(e,t,a){return a.indexOf(e)===t}));$.a.clientUpdate({"@type":"updateBulkMessageContacts",contacts:i})},n.handleOpenSelectContactDialog=function(){n.state.contacts.length<1?n.handleOpenPopupDialog("No Contacts Found !"):n.setState({openSelectContactDialog:!0})},n.handleCloseSelectContactDialog=function(){n.setState({openSelectContactDialog:!1})},n.handleSubmitSelectContact=function(e){e.preventDefault();var t=new FormData(e.target).getAll("contacts[]");n.setState({openSelectContactDialog:!1,selectedContacts:t},(function(){return n.handleUpdateContactsToMarketingToolStore()}))},n.handleCancelSelectContact=function(){n.setState({openSelectContactDialog:!1})},n.handleSelectAllContact=function(){var e=n.state,t=e.contacts,a=e.selectAllContacts,r=[];r=1==a?t.map((function(e){return Object(Ge.a)(Object(Ge.a)({},e),{},{selected:!1})})):t.map((function(e){return Object(Ge.a)(Object(Ge.a)({},e),{},{selected:!0})})),n.setState({selectAllContacts:!a,contacts:r})},n.handleOnChangeSelectContact=function(e){var t=n.state.contacts;if(void 0!=t[e]){var a=t;a[e].selected=!t[e].selected,console.log(a,t);var r=a.find((function(e){return 0==e.selected})),i=void 0==r;console.log(r,i),n.setState({contacts:a,selectAllContacts:i})}},n.handleRenderSelectContactDialog=function(){var e=n.state,t=e.openSelectContactDialog,a=e.contacts,r=e.selectAllContacts;e.selectedContacts;return d.a.createElement(d.a.Fragment,null,d.a.createElement(S.a,{disableBackdropClick:!0,disableEscapeKeyDown:!1,maxWidth:"lg","aria-labelledby":"confirmation-dialog-title",open:t},d.a.createElement("form",{ref:n.selectContactRef,onSubmit:n.handleSubmitSelectContact,id:"select-contact-form"},d.a.createElement(U.a,{id:"confirmation-dialog-title"},d.a.createElement(gi.a,{row:!0},"Select Contacts For Bulk Message",d.a.createElement(rr.a,{control:d.a.createElement(wr.a,{checked:r,onChange:n.handleSelectAllContact,name:"selectAll",color:"primary",value:0}),label:1==r?" Unselect All":" Select All"}))),d.a.createElement(xn.a,{dividers:!0},d.a.createElement(gi.a,{row:!0},a.map((function(e,t){return d.a.createElement(bi,Object.assign({},e,{key:t,index:t,handleChange:n.handleOnChangeSelectContact}))})))),d.a.createElement(O.a,null,d.a.createElement(k.a,{type:"button",autoFocus:!0,onClick:n.handleCancelSelectContact,color:"primary"},"Cancel"),d.a.createElement(k.a,{type:"submit",color:"primary"},"Ok")))))},n.handleImportContact=function(){var e=n.refImportContactTextField.current.value;try{JSON.parse(e)}catch(r){return alert("Text is not JSON"),!1}n.handleCloseImportContactDialog(),n.handleOpenPopupDialog("Import Contact is running, please wait!");var t=n.handleOpenPopupDialog,a=n.handleClosePopupDialog;$.a.importContact(e).catch((function(e){a(),t("Falied !")})).then((function(e){console.log("Marketing Tool: ",e),pi.importContactToBackend(e).then((function(e){a(),t("Process Completed !")}))}))},n.handleOpenImportContactDialog=function(){n.setState({openImportContactDialog:!0})},n.handleCloseImportContactDialog=function(){n.setState({openImportContactDialog:!1})},n.importContactDialogContent=function(){return d.a.createElement(d.a.Fragment,null,d.a.createElement(S.a,{open:n.state.openImportContactDialog,onClose:n.handleCloseImportContactDialog,"aria-labelledby":"form-dialog-title"},d.a.createElement(U.a,{id:"form-dialog-title"},"Import Contact"),d.a.createElement(xn.a,null,d.a.createElement(Tn.a,null,"Upload Your Excel Contact File To ",d.a.createElement("a",{href:"http://beautifytools.com/excel-to-json-converter.php",target:"_black"},"http://beautifytools.com/excel-to-json-converter.php"),'. Then Past The JSON Data Text Into Field Box. Excel\'s Cell Header Must Has "phone" (with country code), "first_name", "last_name".'),d.a.createElement(An.a,{autoFocus:!0,margin:"dense",id:"json_contact",label:"JSON Contact",type:"text",fullWidth:!0,inputRef:n.refImportContactTextField})),d.a.createElement(O.a,null,d.a.createElement(k.a,{onClick:n.handleCloseImportContactDialog,color:"primary"},"Cancel"),d.a.createElement(k.a,{onClick:n.handleImportContact,color:"primary"},"Submit"))))},n.handleClosePopupDialog=function(){n.setState({openPopupDialog:!1})},n.handleOpenPopupDialog=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";n.setState({openPopupDialog:!0,popupDialogMessage:e})},n.popupDialogContent=function(){var e=n.state.popupDialogMessage;return d.a.createElement(d.a.Fragment,null,d.a.createElement(S.a,{open:n.state.openPopupDialog,TransitionComponent:vi,keepMounted:!0,onClose:n.handleClosePopupDialog,"aria-labelledby":"alert-dialog-slide-title","aria-describedby":"alert-dialog-slide-description"},d.a.createElement(U.a,{id:"alert-dialog-slide-title"},""),d.a.createElement(xn.a,null,d.a.createElement("h3",null,e)),d.a.createElement(O.a,null,d.a.createElement(k.a,{onClick:n.handleClosePopupDialog,color:"primary"},"Okay"))))},n.searchInputRef=d.a.createRef(),n.listRef=d.a.createRef(),n.searchListRef=d.a.createRef(),n.state={items:null,searchItems:null,openImportContactDialog:!1,openPopupDialog:!1,popupDialogMessage:"success",openSelectContactDialog:!1,contacts:[{id:"123123",firstName:"test",lastName:1,phone:"8559123123",selected:!1},{id:"222",firstName:"test",lastName:2,phone:"8559123123",selected:!1}],selectedContacts:[],selectAllContacts:!1,groups:[{id:"123123",name:"test group 1",contacts:[1,2,3],phone:"8559123123",selected:!1},{id:"222",name:"test group 2",contacts:[1,2,3],phone:"42424",selected:!1}],selectedGroups:[],selectAllGroups:!1},n.handleDebounceScroll=Object(We.d)(n.handleDebounceScroll,100,!1),n.handleThrottleScroll=Object(We.z)(n.handleThrottleScroll,200,!1),n.refImportContactTextField=d.a.createRef(),n.selectContactRef=d.a.createRef(),n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this.searchInputRef.current;e&&setTimeout((function(){return e.focus()}),50),this.handleGetContactList()}},{key:"handleDebounceScroll",value:function(){this.loadRenderIdsContent()}},{key:"handleThrottleScroll",value:function(){this.loadRenderIdsContent()}},{key:"loadContent",value:function(){var e=Object(i.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=bn.contacts){e.next=7;break}return e.next=4,$.a.send({"@type":"getContacts"});case 4:(t=e.sent).user_ids=t.user_ids.sort((function(e,t){return Object(_.c)(e).localeCompare(Object(_.c)(t))})),bn.contacts=t;case 7:a=R.a.getStore(),Object(N.F)(a,t.user_ids.slice(0,20)),this.setState({items:t});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.popup,t=this.state;t.items,t.searchItems;return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"header-master"},d.a.createElement(E.a,{className:"header-left-button",onClick:this.handleClose},e?d.a.createElement(w.a,null):d.a.createElement(Ne,null)),d.a.createElement("div",{className:"placeholder-wrapper",style:{width:"100%"}},d.a.createElement("div",{className:"placeholder-meta"},"Marketing Tool"))),d.a.createElement("button",{variant:"contained",className:"mg-b-5 btn my-custom-button",disabled:!0,onClick:this.handleSelectGroup}," Select Group"),d.a.createElement("button",{variant:"contained",className:"mg-b-5 btn my-custom-button",onClick:this.handleOpenSelectContactDialog}," Select Contact"),d.a.createElement("button",{variant:"contained",className:"mg-b-5 btn my-custom-button",onClick:this.handleOpenImportContactDialog}," Import Contact"),d.a.createElement("br",null),this.importContactDialogContent(),this.popupDialogContent(),this.handleRenderSelectContactDialog())}}]),a}(d.a.Component),yi=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdateSearchChat=function(e){if(lt.a.isSmallWidth){var t=e.chatId,a=e.query,r=n.state,i=r.openSearch,o=r.searchChatId,s=r.searchText;i&&t===o&&a===s||(n.query=a,n.setState({openSearch:!0,searchChatId:t,searchText:null}))}},n.handleDialogEnter=function(){if(n.query){var e=n.headerRef.current;e&&e.setInitQuery(n.query),n.query=null}},n.onClientUpdateSettings=function(e){if(lt.a.isSmallWidth){var t=e.open,a=e.chatId;n.setState({openSettings:t,meChatId:a})}},n.onClientUpdateContacts=function(){var e=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(lt.a.isSmallWidth){e.next=3;break}return e.abrupt("return");case 3:a=t.open,n.setState({openContacts:a});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onClientUpdateNewGroup=function(){var e=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(lt.a.isSmallWidth){e.next=3;break}return e.abrupt("return");case 3:a=t.open,n.setState({openNewGroup:a});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onClientUpdateNewChannel=function(){var e=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(lt.a.isSmallWidth){e.next=3;break}return e.abrupt("return");case 3:a=t.open,n.setState({openNewChannel:a});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleClose=function(){n.setState({openSettings:!1,openContacts:!1,openNewGroup:!1,openNewChannel:!1,openSearch:!1,openCustomContacts:!1,openMarketingTool:!1})},n.handleSearch=function(e){n.setState({openSearch:e,searchChatId:0,searchText:null})},n.handleSearchTextChange=function(e){n.setState({searchText:e,query:null})},n.handleSelectMessage=function(e,t,a){Object(Q.i)(e,t),n.handleCloseSearch()},n.handleCloseSearch=function(){n.setState({openSearch:!1,searchChatId:0,searchText:null})},n.onClientUpdateCustomContacts=function(){var e=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(lt.a.isSmallWidth){e.next=3;break}return e.abrupt("return");case 3:a=t.open,n.setState({openCustomContacts:a});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onClientUpdateMarketingTool=function(){var e=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(lt.a.isSmallWidth){e.next=3;break}return e.abrupt("return");case 3:a=t.open,n.setState({openMarketingTool:a});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.headerRef=d.a.createRef(),n.state={openSearch:!1,openSettings:!1,openContacts:!1,openNewGroup:!1,openNewChannel:!1,openCustomContacts:!1,openMarketingTool:!1},n}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t,a){var n=this.state,r=n.openSearch,i=n.searchText,o=n.openSettings,s=n.openContacts,c=n.openNewGroup,l=n.openNewChannel,u=n.openCustomContacts,d=n.openMarketingTool;return t.openSearch!==r||(t.searchText!==i||(t.openSettings!==o||(t.openContacts!==s||(t.openNewGroup!==c||(t.openNewChannel!==l||(t.openCustomContacts!==u||t.openMarketingTool!==d))))))}},{key:"componentDidMount",value:function(){lt.a.on("clientUpdateSearchChat",this.onClientUpdateSearchChat),D.a.on("clientUpdateSettings",this.onClientUpdateSettings),D.a.on("clientUpdateContacts",this.onClientUpdateContacts),D.a.on("clientUpdateNewGroup",this.onClientUpdateNewGroup),D.a.on("clientUpdateNewChannel",this.onClientUpdateNewChannel),D.a.on("clientUpdateCustomContacts",this.onClientUpdateCustomContacts),D.a.on("clientUpdateMarketingTool",this.onClientUpdateMarketingTool)}},{key:"componentWillUnmount",value:function(){lt.a.off("clientUpdateSearchChat",this.onClientUpdateSearchChat),D.a.off("clientUpdateSettings",this.onClientUpdateSettings),D.a.off("clientUpdateContacts",this.onClientUpdateContacts),D.a.off("clientUpdateNewGroup",this.onClientUpdateNewGroup),D.a.off("clientUpdateNewChannel",this.onClientUpdateNewChannel),D.a.off("clientUpdateCustomContacts",this.onClientUpdateCustomContacts),D.a.off("clientUpdateMarketingTool",this.onClientUpdateMarketingTool)}},{key:"render",value:function(){var e=this.state,t=e.meChatId,a=e.searchChatId,n=e.searchText,r=e.openSearch,i=e.openContacts,o=e.openSettings,s=e.openNewGroup,c=e.openNewChannel,l=e.openCustomContacts,u=e.openMarketingTool;return r||i||o||s||c?d.a.createElement(S.a,{open:!0,transitionDuration:0,onClose:this.handleClose,classes:{root:"chat-info-dialog-root",container:"chat-info-dialog-container",paper:"chat-info-dialog-paper"},onEnter:this.handleDialogEnter},o&&d.a.createElement(Hr,{chatId:t,popup:!0}),i&&d.a.createElement(Gr,{popup:!0}),l&&d.a.createElement(mi,{popup:!0}),u&&d.a.createElement(Ci,{popup:!0}),s&&d.a.createElement(ci,{popup:!0}),c&&d.a.createElement($r,{popup:!0}),r&&d.a.createElement(d.a.Fragment,null,d.a.createElement(Un,{ref:this.headerRef,openSearch:!0,timeout:!1,onClick:this.handleHeaderClick,onSearch:this.handleSearch,onSearchTextChange:this.handleSearchTextChange,popup:!0}),d.a.createElement("div",{className:"search-content"},d.a.createElement(ln,{chatId:a,text:n,onSelectMessage:this.handleSelectMessage,onClose:this.handleCloseSearch})))):null}}]),a}(d.a.Component),ki={enter:Qr.duration.enteringScreen,exit:Qr.duration.leavingScreen},Ei=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdatePageWidth=function(e){if(e.isSmallWidth){var t=n.state,a=t.openSettings,r=t.openContacts,i=t.openSearch,o=t.openNewGroup,s=t.openNewChannel;(a||r||i||o||s)&&n.setState({openContacts:!1,openSettings:!1,openSearch:!1,openNewGroup:!1,openNewChannel:!1,timeout:0},(function(){n.setState({timeout:ki})}))}},n.onUpdateChatOrder=function(e){var t=e.chat_id,a=n.dialogListRef.current;if(!a||!a.loading){var r=n.archiveListRef.current;if(!r||!r.loading){var i=D.a.chatList.get("chatListArchive");i&&i.has(t)&&n.setState({archiveTitle:Yr()})}}},n.onUpdateChatChatList=function(e){var t=n.state.showArchive,a=n.dialogListRef.current;if(!a||!a.loading){var r=n.archiveListRef.current;if(!r||!r.loading){var i=D.a.chatList.get("chatListArchive"),o=i&&i.size>0;n.setState({showArchive:o,archiveTitle:Yr()},(function(){if(!t&&o){var e=n.dialogListRef.current;if(e.listRef){var a=e.listRef.current;a&&a.scrollTop>0&&(e.scrollTop+=68)}}})),t&&!o&&$.a.clientUpdate({"@type":"clientUpdateCloseArchive"})}}},n.onClientUpdateContacts=function(){var e=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!lt.a.isSmallWidth){e.next=3;break}return e.abrupt("return");case 3:a=t.open,n.setState({openContacts:a});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onClientUpdateSettings=function(e){if(!lt.a.isSmallWidth){var t=e.open,a=e.chatId;n.setState({openSettings:t,meChatId:a})}},n.onClientUpdateNewGroup=function(){var e=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!lt.a.isSmallWidth){e.next=3;break}return e.abrupt("return");case 3:a=t.open,n.setState({openNewGroup:a});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onClientUpdateNewChannel=function(){var e=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!lt.a.isSmallWidth){e.next=3;break}return e.abrupt("return");case 3:a=t.open,n.setState({openNewChannel:a});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onClientUpdateArchive=function(e){var t=e.open;n.setState({openArchive:t})},n.onClientUpdateThemeChange=function(e){n.forceUpdate()},n.onClientUpdateSearchChat=function(e){if(!lt.a.isSmallWidth){var t=e.chatId,a=e.query,r=n.state,i=r.openSearch,o=r.searchChatId,s=r.searchText;if(!i||t!==o||a!==s){var c=n.dialogsHeaderRef.current;n.setState({openSearch:!0,searchChatId:t,searchText:null,openSettings:!1,openActiveSessions:!1,openContacts:!1},(function(){c&&c.setInitQuery(a)}))}}},n.handleHeaderClick=function(){n.state.openArchive?$.a.clientUpdate({"@type":"clientUpdateCloseArchive"}):n.dialogListRef.current.scrollToTop()},n.handleSearch=function(e){n.setState({openSearch:e,searchChatId:0,searchText:null})},n.handleSelectMessage=function(e,t,a){Object(Q.i)(e,t);var r=a?n.state.searchChatId:0,i=a?n.state.searchText:null;n.setState({openSearch:a,searchChatId:r,searchText:i})},n.handleCloseSearch=function(){n.setState({openSearch:!1,searchChatId:0,searchText:null})},n.handleSearchTextChange=function(e){n.setState({searchText:e,query:null})},n.handleSaveCache=function(){n.saveCache()},n.handleCloseArchive=function(){n.setState({openArchive:!1})},n.handleCloseContacts=function(){n.setState({openContacts:!1})},n.handleCloseSettings=function(){n.setState({openSettings:!1})},n.handleCloseNewGroup=function(){n.setState({openNewGroup:!1})},n.handleCloseNewChannel=function(){n.setState({openNewChannel:!1})},n.onClientUpdateCustomContacts=function(){var e=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!lt.a.isSmallWidth){e.next=3;break}return e.abrupt("return");case 3:a=t.open,n.setState({openCustomContacts:a});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleCloseCustomContacts=function(){n.setState({openCustomContacts:!1})},n.onClientUpdateMarketingTool=function(){var e=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!lt.a.isSmallWidth){e.next=3;break}return e.abrupt("return");case 3:a=t.open,n.setState({openMarketingTool:a});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleCloseMarketingTool=function(){n.setState({openMarketingTool:!1})},n.dialogListRef=d.a.createRef(),n.archiveListRef=d.a.createRef(),n.dialogsHeaderRef=d.a.createRef(),n.state={cache:null,showArchive:!1,archiveTitle:null,mainItems:[],archiveItems:[],timeout:ki,openSearch:!1,openArchive:!1,openContacts:!1,openSettings:!1,openNewGroup:!1,openNewChannel:!1,searchChatId:0,searchText:null,query:null,openCustomContacts:!1,openMarketingTool:!1},n}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.state,n=a.cache,r=a.showArchive,i=a.archiveTitle,o=a.mainItems,s=a.archiveItems,c=a.openSearch,l=a.openArchive,u=a.openSettings,d=a.openContacts,p=a.openNewGroup,h=a.openNewChannel,m=a.searchChatId,f=a.searchText,g=a.openCustomContacts,v=a.openMarketingTool;return t.cache!==n||(t.showArchive!==r||(t.archiveTitle!==i||(t.archiveItems!==s||(t.mainItems!==o||(t.openSearch!==c||(t.openArchive!==l||(t.openSettings!==u||(t.openContacts!==d||(t.openNewGroup!==p||(t.openNewChannel!==h||(t.searchChatId!==m||(t.searchText!==f||(t.openCustomContacts!==g||t.openMarketingTool!==v)))))))))))))}},{key:"componentDidMount",value:function(){this.loadCache(),lt.a.on("clientUpdateThemeChange",this.onClientUpdateThemeChange),lt.a.on("clientUpdatePageWidth",this.onClientUpdatePageWidth),D.a.on("updateChatChatList",this.onUpdateChatChatList),D.a.on("updateChatDraftMessage",this.onUpdateChatOrder),D.a.on("updateChatIsPinned",this.onUpdateChatOrder),D.a.on("updateChatIsSponsored",this.onUpdateChatOrder),D.a.on("updateChatLastMessage",this.onUpdateChatOrder),D.a.on("updateChatOrder",this.onUpdateChatOrder),lt.a.on("clientUpdateSearchChat",this.onClientUpdateSearchChat),D.a.on("clientUpdateSettings",this.onClientUpdateSettings),D.a.on("clientUpdateArchive",this.onClientUpdateArchive),D.a.on("clientUpdateContacts",this.onClientUpdateContacts),D.a.on("clientUpdateNewGroup",this.onClientUpdateNewGroup),D.a.on("clientUpdateNewChannel",this.onClientUpdateNewChannel),D.a.on("clientUpdateCustomContacts",this.onClientUpdateCustomContacts),D.a.on("clientUpdateMarketingTool",this.onClientUpdateMarketingTool)}},{key:"componentWillUnmount",value:function(){lt.a.off("clientUpdateThemeChange",this.onClientUpdateThemeChange),lt.a.off("clientUpdatePageWidth",this.onClientUpdatePageWidth),D.a.off("updateChatChatList",this.onUpdateChatChatList),D.a.off("updateChatDraftMessage",this.onUpdateChatOrder),D.a.off("updateChatIsPinned",this.onUpdateChatOrder),D.a.off("updateChatIsSponsored",this.onUpdateChatOrder),D.a.off("updateChatLastMessage",this.onUpdateChatOrder),D.a.off("updateChatOrder",this.onUpdateChatOrder),lt.a.off("clientUpdateSearchChat",this.onClientUpdateSearchChat),D.a.off("clientUpdateSettings",this.onClientUpdateSettings),D.a.off("clientUpdateArchive",this.onClientUpdateArchive),D.a.off("clientUpdateContacts",this.onClientUpdateContacts),D.a.off("clientUpdateNewGroup",this.onClientUpdateNewGroup),D.a.off("clientUpdateNewChannel",this.onClientUpdateNewChannel),D.a.off("clientUpdateCustomContacts",this.onClientUpdateCustomContacts),D.a.off("clientUpdateMarketingTool",this.onClientUpdateMarketingTool)}},{key:"loadCache",value:function(){var e=Object(i.a)(r.a.mark((function e(){var t,a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,bn.loadCache();case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:t=e.t0,a=t.chats,n=t.archiveChats,this.setState({cache:t,showArchive:n&&n.length>0,archiveTitle:Yr()}),this.loadChatContents((a||[]).map((function(e){return e.id}))),$.a.clientUpdate({"@type":"clientUpdateCacheLoaded"});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"saveCache",value:function(){var e=this.archiveListRef.current,t=e&&e.state.chats?e.state.chats.slice(0,25):[],a=this.dialogListRef.current,n=a&&a.state.chats?a.state.chats.slice(0,25):[];bn.saveChats(n,t)}},{key:"loadChatContents",value:function(e){var t=R.a.getStore();Object(N.u)(t,e)}},{key:"render",value:function(){var e=this.state,t=e.cache,a=e.showArchive,n=e.archiveTitle,r=e.mainItems,i=e.archiveItems,o=e.meChatId,s=e.openSettings,c=e.openContacts,l=e.openArchive,u=e.openSearch,p=e.openNewGroup,h=e.openNewChannel,m=e.timeout,f=e.searchChatId,g=e.searchText,v=e.openCustomContacts,b=e.openMarketingTool,C=t?t.chats||[]:null,y=t?t.archiveChats||[]:null;return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"dialogs"},d.a.createElement("div",{className:"sidebar-page"},d.a.createElement(Un,{ref:this.dialogsHeaderRef,openSearch:u,timeout:0!==m,onClick:this.handleHeaderClick,onSearch:this.handleSearch,onSearchTextChange:this.handleSearchTextChange}),d.a.createElement("div",{className:"dialogs-content"},d.a.createElement(Za,{type:"chatListMain",ref:this.dialogListRef,cacheItems:C,items:r,showArchive:a,archiveTitle:n,open:!0,onSaveCache:this.handleSaveCache}),d.a.createElement(ha.a,{classNames:"search",timeout:m,in:u,mountOnEnter:!0,unmountOnExit:!0},d.a.createElement(ln,{chatId:f,text:g,onSelectMessage:this.handleSelectMessage,onClose:this.handleCloseSearch}))),d.a.createElement(Kr,null)),d.a.createElement(Mn,{open:l,timeout:m,onClose:this.handleCloseArchive},d.a.createElement(Ka,{innerListRef:this.archiveListRef,items:i,cacheItems:y})),d.a.createElement(Mn,{open:c,timeout:m,onClose:this.handleCloseContacts},d.a.createElement(Gr,null)),d.a.createElement(Mn,{open:b,timeout:m,onClose:this.handleCloseMarketingTool},d.a.createElement(Ci,null)),d.a.createElement(Mn,{open:v,timeout:m,onClose:this.handleCloseCustomContacts},d.a.createElement(mi,null)),d.a.createElement(Mn,{open:s,timeout:m,onClose:this.handleCloseSettings},d.a.createElement(Hr,{chatId:o})),d.a.createElement(Mn,{open:p,timeout:m,onClose:this.handleCloseNewGroup},d.a.createElement(ci,null)),d.a.createElement(Mn,{open:h,timeout:m,onClose:this.handleCloseNewChannel},d.a.createElement($r,null)),d.a.createElement(yi,null)))}}]),a}(u.Component),Si=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={chatId:lt.a.dialogChatId},e.onClientUpdateMediaViewerContent=function(t){lt.a.mediaViewerContent&&e.handleClose()},e.onClientUpdateDialogChatId=function(t){var a=t.chatId;e.setState({chatId:a})},e.handleClose=function(){$.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:0})},e}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t,a){var n=this.state.chatId;return t.chatId!==n}},{key:"componentDidMount",value:function(){lt.a.on("clientUpdateDialogChatId",this.onClientUpdateDialogChatId),lt.a.on("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent)}},{key:"componentWillUnmount",value:function(){lt.a.off("clientUpdateDialogChatId",this.onClientUpdateDialogChatId),lt.a.off("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent)}},{key:"render",value:function(){var e=this.state.chatId;return e?d.a.createElement(S.a,{open:!0,transitionDuration:0,onClose:this.handleClose,classes:{root:"chat-info-dialog-root",container:"chat-info-dialog-container",paper:"chat-info-dialog-paper"}},d.a.createElement(pa,{className:"chat-info-dialog-content",chatId:e,popup:!0})):null}}]),a}(d.a.Component),Oi=a(397),Ui=a.n(Oi),wi=Object(M.a)(d.a.createElement("path",{d:"M4.70710678,12.2928932 C4.31658249,11.9023689 3.68341751,11.9023689 3.29289322,12.2928932 C2.90236893,12.6834175 2.90236893,13.3165825 3.29289322,13.7071068 L8.29289322,18.7071068 C8.68341751,19.0976311 9.31658249,19.0976311 9.70710678,18.7071068 L20.7071068,7.70710678 C21.0976311,7.31658249 21.0976311,6.68341751 20.7071068,6.29289322 C20.3165825,5.90236893 19.6834175,5.90236893 19.2928932,6.29289322 L9,16.5857864 L4.70710678,12.2928932 Z"}),"Done"),Mi=a(415),Ii=Object(M.a)(d.a.createElement("path",{d:"M2.65383364,2.92607697 L4.145798,9.778632 C4.26700994,10.3353554 4.73555061,10.7489799 5.30300879,10.8002098 L16.196355,11.7836569 C16.3159306,11.7944521 16.4041145,11.9001385 16.3933192,12.0197141 C16.3838746,12.1243302 16.3009783,12.2072294 16.1963626,12.2166777 L5.30295988,13.2005138 C4.73552551,13.2517615 4.26701089,13.6653731 4.14579755,14.2220735 L2.65385781,21.074154 C2.55168485,21.543407 2.84926209,22.0066394 3.31851517,22.1088123 C3.50628037,22.1496954 3.70229947,22.1272304 3.87594675,22.0449272 L23.4110848,12.7858981 C23.8450551,12.5802101 24.0301144,12.0616646 23.8244264,11.6276943 C23.7384721,11.4463438 23.5924353,11.300307 23.4110848,11.2143527 L3.87592461,1.95531307 C3.44195432,1.74962507 2.92340882,1.93468443 2.71772082,2.36865471 C2.63541897,2.54229904 2.61295329,2.73831451 2.65383364,2.92607697 Z"}),"Send"),ji=Object(M.a)(d.a.createElement("path",{d:"M11.657825,8.68730116 L7.89384699,12.5266719 C6.53977525,13.9078658 6.53979565,16.118605 7.89389288,17.4997739 C9.18119565,18.812813 11.2598788,18.8798255 12.6276396,17.6859428 L12.8071445,17.5177786 L19.3928802,10.8005213 C21.4766204,8.67512215 21.4766204,5.27313659 19.3928802,3.14773741 C17.4051081,1.12022499 14.1862843,1.0310006 12.0906645,2.90336495 L11.834659,3.14773741 L5.26671543,9.84699003 C2.45333216,12.7166196 2.45333216,17.3098454 5.26671543,20.179475 C7.96150749,22.9281424 12.3352577,23.0332941 15.1578204,20.4629606 L15.452067,20.1794113 L19.2160679,16.340063 C19.6027032,15.945688 19.596429,15.3125541 19.202054,14.9259188 C18.8076791,14.5392835 18.1745452,14.5455577 17.7879099,14.9399327 L13.9520378,18.8511531 C11.9281881,20.8353343 8.67903707,20.8031766 6.6948559,18.7793268 C4.64395201,16.6874204 4.64395201,13.3390446 6.6948559,11.2471382 L13.3088798,4.50180526 C14.6072848,3.22884976 16.6917843,3.24948061 17.9647398,4.54788555 C19.2860006,5.89556155 19.2860006,8.05269718 17.9647398,9.40037319 L11.3764629,16.119959 C10.803533,16.6816592 9.88373353,16.6725557 9.32203335,16.0996258 C8.73040544,15.4961698 8.73039653,14.5302606 9.3220133,13.9267937 L13.0859914,10.0874229 C13.4726243,9.6930457 13.4663463,9.05991185 13.0719691,8.67327889 C12.6775919,8.28664594 12.044458,8.29292392 11.657825,8.68730116 Z"}),"Attach"),_i=a(560),xi=a.n(_i),Ti=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={anchorEl:null},e.handleMenuClick=function(t){e.setState({anchorEl:t.currentTarget})},e.handleMenuClose=function(){e.setState({anchorEl:null})},e.handleAttachPhoto=function(){e.handleMenuClose();var t=e.props.onAttachPhoto;t&&setTimeout((function(){return t()}),v.b)},e.handleAttachDocument=function(){e.handleMenuClose();var t=e.props.onAttachDocument;t&&setTimeout((function(){return t()}),v.b)},e.handleAttachPoll=function(){e.handleMenuClose();var t=e.props.onAttachPoll;t&&t()},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=(e.classes,e.t),a=e.chatId,n=this.state.anchorEl;return d.a.createElement(d.a.Fragment,null,d.a.createElement(E.a,{className:"inputbox-icon-button","aria-label":"Attach",open:Boolean(n),onClick:this.handleMenuClick},d.a.createElement(ji,null)),d.a.createElement(un.a,{id:"attach-menu",anchorEl:n,open:Boolean(n),getContentAnchorEl:null,disableAutoFocusItem:!0,disableRestoreFocus:!0,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"right"},onClose:this.handleMenuClose},d.a.createElement(Et.a,{onClick:this.handleAttachPhoto,disabled:!Object(x.d)(a)},d.a.createElement(be.a,null,d.a.createElement(Ee,null)),d.a.createElement(Ce.a,{primary:t("AttachPhoto")})),d.a.createElement(Et.a,{onClick:this.handleAttachDocument,disabled:!Object(x.d)(a)},d.a.createElement(be.a,null,d.a.createElement(he,null)),d.a.createElement(Ce.a,{primary:t("AttachDocument")})),!Object(x.U)(a)&&d.a.createElement(Et.a,{onClick:this.handleAttachPoll,disabled:!Object(x.f)(a)},d.a.createElement(be.a,null,d.a.createElement(xi.a,null)),d.a.createElement(Ce.a,{primary:t("Poll")}))))}}]),a}(d.a.Component),Li=Object(y.d)()(Ti),Pi=a(421);function Ni(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){if(t&&e.childNodes&&e.childNodes.length>0){var a=e.childNodes[e.childNodes.length-1],n=document.createRange();n.setStart(a,a.length),n.collapse(!0);var r=window.getSelection();r.removeAllRanges(),r.addRange(n),e.scrollTop=e.scrollHeight}e.focus()}}var Di=8,Ri=16,Bi=17,Ai=18,Fi=46,Vi=37,zi=38,Hi=39,Wi=40,Gi={special:{},navigational:{},isSpecial(e){return"undefined"!==typeof this.special[e.keyCode]},isNavigational(e){return"undefined"!==typeof this.navigational[e.keyCode]}};Gi.special[Di]=!0,Gi.special[Ri]=!0,Gi.special[Bi]=!0,Gi.special[Ai]=!0,Gi.special[Fi]=!0,Gi.navigational[zi]=!0,Gi.navigational[Wi]=!0,Gi.navigational[Vi]=!0,Gi.navigational[Hi]=!0;a(561);var Zi=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).getText=function(){return n.optionTextRef.current.innerText},n.focus=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=n.optionTextRef.current;Ni(t,e)},n.handleDelete=function(){var e=n.props,t=e.option,a=e.onDelete;t&&a&&a(t.id)},n.handleInput=function(e){var t=n.props.option;e.preventDefault();var a=n.optionTextRef.current,r=a.dataset.length,i=(a.dataset.maxLength,n.getText());n.setState({remainLength:r-i.length}),$.a.clientUpdate({"@type":"clientUpdatePollOption",id:t.id,text:i})},n.handleKeyDown=function(e){var t=n.optionTextRef.current,a=t.dataset.maxLength,r=n.getText().length,i=!1,o=window.getSelection(),s=Gi.isSpecial(e),c=Gi.isNavigational(e);switch(o&&(i=!!o.toString()),e.key){case"Backspace":if(!n.getText()){var l=n.props,u=l.option,d=l.onDelete;return d&&d(u.id,!0),e.preventDefault(),!1}break;case"Enter":var p=n.props,h=p.option,m=p.onFocusNext;return h&&m&&m(h.id),e.preventDefault(),!1;case"ArrowUp":var f=window.getSelection();if(!f)break;if(!f.isCollapsed)break;var g=t.childNodes&&t.childNodes.length>0?t.childNodes[0]:null;if(!g||f.anchorNode===g&&!f.anchorOffset){var v=n.props,b=v.option,C=v.onFocusPrev;return C&&C(b.id),e.preventDefault(),!1}break;case"ArrowDown":var y=window.getSelection();if(!y)break;if(!y.isCollapsed)break;var k=t.childNodes&&t.childNodes.length>0?t.childNodes[t.childNodes.length-1]:null;if(!k||y.anchorNode===k&&y.anchorOffset===k.length){var E=n.props,S=E.option,O=E.onFocusNext;return O&&O(S.id),e.preventDefault(),!1}}return!(!s&&!c)||(!(r>=a&&!i)||(e.preventDefault(),!1))},n.handlePaste=function(e){e.preventDefault();var t=n.optionTextRef.current.dataset.maxLength,a=window.getSelection(),r=a?a.toString():"",i=n.getText();if(!(i.length-a.length>=t)){var o=e.clipboardData.getData("text/plain");o&&(o=o.replace("\r\n","\n").replace("\n"," "),i.length-r.length+o.length>t&&(o=o.substr(0,t-i.length+r.length)),document.execCommand("insertText",!1,o))}},n.handleChange=function(){var e=n.props.option;e&&$.a.clientUpdate({"@type":"clientUpdatePollChooseOption",id:e.id})},n.optionTextRef=d.a.createRef(),n.state={remainLength:v.P},n}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.t,a=e.option,n=this.state.remainLength,r=a.is_chosen;return d.a.createElement("div",{className:"create-poll-option"},d.a.createElement("div",{className:"create-poll-option-wrapper"},d.a.createElement(ar.a,{key:Date.now(),classes:{root:"create-poll-radio-root"},color:"primary",checked:r,onChange:this.handleChange}),d.a.createElement("div",{ref:this.optionTextRef,className:"create-poll-option-text",contentEditable:!0,suppressContentEditableWarning:!0,placeholder:t("Option"),"data-length":v.O,"data-max-length":v.P,onInput:this.handleInput,onKeyDown:this.handleKeyDown,onPaste:this.handlePaste})),d.a.createElement("div",{className:"create-poll-option-delete-button"},d.a.createElement(E.a,{className:"create-poll-option-button",onClick:this.handleDelete},d.a.createElement(w.a,{fontSize:"small"}))),d.a.createElement("div",{className:"create-poll-option-bottom-border"}),n<=v.O-v.N&&d.a.createElement(Pi.a,{align:"center",className:"create-poll-option-subtitle",color:n>=0?"textSecondary":"error",variant:"subtitle1"},n))}}]),a}(d.a.Component),qi=Object(m.a)(Object(m.d)(),Object(y.d)(),Object(m.c)())(Zi),Ki=a(403),Ji=a(402),Yi=(a(562),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleClientUpdateNewPoll=function(e){var t=Ji.a.poll;n.setState({confirm:!1,remainLength:v.S,poll:t})},n.handleClientUpdatePollQuestion=function(e){var t=Ji.a.poll,a=n.questionRef.current,r=a.dataset.length,i=a.innerText;n.setState({remainLength:r-i.length,poll:t})},n.handleClientUpdatePoll=function(e){var t=Ji.a.poll;n.setState({poll:t})},n.handleClientUpdateNewPollOption=function(e){var t=Ji.a.poll;n.setState({poll:t},(function(){setTimeout((function(){n.optionsRefMap.get(t.options.length-1).focus(!0)}))}))},n.handleKeyDown=function(e){var t=n.questionRef.current,a=t.dataset.maxLength,r=t.innerText.length,i=!1,o=window.getSelection(),s=Gi.isSpecial(e),c=Gi.isNavigational(e);switch(o&&(i=!!o.toString()),e.key){case"Enter":if(!e.shiftKey)return n.handleFocusNextOption(0),e.preventDefault(),!1;break;case"ArrowDown":var l=window.getSelection();if(!l)break;if(!l.isCollapsed)break;var u=t.childNodes&&t.childNodes.length>0?t.childNodes[t.childNodes.length-1]:null;if(!u||l.anchorNode===u&&l.anchorOffset===u.length)return n.handleFocusNextOption(0),e.preventDefault(),!1}return!(!s&&!c)||(!(r>=a&&!i)||(e.preventDefault(),!1))},n.handlePaste=function(e){e.preventDefault();var t=n.questionRef.current,a=t.dataset.maxLength,r=window.getSelection(),i=r?r.toString():"",o=t.innerText;if(!(o.length-r.length>=a)){var s=e.clipboardData.getData("text/plain");s&&(o.length-i.length+s.length>a&&(s=s.substr(0,a-o.length+i.length)),document.execCommand("insertText",!1,s))}},n.handleInput=function(e){e.preventDefault();var t=n.questionRef.current,a=t.innerText;"<br>"===t.innerHTML&&(t.innerText=""),$.a.clientUpdate({"@type":"clientUpdatePollQuestion",question:a})},n.handleAddOption=function(){var e=n.state.poll;if(e&&!(e.options.length>=v.M)){var t={id:Date.now(),text:""};$.a.clientUpdate({"@type":"clientUpdateNewPollOption",option:t})}},n.handleDeleteOption=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t?n.handleDeleteByBackspace(e):n.handleDelete(e)},n.handleDelete=function(e){$.a.clientUpdate({"@type":"clientUpdateDeletePollOption",id:e})},n.handleDeleteByBackspace=function(e){var t=n.state.poll;if(t){for(var a=t.options,r=a.findIndex((function(t){return t.id===e})),i=r-1,o=!0,s=r;s<a.length;s++){if(a[s].text){o=!1;break}}o&&n.handleDeleteOption(e);var c=n.optionsRefMap.get(i);if(c)c.focus(!0);else Ni(n.questionRef.current,!0)}},n.handleFocusPrevOption=function(e){var t=n.state.poll;if(t){var a=t.options.findIndex((function(t){return t.id===e}))-1,r=n.optionsRefMap.get(a);if(r)r.focus(!1);else Ni(n.questionRef.current,!1)}},n.handleFocusNextOption=function(e){var t=n.state.poll;if(t){var a=t.options,r=a.findIndex((function(t){return t.id===e})),i=r+1,o=n.optionsRefMap.get(i);if(o)o.focus(o,!0);else{var s=r>=0&&r<a.length?a[r].text:"";if(a.length&&!s)return;n.handleAddOption()}}},n.getHint=function(){var e=n.state.poll;if(e){var t=e.options,a=v.M-t.length;return a<=0?"You have added the maximum number of options.":1===a?"You can add 1 more option.":"You can add ".concat(v.M-t.length," more options.")}},n.handleClose=function(){var e=n.state.poll;Object(Ki.a)(e)?n.setState({confirm:!0}):n.handleConfirmationDone()},n.handleSend=function(){var e=n.props.onSend,t=Ji.a.getInputMessagePoll();t&&(e(t),n.handleConfirmationDone())},n.handleConfirmationClose=function(){n.setState({confirm:!1})},n.handleConfirmationDone=function(){n.handleConfirmationClose(),$.a.clientUpdate({"@type":"clientUpdateDeletePoll"})},n.handleChangeAnonymous=function(){$.a.clientUpdate({"@type":"clientUpdatePollChangeAnonymous"})},n.handleChangeAllowMultipleAnswers=function(){$.a.clientUpdate({"@type":"clientUpdatePollChangeAllowMultipleAnswers"})},n.handleChangeType=function(){$.a.clientUpdate({"@type":"clientUpdatePollChangeType"})},n.handleScheduledAction=function(e){var t=n.props,a=t.enqueueSnackbar,r=t.closeSnackbar,i=a(e,{autoHideDuration:v.x,preventDuplicate:!0,action:[d.a.createElement(E.a,{key:"close","aria-label":"Close",color:"inherit",className:"notification-close-button",onClick:function(){return r(i)}},d.a.createElement(w.a,null))]})},n.handleAllowMultipleAnswersClick=function(e){var t=n.props.t,a=n.state.poll;a&&("pollTypeQuiz"===a.type["@type"]&&(e.stopPropagation(),n.handleScheduledAction(t("PollQuizOneRightAnswer"))))},n.questionRef=d.a.createRef(),n.optionsRefMap=new Map,n.state={poll:null,confirm:!1,remainLength:v.S},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){Ji.a.on("clientUpdatePollChooseOption",this.handleClientUpdatePoll),Ji.a.on("clientUpdatePollChangeAnonymous",this.handleClientUpdatePoll),Ji.a.on("clientUpdatePollChangeAllowMultipleAnswers",this.handleClientUpdatePoll),Ji.a.on("clientUpdatePollChangeType",this.handleClientUpdatePoll),Ji.a.on("clientUpdateDeletePoll",this.handleClientUpdatePoll),Ji.a.on("clientUpdateDeletePollOption",this.handleClientUpdatePoll),Ji.a.on("clientUpdateNewPoll",this.handleClientUpdateNewPoll),Ji.a.on("clientUpdateNewPollOption",this.handleClientUpdateNewPollOption),Ji.a.on("clientUpdatePollOption",this.handleClientUpdatePoll),Ji.a.on("clientUpdatePollQuestion",this.handleClientUpdatePollQuestion)}},{key:"componentWillUnmount",value:function(){Ji.a.off("clientUpdatePollChooseOption",this.handleClientUpdatePoll),Ji.a.off("clientUpdatePollChangeAnonymous",this.handleClientUpdatePoll),Ji.a.off("clientUpdatePollChangeAllowMultipleAnswers",this.handleClientUpdatePoll),Ji.a.off("clientUpdatePollChangeType",this.handleClientUpdatePoll),Ji.a.off("clientUpdateDeletePoll",this.handleClientUpdatePoll),Ji.a.off("clientUpdateDeletePollOption",this.handleClientUpdatePoll),Ji.a.off("clientUpdateNewPoll",this.handleClientUpdateNewPoll),Ji.a.off("clientUpdateNewPollOption",this.handleClientUpdateNewPollOption),Ji.a.off("clientUpdatePollOption",this.handleClientUpdatePoll),Ji.a.off("clientUpdatePollQuestion",this.handleClientUpdatePollQuestion)}},{key:"componentDidUpdate",value:function(e,t,a){var n=this;this.state.poll&&!t.poll&&setTimeout((function(){Ni(n.questionRef.current,!0)}),0)}},{key:"render",value:function(){var e=this,t=this.props.t,a=this.state,n=a.remainLength,r=a.confirm,i=a.poll;if(!i)return null;var o=i.is_anonymous,s=i?i.options:[],c=i.type.allow_multiple_answers,l="pollTypeRegular"!==i.type["@type"],u="pollTypeQuiz"===i.type["@type"];this.optionsRefMap.clear();var p=s.map((function(t,a){return d.a.createElement(qi,{ref:function(t){return e.optionsRefMap.set(a,t)},key:t.id,option:t,onDelete:e.handleDeleteOption,onFocusPrev:e.handleFocusPrevOption,onFocusNext:e.handleFocusNextOption})})),m=v.M-s.length>0,f=this.getHint();return d.a.createElement(d.a.Fragment,null,d.a.createElement(S.a,{className:h()("create-poll-dialog",{"create-quiz-dialog":u}),open:!0,transitionDuration:0,onClose:this.handleClose,"aria-labelledby":"dialog-title"},d.a.createElement(U.a,{id:"dialog-title"},t("NewPoll")),d.a.createElement(xn.a,{classes:{root:"create-poll-dialog-root"}},d.a.createElement("div",{className:"create-poll-dialog-question-title"},d.a.createElement(Se.a,{color:"primary",variant:"subtitle1",style:{flexGrow:1}},t("Question")),n<=v.R-v.Q&&d.a.createElement(Se.a,{color:n>=0?"textSecondary":"error",variant:"subtitle1"},n)),d.a.createElement("div",{ref:this.questionRef,id:"create-poll-dialog-question",contentEditable:!0,suppressContentEditableWarning:!0,placeholder:t("QuestionHint"),"data-length":v.R,"data-max-length":v.S,onPaste:this.handlePaste,onKeyDown:this.handleKeyDown,onInput:this.handleInput}),d.a.createElement(ce.a,{className:"divider"}),d.a.createElement(Se.a,{color:"primary",variant:"subtitle1"},t("PollOptions")),d.a.createElement(ge.a,{classes:{root:"create-poll-dialog-list"}},p,m&&d.a.createElement(ve.a,{selected:!1,className:"create-poll-add-option",button:!0,onClick:this.handleAddOption},d.a.createElement(Ce.a,{disableTypography:!0,primary:t("AddAnOption")}))),d.a.createElement(Se.a,null,f),d.a.createElement(ce.a,{className:"divider"}),d.a.createElement(Se.a,{color:"primary",variant:"subtitle1"},t("Settings")),d.a.createElement(gi.a,null,d.a.createElement(rr.a,{control:d.a.createElement(wr.a,{color:"primary",checked:o,onChange:this.handleChangeAnonymous}),label:t("PollAnonymous")}),d.a.createElement("div",{onClick:this.handleAllowMultipleAnswersClick,style:{background:"transparent"}},d.a.createElement(rr.a,{control:d.a.createElement(wr.a,{color:"primary",disabled:l,checked:c,onChange:this.handleChangeAllowMultipleAnswers}),label:t("PollMultiple")})),d.a.createElement(rr.a,{control:d.a.createElement(wr.a,{color:"primary",checked:u,onChange:this.handleChangeType}),label:t("PollQuiz")})),d.a.createElement(Se.a,null,t("QuizInfo"))),d.a.createElement(O.a,null,d.a.createElement(k.a,{color:"primary",onClick:this.handleClose},t("Cancel")),Object(Ki.b)(i)&&d.a.createElement(k.a,{color:"primary",onClick:this.handleSend},t("Create")))),d.a.createElement(S.a,{className:"create-poll-dialog-root",open:r,transitionDuration:0,onClose:this.handleConfirmationClose,"aria-labelledby":"dialog-title"},d.a.createElement(U.a,{id:"dialog-title"},t("CancelPollAlertTitle")),d.a.createElement(xn.a,{classes:{root:"create-poll-dialog-root"}},t("CancelPollAlertText")),d.a.createElement(O.a,null,d.a.createElement(k.a,{color:"primary",onClick:this.handleConfirmationClose},t("Cancel")),d.a.createElement(k.a,{color:"primary",onClick:this.handleConfirmationDone},t("Ok")))))}}]),a}(d.a.Component)),Qi=Object(m.a)(Object(m.d)(),Object(y.d)(),g.withSnackbar,Object(m.c)())(Yi),Xi=a(378),$i=(a(563),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleTextKeyDown=function(e){"Enter"===e.key&&(n.urlInputRef.current.focus(),e.preventDefault(),e.stopPropagation())},n.handleUrlKeyDown=function(e){"Enter"===e.key&&(n.handleDone(),e.preventDefault(),e.stopPropagation())},n.handleTextChange=function(e){n.setState({text:e.target.value})},n.handleUrlChange=function(e){n.setState({url:e.target.value})},n.handleDone=function(){var e=n.props,t=e.defaultText,a=e.defaultUrl,r=n.state,i=r.text,o=r.url;if(o=null!==o?o:a,(i=null!==i?i:t)||o){if(!i)return n.setState({textError:!0}),void n.textInputRef.current.focus();if(!(o=Object(Xi.d)(o)))return n.setState({urlError:!0}),void n.urlInputRef.current.focus();(0,n.props.onDone)(i,o)}else n.textInputRef.current.focus()},n.handleCancel=function(){(0,n.props.onCancel)()},n.textRef=d.a.createRef(),n.textInputRef=d.a.createRef(),n.urlRef=d.a.createRef(),n.urlInputRef=d.a.createRef(),n.state={},n}return Object(s.a)(a,[{key:"componentDidUpdate",value:function(e,t,a){var n=this,r=this.props,i=r.defaultText,o=r.defaultUrl,s=r.open;s&&e.open!==s&&setTimeout((function(){var e=n.textInputRef.current,t=n.urlInputRef.current;e&&t&&(i?o?(e.focus(),e.select()):t.focus():e.focus())}),0)}},{key:"componentDidMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t,a){var n=this.props,r=n.defaultText,i=n.defaultUrl,o=n.onDone,s=n.onCancel,c=n.open,l=this.state,u=l.textError,d=l.urlError;return e.defaultText!==r||(e.defaultUrl!==i||(t.textError!==u||(t.urlError!==d||(e.onDone!==o||(e.onCancel!==s||e.open!==c)))))}},{key:"render",value:function(){var e=this.props,t=e.open,a=e.defaultUrl,n=e.defaultText,r=e.t,i=this.state,o=i.textError,s=i.urlError;return t?d.a.createElement(S.a,{transitionDuration:0,open:!0,onClose:this.handleCancel,"aria-labelledby":"edit-url-dialog-title"},d.a.createElement(U.a,{id:"edit-url-dialog-title"},r("CreateLink")),d.a.createElement(xn.a,null,d.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:260}},d.a.createElement(An.a,{ref:this.textRef,inputRef:this.textInputRef,label:r("Text"),margin:"normal",autoComplete:"off",defaultValue:n,error:o,onChange:this.handleTextChange,onKeyDown:this.handleTextKeyDown}),d.a.createElement(An.a,{ref:this.urlRef,inputRef:this.urlInputRef,label:r("URL"),margin:"normal",autoComplete:"off",defaultValue:a,error:s,onChange:this.handleUrlChange,onKeyDown:this.handleUrlKeyDown}))),d.a.createElement(O.a,null,d.a.createElement(k.a,{onClick:this.handleCancel,color:"primary"},r("Cancel")),d.a.createElement(k.a,{onClick:this.handleDone,color:"primary"},r("Create")))):null}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t.prevOpen!==e.open?{prevOpen:!0,textError:!1,urlError:!1,text:null,url:null}:null}}]),a}(d.a.Component)),eo=Object(y.d)()($i),to=(a(564),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).onClientUpdatePhotoBlob=function(t){var a=e.props,n=a.chatId,r=a.messageId,i=a.photoSize;if(i){var o=i.photo;o&&t.chatId===n&&t.messageId===r&&t.fileId===o.id&&e.forceUpdate()}},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){R.a.on("clientUpdateAnimationThumbnailBlob",this.onClientUpdatePhotoBlob),R.a.on("clientUpdateAudioThumbnailBlob",this.onClientUpdatePhotoBlob),R.a.on("clientUpdateDocumentThumbnailBlob",this.onClientUpdatePhotoBlob),R.a.on("clientUpdatePhotoBlob",this.onClientUpdatePhotoBlob),R.a.on("clientUpdateStickerThumbnailBlob",this.onClientUpdatePhotoBlob),R.a.on("clientUpdateVideoThumbnailBlob",this.onClientUpdatePhotoBlob),R.a.on("clientUpdateVideoNoteThumbnailBlob",this.onClientUpdatePhotoBlob)}},{key:"componentWillUnmount",value:function(){R.a.off("clientUpdateAnimationThumbnailBlob",this.onClientUpdatePhotoBlob),R.a.off("clientUpdateAudioThumbnailBlob",this.onClientUpdatePhotoBlob),R.a.off("clientUpdateDocumentThumbnailBlob",this.onClientUpdatePhotoBlob),R.a.off("clientUpdatePhotoBlob",this.onClientUpdatePhotoBlob),R.a.off("clientUpdateStickerThumbnailBlob",this.onClientUpdatePhotoBlob),R.a.off("clientUpdateVideoThumbnailBlob",this.onClientUpdatePhotoBlob),R.a.off("clientUpdateVideoNoteThumbnailBlob",this.onClientUpdatePhotoBlob)}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.messageId,n=e.photoSize,r=e.minithumbnail;if(!n)return null;var i=n.photo;if(!i)return null;var o=r?"data:image/jpeg;base64, "+r.data:null,s=Object(N.l)(i),c=!s&&o||Object(Mt.k)(n),l=Object(wt.B)(t,a),u=Boolean(s||o);return d.a.createElement("div",{className:"reply-tile"},u&&d.a.createElement("img",{className:h()("reply-tile-photo",{"reply-tile-photo-round":l},{"reply-tile-photo-loading":!s},{"media-blurred":s&&c},{"media-mini-blurred":!s&&o&&c}),draggable:!1,src:s||o,alt:""}))}}]),a}(d.a.Component)),ao=(a(565),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).onGetMessageResult=function(t){var a=e.props,n=a.chatId,r=a.messageId;n===t.chat_id&&r===t.id&&e.forceUpdate()},e.handleClick=function(e){e.stopPropagation()},e.handleOpen=function(t){if(0===t.button){t.stopPropagation();var a=e.props,n=a.chatId,r=a.messageId,i=a.onClick,o=X.a.get(n,r);if(!o)return null;if(Object(wt.E)(o))return null;Object(Q.i)(n,r,!1),i&&i()}},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){X.a.on("getMessageResult",this.onGetMessageResult)}},{key:"componentWillUnmount",value:function(){X.a.off("getMessageResult",this.onGetMessageResult)}},{key:"render",value:function(){var e=this.props,t=e.t,a=e.chatId,n=e.messageId,r=this.props.title,i=X.a.get(a,n);r=r||Object(wt.y)(i,t);var o=i?Object(wt.i)(i,t):t("Loading"),s=Object(wt.u)(a,n),c=Object(wt.t)(a,n);return Object(wt.E)(i)&&(r=null,o=t("DeletedMessage")),d.a.createElement("div",{className:"reply",onMouseDown:this.handleOpen,onClick:this.handleClick},d.a.createElement("div",{className:"reply-wrapper"},d.a.createElement("div",{className:"border reply-border"}),s&&d.a.createElement(to,{chatId:a,messageId:n,photoSize:s,minithumbnail:c}),d.a.createElement("div",{className:"reply-content"},r&&d.a.createElement("div",{className:"reply-content-title"},r),d.a.createElement("div",{className:h()("reply-content-subtitle")},o))))}}]),a}(d.a.Component)),no=Object(y.d)()(ao),ro=(a(566),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).onUpdateMessageContent=function(t){var a=e.props,n=a.chatId,r=a.messageId,i=a.editMessageId,o=t.chat_id,s=t.message_id;n===o&&(r!==s&&i!==s||e.forceUpdate())},e.handleClose=function(){var t=e.props,a=t.chatId;t.editMessageId?Object(Q.d)(a,0):Object(Q.l)(a,0)},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){X.a.on("updateMessageContent",this.onUpdateMessageContent)}},{key:"componentWillUnmount",value:function(){X.a.off("updateMessageContent",this.onUpdateMessageContent)}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.messageId,n=e.editMessageId,r=e.t,i=e.onClick;return t&&(a||n)?d.a.createElement("div",{className:"inputbox-header"},d.a.createElement("div",{className:"inputbox-header-left-column"},d.a.createElement(E.a,{className:"inputbox-icon-button","aria-label":"Close",onClick:this.handleClose},d.a.createElement(w.a,null))),d.a.createElement("div",{className:"inputbox-header-middle-column"},d.a.createElement(no,{chatId:t,messageId:n||a,title:n?r("EditMessage"):null,onClick:i})),d.a.createElement("div",{className:"inputbox-header-right-column"})):null}}]),a}(d.a.Component)),io=Object(y.d)()(ro),oo=(a(567),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleDone=function(){(0,e.props.onConfirm)()},e.handleCancel=function(){(0,e.props.onCancel)()},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.files,a=e.t;return t?d.a.createElement(S.a,{transitionDuration:0,open:!0,onClose:this.handleCancel,"aria-labelledby":"delete-dialog-title"},d.a.createElement(U.a,{id:"delete-dialog-title"},a("Confirm")),d.a.createElement(xn.a,null,d.a.createElement(Tn.a,null,t.length>1?a("SendFilesConfirmation"):a("SendFileConfirmation"))),d.a.createElement(O.a,null,d.a.createElement(k.a,{onClick:this.handleCancel,color:"primary"},a("Cancel")),d.a.createElement(k.a,{onClick:this.handleDone,color:"primary"},a("Ok")))):null}}]),a}(d.a.Component)),so=Object(m.a)(Object(y.d)())(oo),co=a(569),lo=a.n(co),uo=(a(568),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleSelectionChange=function(){document.activeElement===n.captionRef.current&&n.saveSelection()},n.handleEnter=function(){var e=n.props,t=e.chatId,a=e.messageId,r=e.open,i=e.newItem;if(r){var o=null,s=null,c=X.a.get(t,a);if(c){var l=c.content;l&&(o=l.text,s=l.caption)}var u=n.captionRef.current;u&&(o?n.setFormattedText(o):s?n.setFormattedText(s):i&&i.caption?u.innerHTML=i.caption:u.innerText=null,Ha(u))}},n.handleDone=function(){var e=n.props,t=e.chatId,a=e.newItem,r=e.onSend,i=e.onEdit,o=n.state,s=o.editMessage,c=o.editFile,l=o.editMedia,u=o.sendAsPhoto,d=n.captionRef.current;if(d){var p=d.innerHTML;d.innerText=null;var h=Object(wt.m)(p),m={"@type":"formattedText",text:h.text,entities:h.entities};if(Boolean(s)){if(l){var f=l.photo;if(!f)return;var g=f.sizes;if(!g)return;var v=g[g.length-1],b=v.width,C=v.height;i(null,{"@type":"inputMessagePhoto",photo:{"@type":"inputFileBlob",name:c.name,data:c},width:b,height:C,caption:m})}else i(m,null);Object(Q.d)(t,0)}else{var y=a.media,k=a.file,E=y.audio,S=y.photo,O=y.document,U=null;if(S){var w=S.sizes;if(!w)return;var M=w[w.length-1],I=M.width,j=M.height;U=u?{"@type":"inputMessagePhoto",photo:{"@type":"inputFileBlob",name:k.name,data:k},width:I,height:j,caption:m}:{"@type":"inputMessageDocument",document:{"@type":"inputFileBlob",name:k.name,data:k},thumbnail:null,caption:m}}else if(O)U={"@type":"inputMessageDocument",document:{"@type":"inputFileBlob",name:k.name,data:k},thumbnail:null,caption:m};else if(E){var _=E.duration,x=E.title,T=E.performer;U={"@type":"inputMessageAudio",audio:{"@type":"inputFileBlob",name:k.name,data:k},thumbnail:null,duration:_,title:x,performer:T,caption:m}}if(!U)return;r(U,k)}}},n.handleCancel=function(){var e=n.props,t=e.chatId,a=e.messageId,r=e.onCancel,i=X.a.get(t,a);Boolean(i)&&Object(Q.d)(t,0),r()},n.handleKeyDown=function(e){var t=e.altKey,a=e.ctrlKey,r=e.keyCode,i=e.metaKey,o=e.repeat,s=e.shiftKey;switch(r){case 13:t||a||i||s||(o||n.handleDone(),e.preventDefault(),e.stopPropagation());break;case 66:t||!a&&!i||s||(o||n.handleBold(),e.preventDefault(),e.stopPropagation());break;case 73:t||!a&&!i||s||(o||n.handleItalic(),e.preventDefault(),e.stopPropagation());break;case 75:t||!a&&!i||s?t&&(a||i)&&!s&&(o||n.handleMono(),e.preventDefault(),e.stopPropagation()):(o||n.handleUrl(),e.preventDefault(),e.stopPropagation());break;case 192:t&&(a||i)&&!s&&(o||n.handleClear(),e.preventDefault(),e.stopPropagation())}},n.handleClear=function(){document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null)},n.handleBold=function(){document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null),document.execCommand("bold",!1,null)},n.handleItalic=function(){document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null),document.execCommand("italic",!1,null)},n.handleMono=function(){document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null);var e="",t=Object(yt.a)(n).selection;t&&!t.isCollapsed&&(e=t.toString()),e&&(e="<code>".concat(e,"</code>"),document.execCommand("removeFormat",!1,null),document.execCommand("insertHTML",!1,e))},n.handleUnderline=function(){document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null),document.execCommand("underline",!1,null)},n.handleStrikeThrough=function(){document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null),document.execCommand("strikeThrough",!1,null)},n.handleUrl=function(){n.openEditUrlDialog()},n.openEditUrlDialog=function(){var e="",t="",a=Object(yt.a)(n),r=a.selection,i=a.range;if(i){var o=i.startContainer;if(o===i.endContainer){var s=o.parentElement;s&&"A"===s.nodeName&&(e=s.innerText,t=s.href)}}e||!r||r.isCollapsed||(e=r.toString()),n.setState({openEditUrl:!0,defaultUrl:t,defaultText:e})},n.closeEditUrlDialog=function(){n.setState({openEditUrl:!1},(function(){n.restoreSelection()}))},n.handlePaste=function(e){var t=e.clipboardData.getData("text/plain");t&&(e.preventDefault(),document.execCommand("insertText",!1,t))},n.handleInput=function(){n.clearInnerHtml()},n.handleCancelEditUrl=function(){n.closeEditUrlDialog()},n.handleDoneEditUrl=function(e,t){n.closeEditUrlDialog(),setTimeout((function(){var a=Object(yt.a)(n).range;if(a){var r=a.startContainer,i=a.endContainer;if(r&&r===i){var o=r.parentNode;if(o&&"A"===o.nodeName){o.href=t,o.title=t,o.innerText=e;var s=o.lastChild;if(s){var c=document.createRange();c.setStart(s,s.textContent.length),c.setEnd(s,s.textContent.length);var l=document.getSelection();l.removeAllRanges(),l.addRange(c)}return}}}var u="<a href=".concat(t," title=").concat(t," rel='noopener noreferrer' target='_blank'>").concat(e,"</a>");document.execCommand("removeFormat",!1,null),document.execCommand("insertHTML",!1,u)}),0)},n.handleEditMedia=function(e){var t=n.editMediaRef.current;t&&t.click()},n.handleEditMediaComplete=Object(i.a)(r.a.mark((function e(){var t,a,i,o,s,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.editMediaRef.current){e.next=3;break}return e.abrupt("return");case 3:if(0!==(a=t.files).length){e.next=6;break}return e.abrupt("return");case 6:if(i=Array.from(a),o=Object(Fn.a)(i),s=o[0],o.slice(1),s){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,Object(Mt.h)(s);case 11:c=e.sent,n.setState({editFile:s,editMedia:c}),t.value="";case 14:case"end":return e.stop()}}),e)}))),n.handleSendAsPhoto=function(){var e=n.state.sendAsPhoto;n.setState({sendAsPhoto:!e})},n.captionRef=d.a.createRef(),n.editMediaRef=d.a.createRef(),n.state={},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){document.addEventListener("selectionchange",this.handleSelectionChange,!0)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("selectionchange",this.handleSelectionChange,!0)}},{key:"setFormattedText",value:function(e){var t=this.props.t,a=this.captionRef.current;if(e){var n=e.text,r=e.entities;try{var i=Object(wt.s)(n,r,t);a.innerHTML=null,i.forEach((function(e){a.appendChild(e)}))}catch(o){a.innerText=n}}else a.innerText=null}},{key:"saveSelection",value:function(){this.selection=document.getSelection(),this.selection&&this.selection.rangeCount&&(this.range=this.selection.getRangeAt(0))}},{key:"restoreSelection",value:function(){var e=this.range;if(e){var t=document.getSelection();t.removeAllRanges(),t.addRange(e),this.captionRef.current.focus()}else Ha()}},{key:"clearInnerHtml",value:function(){var e=this.captionRef.current;if(e){var t=e.innerHTML;"<br>"!==t&&"<div><br></div>"!==t||(e.innerHTML=null)}}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.messageId,n=e.newItem,r=e.open,i=e.t,o=this.state,s=o.defaultText,c=o.defaultUrl,l=o.openEditUrl,u=o.editMessage,p=o.editMedia,h=o.sendAsPhoto;if(!r)return null;var m=X.a.get(t,a),f=Boolean(m),g=!1;(n&&n.media&&"messagePhoto"===n.media["@type"]||p&&"messagePhoto"===p["@type"]||u&&"messagePhoto"===u.content["@type"])&&(g=!0);var v=null;f?v=p?Object(Mt.f)({content:p}):Object(Mt.f)(m,null):n&&(v=Object(Mt.f)({content:n.media}));var b=i(f?"Edit":"Send");return d.a.createElement(S.a,{transitionDuration:0,open:!0,onClose:this.handleCancel,"aria-labelledby":"edit-media-dialog-title",onEnter:this.handleEnter},d.a.createElement("div",{className:"edit-media-dialog-content"},d.a.createElement("div",{style:{margin:24}},v),f&&d.a.createElement(d.a.Fragment,null,d.a.createElement(E.a,{disableRipple:!0,"aria-label":i("Edit"),className:"edit-media-dialog-edit-button",size:"small",onClick:this.handleEditMedia},d.a.createElement(lo.a,{fontSize:"inherit"})),d.a.createElement("input",{ref:this.editMediaRef,className:"inputbox-attach-button",type:"file",accept:"image/*",onChange:this.handleEditMediaComplete})),!f&&g&&d.a.createElement(nr.a,{value:h,onChange:this.handleSendAsPhoto,style:{margin:"0 24px 24px"}},d.a.createElement(rr.a,{value:!0,control:d.a.createElement(ar.a,{color:"primary"}),label:i("SendAsPhoto")}),d.a.createElement(rr.a,{value:!1,control:d.a.createElement(ar.a,{color:"primary"}),label:i("SendAsFile")}))),d.a.createElement("div",{ref:this.captionRef,id:"edit-media-dialog-caption",contentEditable:!0,suppressContentEditableWarning:!0,placeholder:i("Caption"),onKeyDown:this.handleKeyDown,onPaste:this.handlePaste,onInput:this.handleInput}),d.a.createElement(O.a,null,d.a.createElement(k.a,{onClick:this.handleCancel,color:"primary"},i("Cancel")),d.a.createElement(k.a,{onClick:this.handleDone,color:"primary"},b)),d.a.createElement(eo,{open:l,defaultText:s,defaultUrl:c,onDone:this.handleDoneEditUrl,onCancel:this.handleCancelEditUrl}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=t.prevOpen,n=e.open,r=e.chatId,i=e.messageId,o=e.newItem;if(a!==n){if(n){var s=X.a.get(r,i),c=!1;return(s&&"messagePhoto"===s.content["@type"]||o&&o.media&&"messagePhoto"===o.media["@type"])&&(c=!0),{prevOpen:!0,sendAsPhoto:c,editMessage:s,editMedia:null,editFile:null}}return{prevOpen:!1,sendAsPhoto:!1,editMessage:null,editMedia:null,editFile:null}}return null}}]),a}(d.a.Component)),po=Object(y.d)()(uo),ho=function(){function e(t){Object(o.a)(this,e),this.chatId=t,this.lastAction=null}return Object(s.a)(e,[{key:"setTyping",value:function(e){if(this.chatId){if(this.lastAction&&this.lastAction["@type"]===e["@type"]){var t=new Date;if(t.setSeconds(t.getSeconds()-v.qb),this.lastTypingDate&&this.lastTypingDate>t)return}this.lastAction=e,this.lastTypingDate=new Date,$.a.send({"@type":"sendChatAction",chat_id:this.chatId,action:e})}}}]),e}(),mo=a(357),fo=(a(570),new(function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;return Object(o.a)(this,a),(e=t.call(this)).reset=function(){e.bulkMessageContacts=new Map,e.selectedBulkMessageContacts=new Map,e.selectedBulkMessageGroups=new Map},e.loadClientData=function(){var t=new Map;try{var a=localStorage.get("clientData");a&&(a=JSON.parse(a))&&Object.keys(a).forEach((function(e){t.set(Number(e),a[e])}))}catch(n){}e.clientData=t},e.saveClientData=function(){var t=Array.from(e.clientData.entries()).reduce((function(e,t){var a=Object(C.a)(t,2),n=a[0],r=a[1];return r&&(e[String(n)]=r),e}),{});localStorage.setItem("clientData",JSON.stringify(t))},e.onUpdate=function(t){switch(t["@type"]){case"updateAuthorizationState":var a=t.authorization_state;if(!a)break;switch(a["@type"]){case"authorizationStateClosed":e.reset()}}},e.onClientUpdate=function(t){switch(console.log("ChatStore: ",t),t["@type"]){case"clientUpdateChatBackground":var a=t.wallpaper;e.wallpaper=a,e.emitUpdate(t);break;case"updateSelectedGroup":var n=t.groups;e.selectedBulkMessageGroups=n;break;case"updateSelectedContact":var r=t.contacts;e.selectedBulkMessageContacts=r;break;case"updateBulkMessageContacts":var i=t.contacts;e.bulkMessageContacts=i,e.emitUpdate(t)}},e.emitUpdate=function(t){e.emit(t["@type"],t)},e.emitFastUpdate=function(t){e.updating&&$.a.parameters.fastUpdating?e.skippedUpdates.push(t):e.emit(t["@type"],t)},e.addTdLibListener=function(){$.a.on("update",e.onUpdate),$.a.on("clientUpdate",e.onClientUpdate)},e.removeTdLibListener=function(){$.a.off("update",e.onUpdate),$.a.off("clientUpdate",e.onClientUpdate)},e.reset(),e.loadClientData(),e.addTdLibListener(),e}return Object(s.a)(a,[{key:"assign",value:function(e,t){this.set(Object.assign({},e,t))}}]),a}(fn.a)));window.chat=fo;var go=fo,vo=d.a.lazy((function(){return Promise.all([a.e(7),a.e(8)]).then(a.bind(null,660))})),bo=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).selectionChangeListener=function(){document.activeElement===n.newMessageRef.current&&n.saveSelection()},n.onUpdateBulkMessageContact=function(e){var t=e.contacts;console.log("contacts arrive at InputBox:",t),n.setState({bulkMessageContacts:t})},n.onClientUpdateSendFiles=function(e){var t=e.files;t&&n.handleSendFiles(Array.from(t))},n.onUpdateDeleteMessages=function(e){var t=n.state,a=t.chatId,r=t.editMessageId,i=e.chat_id,o=e.message_ids,s=e.is_permanent;r&&s&&a===i&&-1!==o.indexOf(r)&&n.handleCancel()},n.onClientUpdateEditMessage=function(e){var t=e.chatId,a=e.messageId;if(n.state.chatId===t){a?n.saveDraftAndSelection():n.restoreDraftAndSelection();var r=0!==a&&Object(Mt.l)(t,a);n.setState({editMessageId:a,openEditMedia:r},(function(){n.state.openEditMedia||(n.setEditMessage(),n.handleInput(),setTimeout((function(){n.focusInput()}),0))}))}},n.onClientUpdateFocusWindow=function(e){e.focused||n.saveDraft()},n.onUpdateChatDraftMessage=function(e){var t=e.chat_id;n.state.chatId===t&&n.loadDraft()},n.onClientUpdateStickerSend=function(e){var t=e.sticker;if(t){var a=t.sticker,r=t.thumbnail,i=t.width,o=t.height;if(a){var s=n.newMessageRef.current;if(s){s.innerText=null,n.restoreSelection();var c={"@type":"inputMessageSticker",sticker:{"@type":"inputFileId",id:a.id},width:i,height:o};if(r){var l=r.width,u=r.height,d=r.photo;c.thumbnail={thumbnail:{"@type":"inputFileId",id:d.id},width:l,height:u}}n.sendMessage(c,!1,(function(e){})),$.a.clientUpdate({"@type":"clientUpdateLocalStickersHint",hint:null})}}}},n.onClientUpdateReply=function(e){var t=n.state.chatId,a=e.chatId,r=e.messageId;t===a&&(n.setState({replyToMessageId:r}),r&&n.setInputFocus())},n.onClientUpdateChatId=function(e){n.state.chatId!==e.nextChatId&&(n.saveDraft(),n.beforeEditText=null,n.setState({chatId:e.nextChatId,replyToMessageId:Object(x.l)(e.nextChatId),editMessageId:0,openEditUrl:!1},(function(){n.loadDraft()})))},n.setDraft=function(){var e=n.state.chatId,t=n.newMessageRef.current,a=Object(x.k)(e);a?(n.setFormattedText(a),n.setState({replyToMessageId:Object(x.l)(e)})):t.innerText=null},n.setInputFocus=function(){setTimeout((function(){Ha(n.newMessageRef.current)}),100)},n.setChatDraftMessage=function(e){if(e){var t=e.chatId,a=e.draftMessage;t&&$.a.send({"@type":"setChatDraftMessage",chat_id:t,draft_message:a})}},n.getDraftMessage=function(e,t,a){var n=D.a.get(e);if(n){var r=n.draft_message,i=Object(wt.m)(a),o=i.text,s=i.entities,c=o&&o.length>0||s.length>0?{"@type":"draftMessage",reply_to_message_id:t,input_message_text:{"@type":"inputMessageText",text:{"@type":"formattedText",text:o,entities:s},disable_web_page_preview:!1,clear_draft:!1}}:null;return Object(x.i)(r,c)?null:{chatId:e,draftMessage:c}}},n.handleSubmit=function(){var e=n.state,t=e.chatId,a=e.editMessageId,r=n.newMessageRef.current;if(r){var i=r.innerHTML;if(r.innerText=null,n.handleInput(),Object(Q.d)(t,0),i&&i.trim()){var o=Object(wt.m)(i),s={"@type":"formattedText",text:o.text,entities:o.entities},c={"@type":"inputMessageText",text:s,disable_web_page_preview:!1,clear_draft:!0};if(a){var l=X.a.get(t,a);if(!l)return;var u=l.content;if(!u)return;var d=u.text,p=u.caption;d?n.editMessageText(c,(function(e){})):p&&n.editMessageCaption(s)}else n.sendMessage(c,!1,(function(e){}))}}},n.handleAttachPoll=function(){$.a.clientUpdate({"@type":"clientUpdateNewPoll"})},n.handleAttachPhoto=function(){n.attachPhotoRef&&n.attachPhotoRef.current.click()},n.handleAttachPhotoComplete=Object(i.a)(r.a.mark((function e(){var t,a,o,s,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(t=n.attachPhotoRef.current.files).length){e.next=3;break}return e.abrupt("return");case 3:if(1!==t.length){e.next=13;break}if(a=Array.from(t),o=Object(Fn.a)(a),s=o[0],o.slice(1),s){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,n.getNewItem(s,!0);case 9:c=e.sent,n.setState({openEditMedia:!0,newItem:c}),e.next=14;break;case 13:Array.from(t).forEach(function(){var e=Object(i.a)(r.a.mark((function e(t){var a,i,o,s,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(We.x)(t);case 2:a=e.sent,i=Object(C.a)(a,2),o=i[0],s=i[1],c={"@type":"inputMessagePhoto",photo:{"@type":"inputFileBlob",name:t.name,size:t.size,data:t},width:o,height:s},n.handleSendPhoto(c,t);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 14:n.attachPhotoRef.current.value="";case 15:case"end":return e.stop()}}),e)}))),n.handleAttachDocument=function(){n.attachDocumentRef&&n.attachDocumentRef.current.click()},n.handleAttachDocumentComplete=Object(i.a)(r.a.mark((function e(){var t,a,i,o,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(t=n.attachDocumentRef.current.files).length){e.next=3;break}return e.abrupt("return");case 3:if(1!==t.length){e.next=13;break}if(a=Array.from(t),i=Object(Fn.a)(a),o=i[0],i.slice(1),o){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,n.getNewItem(o,!1);case 9:s=e.sent,n.setState({openEditMedia:!0,newItem:s}),e.next=14;break;case 13:Array.from(t).forEach((function(e){var t={"@type":"inputMessageDocument",document:{"@type":"inputFileBlob",name:e.name,size:e.size,data:e}};n.handleSendDocument(t,e)}));case 14:n.attachDocumentRef.current.value="";case 15:case"end":return e.stop()}}),e)}))),n.handleClear=function(){document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null)},n.handleBold=function(){document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null),document.execCommand("bold",!1,null)},n.handleItalic=function(){document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null),document.execCommand("italic",!1,null)},n.handleMono=function(){document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null);var e="",t=Object(yt.a)(n).selection;t&&!t.isCollapsed&&(e=t.toString()),e&&(e="<code>".concat(e,"</code>"),document.execCommand("removeFormat",!1,null),document.execCommand("insertHTML",!1,e))},n.handleUnderline=function(){document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null),document.execCommand("underline",!1,null)},n.handleStrikeThrough=function(){document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null),document.execCommand("strikeThrough",!1,null)},n.handleUrl=function(){n.openEditUrlDialog()},n.handleCancel=function(){var e=n.state,t=e.chatId,a=e.editMessageId,r=e.replyToMessageId;a?Object(Q.d)(t,0):r&&Object(Q.l)(t,0)},n.handleKeyDown=function(e){var t=e.altKey,a=e.ctrlKey,r=e.keyCode,i=e.metaKey,o=e.repeat,s=e.shiftKey;switch(r){case 13:t||a||i||s||(o||n.handleSubmit(),e.preventDefault(),e.stopPropagation());break;case 27:t||a||i||s||(o||n.handleCancel(),e.preventDefault(),e.stopPropagation());break;case 38:if(!o&&!t&&!a&&!i&&!s){var c=n.newMessageRef.current;if(c&&!c.innerText){if(n.state.editMessageId)return;$.a.clientUpdate({"@type":"clientUpdateTryEditMessage"}),e.preventDefault(),e.stopPropagation()}}break;case 66:t||!a&&!i||s||(o||n.handleBold(),e.preventDefault(),e.stopPropagation());break;case 73:t||!a&&!i||s||(o||n.handleItalic(),e.preventDefault(),e.stopPropagation());break;case 75:t||!a&&!i||s?t&&(a||i)&&!s&&(o||n.handleMono(),e.preventDefault(),e.stopPropagation()):(o||n.handleUrl(),e.preventDefault(),e.stopPropagation());break;case 192:t&&(a||i)&&!s&&(o||n.handleClear(),e.preventDefault(),e.stopPropagation())}},n.handleSendPhoto=function(e,t){e&&n.sendMessage(e,!0,(function(e){var a=X.a.get(e.chat_id,e.id);null!=a&&n.handleSendingMessage(a,t),R.a.uploadFile(e.content.photo.sizes[0].photo.id,e)}))},n.handleSendPoll=function(e){n.sendMessage(e,!0,(function(){}))},n.handleSendDocument=function(e,t){e&&n.sendMessage(e,!0,(function(e){return R.a.uploadFile(e.content.document.document.id,e)}))},n.handleSendAudio=function(e,t){e&&n.sendMessage(e,!0,(function(e){return R.a.uploadFile(e.content.audio.audio.id,e)}))},n.handlePaste=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,i,o,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.clipboardData||t.originalEvent.clipboardData,i=a.items){e.next=3;break}return e.abrupt("return");case 3:if(o=[],Array.from(i).forEach((function(e){if(0===e.kind.indexOf("file")){var t=e.getAsFile();t&&o.push(t)}})),!(o.length>0)){e.next=9;break}return t.preventDefault(),n.handleSendFiles(o),e.abrupt("return");case 9:if(!(s=t.clipboardData.getData("text/plain"))){e.next=14;break}return t.preventDefault(),document.execCommand("insertText",!1,s),e.abrupt("return");case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handlePasteConfirm=function(){var e=n.state.files;e&&e.length&&(e.forEach((function(e){var t={"@type":"inputMessageDocument",document:{"@type":"inputFileBlob",name:e.name,data:e}};n.handleSendDocument(t,e)})),n.handlePasteCancel())},n.handlePasteCancel=function(){n.setState({files:null})},n.handleUpdateDraftConfirm=function(){n.state.newDraft&&(n.loadDraft(),n.handleUpdateDraftCancel())},n.handleUpdateDraftCancel=function(){n.setState({newDraft:null})},n.handleSendingMessage=function(e,t){if(e){var a=e.sending_state,n=e.content,r=e.chat_id,i=e.id;if(a&&"messageSendingStatePending"===a["@type"]&&"messagePhoto"===n["@type"]){var o=n.photo;if(o){var s=Object(We.n)(o.sizes,v.F);if(s){var c=s.photo;c&&(c.blob||(c.blob=t,R.a.updatePhotoBlob(r,i,c.id)))}}}}},n.sendMessage=function(){var e=Object(i.a)(r.a.mark((function e(t,a,i){var o,s,c,l,u;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.state,s=o.chatId,c=o.replyToMessageId,l=o.bulkMessageContacts,s){e.next=3;break}return e.abrupt("return");case 3:if(t){e.next=5;break}return e.abrupt("return");case 5:if(1111!==s){e.next=10;break}if(!(l.length<1)){e.next=8;break}return e.abrupt("return");case 8:return $.a.clientUpdate({"@type":"sendMarketingToolMessage",chat_id:s,input_message_content:t,bulk_message_contacts:l}),e.abrupt("return");case 10:return e.prev=10,e.next=13,lt.a.invokeScheduledAction("clientUpdateClearHistory chatId=".concat(s));case 13:return e.next=15,$.a.send({"@type":"sendMessage",chat_id:s,reply_to_message_id:c,input_message_content:t});case 15:u=e.sent,n.setState({replyToMessageId:0},(function(){a&&n.saveDraft()})),$.a.send({"@type":"viewMessages",chat_id:s,message_ids:[u.id]}),i(u),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(10),alert("sendMessage error "+JSON.stringify(e.t0));case 24:case"end":return e.stop()}}),e,null,[[10,21]])})));return function(t,a,n){return e.apply(this,arguments)}}(),n.handleEmojiSelect=function(e){e&&(n.restoreSelection(),document.execCommand("insertText",!1,e.native),n.handleInput())},n.handleInput=function(){var e=Object(i.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.setTyping(),n.setHints();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.openEditUrlDialog=function(){var e="",t="",a=Object(yt.a)(n),r=a.selection,i=a.range;if(i){var o=i.startContainer;if(o===i.endContainer){var s=o.parentElement;s&&"A"===s.nodeName&&(e=s.innerText,t=s.href)}}e||!r||r.isCollapsed||(e=r.toString()),n.setState({openEditUrl:!0,defaultUrl:t,defaultText:e})},n.closeEditUrlDialog=function(){n.setState({openEditUrl:!1},(function(){n.restoreSelection()}))},n.focusInput=function(){var e=n.newMessageRef.current;if(e)if(e.childNodes.length){var t=za(e);if(t){var a=document.createRange();a.setStart(t,t.length),a.collapse(!0);var r=window.getSelection();r.removeAllRanges(),r.addRange(a),e.focus()}}else e.focus()},n.handleCancelEditUrl=function(){n.closeEditUrlDialog()},n.handleDoneEditUrl=function(e,t){n.closeEditUrlDialog(),setTimeout((function(){var a=Object(yt.a)(n).range;if(a){var r=a.startContainer,i=a.endContainer;if(r&&r===i){var o=r.parentNode;if(o&&"A"===o.nodeName){o.href=t,o.title=t,o.innerText=e;var s=o.lastChild;if(s){var c=document.createRange();c.setStart(s,s.textContent.length),c.setEnd(s,s.textContent.length);var l=document.getSelection();l.removeAllRanges(),l.addRange(c)}return}}}var u="<a href=".concat(t," title=").concat(t," rel='noopener noreferrer' target='_blank'>").concat(e,"</a>");document.execCommand("removeFormat",!1,null),document.execCommand("insertHTML",!1,u)}),0)},n.handleCancelEditMedia=function(){n.closeEditMediaDialog()},n.handleEditMedia=function(e,t){t?n.editMessageMedia(t):n.editMessageCaption(e)},n.handleSendMedia=function(e,t){switch(n.closeEditMediaDialog(!1),e["@type"]){case"inputMessageAudio":n.handleSendAudio(e,t);break;case"inputMessagePhoto":n.handleSendPhoto(e,t);break;case"inputMessageDocument":n.handleSendDocument(e,t)}},n.handleHeaderClick=function(){setTimeout((function(){return n.restoreSelection()}),0)},n.attachDocumentRef=d.a.createRef(),n.attachPhotoRef=d.a.createRef(),n.newMessageRef=d.a.createRef();var s=lt.a.getChatId();return n.state={chatId:s,replyToMessageId:Object(x.l)(s),editMessageId:0,sendFile:null,bulkMessageContacts:[]},document.execCommand("defaultParagraphSeparator",!1,"br"),n}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props.t,n=this.state,r=n.chatId,i=n.newDraft,o=n.files,s=n.replyToMessageId,c=n.editMessageId,l=n.openEditMedia,u=n.openEditUrl,d=n.sendFile;return e.t!==a||(t.chatId!==r||(t.newDraft!==i||(t.files!==o||(t.replyToMessageId!==s||(t.editMessageId!==c||(t.sendFile!==d||(t.openEditUrl!==u||t.openEditMedia!==l)))))))}},{key:"loadDraft",value:function(){this.setDraft(),this.setInputFocus(),this.handleInput()}},{key:"saveDraft",value:function(){var e=this.state,t=e.chatId,a=e.editMessageId,n=e.replyToMessageId,r=this.newMessageRef.current;if(r){var i=null;i=a?this.beforeEditText?this.beforeEditText.innerHTML:null:r.innerHTML;var o=this.getDraftMessage(t,n,i);this.setChatDraftMessage(o)}}},{key:"componentDidMount",value:function(){document.addEventListener("selectionchange",this.selectionChangeListener,!0),lt.a.on("clientUpdateChatId",this.onClientUpdateChatId),lt.a.on("clientUpdateEditMessage",this.onClientUpdateEditMessage),lt.a.on("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),D.a.on("updateChatDraftMessage",this.onUpdateChatDraftMessage),R.a.on("clientUpdateSendFiles",this.onClientUpdateSendFiles),X.a.on("clientUpdateReply",this.onClientUpdateReply),X.a.on("updateDeleteMessages",this.onUpdateDeleteMessages),mo.a.on("clientUpdateStickerSend",this.onClientUpdateStickerSend),go.on("updateBulkMessageContacts",this.onUpdateBulkMessageContact),this.loadDraft()}},{key:"componentWillUnmount",value:function(){this.saveDraft(),lt.a.off("clientUpdateChatId",this.onClientUpdateChatId),lt.a.off("clientUpdateEditMessage",this.onClientUpdateEditMessage),lt.a.off("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),D.a.off("updateChatDraftMessage",this.onUpdateChatDraftMessage),R.a.off("clientUpdateSendFiles",this.onClientUpdateSendFiles),X.a.off("clientUpdateReply",this.onClientUpdateReply),X.a.off("updateDeleteMessages",this.onUpdateDeleteMessages),mo.a.off("clientUpdateStickerSend",this.onClientUpdateStickerSend),go.off("updateBulkMessageContacts",this.onUpdateBulkMessageContact),document.removeEventListener("selectionchange",this.selectionChangeListener,!0)}},{key:"restoreDraftAndSelection",value:function(){var e=this.newMessageRef.current;if(e){var t=this.beforeEditText;if(t){if(e.innerHTML=t.innerHTML,!t.range)return void this.focusInput();var a=document.getSelection();a.removeAllRanges(),a.addRange(t.range),e.focus()}else e.innerHTML=null,this.focusInput();this.handleInput()}}},{key:"saveDraftAndSelection",value:function(){var e=this.newMessageRef.current;e&&(this.beforeEditText={innerHTML:e.innerHTML,range:this.range})}},{key:"setEditMessage",value:function(){var e=this.state,t=e.chatId,a=e.editMessageId,n=X.a.get(t,a);if(n){var r=n.content;if(r){var i=r.text,o=r.caption;if(i||o){var s=this.newMessageRef.current;i?this.setFormattedText(i):o?this.setFormattedText(o):s.innerText=null}}}}},{key:"setFormattedText",value:function(e){var t=this.props.t,a=this.newMessageRef.current;if(e){var n=e.text,r=e.entities;try{var i=Object(wt.s)(n,r,t);a.innerHTML=null,i.forEach((function(e){a.appendChild(e)}))}catch(o){a.innerText=n}}else a.innerText=null}},{key:"getNewItem",value:function(){var e=Object(i.a)(r.a.mark((function e(t,a){var n,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:if((n=this.newMessageRef.current.innerHTML)&&(this.newMessageRef.current.innerHTML=null,this.handleInput()),!a){e.next=10;break}return e.next=7,Object(Mt.h)(t);case 7:e.t0=e.sent,e.next=13;break;case 10:return e.next=12,Object(Mt.g)(t);case 12:e.t0=e.sent;case 13:return i=e.t0,e.abrupt("return",{file:t,media:i,caption:n});case 15:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"setTyping",value:function(){var e=this.state,t=e.chatId,a=e.editMessageId,n=D.a.get(t);if(n){var r=this.newMessageRef.current;if(r){var i=r.innerHTML;if("<br>"!==i&&"<div><br></div>"!==i||(r.innerHTML=null),r.innerText)if(!Object(x.T)(t))if(!a)(n.OutputTypingManager||(n.OutputTypingManager=new ho(n.id))).setTyping({"@type":"chatActionTyping"})}}}},{key:"setHints",value:function(){var e=this.state.editMessageId,t=this.newMessageRef.current.innerText;if(!t||t.length>11||e){mo.a.hint&&$.a.clientUpdate({"@type":"clientUpdateLocalStickersHint",hint:null})}else{performance.now();var a=Ui()().exec(t);performance.now();if(a&&t===a[0]){var n=Date.now();$.a.send({"@type":"getStickers",emoji:a[0],limit:100}).then((function(e){$.a.clientUpdate({"@type":"clientUpdateLocalStickersHint",hint:{timestamp:n,emoji:a[0],stickers:e}})})),$.a.send({"@type":"searchStickers",emoji:a[0],limit:100}).then((function(e){$.a.clientUpdate({"@type":"clientUpdateRemoteStickersHint",hint:{timestamp:n,emoji:a[0],stickers:e}})}))}else{mo.a.hint&&$.a.clientUpdate({"@type":"clientUpdateLocalStickersHint",hint:null})}}}},{key:"handleSendFiles",value:function(){var e=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(t.length){e.next=4;break}return e.abrupt("return");case 4:if(1!==t.length){e.next=13;break}return e.next=7,this.getNewItem(t[0],t[0].type.startsWith("image"));case 7:if(a=e.sent){e.next=10;break}return e.abrupt("return");case 10:this.setState({openEditMedia:!0,newItem:a}),e.next=14;break;case 13:this.setState({files:t});case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"editMessageMedia",value:function(e){var t=this.state,a=t.chatId,n=t.editMessageId;a&&n&&e&&$.a.send({"@type":"editMessageMedia",chat_id:a,message_id:n,input_message_content:e})}},{key:"editMessageCaption",value:function(e){var t=this.state,a=t.chatId,n=t.editMessageId;a&&n&&e&&$.a.send({"@type":"editMessageCaption",chat_id:a,message_id:n,caption:e})}},{key:"editMessageText",value:function(){var e=Object(i.a)(r.a.mark((function e(t,a){var n,i,o,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.state,i=n.chatId,o=n.editMessageId,i){e.next=3;break}return e.abrupt("return");case 3:if(o){e.next=5;break}return e.abrupt("return");case 5:if(t){e.next=7;break}return e.abrupt("return");case 7:return e.prev=7,e.next=10,$.a.send({"@type":"editMessageText",chat_id:i,message_id:o,input_message_content:t});case 10:s=e.sent,a(s);case 12:return e.prev=12,e.finish(12);case 14:case"end":return e.stop()}}),e,this,[[7,,12,14]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"saveSelection",value:function(){this.selection=document.getSelection(),this.selection&&this.selection.rangeCount&&(this.range=this.selection.getRangeAt(0))}},{key:"restoreSelection",value:function(){var e=this.range;if(e){var t=document.getSelection();t.removeAllRanges(),t.addRange(e),this.newMessageRef.current.focus()}else this.focusInput()}},{key:"closeEditMediaDialog",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],a=this.state.newItem;this.setState({openEditMedia:!1,newItem:null},(function(){t&&a&&a.caption?(e.newMessageRef.current.innerHTML=a.caption,e.focusInput(),e.handleInput()):e.restoreSelection()}))}},{key:"render",value:function(){var e=this.props.t,t=this.state,a=t.chatId,n=t.editMessageId,r=t.newItem,i=t.replyToMessageId,o=t.files,s=(t.newDraft,t.defaultText),c=t.defaultUrl,l=t.openEditUrl,u=t.openEditMedia,p=n>0&&!Object(wt.L)(a,n);return d.a.createElement("div",{className:"inputbox-background"},d.a.createElement("div",{className:"inputbox"},d.a.createElement("div",{className:"inputbox-bubble"},d.a.createElement(io,{chatId:a,messageId:i,editMessageId:u?0:n,onClick:this.handleHeaderClick}),d.a.createElement("div",{className:"inputbox-wrapper"},d.a.createElement("div",{className:"inputbox-left-column"},d.a.createElement(d.a.Suspense,{fallback:d.a.createElement(E.a,{className:"inputbox-icon-button","aria-label":"Emoticon"},d.a.createElement(Mi.a,null))},d.a.createElement(vo,{onSelect:this.handleEmojiSelect}))),d.a.createElement("div",{className:"inputbox-middle-column"},d.a.createElement("div",{id:"inputbox-message",ref:this.newMessageRef,placeholder:e(p?"Caption":"Message"),contentEditable:!0,suppressContentEditableWarning:!0,onKeyDown:this.handleKeyDown,onPaste:this.handlePaste,onInput:this.handleInput})),d.a.createElement("div",{className:"inputbox-right-column"},d.a.createElement("input",{ref:this.attachDocumentRef,className:"inputbox-attach-button",type:"file",multiple:"multiple",onChange:this.handleAttachDocumentComplete}),d.a.createElement("input",{ref:this.attachPhotoRef,className:"inputbox-attach-button",type:"file",multiple:"multiple",accept:"image/*",onChange:this.handleAttachPhotoComplete}),!Boolean(n)&&d.a.createElement(Li,{chatId:a,onAttachPhoto:this.handleAttachPhoto,onAttachDocument:this.handleAttachDocument,onAttachPoll:this.handleAttachPoll})))),d.a.createElement("div",{className:"inputbox-send-button-background"},d.a.createElement(E.a,{className:"inputbox-send-button","aria-label":"Send",size:"small",onClick:this.handleSubmit},n?d.a.createElement(wi,null):d.a.createElement(Ii,null)))),!Object(x.U)(a)&&d.a.createElement(Qi,{onSend:this.handleSendPoll}),d.a.createElement(so,{files:o,onConfirm:this.handlePasteConfirm,onCancel:this.handlePasteCancel}),d.a.createElement(eo,{open:l,defaultText:s,defaultUrl:c,onDone:this.handleDoneEditUrl,onCancel:this.handleCancelEditUrl}),d.a.createElement(po,{open:u,chatId:a,messageId:n,newItem:r,onEdit:this.handleEditMedia,onSend:this.handleSendMedia,onCancel:this.handleCancelEditMedia}))}}]),a}(u.Component),Co=Object(y.d)()(bo),yo=a(169),ko=a.n(yo),Eo=(a(571),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.command,a=e.onCommand;return d.a.createElement("div",{className:"footer-command-wrapper"},d.a.createElement("div",{className:"footer-command-actions"},d.a.createElement(ko.a,{color:"primary",className:"footer-command-button",onClick:a},t)))}}]),a}(d.a.Component)),So=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.t,t=e(this.state.isMuted?"ChatsUnmute":"ChatsMute");return d.a.createElement(Eo,{command:t,onCommand:this.handleSetChatNotifications})}}]),a}($e),Oo=Object(y.d)()(So),Uo=(a(572),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).onUpdateBasicGroup=function(t){var a=e.props.chatId;Object(x.F)(a,t.basic_group.id)&&e.forceUpdate()},e.onUpdateSupergroup=function(t){var a=e.props.chatId;Object(x.G)(a,t.supergroup.id)&&e.forceUpdate()},e.handleJoin=function(){var t=e.props.chatId;t&&$.a.send({"@type":"joinChat",chat_id:t})},e.handleDeleteAndExit=function(){var t=e.props.chatId;t&&$.a.send({"@type":"deleteChatHistory",chat_id:t,remove_from_chat_list:!0})},e}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props,n=a.t,r=a.chatId;return e.chatId!==r||e.t!==n}},{key:"componentDidMount",value:function(){_e.a.on("updateBasicGroup",this.onUpdateBasicGroup),xe.a.on("updateSupergroup",this.onUpdateSupergroup)}},{key:"componentWillUnmount",value:function(){_e.a.off("updateBasicGroup",this.onUpdateBasicGroup),xe.a.off("updateSupergroup",this.onUpdateSupergroup)}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.t,n=D.a.get(t);if(!n)return null;var r=n.type;if(!r)return null;switch(r["@type"]){case"chatTypeBasicGroup":var i=_e.a.get(r.basic_group_id);if(!i)return null;var o=i.status;if(!o)return null;var s=o.is_member,c=o.permissions;switch(o["@type"]){case"chatMemberStatusAdministrator":return d.a.createElement(Co,null);case"chatMemberStatusBanned":return d.a.createElement(Eo,{command:a("DeleteChat"),onCommand:this.handleDeleteAndExit});case"chatMemberStatusCreator":return s?d.a.createElement(Co,null):d.a.createElement(Eo,{command:a("JoinGroup"),onCommand:this.handleJoin});case"chatMemberStatusLeft":return null;case"chatMemberStatusMember":return d.a.createElement(Co,null);case"chatMemberStatusRestricted":return s?c&&c.can_send_messages?d.a.createElement(Co,null):null:d.a.createElement(Eo,{command:a("JoinGroup"),onCommand:this.handleJoin})}break;case"chatTypePrivate":case"chatTypeSecret":return d.a.createElement(Co,null);case"chatTypeSupergroup":var l=xe.a.get(r.supergroup_id);if(!l)return null;var u=l.is_channel,p=l.status;if(!p)return null;var h=p.is_member,m=p.permissions;switch(p["@type"]){case"chatMemberStatusAdministrator":return d.a.createElement(Co,null);case"chatMemberStatusBanned":return d.a.createElement(Eo,{command:a("DeleteChat"),onCommand:this.handleDeleteAndExit});case"chatMemberStatusCreator":return h?d.a.createElement(Co,null):d.a.createElement(Eo,{command:a(u?"ChannelJoin":"JoinGroup"),onCommand:this.handleJoin});case"chatMemberStatusLeft":return d.a.createElement(Eo,{command:a(u?"ChannelJoin":"JoinGroup"),onCommand:this.handleJoin});case"chatMemberStatusMember":return u?d.a.createElement(Oo,{chatId:t}):d.a.createElement(Co,null);case"chatMemberStatusRestricted":return h?m&&m.can_send_messages?d.a.createElement(Co,null):null:d.a.createElement(Eo,{command:a(u?"ChannelJoin":"JoinGroup"),onCommand:this.handleJoin})}}return null}}]),a}(d.a.Component)),wo=Object(y.d)()(Uo),Mo=a(642),Io=(a(573),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleTimer=function(){var e=new Date,t=n.expire-e,a=100-t/n.props.timeout*100;if(n.setState({seconds:t>0?t:0,value:a>100?100:a}),e>=n.expire&&n.timerId){clearInterval(n.timerId),n.timerId=null;var r=n.props.onTimeout;r&&r()}},n.state={seconds:n.props.timeout/1e3,value:0},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.startTime=new Date,this.expire=this.startTime,this.expire.setMilliseconds(this.expire.getMilliseconds()+this.props.timeout),this.timerId=setInterval(this.handleTimer,100)}},{key:"componentWillUnmount",value:function(){this.timerId&&(clearInterval(this.timerId),this.timerId=null)}},{key:"render",value:function(){var e=this.state,t=e.value,a=e.seconds;return d.a.createElement("div",{className:"notification-timer"},d.a.createElement("div",{className:"notification-timer-text"},d.a.createElement(Pi.a,{color:"inherit"},(a/1e3).toFixed())),d.a.createElement("div",{className:"notification-timer-progress"},d.a.createElement(Mo.a,{size:32,value:100-t,variant:"static"})))}}]),a}(d.a.Component)),jo=(a(574),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).getDeleteDialogText=function(e,t){var a=D.a.get(e);if(!a)return null;if(!a.type)return null;switch(a.type["@type"]){case"chatTypeBasicGroup":return"Are you sure you want to leave group ".concat(a.title,"?");case"chatTypeSupergroup":var n=xe.a.get(a.type.supergroup_id);return n?n.is_channel?"Are you sure you want to leave channel ".concat(a.title,"?"):"Are you sure you want to leave group ".concat(a.title,"?"):null;case"chatTypePrivate":case"chatTypeSecret":return"Are you sure you want to delete chat with ".concat(Object(x.p)(e,!1,t),"?")}return null},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.onClose,a=e.chatId,n=e.t,r=e.open;return d.a.createElement(S.a,{transitionDuration:0,onClose:function(){return t(!1)},"aria-labelledby":"delete-dialog-title",open:r},d.a.createElement(U.a,{id:"delete-dialog-title"},Object(x.p)(a,!1,n)),d.a.createElement(xn.a,null,d.a.createElement("div",{className:"delete-dialog-content"},d.a.createElement(A,{chatId:a}),d.a.createElement(Tn.a,{id:"delete-dialog-description"},this.getDeleteDialogText(a,n)))),d.a.createElement(O.a,null,d.a.createElement(k.a,{onClick:function(){return t(!1)},color:"primary"},"Cancel"),d.a.createElement(k.a,{onClick:function(){return t(!0)},color:"primary",autoFocus:!0},"Ok")))}}]),a}(d.a.Component)),_o=Object(y.d)()(jo),xo=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.onClose,a=e.chatId,n=e.t,r=e.open;return d.a.createElement(S.a,{transitionDuration:0,onClose:function(){return t(!1)},"aria-labelledby":"delete-dialog-title",open:r},d.a.createElement(U.a,{id:"delete-dialog-title"},Object(x.p)(a,!1,n)),d.a.createElement(xn.a,null,d.a.createElement("div",{className:"delete-dialog-content"},d.a.createElement(A,{chatId:a}),d.a.createElement(Tn.a,{id:"delete-dialog-description"},"Are you sure you want clear history?"))),d.a.createElement(O.a,null,d.a.createElement(k.a,{onClick:function(){return t(!1)},color:"primary"},"Cancel"),d.a.createElement(k.a,{onClick:function(){return t(!0)},color:"primary",autoFocus:!0},"Ok")))}}]),a}(d.a.Component),To=Object(y.d)()(xo),Lo=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleButtonClick=function(e){n.setState({anchorEl:e.currentTarget})},n.handleMenuClose=function(){n.setState({anchorEl:null})},n.handleChatInfo=function(){n.handleMenuClose(),setTimeout((function(){return n.props.openChatDetails()}),150)},n.handleClearHistory=function(){n.handleMenuClose(),n.setState({openClearHistory:!0})},n.handleClearHistoryContinue=function(e){var t=n.props.t;if(n.setState({openClearHistory:!1}),e){var a=lt.a.getChatId(),r=t("HistoryClearedUndo"),i={"@type":"deleteChatHistory",chat_id:a,remove_from_chat_list:!1};n.handleScheduledAction(a,"clientUpdateClearHistory",r,i)}},n.handleLeave=function(){n.handleMenuClose(),n.setState({openDelete:!0})},n.handleLeaveContinue=function(e){if(n.setState({openDelete:!1}),e){var t=lt.a.getChatId(),a=n.getLeaveChatNotification(t),r=Object(x.U)(t)?{"@type":"deleteChatHistory",chat_id:t,remove_from_chat_list:!0}:{"@type":"leaveChat",chat_id:t};Object(x.V)(t)&&Object(x.Q)(t)&&(r={"@type":"setChatMemberStatus",chat_id:t,user_id:T.a.getMyId(),status:{"@type":"chatMemberStatusCreator",is_member:!1}}),n.handleScheduledAction(t,"clientUpdateLeaveChat",a,r)}},n.handleScheduledAction=function(e,t,a,o){var s=n.props.t;if(t){var c="".concat(t," chatId=").concat(e),l=function(){var a=Object(i.a)(r.a.mark((function a(){return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,$.a.send(o);case 3:return a.prev=3,$.a.clientUpdate({"@type":t,chatId:e,inProgress:!1}),a.finish(3);case 6:case"end":return a.stop()}}),a,null,[[0,,3,6]])})));return function(){return a.apply(this,arguments)}}(),u=n.props,p=u.enqueueSnackbar,h=u.closeSnackbar;$.a.clientUpdate({"@type":t,chatId:e,inProgress:!0});var m=p(a,{persist:!0,key:c,preventDuplicate:!0,action:[d.a.createElement(E.a,{key:"progress",color:"inherit",className:"progress-button"},d.a.createElement(Io,{timeout:v.x,onTimeout:function(){l(),h(m)}})),d.a.createElement(k.a,{key:"undo",color:"primary",size:"small",onClick:function(){$.a.clientUpdate({"@type":t,chatId:e,inProgress:!1}),h(m)}},s("Undo"))]})}},n.getLeaveChatTitle=function(e,t){var a=D.a.get(e);if(!a)return null;if(!a.type)return null;switch(a.type["@type"]){case"chatTypeBasicGroup":return t("DeleteChat");case"chatTypeSupergroup":var n=xe.a.get(a.type.supergroup_id);return n?n.is_channel?t("LeaveChannel"):t("LeaveMegaMenu"):null;case"chatTypePrivate":case"chatTypeSecret":return t("DeleteChatUser")}return null},n.getLeaveChatNotification=function(e){var t=n.props.t,a=D.a.get(e);if(!a)return t("ChatDeletedUndo");if(!a.type)return t("ChatDeletedUndo");switch(a.type["@type"]){case"chatTypeBasicGroup":return t("ChatDeletedUndo");case"chatTypeSupergroup":var r=xe.a.get(a.type.supergroup_id);return r?r.is_channel?"Left channel":"Left group":t("ChatDeletedUndo");case"chatTypePrivate":case"chatTypeSecret":return t("ChatDeletedUndo")}return t("ChatDeletedUndo")},n.handleUnpin=function(){n.handleMenuClose();var e=lt.a.getChatId();$.a.clientUpdate({"@type":"clientUpdateUnpin",chatId:e})},n.state={anchorEl:null,openDelete:!1,openClearHistory:!1},n}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.t,t=this.state,a=t.anchorEl,n=t.openDelete,r=t.openClearHistory,i=lt.a.getChatId(),o=Object(x.a)(i),s=Object(x.b)(i),c=this.getLeaveChatTitle(i,e),l=Object(x.h)(i);return d.a.createElement(d.a.Fragment,null,d.a.createElement(E.a,{"aria-owns":a?"simple-menu":null,"aria-haspopup":"true",className:"main-menu-button","aria-label":"Menu",onClick:this.handleButtonClick},d.a.createElement(_n,null)),d.a.createElement(un.a,{id:"main-menu",anchorEl:a,open:Boolean(a),onClose:this.handleMenuClose,getContentAnchorEl:null,disableAutoFocusItem:!0,disableRestoreFocus:!0,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},d.a.createElement(Et.a,{onClick:this.handleChatInfo},e("ChatInfo")),o&&d.a.createElement(Et.a,{onClick:this.handleClearHistory},e("ClearHistory")),s&&c&&d.a.createElement(Et.a,{onClick:this.handleLeave},c),l&&d.a.createElement(Et.a,{onClick:this.handleUnpin},e("Unpin"))),d.a.createElement(_o,{chatId:i,open:n,onClose:this.handleLeaveContinue}),d.a.createElement(To,{chatId:i,open:r,onClose:this.handleClearHistoryContinue}))}}]),a}(d.a.Component),Po=Object(m.a)(g.withSnackbar,Object(y.d)())(Lo),No=(a(575),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).onUpdateChatOnlineMemberCount=function(t){e.props.chatId===t.chat_id&&e.forceUpdate()},e.onUpdateChatTitle=function(t){e.props.chatId===t.chat_id&&e.forceUpdate()},e.onUpdateUserChatAction=function(t){e.props.chatId===t.chat_id&&e.forceUpdate()},e.onUpdateUserStatus=function(t){var a=e.props.chatId,n=D.a.get(a);if(n&&n.type)switch(n.type["@type"]){case"chatTypeBasicGroup":var r=_e.a.getFullInfo(n.type.basic_group_id);if(r&&r.members)r.members.find((function(e){return e.user_id===t.user_id}))&&e.forceUpdate();break;case"chatTypePrivate":case"chatTypeSecret":n.type.user_id===t.user_id&&e.forceUpdate()}},e.onUpdateUserFullInfo=function(t){var a=e.props.chatId,n=D.a.get(a);n&&n.type&&("chatTypePrivate"!==n.type["@type"]&&"chatTypeSecret"!==n.type["@type"]||n.type.user_id!==t.user_id||e.forceUpdate())},e.onUpdateBasicGroupFullInfo=function(t){var a=e.props.chatId,n=D.a.get(a);n&&n.type&&"chatTypeBasicGroup"===n.type["@type"]&&n.type.basic_group_id===t.basic_group_id&&e.forceUpdate()},e.onUpdateSupergroupFullInfo=function(t){var a=e.props.chatId,n=D.a.get(a);n&&n.type&&"chatTypeSupergroup"===n.type["@type"]&&n.type.supergroup_id===t.supergroup_id&&e.forceUpdate()},e.onUpdateBasicGroup=function(t){var a=e.props.chatId,n=D.a.get(a);n&&n.type&&"chatTypeBasicGroup"===n.type["@type"]&&n.type.basic_group_id===t.basic_group.id&&e.forceUpdate()},e.onUpdateSupergroup=function(t){var a=e.props.chatId,n=D.a.get(a);n&&n.type&&"chatTypeSupergroup"===n.type["@type"]&&n.type.supergroup_id===t.supergroup.id&&e.forceUpdate()},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){D.a.on("updateChatOnlineMemberCount",this.onUpdateChatOnlineMemberCount),D.a.on("updateChatTitle",this.onUpdateChatTitle),T.a.on("updateUserStatus",this.onUpdateUserStatus),D.a.on("updateUserChatAction",this.onUpdateUserChatAction),T.a.on("updateUserFullInfo",this.onUpdateUserFullInfo),_e.a.on("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),xe.a.on("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo),_e.a.on("updateBasicGroup",this.onUpdateBasicGroup),xe.a.on("updateSupergroup",this.onUpdateSupergroup)}},{key:"componentWillUnmount",value:function(){D.a.off("updateChatOnlineMemberCount",this.onUpdateChatOnlineMemberCount),D.a.off("updateChatTitle",this.onUpdateChatTitle),T.a.off("updateUserStatus",this.onUpdateUserStatus),D.a.off("updateUserChatAction",this.onUpdateUserChatAction),T.a.off("updateUserFullInfo",this.onUpdateUserFullInfo),_e.a.off("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),xe.a.off("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo),_e.a.off("updateBasicGroup",this.onUpdateBasicGroup),xe.a.off("updateSupergroup",this.onUpdateSupergroup)}},{key:"render",value:function(){var e=this.props.chatId,t=Object(x.q)(e,!0),a=Object(x.H)(e);return d.a.createElement("div",{className:h()("header-chat-subtitle",{"header-chat-subtitle-accent":a})},t)}}]),a}(d.a.Component)),Do=(a(576),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.className,a=e.chatId,n=e.onClick;return d.a.createElement("div",{className:h()("header-chat",t),onClick:n},d.a.createElement(A,{chatId:a,size:44}),d.a.createElement("div",{className:"header-chat-content"},d.a.createElement(je,{chatId:a}),d.a.createElement(No,{chatId:a})))}}]),a}(d.a.Component)),Ro=(a(577),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleCancel=function(){Object(Q.a)()},e.handleDelete=function(){var e,t=0,a=[],n=Object(Jr.a)(X.a.selectedItems.values());try{for(n.s();!(e=n.n()).done;){var r=e.value,i=r.chatId,o=r.messageId;t=i,a.push(o)}}catch(s){n.e(s)}finally{n.f()}Object(Q.c)(t,a)},e.handleForward=function(){var e,t,a=[],n=Object(Jr.a)(X.a.selectedItems.values());try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.chatId,o=r.messageId;e=i,a.push(o)}}catch(s){n.e(s)}finally{n.f()}Object(Q.f)(e,a)},e}return Object(s.a)(a,[{key:"render",value:function(){var e,t=this.props,a=t.t,n=t.count,r=!0,i=Object(Jr.a)(X.a.selectedItems.values());try{for(i.s();!(e=i.n()).done;){var o=e.value,s=o.chatId,c=o.messageId,l=X.a.get(s,c);if(!l){r=!1;break}if(!l.can_be_deleted_only_for_self&&!l.can_be_deleted_for_all_users){r=!1;break}}}catch(b){i.e(b)}finally{i.f()}var u,p=!0,h=Object(Jr.a)(X.a.selectedItems.values());try{for(h.s();!(u=h.n()).done;){var m=u.value,f=m.chatId,g=m.messageId,v=X.a.get(f,g);if(!v){p=!1;break}if(!v.can_be_forwarded){p=!1;break}}}catch(b){h.e(b)}finally{h.f()}return d.a.createElement("div",{className:"header-command"},p&&d.a.createElement(k.a,{color:"primary",className:"header-command-button",onClick:this.handleForward},n<=1?a("Forward"):"".concat(a("Forward")," ").concat(n)),r&&d.a.createElement(k.a,{color:"primary",className:"header-command-button",onClick:this.handleDelete},n<=1?a("Delete"):"".concat(a("Delete")," ").concat(n)),d.a.createElement("div",{className:"header-command-space"}),d.a.createElement(k.a,{color:"primary",className:"header-command-button",onClick:this.handleCancel},a("Cancel")))}}]),a}(d.a.Component)),Bo=Object(y.d)()(Ro),Ao=a(68),Fo=(a(578),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdateUnpin=function(e){var t=e.chatId;n.props.chatId===t&&n.handleDelete()},n.onClientUpdateDialogsReady=function(e){n.state.messageId&&n.loadContent()},n.onClientUpdateSetChatClientData=function(e){var t=e.chatId,a=e.clientData;n.props.chatId===t&&n.setState({clientData:a})},n.onUpdateChatPinnedMessage=function(e){var t=e.chat_id,a=e.pinned_message_id;n.props.chatId===t&&n.setState({messageId:a})},n.loadContent=function(){var e=n.props.chatId,t=n.state.messageId;e&&(t&&(X.a.get(e,t)||$.a.send({"@type":"getMessage",chat_id:e,message_id:t}).then((function(e){X.a.set(e);var t=R.a.getStore();Object(N.y)(t,[e]),n.forceUpdate()})).catch((function(a){a.code;if("Chat not found"!==a.message){var r={"@type":"deletedMessage",chat_id:e,id:t,content:null};X.a.set(r),n.forceUpdate()}}))))},n.handleClick=function(e){var t=n.props.chatId,a=n.state.messageId;a&&Object(Q.i)(t,a)},n.handleDelete=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,i,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&(t.preventDefault(),t.stopPropagation()),a=n.props.chatId,i=n.state.messageId,!Object(x.c)(a)){e.next=8;break}n.setState({confirm:!0}),e.next=11;break;case 8:return o=D.a.getClientData(a),e.next=11,$.a.clientUpdate({"@type":"clientUpdateSetChatClientData",chatId:a,clientData:Object.assign({},o,{unpinned_message_id:i})});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleUnpin=Object(i.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.props.chatId,n.handleClose(),$.a.send({"@type":"unpinChatMessage",chat_id:t});case 3:case"end":return e.stop()}}),e)}))),n.handleClose=function(){n.setState({confirm:!1})},n.state={},n}return Object(s.a)(a,[{key:"componentDidUpdate",value:function(e,t,a){var n=this.state.messageId;n&&t.messageId!==n&&this.loadContent()}},{key:"componentDidMount",value:function(){this.loadContent(),lt.a.on("clientUpdateDialogsReady",this.onClientUpdateDialogsReady),D.a.on("clientUpdateSetChatClientData",this.onClientUpdateSetChatClientData),D.a.on("clientUpdateUnpin",this.onClientUpdateUnpin),D.a.on("updateChatPinnedMessage",this.onUpdateChatPinnedMessage)}},{key:"componentWillUnmount",value:function(){lt.a.off("clientUpdateDialogsReady",this.onClientUpdateDialogsReady),D.a.off("clientUpdateSetChatClientData",this.onClientUpdateSetChatClientData),D.a.off("clientUpdateUnpin",this.onClientUpdateUnpin),D.a.off("updateChatPinnedMessage",this.onUpdateChatPinnedMessage)}},{key:"shouldComponentUpdate",value:function(e,t,a){var n=this.props,r=n.chatId,i=n.t,o=n.theme,s=this.state,c=s.clientData,l=s.confirm,u=s.messageId;return e.t!==i||(e.theme!==o||(e.chatId!==r||(t.clientData!==c||(t.confirm!==l||t.messageId!==u))))}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.t,n=this.state,r=n.messageId,i=n.confirm;if(!t)return null;if(D.a.getClientData(t).unpinned_message_id===r)return null;var o=X.a.get(t,r);if(!o)return null;var s=o?Object(wt.i)(o,a):a("Loading"),c=Object(wt.u)(t,r),l=Object(wt.t)(t,r);return Object(wt.E)(o)&&(s=a("DeletedMessage")),d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"pinned-message",onMouseDown:this.handleClick},d.a.createElement("div",{className:"border reply-border"}),c&&d.a.createElement(to,{chatId:t,messageId:r,photoSize:c,minithumbnail:l}),d.a.createElement("div",{className:"pinned-message-content"},d.a.createElement("div",{className:"pinned-message-title"},a("PinnedMessage")),d.a.createElement("div",{className:"pinned-message-subtitle"},s))),i&&d.a.createElement(S.a,{transitionDuration:0,open:!0,onClose:this.handleClose,"aria-labelledby":"unpin-message-confirmation"},d.a.createElement(U.a,{id:"unpin-message-confirmation"},a("Confirm")),d.a.createElement(xn.a,null,d.a.createElement(Tn.a,null,a("UnpinMessageAlert"))),d.a.createElement(O.a,null,d.a.createElement(k.a,{onClick:this.handleClose,color:"primary"},a("Cancel")),d.a.createElement(k.a,{onClick:this.handleUnpin,color:"primary"},a("Ok")))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=t.prevPropsChatId,n=e.chatId;if(a!==n){var r=D.a.get(n);return{prevPropsChatId:n,clientData:D.a.getClientData(n),messageId:r&&r.pinned_message_id?r.pinned_message_id:0,confirm:!1}}return null}}]),a}(d.a.Component)),Vo=Object(y.d)()(Fo),zo=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdateDeleteMessages=function(e){var t,a=e.chatId,r=e.messageIds,i=!0,o=Object(Jr.a)(r);try{for(o.s();!(t=o.n()).done;){var s=t.value,c=X.a.get(a,s);if(!c){i=!1;break}if(!c.can_be_deleted_for_all_users){i=!1;break}}}catch(l){o.e(l)}finally{o.f()}n.setState({openDeleteDialog:!0,chatId:a,messageIds:r,canBeDeletedForAllUsers:i,revoke:i})},n.handleRevokeChange=function(){n.setState({revoke:!n.state.revoke})},n.handleCloseDelete=function(){n.setState({openDeleteDialog:!1})},n.handleDeleteContinue=function(){var e=n.state,t=e.revoke,a=e.chatId,r=e.messageIds;Object(Q.a)(),n.handleCloseDelete(),$.a.send({"@type":"deleteMessages",chat_id:a,message_ids:r,revoke:t})},n.onClientUpdateMessageSelected=function(e){n.setState({selectionCount:X.a.selectedItems.size})},n.onClientUpdateChatId=function(e){n.forceUpdate()},n.onUpdateConnectionState=function(e){n.setState({connectionState:e.state})},n.onUpdateAuthorizationState=function(e){n.setState({authorizationState:e.authorization_state})},n.openChatDetails=function(){var e=lt.a.getChatId();D.a.get(e)&&(lt.a.isSmallWidth?Object(Q.i)(e,null,!0):lt.a.changeChatDetailsVisibility(!0))},n.handleSearchChat=function(){var e=lt.a.getChatId();D.a.get(e)&&Object(Q.m)(e)},n.localize=function(e){return(0,n.props.t)(e).replace("...","").replace("\u2026","")},n.state={authorizationState:lt.a.getAuthorizationState(),connectionState:lt.a.getConnectionState(),openDeleteDialog:!1},n}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){return t!==this.state||(e.theme!==this.props.theme||e.t!==this.props.t)}},{key:"componentDidMount",value:function(){lt.a.on("clientUpdateChatId",this.onClientUpdateChatId),lt.a.on("clientUpdateDeleteMessages",this.onClientUpdateDeleteMessages),lt.a.on("updateAuthorizationState",this.onUpdateAuthorizationState),lt.a.on("updateConnectionState",this.onUpdateConnectionState),X.a.on("clientUpdateClearSelection",this.onClientUpdateMessageSelected),X.a.on("clientUpdateMessageSelected",this.onClientUpdateMessageSelected)}},{key:"componentWillUnmount",value:function(){lt.a.off("clientUpdateChatId",this.onClientUpdateChatId),lt.a.off("clientUpdateDeleteMessages",this.onClientUpdateDeleteMessages),lt.a.off("updateAuthorizationState",this.onUpdateAuthorizationState),lt.a.off("updateConnectionState",this.onUpdateConnectionState),X.a.off("clientUpdateClearSelection",this.onClientUpdateMessageSelected),X.a.off("clientUpdateMessageSelected",this.onClientUpdateMessageSelected)}},{key:"render",value:function(){var e=this.props.t,t=this.state,a=t.authorizationState,n=t.connectionState,r=t.selectionCount,i=t.openDeleteDialog,o=t.canBeDeletedForAllUsers,s=t.revoke,c=t.messageIds,l=c?c.length:0,u=null;r&&(u=d.a.createElement(Bo,{count:r}));var p=lt.a.getChatId(),m=D.a.get(p),f=Object(x.H)(p),g=Object(x.s)(p,!0,e),v=Object(x.q)(p,!0),b=!1;if(n)switch(n["@type"]){case"connectionStateConnecting":g=this.localize("Connecting"),v="",b=!0;break;case"connectionStateConnectingToProxy":g=this.localize("Connecting to proxy"),v="",b=!0;break;case"connectionStateReady":break;case"connectionStateUpdating":g=this.localize("Updating"),v="",b=!0;break;case"connectionStateWaitingForNetwork":g=this.localize("Waiting for network"),v="",b=!0}else if(a)switch(a["@type"]){case"authorizationStateClosed":case" authorizationStateClosing":break;case"authorizationStateLoggingOut":g=this.localize("Logging out"),v="",b=!0;break;case"authorizationStateReady":case"authorizationStateWaitCode":break;case"authorizationStateWaitEncryptionKey":g=this.localize("Loading"),v="",b=!0;break;case"authorizationStateWaitPassword":case"authorizationStateWaitPhoneNumber":break;case"authorizationStateWaitTdlibParameters":g=this.localize("Loading"),v="",b=!0}else g=this.localize("Loading"),v="",b=!0;return u=u||d.a.createElement("div",{className:"header-details"},b?d.a.createElement("div",{className:h()("header-status","grow",m?"cursor-pointer":"cursor-default"),onClick:this.openChatDetails},d.a.createElement("span",{className:"header-status-content"},g),d.a.createElement(Ao.a,null),d.a.createElement("span",{className:h()("header-status-title",{"header-status-accent":f})},v),d.a.createElement("span",{className:"header-status-tail"})):d.a.createElement(Do,{className:h()("grow","cursor-pointer"),chatId:p,onClick:this.openChatDetails}),d.a.createElement(Vo,{chatId:p}),m&&d.a.createElement(d.a.Fragment,null,d.a.createElement(E.a,{className:"header-right-second-button","aria-label":"Search",onClick:this.handleSearchChat},d.a.createElement(jt,null)),d.a.createElement(Po,{openChatDetails:this.openChatDetails}))),d.a.createElement(d.a.Fragment,null,u,d.a.createElement(S.a,{transitionDuration:0,open:i,onClose:this.handleCloseDelete,"aria-labelledby":"delete-dialog-title"},d.a.createElement(U.a,{id:"delete-dialog-title"},"Confirm"),d.a.createElement(xn.a,null,d.a.createElement(Tn.a,null,1===l?"Do you want to delete this message?":"Do you want to delete ".concat(l," messages?")),Object(x.V)(p)?d.a.createElement(Tn.a,null,!Object(x.J)(p)&&(1===l?"This will delete it for everyone in this chat":"This will delete them for everyone in this chat")):d.a.createElement(d.a.Fragment,null,o&&d.a.createElement(rr.a,{control:d.a.createElement(wr.a,{checked:s,onChange:this.handleRevokeChange,color:"primary"}),label:Object(x.U)(p)?"Delete for ".concat(Object(x.p)(p,!1,e)):"Delete for all"}))),d.a.createElement(O.a,null,d.a.createElement(k.a,{onClick:this.handleCloseDelete,color:"primary"},e("Cancel")),d.a.createElement(k.a,{onClick:this.handleDeleteContinue,color:"primary"},e("Ok")))))}}]),a}(u.Component),Ho=Object(y.d)()(zo),Wo=a(374),Go=a(380),Zo=a(589),qo=a.n(Zo),Ko=a(588),Jo=a.n(Ko),Yo=a(580),Qo=a.n(Yo),Xo=a(581),$o=a.n(Xo),es=a(582),ts=a.n(es),as=a(408),ns=a.n(as),rs=a(662),is=a(346),os=(a(579),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={anchorEl:null,value:is.b.volume,prevValue:is.b.volume,dragging:!1,buttonOver:!1,popupOver:!1},e.onClientUpdateMediaVolume=function(t){var a=t.volume,n=t.prevVolume;void 0===n?e.setState({value:a}):e.setState({value:a,prevValue:n})},e.handlePopoverOpen=function(t){e.setState({anchorEl:t})},e.handlePopoverClose=function(){var t=e.state,a=t.dragging,n=t.buttonOver,r=t.popupOver;a||n||r||e.setState({anchorEl:null})},e.handleMouseEnter=function(t,a){e.setState({buttonOver:!0}),a&&e.handlePopoverOpen(t.currentTarget)},e.handleMouseLeave=function(){e.setState({buttonOver:!1},(function(){e.handlePopoverClose()}))},e.handlePopupMouseLeave=function(){e.setState({popupOver:!1},(function(){e.handlePopoverClose()}))},e.handleVoiceClick=function(){var t=e.state,a=t.value,n=t.prevValue,r=a>0?0:n||v.L;$.a.clientUpdate({"@type":"clientUpdateMediaVolume",volume:r})},e.handleChange=function(t,a){var n=e.state,r=n.dragging,i=n.prevValue;r?$.a.clientUpdate({"@type":"clientUpdateMediaVolume",volume:a}):$.a.clientUpdate({"@type":"clientUpdateMediaVolume",prevVolume:a>0?a:i,volume:a})},e.handleDragStart=function(){var t=e.state.value;e.setState({dragging:!0,prevValue:t})},e.handleDragEnd=function(){var t=e.state,a=t.value,n=t.prevValue;e.setState({dragging:!1,prevValue:a>0?a:n},(function(){e.handlePopoverClose()}))},e.getVolumeIcon=function(e){return 0===e?d.a.createElement(ns.a,{fontSize:"small"}):e<.25?d.a.createElement(Qo.a,{fontSize:"small"}):e<.5?d.a.createElement($o.a,{fontSize:"small"}):d.a.createElement(ts.a,{fontSize:"small"})},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){is.b.on("clientUpdateMediaVolume",this.onClientUpdateMediaVolume)}},{key:"componentWillUnmount",value:function(){is.b.off("clientUpdateMediaVolume",this.onClientUpdateMediaVolume)}},{key:"render",value:function(){var e=this,t=this.state,a=t.anchorEl,n=t.value,r=Boolean(a);return d.a.createElement("div",{onMouseEnter:function(t){return e.handleMouseEnter(t,!0)},onMouseLeave:this.handleMouseLeave,style:{position:"relative",background:"transparent"}},d.a.createElement(E.a,{className:"header-player-button",color:"primary",onClick:this.handleVoiceClick},this.getVolumeIcon(n)),d.a.createElement("div",{style:{position:"absolute",background:"transparent",visibility:r?"visible":"hidden",zIndex:1},onMouseEnter:function(t){return e.handleMouseEnter(t,!1)},onMouseLeave:this.handlePopupMouseLeave},d.a.createElement("div",{className:"volume-button-panel"},d.a.createElement(rs.a,{min:0,max:1,step:.01,value:n,onChange:this.handleChange,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,orientation:"vertical"}))))}}]),a}(d.a.Component)),ss=a(583),cs=a.n(ss),ls=a(584),us=a.n(ls),ds=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdateMediaRepeat=function(e){var t=e.repeat;n.setState({repeat:t})},n.handleRepeat=function(){var e=n.state.repeat,t=e;switch(e){case is.a.NONE:t=is.a.REPEAT;break;case is.a.REPEAT:t=is.a.REPEAT_ONE;break;case is.a.REPEAT_ONE:t=is.a.NONE}$.a.clientUpdate({"@type":"clientUpdateMediaRepeat",repeat:t})},n.getIcon=function(e){switch(e){case is.a.NONE:case is.a.REPEAT:return d.a.createElement(cs.a,{fontSize:"small"});case is.a.REPEAT_ONE:return d.a.createElement(us.a,{fontSize:"small"});default:return d.a.createElement(cs.a,{fontSize:"small"})}};var r=is.b.repeat;return n.state={repeat:r},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){is.b.on("clientUpdateMediaRepeat",this.onClientUpdateMediaRepeat)}},{key:"componentWillUnmount",value:function(){is.b.off("clientUpdateMediaRepeat",this.onClientUpdateMediaRepeat)}},{key:"render",value:function(){var e=this.state.repeat;return d.a.createElement(E.a,{className:"header-player-button",color:e===is.a.NONE?"default":"primary",onClick:this.handleRepeat},this.getIcon(e))}}]),a}(d.a.Component),ps=a(585),hs=a.n(ps),ms=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdateMediaShuffle=function(e){var t=e.shuffle;n.setState({shuffle:t})},n.handleShuffle=function(){var e=n.state.shuffle;$.a.clientUpdate({"@type":"clientUpdateMediaShuffle",shuffle:!e})};var r=is.b.shuffle;return n.state={shuffle:r},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){is.b.on("clientUpdateMediaShuffle",this.onClientUpdateMediaShuffle)}},{key:"componentWillUnmount",value:function(){is.b.off("clientUpdateMediaShuffle",this.onClientUpdateMediaShuffle)}},{key:"render",value:function(){var e=this.state.shuffle;return d.a.createElement(E.a,{className:"header-player-button",color:e?"primary":"default",onClick:this.handleShuffle},d.a.createElement(hs.a,{fontSize:"small"}))}}]),a}(d.a.Component),fs=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdateMediaPlaybackRate=function(e){var t=e.playbackRate;n.setState({playbackRate:t})},n.handlePlaybackRate=function(){var e=n.state.playbackRate===v.I?v.H:v.I;$.a.clientUpdate({"@type":"clientUpdateMediaPlaybackRate",playbackRate:e})};var r=is.b.playbackRate;return n.state={playbackRate:r},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){is.b.on("clientUpdateMediaPlaybackRate",this.onClientUpdateMediaPlaybackRate)}},{key:"componentWillUnmount",value:function(){is.b.off("clientUpdateMediaPlaybackRate",this.onClientUpdateMediaPlaybackRate)}},{key:"render",value:function(){var e=this.state.playbackRate;return d.a.createElement(E.a,{className:"header-player-button",color:e>v.I?"primary":"default",onClick:this.handlePlaybackRate},d.a.createElement("div",{className:"header-player-playback-icon"},"2X"))}}]),a}(d.a.Component),gs=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdateMediaTime=function(e){var t=e.currentTime;n.setState({currentTime:t,currentTimeString:Object(We.f)(Math.floor(t||0))})},n.getTimeString=function(e,t){Object(We.f)(Math.floor(t||0));return Object(We.f)(Math.floor(e||0))},n.state={currentTime:0,duration:0,timeString:n.getTimeString(0,0)},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){is.b.on("clientUpdateMediaTime",this.onClientUpdateMediaTime)}},{key:"componentWillUnmount",value:function(){is.b.off("clientUpdateMediaTime",this.onClientUpdateMediaTime)}},{key:"render",value:function(){var e=this.state.currentTimeString;return d.a.createElement(d.a.Fragment,null,e)}}]),a}(d.a.Component),vs=a(20),bs=a.n(vs),Cs=(a(586),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).scrollToActive=function(){var e=n.listRef.current;if(e){var t=Object(yt.a)(n).messageId;if(t){var a=n.itemRefMap.get(t);if(a){var r=vs.findDOMNode(a);r&&(e.scrollTop=r.offsetTop-15)}}}},n.onClientUpdateMediaTitleMouseOver=function(e){var t=e.over;t?n.setState({playlistMouseOver:t},(function(){n.tryOpen()})):n.setState({playlistMouseOver:t},(function(){n.tryClose()}))},n.onClientUpdateMediaActive=function(e){var t=e.chatId,a=e.messageId;n.chatId=t,n.messageId=a},n.onClientUpdateMediaPlaylistLoading=function(e){var t=Object(yt.a)(n),a=t.chatId,r=t.messageId;e.chatId===a&&e.messageId===r&&n.setState({playlist:null})},n.onClientUpdateMediaPlaylist=function(e){var t=Object(yt.a)(n),a=t.chatId,r=t.messageId,i=e.playlist;a===i.chatId&&r===i.messageId&&n.setState({playlist:i})},n.tryOpen=function(){clearTimeout(n.openTimeout),n.openTimeout=setTimeout((function(){var e=n.state,t=e.titleMouseOver,a=e.playlistMouseOver;n.setState({open:t||a})}),250)},n.tryClose=function(){clearTimeout(n.timeout),n.timeout=setTimeout((function(){var e=n.state,t=e.titleMouseOver,a=e.playlistMouseOver;n.setState({open:t||a})}),250)},n.handleMouseEnter=function(){n.setState({playlistMouseOver:!0,open:!0})},n.handleMouseLeave=function(){n.setState({playlistMouseOver:!1},(function(){n.tryClose()}))},n.handleScroll=function(){var e=n.listRef.current;e&&(e.scrollTop<=v.gb?$.a.clientUpdate({"@type":"clientUpdateMediaPlaylistNext"}):e.scrollTop+e.offsetHeight>=e.scrollHeight-v.gb&&$.a.clientUpdate({"@type":"clientUpdateMediaPlaylistPrev"}))},n.listRef=d.a.createRef(),n.itemRefMap=new Map;var r=is.b.message,i=is.b.playlist;return n.chatId=r?r.chat_id:0,n.messageId=r?r.id:0,n.state={open:!1,titleMouseOver:!1,playlistMouseOver:!1,playlist:i},n}return Object(s.a)(a,[{key:"componentDidUpdate",value:function(e,t,a){var n=this.state.open;!t.open&&n&&this.scrollToActive()}},{key:"componentDidMount",value:function(){is.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),is.b.on("clientUpdateMediaPlaylist",this.onClientUpdateMediaPlaylist),is.b.on("clientUpdateMediaPlaylistLoading",this.onClientUpdateMediaPlaylistLoading),is.b.on("clientUpdateMediaTitleMouseOver",this.onClientUpdateMediaTitleMouseOver)}},{key:"componentWillUnmount",value:function(){is.b.off("clientUpdateMediaActive",this.onClientUpdateMediaActive),is.b.off("clientUpdateMediaPlaylist",this.onClientUpdateMediaPlaylist),is.b.off("clientUpdateMediaPlaylistLoading",this.onClientUpdateMediaPlaylistLoading),is.b.off("clientUpdateMediaTitleMouseOver",this.onClientUpdateMediaTitleMouseOver)}},{key:"render",value:function(){var e=this,t=this.state,a=t.open,n=t.playlist;if(!a)return null;if(!n)return null;var r=n.messages;return r?r.length<=1?null:(this.itemRefMap.clear(),d.a.createElement("div",{className:"playlist"},d.a.createElement("div",{className:"playlist-wrapper"},d.a.createElement("div",{ref:this.listRef,className:"playlist-items",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onScroll:this.handleScroll},n.messages.slice(0).reverse().map((function(t){return d.a.createElement("div",{key:t.id,ref:function(a){return e.itemRefMap.set(t.id,a)},className:"playlist-item"},Object(Mt.f)(t,(function(){return Object(wt.O)(t.chat_id,t.id)})))})))))):null}}]),a}(d.a.Component)),ys=(a(587),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdateMediaPlaybackRate=function(e){var t=e.playbackRate,a=n.videoRef.current;a&&(a.playbackRate=t)},n.onClientUpdateMediaVolume=function(e){var t=e.volume,a=n.videoRef.current;a&&(a.volume=t)},n.onClientUpdateMediaSeek=function(e){var t=e.chatId,a=e.messageId,r=e.value,i=n.state.message;if(i){var o=i.chat_id,s=i.id;if(i.content&&t===o&&a===s){var c=n.videoRef.current;c&&c.duration&&(c.currentTime=r*c.duration)}}},n.onClientUpdateMediaViewerContent=function(e){n.playingMediaViewer=Boolean(lt.a.mediaViewerContent)},n.onClientUpdateMediaViewerEnded=function(e){n.playingMediaViewer=!1},n.onClientUpdateMediaViewerPause=function(e){n.playingMediaViewer=!1},n.onClientUpdateMediaViewerPlay=function(e){n.playingMediaViewer=!0;var t=n.videoRef.current;t&&t.pause()},n.startPlayingFile=function(e){var t=e.chat_id,a=e.id,r=n.state.src,i=n.getMediaSrc(e),o=n.getMediaMimeType(e),s=Boolean(i),c=is.b.playlist;n.setState({message:e,playlist:c,playing:s,src:i,mimeType:o},(function(){var e=n.videoRef.current;e&&(r!==i&&e.load(),e.currentTime=n.startTime,n.playingMediaViewer?(e.pause(),$.a.clientUpdate({"@type":"clientUpdateMediaPause",chatId:t,messageId:a})):e.paused&&e.play())}))},n.onClientUpdateMediaBlob=function(e){var t=e.chatId,a=e.messageId,r=n.state.message;if(r){var i=r.chat_id,o=r.id,s=r.content;if(s&&t===i&&a===o)switch(s["@type"]){case"messageText":var c=s.web_page;if(c){var l=c.audio,u=c.voice_note,d=c.video_note;if(l)l.audio&&n.startPlayingFile(r);if(u)u.voice&&n.startPlayingFile(r);if(d)d.video&&n.startPlayingFile(r)}break;case"messageAudio":var p=s.audio;if(p)p.audio&&n.startPlayingFile(r);break;case"messageVoiceNote":var h=s.voice_note;if(h)h.voice&&n.startPlayingFile(r);break;case"messageVideoNote":var m=s.video_note;if(m)m.video&&n.startPlayingFile(r)}}},n.onClientUpdateMediaPlaylist=function(e){var t=e.playlist,a=t.chatId,r=t.messageId,i=n.state.message;i&&i.chat_id===a&&i.id===r&&n.setState({playlist:t})},n.onClientUpdateMediaClose=function(e){n.setState({message:null,playlist:null,playing:!1,src:null,mimeType:null})},n.onClientUpdateMediaActive=function(e){var t=e.chatId,a=e.messageId,r=n.state,i=r.message,o=r.src;if(i&&i.chat_id===t&&i.id===a){if(!o)return;var s=n.videoRef.current;if(!s)return;s.paused?s.play():s.pause()}else n.startPlayingFile(is.b.message)},n.handlePrev=function(){$.a.clientUpdate({"@type":"clientUpdateMediaPrev"})},n.handlePlay=function(){var e=n.state.message;e&&$.a.clientUpdate({"@type":"clientUpdateMediaActive",chatId:e.chat_id,messageId:e.id})},n.handleNext=function(){$.a.clientUpdate({"@type":"clientUpdateMediaNext"})},n.getMediaMimeType=function(e){if(e){var t=e.content;if(t){var a=t.audio,n=t.voice_note,r=t.video_note,i=t.web_page;if(a)return a.mime_type;if(n)return n.mime_type;if(r)return"video/mp4";if(i){if(i.audio)return i.audio.mime_type;if(i.voice_note)return i.voice_note.mime_type;if(i.video_note)return"video/mp4"}}}return""},n.getMediaSrc=function(e){if(e){var t=e.content;if(t){var a=t.audio,n=t.voice_note,r=t.video_note,i=t.web_page;if(a){var o=a.audio;if(o)return Object(N.l)(o)}if(n){var s=n.voice;if(s)return Object(N.l)(s)}if(r){var c=r.video;if(c)return Object(N.l)(c)}if(i){if(i.audio){var l=i.audio.audio;if(l)return Object(N.l)(l)}if(i.voice_note){var u=i.voice_note.voice;if(u)return Object(N.l)(u)}if(i.video_note){var d=i.video_note.video;if(d)return Object(N.l)(d)}}}}return""},n.handleEnded=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=n.state.message;t&&($.a.clientUpdate({"@type":"clientUpdateMediaEnding",chatId:t.chat_id,messageId:t.id,moveNext:e}),n.setState({},(function(){$.a.clientUpdate({"@type":"clientUpdateMediaEnd",chatId:t.chat_id,messageId:t.id,moveNext:e})})))},n.handleVideoEnded=function(){n.handleEnded(!0)},n.handleClose=function(){var e=n.videoRef.current;e&&e.pause(),n.handleEnded(!1)},n.handleTimeUpdate=function(){var e=n.state.message;if(e){var t=n.videoRef.current;t&&(n.setState({currentTime:t.currentTime,currentTimeString:Object(We.f)(Math.floor(t.currentTime||0))}),$.a.clientUpdate({"@type":"clientUpdateMediaTime",chatId:e.chat_id,messageId:e.id,duration:t.duration,currentTime:t.currentTime,timestamp:Date.now()}))}},n.handleCanPlay=function(){var e=n.state.message;if(e){var t=n.videoRef.current;if(t){var a=is.b.playbackRate,r=is.b.volume,i=e.chat_id,o=e.id,s=Object(wt.A)(i,o);if(t.playbackRate=s?v.I:a,t.volume=r,t.muted=!1,!s){var c=null;"captureStream"in t?c=t.captureStream():"mozCaptureStream"in t&&(c=t.mozCaptureStream()),c&&$.a.clientUpdate({"@type":"clientUpdateMediaCaptureStream",chatId:e.chat_id,messageId:e.id,stream:c})}}}},n.handleVideoPlay=function(){var e=n.state.message;if(e){n.setState({playing:!0});var t=n.videoRef.current;t&&$.a.clientUpdate({"@type":"clientUpdateMediaPlay",chatId:e.chat_id,messageId:e.id,currentTime:t.currentTime,duration:t.duration,timestamp:Date.now()})}},n.handleVideoPause=function(){var e=n.state.message;e&&(n.setState({playing:!1}),n.videoRef.current&&$.a.clientUpdate({"@type":"clientUpdateMediaPause",chatId:e.chat_id,messageId:e.id}))},n.handlePlaybackRate=function(){var e=n.state.playbackRate===v.I?v.H:v.I;n.setState({playbackRate:e},(function(){var t=n.videoRef.current;t&&(t.playbackRate=e)})),$.a.clientUpdate({"@type":"clientUpdateMediaPlaybackRate",playbackRate:e})},n.hasPrev=function(e,t){if(!e)return!1;if(!t||!t.messages.length)return!1;var a=e.chat_id,n=e.id,r=t.messages.findIndex((function(e){return e.chat_id===a&&e.id===n}));return-1!==r&&r+1<t.messages.length},n.hasNext=function(e,t){if(!e)return!1;if(!t||!t.messages.length)return!1;var a=e.chat_id,n=e.id,r=t.messages.findIndex((function(e){return e.chat_id===a&&e.id===n}));return-1!==r&&r-1>=0},n.handleTitleMouseEnter=function(){$.a.clientUpdate({"@type":"clientUpdateMediaTitleMouseOver",over:!0})},n.handleTitleMouseLeave=function(){$.a.clientUpdate({"@type":"clientUpdateMediaTitleMouseOver",over:!1})},n.handleTitleClick=function(){var e=n.state.message;e&&Object(Q.i)(e.chat_id,e.id)},n.videoRef=d.a.createRef();var r=is.b.message,i=is.b.playlist;return n.startTime=v.K,n.state={currentTime:0,currentTimeString:Object(We.f)(0),message:r,playlist:i,playing:!1,src:n.getMediaSrc(r),mimeType:n.getMediaMimeType(r)},n}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t,a){var n=this.props.theme,r=this.state,i=r.message,o=r.playlist,s=r.src,c=r.playing;return e.theme!==n||(t.message!==i||(t.playlist!==o||(t.src!==s||t.playing!==c)))}},{key:"componentDidMount",value:function(){R.a.on("clientUpdateVoiceNoteBlob",this.onClientUpdateMediaBlob),R.a.on("clientUpdateVideoNoteBlob",this.onClientUpdateMediaBlob),R.a.on("clientUpdateAudioBlob",this.onClientUpdateMediaBlob),is.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),is.b.on("clientUpdateMediaClose",this.onClientUpdateMediaClose),is.b.on("clientUpdateMediaPlaylist",this.onClientUpdateMediaPlaylist),is.b.on("clientUpdateMediaViewerPlay",this.onClientUpdateMediaViewerPlay),is.b.on("clientUpdateMediaViewerPause",this.onClientUpdateMediaViewerPause),is.b.on("clientUpdateMediaViewerEnded",this.onClientUpdateMediaViewerEnded),is.b.on("clientUpdateMediaVolume",this.onClientUpdateMediaVolume),is.b.on("clientUpdateMediaPlaybackRate",this.onClientUpdateMediaPlaybackRate),is.b.on("clientUpdateMediaSeek",this.onClientUpdateMediaSeek),lt.a.on("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent)}},{key:"componentWillUnmount",value:function(){R.a.off("clientUpdateVoiceNoteBlob",this.onClientUpdateMediaBlob),R.a.off("clientUpdateVideoNoteBlob",this.onClientUpdateMediaBlob),R.a.off("clientUpdateAudioBlob",this.onClientUpdateMediaBlob),is.b.off("clientUpdateMediaActive",this.onClientUpdateMediaActive),is.b.off("clientUpdateMediaClose",this.onClientUpdateMediaClose),is.b.off("clientUpdateMediaPlaylist",this.onClientUpdateMediaPlaylist),is.b.off("clientUpdateMediaViewerPlay",this.onClientUpdateMediaViewerPlay),is.b.off("clientUpdateMediaViewerPause",this.onClientUpdateMediaViewerPause),is.b.off("clientUpdateMediaViewerEnded",this.onClientUpdateMediaViewerEnded),is.b.off("clientUpdateMediaVolume",this.onClientUpdateMediaVolume),is.b.off("clientUpdateMediaPlaybackRate",this.onClientUpdateMediaPlaybackRate),is.b.off("clientUpdateMediaSeek",this.onClientUpdateMediaSeek),lt.a.off("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent)}},{key:"render",value:function(){var e=this.props.t,t=this.state,a=t.playing,n=t.message,r=t.playlist,i=t.src,o=t.mimeType,s=!1;if(n){var c=n.chat_id,l=n.id;s=Object(wt.A)(c,l)}var u=n?n.date:null,p=Object(wt.q)(n,e),h=Object(wt.k)(u),m=Object(wt.j)(u),f=!s,g=!s,v=s,b=s,C=this.hasPrev(n,r),y=this.hasNext(n,r),k=i?d.a.createElement("source",{src:i,type:o}):null;return d.a.createElement(d.a.Fragment,null,d.a.createElement("video",{className:"header-player-video",ref:this.videoRef,autoPlay:!0,controls:!1,width:44,height:44,onCanPlay:this.handleCanPlay,onPlay:this.handleVideoPlay,onPause:this.handleVideoPause,onTimeUpdate:this.handleTimeUpdate,onEnded:this.handleVideoEnded},k),n&&d.a.createElement("div",{className:"header-player"},d.a.createElement(E.a,{disabled:!C,className:"header-player-button",color:"primary",onClick:this.handlePrev},d.a.createElement(Jo.a,{fontSize:"small"})),d.a.createElement(E.a,{className:"header-player-button",color:"primary",disabled:!i,onClick:this.handlePlay},a?d.a.createElement(Go.a,null):d.a.createElement(Wo.a,null)),d.a.createElement(E.a,{disabled:!y,className:"header-player-button",color:"primary",onClick:this.handleNext},d.a.createElement(qo.a,{fontSize:"small"})),d.a.createElement(Cs,null),d.a.createElement("div",{className:"header-player-content",onMouseEnter:this.handleTitleMouseEnter,onMouseLeave:this.handleTitleMouseLeave,onClick:this.handleTitleClick},d.a.createElement("div",{className:"header-player-title"},p,f&&d.a.createElement("span",{title:h},"\xa0",m)),"\xa0",d.a.createElement(gs,null)),d.a.createElement(os,null),g&&d.a.createElement(fs,null),v&&d.a.createElement(ds,null),b&&d.a.createElement(ms,null),d.a.createElement(E.a,{className:"header-player-button",onClick:this.handleClose},d.a.createElement(w.a,{fontSize:"small"}))))}}]),a}(d.a.Component)),ks=Object(y.d)()(ys),Es=(a(590),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).onUpdateChatActionBar=function(t){var a=e.props.chatId;t.chat_id===a&&e.forceUpdate()},e.handleClose=function(){var t=e.props.chatId;if(!D.a.get(t))return null;$.a.send({"@type":"removeChatActionBar",chat_id:t})},e.handleReportSpam=function(){var t=e.props.chatId;if(!D.a.get(t))return null;$.a.send({"@type":"reportChat",chat_id:t,reason:{"@type":"chatReportReasonSpam"},message_ids:[]})},e.handleReportUnrelatedLocation=function(){var t=e.props.chatId;if(!D.a.get(t))return null;$.a.send({"@type":"reportChat",chat_id:t,reason:{"@type":"chatReportReasonUnrelatedLocation"},message_ids:[]})},e.handleSharePhoneNumber=function(){var t=e.props.chatId,a=Object(x.u)(t);a&&$.a.send({"@type":"sharePhoneNumber",user_id:a})},e.handleAddContact=function(){var t=e.props.chatId,a=Object(x.u)(t);if(a){var n=T.a.get(a);if(n){var r=n.user_id,i=n.phone_number,o=n.first_name,s=n.last_name;$.a.send({"@type":"addContact",contact:{"@type":"contact",phone_number:i,first_name:o,last_name:s,vcard:"",user_id:r},share_phone_number:!1})}}},e.handleBlockUser=function(){var t=e.props.chatId,a=Object(x.u)(t);a&&$.a.send({"@type":"blockUser",user_id:a})},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){D.a.on("updateChatActionBar",this.onUpdateChatActionBar)}},{key:"componentWillUnmount",value:function(){D.a.off("updateChatActionBar",this.onUpdateChatActionBar)}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.t;if(!t)return null;var n=D.a.get(t);if(!n)return null;var r=n.action_bar;if(!r)return null;var i=null;switch(r["@type"]){case"chatActionBarSharePhoneNumber":i=d.a.createElement(k.a,{color:"primary",className:"header-command-button",onClick:this.handleSharePhoneNumber},a("ShareMyPhone"));break;case"chatActionBarAddContact":i=d.a.createElement(k.a,{color:"primary",className:"header-command-button",onClick:this.handleAddContact},a("AddContactChat"));break;case"chatActionBarReportAddBlock":i=d.a.createElement(d.a.Fragment,null,d.a.createElement(k.a,{color:"primary",className:"header-command-button",onClick:this.handleAddContact},a("AddContactChat")),d.a.createElement(k.a,{color:"secondary",className:"header-command-button",onClick:this.handleBlockUser},a("ReportSpamUser")));break;case"chatActionBarUnrelatedLocation":i=d.a.createElement(k.a,{color:"secondary",className:"header-command-button",onClick:this.handleReportUnrelatedLocation},a("ReportSpamLocation"));break;case"chatActionBarReportSpam":i=d.a.createElement(k.a,{color:"secondary",className:"header-command-button",onClick:this.handleReportSpam},a("ReportSpam"))}return d.a.createElement("div",{className:"action-bar",onMouseDown:this.handleClick},d.a.createElement("div",{className:"action-bar-content"},i),d.a.createElement("div",{className:"action-bar-close-button"},d.a.createElement(E.a,{onClick:this.handleClose},d.a.createElement(w.a,null))))}}]),a}(d.a.Component)),Ss=Object(y.d)()(Es),Os=(a(591),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).onClientUpdateLanguage=function(){e.forceUpdate()},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){Sr.a.on("clientUpdateLanguageChange",this.onClientUpdateLanguage)}},{key:"componentWillUnmount",value:function(){Sr.a.off("clientUpdateLanguageChange",this.onClientUpdateLanguage)}},{key:"render",value:function(){var e=this.props,t=e.date,a=e.i18n,n=new Date(1e3*t)<(new Date).setMonth((new Date).getMonth()-3)?{day:"numeric",month:"long",year:"numeric"}:{day:"numeric",month:"long"};return d.a.createElement("div",{className:"day-meta"},d.a.createElement("div",{className:"day-meta-wrapper"},d.a.createElement("div",null,new Date(1e3*t).toLocaleDateString([a.language],n))))}}]),a}(d.a.Component)),Us=Object(y.d)()(Os),ws=(a(592),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdateDragging=function(e){var t=lt.a.dragParams;n.setState({dragParams:t})},n.handleDragEnter=function(e){e.preventDefault(),e.stopPropagation()},n.handleDrop=function(e){e.preventDefault(),e.stopPropagation(),$.a.clientUpdate({"@type":"clientUpdateDragging",dragging:!1}),n.handleAttachDocumentComplete(e.dataTransfer.files)},n.handleDragLeave=function(e){e.preventDefault(),e.stopPropagation(),$.a.clientUpdate({"@type":"clientUpdateDragging",dragging:!1})},n.handleAttachDocumentComplete=function(e){0!==e.length&&$.a.clientUpdate({"@type":"clientUpdateSendFiles",files:e})};var r=lt.a.dragParams;return n.state={dragParams:r},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){lt.a.on("clientUpdateDragging",this.onClientUpdateDragging)}},{key:"componentWillUnmount",value:function(){lt.a.off("clientUpdateDragging",this.onClientUpdateDragging)}},{key:"render",value:function(){return this.state.dragParams?d.a.createElement("div",{className:"files-drop-target",onDragEnter:this.handleDragEnter,onDragLeave:this.handleDragLeave,onDrop:this.handleDrop},d.a.createElement("div",{className:"files-drop-target-wrapper"},d.a.createElement("div",{className:"files-drop-target-text"},d.a.createElement("div",{className:"files-drop-target-title"},"Drop files here"),d.a.createElement("div",{className:"files-drop-target-subtitle"},"to send them")))):null}}]),a}(d.a.Component)),Ms=a(599),Is=a.n(Ms),js=a(656),_s=(a(593),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={arrowRef:null},e.handleArrowRef=function(t){e.setState({arrowRef:t})},e.openForward=function(t){t.stopPropagation();var a=e.props.forwardInfo;if(!a)return null;var n=a.origin;switch(n["@type"]){case"messageForwardOriginUser":var r=n.sender_user_id;Object(Q.k)(r,!0);break;case"messageForwardOriginHiddenUser":break;case"messageForwardOriginChannel":var i=n.chat_id,o=n.message_id;Object(Q.i)(i,o)}},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.t,a=e.forwardInfo,n=this.state.arrowRef,r=Object(wt.o)(a,t),i=Object(wt.F)(a)?d.a.createElement(d.a.Fragment,null,t("HidAccount"),d.a.createElement("span",{className:"forward-arrow",ref:this.handleArrowRef})):"";return d.a.createElement("div",{className:h()("message-author","forward")},d.a.createElement("div",null,t("ForwardedMessage")),d.a.createElement("div",null,t("From")+" ",d.a.createElement(js.a,{title:i,classes:{popper:"forward-arrow-popper",tooltip:"forward-tooltip"},PopperProps:{popperOptions:{modifiers:{arrow:{enabled:Boolean(n),element:n}}}},placement:"top"},d.a.createElement("a",{onClick:this.openForward},r))))}}]),a}(d.a.Component)),xs=Object(y.d)()(_s),Ts=a(168),Ls=a.n(Ts),Ps=(a(594),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.className,a=e.chatId,n=e.messageId,r=e.date,i=e.editDate,o=e.onDateClick,s=e.t,c=e.views,l=e.style,u=X.a.get(a,n);if(!u)return null;var p=u.is_outgoing,m=Object(wt.j)(r),f=Object(wt.k)(r);return d.a.createElement("div",{className:h()("meta",t),style:l},d.a.createElement("span",null,"\u2002"),c>0&&d.a.createElement(d.a.Fragment,null,d.a.createElement(Ls.a,{className:"meta-views-icon"}),d.a.createElement("span",{className:"meta-views"},"\xa0",c,"\xa0 \xa0")),i>0&&d.a.createElement("span",null,s("EditedMessage"),"\xa0"),d.a.createElement("a",{onClick:o},d.a.createElement("span",{title:f},m)),p&&d.a.createElement(Ea,{chatId:a,messageId:n}))}}]),a}(d.a.Component)),Ns=Object(y.d)()(Ps),Ds=Object(M.a)(d.a.createElement("path",{d:"M18,5 C19.6568542,5 21,6.34314575 21,8 L21,20 C21,21.6568542 19.6568542,23 18,23 L9,23 C7.34314575,23 6,21.6568542 6,20 L6,8 C6,6.34314575 7.34314575,5 9,5 L18,5 Z M18,7 L9,7 C8.44771525,7 8,7.44771525 8,8 L8,20 C8,20.5522847 8.44771525,21 9,21 L18,21 C18.5522847,21 19,20.5522847 19,20 L19,8 C19,7.44771525 18.5522847,7 18,7 Z M15,1 C15.5522847,1 16,1.44771525 16,2 C16,2.55228475 15.5522847,3 15,3 L15,3 L5,3 C4.44771525,3 4,3.44771525 4,4 L4,4 L4,16 C4,16.5522847 3.55228475,17 3,17 C2.44771525,17 2,16.5522847 2,16 L2,16 L2,4 C2,2.34314575 3.34314575,1 5,1 L5,1 Z"}),"Copy"),Rs=Object(M.a)(d.a.createElement("path",{d:"M18,3 C19.6568542,3 21,4.34314575 21,6 L21,18 C21,19.6568542 19.6568542,21 18,21 L6,21 C4.34314575,21 3,19.6568542 3,18 L3,6 C3,4.34314575 4.34314575,3 6,3 L18,3 Z M18,5 L6,5 C5.44771525,5 5,5.44771525 5,6 L5,18 C5,18.5522847 5.44771525,19 6,19 L18,19 C18.5522847,19 19,18.5522847 19,18 L19,6 C19,5.44771525 18.5522847,5 18,5 Z M15.7928932,8.29289322 C16.1834175,7.90236893 16.8165825,7.90236893 17.2071068,8.29289322 C17.5976311,8.68341751 17.5976311,9.31658249 17.2071068,9.70710678 L17.2071068,9.70710678 L11.2071068,15.7071068 C10.8165825,16.0976311 10.1834175,16.0976311 9.79289322,15.7071068 L9.79289322,15.7071068 L7.29289322,13.2071068 C6.90236893,12.8165825 6.90236893,12.1834175 7.29289322,11.7928932 C7.68341751,11.4023689 8.31658249,11.4023689 8.70710678,11.7928932 L8.70710678,11.7928932 L10.5,13.5857864 Z"}),"FrameCheck"),Bs=Object(M.a)(d.a.createElement("g",{stroke:"currentColor",strokeWidth:"2",fill:"none",fillRule:"evenodd",strokeLinecap:"round",transform:"translate(4, 1)"},d.a.createElement("path",{d:"M2,3 L14,3 C15.1045695,3 16,3.8954305 16,5 L16,17 C16,18.1045695 15.1045695,19 14,19 L2,19 C0.8954305,19 0,18.1045695 0,17 L0,10 L0,10"}),d.a.createElement("polyline",{strokeLinejoin:"round",points:"4 11.5 6.5 14 12.5 8"}),d.a.createElement("polyline",{strokeLinejoin:"round",points:"3 0 -2.87547763e-14 3 3 6"})),"RemoveCheck"),As=Object(M.a)(d.a.createElement("path",{d:"M11.8025478,4.79529691 C11.8025478,3.93005081 12.5039683,3.22863025 13.3692144,3.22863025 C13.7633775,3.22863025 14.1430567,3.37720768 14.4325315,3.64473128 L22.2284036,10.8494344 C22.8638434,11.4366882 22.9029059,12.4278772 22.2883553,13.0917108 L22.2284036,13.1505656 L14.4325315,20.3552687 C13.7970916,20.9425225 12.8059026,20.90346 12.2186488,20.2680201 C11.9511252,19.9785454 11.8025478,19.5988662 11.8025478,19.2047031 L11.8025478,16.4249931 C8.21922017,16.6092505 5.79479016,17.8111183 4.43312712,19.9909578 L4.29164834,20.2262356 C3.95336498,20.8131459 3.20334729,21.0146979 2.61643694,20.6764146 C2.24185558,20.4605134 2.00860424,20.0633528 2.00249611,19.6310483 C1.8981509,12.2459874 5.13388305,8.13673748 11.4825227,7.6491321 L11.8025478,7.62777147 L11.8025478,4.79529691 Z M13.8025478,5.78581808 L13.8025478,8.6 C13.8025478,9.15228475 13.3548325,9.6 12.8025478,9.6 C7.49232524,9.6 4.65375859,12.0566924 4.1006582,17.2535243 C6.09650127,15.345115 9.01935671,14.4 12.8025478,14.4 C13.3548325,14.4 13.8025478,14.8477153 13.8025478,15.4 L13.8025478,18.2142808 L20.5271714,12.0005066 L13.8025478,5.78581808 Z"}),"Share"),Fs=a(400),Vs=(a(595),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).state={confirmStopPoll:!1},e.handleConfirmStopPoll=function(t){e.state.dialog||e.setState({confirmStopPoll:!0,contextMenu:!1})},e.handleCloseConfirm=function(t){t&&t.stopPropagation(),e.setState({confirmStopPoll:!1})},e.handleStopPoll=function(t){t.stopPropagation();var a=e.props,n=a.chatId,r=a.messageId;e.state.confirmStopPoll&&e.setState({confirmStopPoll:!1}),Object(Fs.c)(n,r)},e.handleUnvote=function(t){t&&t.stopPropagation();var a=e.props,n=a.chatId,r=a.messageId;(0,a.onClose)(t),Object(Fs.a)(n,r)},e.handleCopyLink=function(t){var a=e.props,n=a.onClose,r=a.copyLink;n(t),r&&z(r)},e.handleReply=function(t){var a=e.props,n=a.chatId,r=a.messageId,i=a.onClose;Object(Q.a)(),i(t),Object(Q.l)(n,r)},e.handlePin=function(t){var a=e.props,n=a.chatId,r=a.messageId,i=a.onClose;Object(Q.a)(),i(t),Object(wt.I)(n,r)?Pa(n):La(n,r)},e.handleForward=function(t){var a=e.props,n=a.chatId,r=a.messageId;(0,a.onClose)(t),Object(Q.f)(n,[r])},e.handleEdit=function(t){var a=e.props,n=a.chatId,r=a.messageId,i=a.onClose;Object(Q.a)(),i(t),Object(Q.d)(n,r)},e.handleSelect=function(t){var a=e.props,n=a.chatId,r=a.messageId;(0,a.onClose)(t),Object(Q.n)(n,r,!0)},e.handleDelete=function(t){var a=e.props,n=a.chatId,r=a.messageId;(0,a.onClose)(t),Object(Q.c)(n,[r])},e.handleDownload=function(){var t=Object(i.a)(r.a.mark((function t(a){var n,i,o,s,c,l,u,d,p,h;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.props,i=n.chatId,o=n.messageId,(0,n.onClose)(a),s=X.a.get(i,o)){t.next=5;break}return t.abrupt("return");case 5:if(c=s.content){t.next=8;break}return t.abrupt("return");case 8:if(l=c.audio){t.next=11;break}return t.abrupt("return");case 11:if(u=l.audio){t.next=14;break}return t.abrupt("return");case 14:return d=u.id,t.next=17,$.a.send({"@type":"downloadFile",file_id:d,priority:1,offset:10240,limit:1024,synchronous:!0});case 17:return p=t.sent,t.next=20,$.a.send({"@type":"readFilePart",file_id:d,offset:10240,count:1024});case 20:h=t.sent,console.log("[file] result",p,h);case 22:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.t,a=e.chatId,n=e.messageId,r=e.anchorPosition,i=e.copyLink,o=e.open,s=e.onClose,c=this.state.confirmStopPoll,l=Object(wt.I)(a,n),u=Object(wt.e)(a,n),p=Object(wt.a)(a,n),h=Object(x.e)(a),m=Object(x.c)(a),f=Object(wt.d)(a,n),g=Object(wt.b)(a,n),v=Object(wt.c)(a,n),b=!X.a.hasSelectedMessage(a,n),C=Boolean(i);return d.a.createElement(d.a.Fragment,null,d.a.createElement(St.a,{open:o,onClose:s,anchorReference:"anchorPosition",anchorPosition:r,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},onMouseDown:function(e){return e.stopPropagation()}},d.a.createElement(kt.a,{onClick:function(e){return e.stopPropagation()}},C&&d.a.createElement(Et.a,{onClick:this.handleCopyLink},d.a.createElement(be.a,null,d.a.createElement(Ds,null)),d.a.createElement(Ce.a,{primary:t("CopyLink")})),h&&d.a.createElement(Et.a,{onClick:this.handleReply},d.a.createElement(be.a,null,d.a.createElement(As,{style:{transform:"scaleX(-1)"}})),d.a.createElement(Ce.a,{primary:t("Reply")})),m&&d.a.createElement(Et.a,{onClick:this.handlePin},l?d.a.createElement(d.a.Fragment,null,d.a.createElement(be.a,null,d.a.createElement(wa,null)),d.a.createElement(Ce.a,{primary:t("UnpinFromTop")})):d.a.createElement(d.a.Fragment,null,d.a.createElement(be.a,null,d.a.createElement(wa,null)),d.a.createElement(Ce.a,{primary:t("PinToTop")}))),b&&d.a.createElement(Et.a,{onClick:this.handleSelect},d.a.createElement(be.a,null,d.a.createElement(Rs,null)),d.a.createElement(Ce.a,{primary:t("Select")})),f&&d.a.createElement(Et.a,{onClick:this.handleForward},d.a.createElement(be.a,null,d.a.createElement(As,null)),d.a.createElement(Ce.a,{primary:t("Forward")})),v&&d.a.createElement(Et.a,{onClick:this.handleEdit},d.a.createElement(be.a,null,d.a.createElement(In,null)),d.a.createElement(Ce.a,{primary:t("Edit")})),g&&d.a.createElement(Et.a,{color:"secondary",onClick:this.handleDelete},d.a.createElement(be.a,null,d.a.createElement(Qa,null)),d.a.createElement(Ce.a,{primary:t("Delete")})),u&&d.a.createElement(Et.a,{onClick:this.handleUnvote},d.a.createElement(be.a,null,d.a.createElement(Bs,null)),d.a.createElement(Ce.a,{primary:t("Unvote")})),p&&d.a.createElement(Et.a,{onClick:this.handleConfirmStopPoll},d.a.createElement(be.a,null,d.a.createElement(jr,null)),d.a.createElement(Ce.a,{primary:t("StopPoll")})))),d.a.createElement(S.a,{transitionDuration:0,open:c,onClose:this.handleCloseConfirm,"aria-labelledby":"form-dialog-title"},d.a.createElement(U.a,{id:"form-dialog-title"},t("StopPollAlertTitle")),d.a.createElement(xn.a,null,d.a.createElement(Tn.a,null,t("StopPollAlertText"))),d.a.createElement(O.a,null,d.a.createElement(k.a,{onClick:this.handleCloseConfirm,color:"primary"},t("Cancel")),d.a.createElement(k.a,{onClick:this.handleStopPoll,color:"primary"},t("Stop")))))}}]),a}(d.a.PureComponent)),zs=Object(y.d)()(Vs);a(596);var Hs=Object(y.d)()((function(e){var t=e.t;return d.a.createElement("div",{className:"unread-separator"},t("UnreadMessages"))})),Ws=a(76),Gs=a(373),Zs=a(379),qs=a(423),Ks=a(355),Js=a(384),Ys=a(407),Qs=a(409),Xs=null;function $s(e){return ec.apply(this,arguments)}function ec(){return(ec=Object(i.a)(r.a.mark((function e(t){var a,n,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=Xs=new Date,e.next=4,$.a.send({"@type":"getWebPageInstantView",url:t,force_full:!0});case 4:if(n=e.sent,Xs===a){e.next=7;break}return e.abrupt("return");case 7:console.log("[IV] open",n),Object(N.w)(n),Object(Q.o)({instantView:n}),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(0),(i=window.open()).opener=null,i.location=t;case 17:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}a(597);var tc=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).getMedia=function(){var t=e.props,a=t.chatId,n=t.messageId,r=t.size,i=(t.displaySize,t.displaySmallSize),o=t.displayExtraSmallSize,s=t.openMedia,c=X.a.get(a,n);if(!c)return null;var l=c.content;if(!l)return null;var u=l.web_page;if(!u)return null;var p=u.site_name,h=u.title,m=u.description,f=(u.url,u.photo),g=u.animation,v=u.video,b=u.audio,C=u.document,y=u.voice_note,k=u.video_note,E=u.sticker,S=u.type;if(E)return[null,d.a.createElement(Ks.b,{chatId:a,messageId:n,sticker:E,openMedia:s,source:Ks.a.MESSAGE})];if(y)return[null,d.a.createElement(Qs.a,{chatId:a,messageId:n,voiceNote:y,openMedia:s})];if(k)return[null,d.a.createElement(Ys.a,{chatId:a,messageId:n,videoNote:k,openMedia:s})];if(b)return[null,d.a.createElement(Zs.a,{chatId:a,messageId:n,audio:b,openMedia:s})];if(C)return[null,d.a.createElement(qs.a,{chatId:a,messageId:n,document:C,openMedia:s})];if(g&&(Object(N.l)(g.animation)||g.thumbnail))return[null,d.a.createElement(Gs.a,{chatId:a,messageId:n,animation:g,openMedia:s})];if(v&&v.thumbnail)return[null,d.a.createElement(Js.a,{chatId:a,messageId:n,video:v,openMedia:s})];if(f){var O=Object(We.n)(f.sizes,r),U=("article"===S||"photo"===S)&&(p||h||m)&&O&&O.width===O.height,w=U&&(!m||m.length<50),M=U||w?{float:"right",marginLeft:6}:{};return[U?d.a.createElement(Bt.a,{displaySize:w?o:i,style:M,chatId:a,messageId:n,photo:f,openMedia:s}):null,U?null:d.a.createElement(Bt.a,{chatId:a,messageId:n,photo:f,openMedia:s})]}return[null,null]},e.handleInstantViewClick=function(){var t=Object(i.a)(r.a.mark((function t(a){var n,i,o,s,c,l;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),a.stopPropagation(),n=e.props,i=n.chatId,o=n.messageId,s=X.a.get(i,o)){t.next=6;break}return t.abrupt("return",null);case 6:if(c=s.content){t.next=9;break}return t.abrupt("return",null);case 9:if(l=c.web_page){t.next=12;break}return t.abrupt("return",null);case 12:$s(l.url);case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(s.a)(a,[{key:"getWebPage",value:function(){var e=this.props,t=e.chatId,a=e.messageId,n=e.t,r=X.a.get(t,a);if(!r)return null;var i=r.content;if(!i)return null;var o=i.web_page;if(!o)return null;var s=o.description,c=o.instant_view_version,l=o.site_name,u=o.title,p=d.a.createElement(d.a.Fragment,null,l&&d.a.createElement("div",{className:"web-page-site-name"},l),u&&d.a.createElement("div",{className:"web-page-title"},u),s&&d.a.createElement("div",{className:"web-page-description"},s)),h=this.getMedia(),m=Object(C.a)(h,2),f=m[0],g=m[1],v=c>0&&d.a.createElement(k.a,{variant:"outlined",color:"primary",classes:{outlinedPrimary:"message-control",disabled:"message-control-disabled"},fullWidth:!0,onClick:this.handleInstantViewClick,className:"web-page-button"},d.a.createElement(Ws.a,null,d.a.createElement("path",{d:"M10.5159727,16.7438514 C10.1741929,18.1203636 10.687342,18.4055299 11.6053255,17.4005852 L15.4613785,12.9698209 C16.3535455,11.8808642 16.1300862,11.0059438 14.8452805,10.7872179 L12.9861121,10.4429102 L12.9861121,10.4429102 C12.8775019,10.4227962 12.8057616,10.3184447 12.8258756,10.2098345 C12.8265392,10.2062511 12.8273007,10.2026864 12.8281591,10.1991446 L13.5436135,7.24719783 C13.8863521,5.8619451 13.3150978,5.61107807 12.4582164,6.59275159 C11.2270125,7.98097123 10.2913754,9.02966176 9.65130514,9.73882318 C9.42814828,9.98606827 9.06894462,10.3719875 8.57369417,10.8965808 C7.48829706,12.1010165 8.05955136,12.9745105 9.31498713,13.1932365 L11.0917769,13.5117472 L11.0917769,13.5117472 C11.2005008,13.5312372 11.2728391,13.6351751 11.253349,13.743899 C11.2525988,13.7480841 11.2517153,13.7522442 11.2506999,13.756373 L10.5159727,16.7438514 Z"})),n("InstantView"));return d.a.createElement(d.a.Fragment,null,f,p,g,v)}},{key:"render",value:function(){var e=this.props.meta;return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"web-page"},d.a.createElement("div",{className:"border"}),d.a.createElement("div",{className:"web-page-wrapper"},this.getWebPage())),e)}}]),a}(d.a.Component);tc.defaultProps={size:v.F,displaySize:v.D,displaySmallSize:v.E,displayExtraSmallSize:v.C};var ac=Object(y.d)()(tc),nc=(a(598),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdateClearSelection=function(e){n.state.selected&&n.setState({selected:!1})},n.onClientUpdateMessageShake=function(e){var t=n.props,a=t.chatId,r=t.messageId,i=n.state.shook;a===e.chatId&&r===e.messageId&&(i?n.setState({shook:!1},(function(){setTimeout((function(){n.setState({shook:!0})}),0)})):n.setState({shook:!0}))},n.onClientUpdateMessageHighlighted=function(e){var t=n.props,a=t.chatId,r=t.messageId,i=n.state,o=i.selected,s=i.highlighted;o||(a===e.chatId&&r===e.messageId?s?n.setState({highlighted:!1},(function(){setTimeout((function(){n.setState({highlighted:!0})}),0)})):n.setState({highlighted:!0}):s&&n.setState({highlighted:!1}))},n.onClientUpdateMessageSelected=function(e){var t=n.props,a=t.chatId,r=t.messageId,i=e.selected;a===e.chatId&&r===e.messageId&&n.setState({selected:i,highlighted:!1})},n.onUpdateMessageEdited=function(e){var t=e.chat_id,a=e.message_id,r=n.props,i=r.chatId,o=r.messageId;i===t&&o===a&&n.forceUpdate()},n.onUpdateMessageViews=function(e){var t=e.chat_id,a=e.message_id,r=n.props,i=r.chatId,o=r.messageId;i===t&&o===a&&n.forceUpdate()},n.onUpdateMessageContent=function(e){var t=e.chat_id,a=e.message_id,r=n.props,i=r.chatId,o=r.messageId,s=n.state.emojiMatches;i===t&&(o===a&&(Object(wt.l)(i,o)!==s?n.setState({emojiMatches:Object(wt.l)(i,o)}):n.forceUpdate()))},n.handleSelectUser=function(e){Object(Q.k)(e,!0)},n.handleSelectChat=function(e){Object(Q.i)(e,null,!0)},n.handleSelection=function(){if(n.mouseDown&&!window.getSelection().toString()){var e=n.props,t=e.chatId,a=e.messageId,r=!X.a.selectedItems.has("chatId=".concat(t,"_messageId=").concat(a));Object(Q.n)(t,a,r)}},n.handleDateClick=function(e){e.preventDefault(),e.stopPropagation();var t=n.props,a=t.chatId,r=t.messageId;Object(x.e)(a)?Object(Q.l)(a,r):Object(wt.d)(a,r)&&Object(Q.f)(a,[r])},n.openMedia=function(e){e&&(e.preventDefault(),e.stopPropagation());var t=n.props,a=t.chatId,r=t.messageId;Object(wt.O)(a,r)},n.handleAnimationEnd=function(){n.setState({highlighted:!1})},n.handleMouseDown=function(){n.mouseDown=!0},n.handleMouseOver=function(){n.mouseDown=!1},n.handleMouseOut=function(){n.mouseOut=!1},n.handleReplyClick=function(){var e=n.props,t=e.chatId,a=e.messageId;Object(Q.j)(t,a)},n.handleOpenContextMenu=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,i,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&(t.preventDefault(),t.stopPropagation()),!n.state.contextMenu){e.next=6;break}n.setState({contextMenu:!1}),e.next=12;break;case 6:if(!(X.a.selectedItems.size>1)){e.next=8;break}return e.abrupt("return");case 8:a=t.clientX,i=t.clientY,o=t.target&&"A"===t.target.tagName&&t.target.href?t.target.href:null,n.setState({contextMenu:!0,copyLink:o,left:a,top:i});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleCloseContextMenu=function(e){e&&e.stopPropagation(),n.setState({contextMenu:!1})};var s=n.props,c=s.chatId,l=s.messageId;return n.state={message:X.a.get(c,l),emojiMatches:Object(wt.l)(c,l),selected:!1,highlighted:!1,shook:!1,contextMenu:!1,copyLink:null,left:0,top:0},n}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props,n=a.chatId,r=a.messageId,i=a.sendingState,o=a.showUnreadSeparator,s=a.showTail,c=a.showTitle,l=this.state,u=l.contextMenu,d=l.selected,p=l.highlighted,h=l.shook,m=l.emojiMatches;return e.chatId!==n||(e.messageId!==r||(e.sendingState!==i||(e.showUnreadSeparator!==o||(e.showTail!==s||(e.showTitle!==c||(t.contextMenu!==u||(t.selected!==d||(t.highlighted!==p||(t.shook!==h||t.emojiMatches!==m)))))))))}},{key:"componentDidMount",value:function(){X.a.on("clientUpdateMessageHighlighted",this.onClientUpdateMessageHighlighted),X.a.on("clientUpdateMessageSelected",this.onClientUpdateMessageSelected),X.a.on("clientUpdateMessageShake",this.onClientUpdateMessageShake),X.a.on("clientUpdateClearSelection",this.onClientUpdateClearSelection),X.a.on("updateMessageContent",this.onUpdateMessageContent),X.a.on("updateMessageEdited",this.onUpdateMessageEdited),X.a.on("updateMessageViews",this.onUpdateMessageViews)}},{key:"componentWillUnmount",value:function(){X.a.off("clientUpdateMessageHighlighted",this.onClientUpdateMessageHighlighted),X.a.off("clientUpdateMessageSelected",this.onClientUpdateMessageSelected),X.a.off("clientUpdateMessageShake",this.onClientUpdateMessageShake),X.a.off("clientUpdateClearSelection",this.onClientUpdateClearSelection),X.a.off("updateMessageContent",this.onUpdateMessageContent),X.a.off("updateMessageEdited",this.onUpdateMessageEdited),X.a.off("updateMessageViews",this.onUpdateMessageViews)}},{key:"render",value:function(){var e=this.props,t=e.t,a=e.chatId,n=e.messageId,r=e.showUnreadSeparator,i=e.showTail,o=e.showTitle,s=e.showDate,c=this.state,l=c.emojiMatches,u=c.selected,p=c.highlighted,m=c.shook,f=c.copyLink,g=c.contextMenu,v=c.left,b=c.top,C=X.a.get(a,n);if(!C)return d.a.createElement("div",null,"[empty message]");var y=C.is_outgoing,k=C.views,E=C.date,S=C.edit_date,O=C.reply_to_message_id,U=C.forward_info,w=C.sender_user_id,M=y&&!Object(x.J)(a),I=d.a.createElement(Ns,{className:"meta-hidden",key:"".concat(a,"_").concat(n,"_meta"),chatId:a,messageId:n,date:E,editDate:S,views:k}),j=Object(wt.x)(C,I,t),_=null!==j&&j.length>0,T=Object(wt.P)(a,n),L=Boolean(O),P=Object(x.U)(a),N=!P&&o||T||L,D=Object(wt.z)(C),R=Object(Mt.f)(C,this.openMedia,N,_,I),B=null;i&&(B=w?d.a.createElement(nn.a,{small:!0,userId:w,onSelect:this.handleSelectUser}):d.a.createElement(A,{small:!0,chatId:a,onSelect:this.handleSelectChat}));var F=Object(wt.r)(a,n),V="messageSticker"!==C.content["@type"]&&"messageVideoNote"!==C.content["@type"];return d.a.createElement("div",null,s&&d.a.createElement(Us,{date:E}),d.a.createElement("div",{className:h()("message",{"message-short":!B,"message-out":M,"message-selected":u,"message-highlighted":p&&!u,"message-top":o&&!i,"message-bottom":!o&&i,"message-middle":!o&&!i,"message-bubble-hidden":!V}),onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onMouseDown:this.handleMouseDown,onClick:this.handleSelection,onAnimationEnd:this.handleAnimationEnd,onContextMenu:this.handleOpenContextMenu},r&&d.a.createElement(Hs,null),d.a.createElement("div",{className:"message-body"},d.a.createElement("div",{className:"message-padding"},d.a.createElement(Is.a,{className:"message-select-tick"})),d.a.createElement("div",{className:h()("message-wrapper",{"message-wrapper-shook":m})},B,d.a.createElement("div",{className:h()("message-content",{"message-bubble":V,"message-bubble-out":V&&M}),style:F},V&&(o&&!P||T)&&d.a.createElement("div",{className:"message-title"},o&&!T&&d.a.createElement(ia.a,{chatId:a,openChat:!0,userId:w,openUser:!0}),T&&d.a.createElement(xs,{forwardInfo:U})),L&&d.a.createElement(no,{chatId:a,messageId:O,onClick:this.handleReplyClick}),R,d.a.createElement("div",{className:h()("message-text",{"message-text-1emoji":1===l,"message-text-2emoji":2===l,"message-text-3emoji":3===l})},j),D&&d.a.createElement(ac,{chatId:a,messageId:n,openMedia:this.openMedia,meta:I}),V&&d.a.createElement(Ns,{className:h()("meta-text",{"meta-bubble":Object(wt.K)(a,n)}),chatId:a,messageId:n,date:E,editDate:S,views:k,onDateClick:this.handleDateClick})),d.a.createElement("div",{className:"message-tile-padding"})),d.a.createElement("div",{className:"message-padding"}))),d.a.createElement(zs,{chatId:a,messageId:n,anchorPosition:{top:b,left:v},open:g,onClose:this.handleCloseContextMenu,copyLink:f}))}}]),a}(u.Component)),rc=Object(m.a)(Object(m.d)(),Object(y.d)(),Object(m.c)())(nc),ic=(a(600),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdateCacheLoaded=function(e){var t=lt.a.cacheLoaded;n.setState({cacheLoaded:t})},n.onClientUpdateChatId=function(e){var t=e.nextChatId;n.setState({chatId:t})},n.onClientUpdateDialogsReady=function(e){var t=lt.a.dialogsReady;n.setState({dialogsReady:t})};var r=lt.a.chatId,i=lt.a.dialogsReady,s=lt.a.cacheLoaded;return n.state={chatId:r,dialogsReady:i,cacheLoaded:s},n}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t,a){return t.chatId!==this.state.chatId||(t.dialogsReady!==this.state.dialogsReady||t.cacheLoaded!==this.state.cacheLoaded)}},{key:"componentDidMount",value:function(){lt.a.on("clientUpdateChatId",this.onClientUpdateChatId),lt.a.on("clientUpdateDialogsReady",this.onClientUpdateDialogsReady),lt.a.on("clientUpdateCacheLoaded",this.onClientUpdateCacheLoaded)}},{key:"componentWillUnmount",value:function(){lt.a.off("clientUpdateChatId",this.onClientUpdateChatId),lt.a.off("clientUpdateDialogsReady",this.onClientUpdateDialogsReady),lt.a.off("clientUpdateCacheLoaded",this.onClientUpdateCacheLoaded)}},{key:"render",value:function(){var e=this.props,t=e.t,a=(e.force,this.state),n=a.chatId;a.dialogsReady,a.cacheLoaded;return n?null:d.a.createElement("div",{className:"placeholder"},d.a.createElement("div",{className:"placeholder-wrapper"},d.a.createElement("div",{className:"placeholder-meta"},t("SelectChatToStartMessaging"))))}}]),a}(d.a.Component)),oc=Object(y.d)()(ic),sc=a(602),cc=a.n(sc),lc=(a(601),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.onClick;return d.a.createElement("div",{className:"scroll-down-button"},d.a.createElement(E.a,{disableRipple:!0,onMouseDown:e},d.a.createElement(cc.a,null)))}}]),a}(d.a.Component)),uc=a(375),dc=(a(603),{width:64,height:64,borderRadius:"50%",margin:"0 auto 5px"}),pc=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdateMessageHighlighted=function(e){var t=n.props,a=t.chatId,r=t.messageId,i=n.state,o=i.selected,s=i.highlighted;o||(a===e.chatId&&r===e.messageId?s?n.setState({highlighted:!1},(function(){setTimeout((function(){n.setState({highlighted:!0})}),0)})):n.setState({highlighted:!0}):s&&n.setState({highlighted:!1}))},n.handleAnimationEnd=function(){n.setState({highlighted:!1})},n.openMedia=function(e){e&&(e.preventDefault(),e.stopPropagation());var t=n.props,a=t.chatId,r=t.messageId;Object(wt.O)(a,r)};var r=n.props,i=r.chatId,s=r.messageId;return n.state={message:X.a.get(i,s),highlighted:!1},n}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props,n=a.chatId,r=a.messageId,i=a.sendingState,o=a.showUnreadSeparator,s=this.state.highlighted;return e.chatId!==n||(e.messageId!==r||(e.sendingState!==i||(e.showUnreadSeparator!==o||t.highlighted!==s)))}},{key:"componentDidMount",value:function(){X.a.on("clientUpdateMessageHighlighted",this.onClientUpdateMessageHighlighted)}},{key:"componentWillUnmount",value:function(){X.a.off("clientUpdateMessageHighlighted",this.onClientUpdateMessageHighlighted)}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.messageId,n=e.showUnreadSeparator,r=e.showDate,i=this.state.highlighted,o=X.a.get(t,a);if(!o)return null;var s=o.content,c=o.date;if(!s)return null;var l=s.photo,u=Object(uc.a)(o,!0);return d.a.createElement("div",null,r&&d.a.createElement(Us,{date:c}),d.a.createElement("div",{className:h()("service-message",{"message-highlighted":i}),onAnimationEnd:this.handleAnimationEnd},n&&d.a.createElement(Hs,null),d.a.createElement("div",{className:"service-message-wrapper"},d.a.createElement("div",{className:"service-message-content"},d.a.createElement("div",null,u))),l&&d.a.createElement(Bt.a,{chatId:t,messageId:a,photo:l,style:dc,openMedia:this.openMedia})))}}]),a}(d.a.Component),hc=Object(m.a)(Object(m.d)(),Object(y.d)(),Object(m.c)())(pc),mc=a(387),fc=(a(605),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdateRemoteStickersHint=function(e){var t=e.hint,a=n.state.hint;if(!a||t.timestamp===a.timestamp){n.setState({hint:mo.a.hint,items:n.getItems(mo.a.hint)});var r=R.a.getStore(),i=t.stickers;Object(N.E)(r,i.stickers)}},n.onClientUpdateLocalStickersHint=function(e){var t=e.hint;if(n.setState({hint:t,items:n.getItems(t),previewStickerId:0,showPreview:!1,cancelSend:!1}),t){var a=R.a.getStore(),r=t.stickers;Object(N.E)(a,r.stickers)}},n.handleSend=function(e){n.state.cancelSend||e&&$.a.clientUpdate({"@type":"clientUpdateStickerSend",sticker:e})},n.loadPreviewContent=function(e){var t=n.state.items,a=t.find((function(t){return t.sticker.id===e}));if(a){var r=R.a.getStore();Object(N.B)(r,a,null);var i=8;n.hintsRef&&n.hintsRef.current&&(i=Math.floor(n.hintsRef.current.clientWidth/v.kb)),n.getNeighborStickers(e,t,i).forEach((function(e){Object(N.B)(r,e,null)}))}},n.getNeighborStickers=function(e,t,a){if(!t)return[];var n=[],r=t.findIndex((function(t){return t.sticker.id===e}));if(-1===r)return[];var i=Math.floor(r/a),o=r%a,s=i-1,c=i+1,l=o-1,u=o+1;return s>=0&&(l>=0&&n.push(a*s+l),n.push(a*s+o),u<a&&n.push(a*s+u)),l>=0&&n.push(a*i+l),u<a&&n.push(a*i+u),c<Math.ceil(t.length/a)&&(l>=0&&n.push(a*c+l),n.push(a*c+o),u<a&&n.push(a*c+u)),n.map((function(e){return t[e]}))},n.handleMouseEnter=function(e){var t=Number(e.currentTarget.dataset.stickerId),a=n.getSticker(t);a&&n.mouseDown&&(n.mouseDownStickerId!==t&&(n.mouseDownStickerId=null),n.setState({sticker:a}),$.a.clientUpdate({"@type":"clientUpdateStickerPreview",sticker:a}),n.loadPreviewContent(t))},n.handleMouseDown=function(e){var t=Number(e.currentTarget.dataset.stickerId),a=n.getSticker(t);if(a){n.mouseDownStickerId=t;var r=Date.now();return n.setState({sticker:a,timestamp:r,showPreview:!1,cancelSend:!1}),setTimeout((function(){n.state.timestamp===r&&(n.setState({showPreview:!0,cancelSend:!0}),$.a.clientUpdate({"@type":"clientUpdateStickerPreview",sticker:a}))}),500),n.loadPreviewContent(t),n.mouseDown=!0,document.addEventListener("mouseup",n.handleMouseUp),e.preventDefault(),e.stopPropagation(),!1}},n.handleMouseUp=function(){n.setState({sticker:null,timestamp:0,showPreview:!1}),$.a.clientUpdate({"@type":"clientUpdateStickerPreview",sticker:null}),n.mouseDown=!1,document.removeEventListener("mouseup",n.handleMouseUp)},n.getItems=function(e){var t=[];if(!e)return t;var a=new Map,n=e.stickers,r=e.foundStickers;return n&&n.stickers.forEach((function(e){t.push(e),a.set(e.sticker.id,e.sticker.id)})),r&&r.stickers.forEach((function(e){a.has(e.sticker.id)||(t.push(e),a.set(e.sticker.id,e.sticker.id))})),t},n.hintsRef=d.a.createRef(),n.state={hint:null,items:[],previewStickerId:0,showPreview:!1,cancelSend:!1},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){mo.a.on("clientUpdateLocalStickersHint",this.onClientUpdateLocalStickersHint),mo.a.on("clientUpdateRemoteStickersHint",this.onClientUpdateRemoteStickersHint)}},{key:"componentWillUnmount",value:function(){mo.a.off("clientUpdateLocalStickersHint",this.onClientUpdateLocalStickersHint),mo.a.off("clientUpdateRemoteStickersHint",this.onClientUpdateRemoteStickersHint)}},{key:"getSticker",value:function(e){var t=this.state.items,a=t.findIndex((function(t){return t.sticker.id===e}));return-1!==a?t[a]:null}},{key:"render",value:function(){var e=this,t=this.state,a=t.hint,n=t.items,r=t.sticker,i=t.showPreview;if(!a)return null;if(!n)return null;if(!n.length)return null;var o=n.map((function(t){return d.a.createElement("div",{className:"sticker-set-dialog-item",key:t.sticker.id,"data-sticker-id":t.sticker.id,style:{width:v.kb,height:v.kb},onClick:function(){return e.handleSend(t)},onMouseEnter:e.handleMouseEnter,onMouseDown:e.handleMouseDown},d.a.createElement(Ks.b,{key:t.sticker.id,className:"sticker-set-dialog-item-sticker",sticker:t,autoplay:!1,blur:!1,displaySize:v.mb,preview:!0,source:Ks.a.HINTS}))}));return d.a.createElement("div",{ref:this.hintsRef,className:"stickers-hint"},o,Boolean(r)&&i&&d.a.createElement(mc.a,{sticker:r}))}}]),a}(d.a.Component)),gc=(a(606),Object.freeze({SCROLL_TO_BOTTOM:"SCROLL_TO_BOTTOM",SCROLL_TO_UNREAD:"SCROLL_TO_UNREAD",SCROLL_TO_MESSAGE:"SCROLL_TO_MESSAGE",KEEP_SCROLL_POSITION:"KEEP_SCROLL_POSITION",NONE:"NONE"})),vc=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onKeyDown=function(e){},n.onClientUpdateTryEditMessage=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,i,o,s,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.completed){e.next=11;break}a=n.state.history,i=a.length-1;case 3:if(!(i>=0)){e.next=11;break}if(o=a[i],!Object(wt.c)(o.chat_id,o.id)){e.next=8;break}return Object(Q.d)(o.chat_id,o.id),e.abrupt("return");case 8:i--,e.next=3;break;case 11:return e.next=13,$.a.send({"@type":"searchChatMessages",chat_id:n.props.chatId,query:"",sender_user_id:T.a.getMyId(),from_message_id:0,offset:0,limit:100,filter:{"@type":"searchMessagesFilterEmpty"}});case 13:s=e.sent,c=0;case 15:if(!(c<s.messages.length)){e.next=23;break}if(l=s.messages[c],!Object(wt.c)(l.chat_id,l.id)){e.next=20;break}return Object(Q.d)(l.chat_id,l.id),e.abrupt("return");case 20:c++,e.next=15;break;case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onClientUpdateDialogsReady=function(){var e=Object(i.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.a.initDB(Object(i.a)(r.a.mark((function e(){var t,a,i,o,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props,a=t.chatId,i=t.messageId,!a){e.next=18;break}if(!(o=D.a.get(a))){e.next=18;break}s=o.type,e.t0=s["@type"],e.next="chatTypePrivate"===e.t0||"chatTypeSecret"===e.t0?8:"chatTypeBasicGroup"===e.t0?11:"chatTypeSupergroup"===e.t0?14:17;break;case 8:return e.next=10,$.a.send({"@type":"createPrivateChat",user_id:s.user_id,force:!1});case 10:return e.abrupt("break",17);case 11:return e.next=13,$.a.send({"@type":"createBasicGroupChat",basic_group_id:s.basic_group_id,force:!1});case 13:return e.abrupt("break",17);case 14:return e.next=16,$.a.send({"@type":"createSupergroupChat",supergroup_id:s.supergroup_id,force:!1});case 16:return e.abrupt("break",17);case 17:n.handleSelectChat(a,0,i,0);case 18:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onClientUpdateFocusWindow=function(e){e.focused&&(n.defferedActions.forEach((function(e){return e()})),n.defferedActions=[])},n.onClientUpdateOpenReply=function(e){var t=e.chatId,a=e.messageId,r=n.state.replyHistory;if(n.props.chatId===t){var i=r.length>0?r[r.length-1]:null;i&&i.chatId===t&&i.messageId===a||r.push({chatId:t,messageId:a})}},n.onClientUpdateMediaActive=function(e){var t=n.listRef.current,a=t.offsetHeight,r=t.scrollTop;n.setState({playerOpened:!0},(function(){t.scrollTop===r&&(t.scrollTop+=Math.abs(a-t.offsetHeight))}))},n.onClientUpdateMediaEnding=function(e){var t=n.listRef.current;n.prevOffsetHeight=t.offsetHeight,n.prevScrollTop=t.scrollTop},n.onClientUpdateMediaEnd=function(e){var t=n.listRef.current;n.setState({playerOpened:!1},(function(){t.scrollTop===n.prevScrollTop&&(t.scrollTop-=Math.abs(n.prevOffsetHeight-t.offsetHeight))}))},n.onClientUpdateSelection=function(e){n.setState({selectionActive:X.a.selectedItems.size>0})},n.onClientUpdateClearHistory=function(e){n.props.chatId===e.chatId&&n.setState({clearHistory:e.inProgress})},n.onUpdateMessageContent=function(e){var t=n.props.chatId,a=n.state.history,r=e.chat_id,i=e.message_id;if(t===r&&-1!==a.findIndex((function(e){return e.id===i}))){var o=X.a.get(r,i);if(!o)return;var s=R.a.getStore();Object(N.y)(s,[o])}},n.onUpdateChatLastMessage=function(e){n.props.chatId;e.chat_id},n.onUpdateMessageSendSucceeded=function(e){if(n.completed){var t=e.message,a=e.old_message_id;if(n.props.chatId===t.chat_id){var r=t.is_outgoing?gc.SCROLL_TO_BOTTOM:gc.KEEP_SCROLL_POSITION;n.replaceMessage(a,t,(function(){r!==gc.KEEP_SCROLL_POSITION&&n.handleScrollBehavior(r,n.snapshot)}));var i=R.a.getStore();Object(N.y)(i,[t]),n.viewMessages([t])}}},n.onUpdateNewMessage=function(e){if(n.completed){var t=e.message;if(n.props.chatId===t.chat_id)if(0!==t.date){var a=n.listRef.current,r=t.is_outgoing?gc.SCROLL_TO_BOTTOM:gc.NONE;a.scrollTop+a.offsetHeight>=a.scrollHeight&&(r=gc.SCROLL_TO_BOTTOM);var i=t.is_outgoing?{scrollDownVisible:!1}:{},o=[t];n.scrollBehaviorNone=!0,n.insertPrevious(Object(wt.g)(o),i,(function(){n.scrollBehaviorNone=!1,n.handleScrollBehavior(r,n.snapshot)}));var s=R.a.getStore();Object(N.y)(s,o),n.viewMessages(o)}}},n.onUpdateDeleteMessages=function(e){var t=n.props.chatId,a=e.chat_id,r=e.is_permanent,i=e.message_ids;t===a&&r&&n.deleteHistory(i)},n.updateItemsInView=function(){if(n.messages){for(var e=new Map,t=Object(We.v)(n.listRef,n.itemsRef),a=0;a<t.length;a++){var r=n.messages[t[a]];if(r){var i=r.props,o=i.chatId,s=i.messageId,c="".concat(o,"_").concat(s);e.set(c,c)}}$.a.clientUpdate({"@type":"clientUpdateMessagesInView",messages:e})}},n.loadIncompleteHistory=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,i,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=5,i=t&&t.messages.length>0&&t.messages.length<v.s,o=0;case 3:if(!(o<a&&i)){e.next=11;break}return e.next=6,n.onLoadNext();case 6:t=e.sent,i=t&&t.messages.length>0&&t.messages.length<v.s;case 8:o++,e.next=3;break;case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onLoadNext=Object(i.a)(r.a.mark((function e(){var t,a,i,o,s,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props.chatId,a=n.state.history,t){e.next=4;break}return e.abrupt("return");case 4:if(!n.loading){e.next=6;break}return e.abrupt("return");case 6:if(!n.loadMigratedHistory){e.next=9;break}return n.onLoadMigratedHistory(),e.abrupt("return");case 9:return i=a&&a.length>0?a[0].id:0,n.loading=!0,o=n.sessionId,e.next=14,$.a.send({"@type":"getChatHistory",chat_id:t,from_message_id:i,offset:0,limit:v.s}).finally((function(){n.loading=!1}));case 14:if(s=e.sent,o===n.sessionId){e.next=17;break}return e.abrupt("return");case 17:if(n.props.chatId===t){e.next=19;break}return e.abrupt("return");case 19:return X.a.setItems(s.messages),s.messages.reverse(),n.insertNext(Object(wt.g)(s.messages),(function(){s.messages.length||n.onLoadMigratedHistory()})),c=R.a.getStore(),Object(N.y)(c,s.messages),n.viewMessages(s.messages),e.abrupt("return",s);case 26:case"end":return e.stop()}}),e)}))),n.onLoadMigratedHistory=Object(i.a)(r.a.mark((function e(){var t,a,i,o,s,c,l,u,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props.chatId,a=n.state.history,t){e.next=4;break}return e.abrupt("return");case 4:if(!n.loading){e.next=6;break}return e.abrupt("return");case 6:if(i=Object(x.E)(t)){e.next=9;break}return e.abrupt("return");case 9:if(o=xe.a.getFullInfo(i)){e.next=12;break}return e.abrupt("return");case 12:if(o.upgraded_from_basic_group_id){e.next=14;break}return e.abrupt("return");case 14:return n.loadMigratedHistory=!0,e.next=17,$.a.send({"@type":"createBasicGroupChat",basic_group_id:o.upgraded_from_basic_group_id});case 17:if(s=e.sent){e.next=20;break}return e.abrupt("return");case 20:return c=a.length>0&&a[0].chat_id===s.id?a[0].id:0,n.loading=!0,l=n.sessionId,e.next=25,$.a.send({"@type":"getChatHistory",chat_id:s.id,from_message_id:c,offset:0,limit:v.s}).finally((function(){n.loading=!1}));case 25:if(u=e.sent,l===n.sessionId){e.next=28;break}return e.abrupt("return");case 28:if(n.props.chatId===t){e.next=30;break}return e.abrupt("return");case 30:X.a.setItems(u.messages),u.messages.reverse(),n.insertNext(Object(wt.g)(u.messages)),d=R.a.getStore(),Object(N.y)(d,u.messages),n.viewMessages(u.messages);case 36:case"end":return e.stop()}}),e)}))),n.onLoadPrevious=Object(i.a)(r.a.mark((function e(){var t,a,i,o,s,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props.chatId,a=n.state.history,i=D.a.get(t)){e.next=5;break}return e.abrupt("return");case 5:if(!n.loading){e.next=7;break}return e.abrupt("return");case 7:if(!n.completed){e.next=9;break}return e.abrupt("return");case 9:return o=a&&a.length>0?a[a.length-1].id:0,n.loading=!0,s=n.sessionId,e.next=14,$.a.send({"@type":"getChatHistory",chat_id:t,from_message_id:o,offset:-v.s-1,limit:v.s+1}).finally((function(){n.loading=!1}));case 14:if(c=e.sent,s===n.sessionId){e.next=17;break}return e.abrupt("return");case 17:if(n.props.chatId===t){e.next=19;break}return e.abrupt("return");case 19:return i.last_message?n.completed=c.messages.length>0&&i.last_message.id===c.messages[0].id:n.completed=!0,Object(wt.f)(c,n.state.history),X.a.setItems(c.messages),c.messages.reverse(),n.scrollBehaviorNone=!0,n.insertPrevious(Object(wt.g)(c.messages),{},(function(){n.scrollBehaviorNone=!1})),l=R.a.getStore(),Object(N.y)(l,c.messages),n.viewMessages(c.messages),e.abrupt("return",c);case 29:case"end":return e.stop()}}),e)}))),n.handleScroll=function(){var e=n.state,t=e.scrollDownVisible,a=e.replyHistory,r=e.history,i=n.listRef.current;n.updateItemsInView(),i.scrollTop<=v.gb?n.onLoadNext():i.scrollTop+i.offsetHeight>=i.scrollHeight-v.gb&&n.onLoadPrevious(),i.scrollTop+i.offsetHeight>=i.scrollHeight-v.gb?n.completed&&t&&(n.prevScrollTop!==i.scrollTop&&n.prevScrollTop&&n.prevHistory===r?n.setState({scrollDownVisible:!1,replyHistory:[]}):a.length||n.setState({scrollDownVisible:!1})):t||n.setState({scrollDownVisible:!0}),n.prevScrollTop=i.scrollTop,n.prevHistory=r},n.handleScrollBehavior=function(e,t){var a=n.props,r=(a.chatId,a.messageId,t||{scrollTop:0,scrollHeight:0,offsetHeight:0});r.scrollTop,r.scrollHeight,r.offsetHeight;switch(e){case gc.SCROLL_TO_BOTTOM:n.scrollToBottom();break;case gc.SCROLL_TO_MESSAGE:n.scrollToMessage();break;case gc.SCROLL_TO_UNREAD:n.scrollToUnread();break;case gc.KEEP_SCROLL_POSITION:n.keepScrollPosition(t);break;case gc.NONE:}},n.keepScrollPosition=function(e){var t=e.scrollTop,a=e.scrollHeight,r=(e.offsetHeight,n.listRef.current);r.scrollTop=t+(r.scrollHeight-a)},n.scrollToUnread=function(){for(var e=n.props,t=e.chatId,a=(e.messageId,n.state.history),r=n.listRef.current,i=(D.a.get(t),!1),o=0;o<a.length;o++){var s=n.itemsMap.get(o),c=vs.findDOMNode(s);if(c&&s.props.showUnreadSeparator){r.scrollTop=c.offsetTop-0,i=!0;break}}i||n.scrollToBottom()},n.scrollToMessage=function(){for(var e=n.props,t=(e.chatId,e.messageId),a=n.state.history,r=n.listRef.current,i=0;i<a.length;i++){var o=n.itemsMap.get(i),s=vs.findDOMNode(o);if(s&&o.props.messageId===t){r.scrollTop=s.offsetTop-r.offsetHeight/2,!0;break}}},n.scrollToBottom=function(){var e=n.props,t=(e.chatId,e.messageId,n.listRef.current);t.scrollHeight-t.offsetHeight!==t.scrollTop&&(t.scrollTop=t.scrollHeight-t.offsetHeight)},n.scrollToStart=Object(i.a)(r.a.mark((function e(){var t,a,i,o,s,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props.chatId,a=D.a.get(t)){e.next=4;break}return e.abrupt("return");case 4:return n.sessionId=Date.now(),n.loading=!1,n.completed=!1,0,0,i=v.s,n.loading=!0,o=n.sessionId,e.next=14,$.a.send({"@type":"getChatHistory",chat_id:a.id,from_message_id:0,offset:0,limit:i}).finally((function(){n.loading=!1}));case 14:if(s=e.sent,o===n.sessionId){e.next=17;break}return e.abrupt("return");case 17:if(n.props.chatId===t){e.next=19;break}return e.abrupt("return");case 19:a.last_message?n.completed=s.messages.length>0&&a.last_message.id===s.messages[0].id:n.completed=!0,n.setState({scrollDownVisible:!1,replyHistory:[]}),X.a.setItems(s.messages),s.messages.reverse(),n.replace(n.state.separatorMessageId,s.messages,(function(){n.handleScrollBehavior(gc.SCROLL_TO_BOTTOM,n.snapshot)})),c=R.a.getStore(),Object(N.y)(c,s.messages),n.viewMessages(s.messages),n.loadIncompleteHistory(s);case 28:case"end":return e.stop()}}),e)}))),n.handleListDragEnter=function(e){e.preventDefault(),e.stopPropagation();var t=n.props.chatId;Object(x.d)(t)&&$.a.clientUpdate({"@type":"clientUpdateDragging",dragging:!0,files:e.dataTransfer.files})},n.handleScrollDownClick=function(e){var t=n.state.replyHistory;if(t.length>0){var a=t.pop();if(a){var r=a.chatId,i=a.messageId;r===n.props.chatId&&Object(Q.i)(r,i)}}else n.scrollToStart()},n.sessionId=Date.now(),n.state={prevChatId:0,prevMessageId:null,playerOpened:!1,history:[],clearHistory:!1,selectionActive:!1,separatorMessageId:0,scrollDownVisible:!1,replyHistory:[]},n.listRef=d.a.createRef(),n.itemsRef=d.a.createRef(),n.scrollDownButtonRef=d.a.createRef(),n.defferedActions=[],n.itemsMap=new Map,n.updateItemsInView=Object(We.z)(n.updateItemsInView,500),n}return Object(s.a)(a,[{key:"getSnapshotBeforeUpdate",value:function(e,t){var a=this.listRef.current,n={scrollTop:a.scrollTop,scrollHeight:a.scrollHeight,offsetHeight:a.offsetHeight};return this.snapshot=n,n}},{key:"componentDidUpdate",value:function(e,t,a){var n=this.props,r=n.chatId,i=n.messageId;this.state.scrollDownVisible,this.listRef.current;e.chatId!==r||e.messageId!==i?this.handleSelectChat(r,e.chatId,i,e.messageId):this.scrollBehaviorNone||this.handleScrollBehavior(gc.KEEP_SCROLL_POSITION,a)}},{key:"shouldComponentUpdate",value:function(e,t){var a=this.props,n=a.chatId,r=a.messageId,i=a.theme,o=this.state,s=o.playerOpened,c=o.history,l=o.dragging,u=o.clearHistory,d=o.selectionActive,p=o.scrollDownVisible;return e.theme!==i||(e.chatId!==n||(e.messageId!==r||(t.scrollDownVisible!==p||(t.playerOpened!==s||(!Object(We.o)(t.history,c)||(t.dragging!==l||(t.clearHistory!==u||t.selectionActive!==d)))))))}},{key:"componentDidMount",value:function(){lt.a.on("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),lt.a.on("clientUpdateDialogsReady",this.onClientUpdateDialogsReady),D.a.on("clientUpdateClearHistory",this.onClientUpdateClearHistory),D.a.on("updateChatLastMessage",this.onUpdateChatLastMessage),X.a.on("clientUpdateClearSelection",this.onClientUpdateSelection),X.a.on("clientUpdateMessageSelected",this.onClientUpdateSelection),X.a.on("clientUpdateOpenReply",this.onClientUpdateOpenReply),X.a.on("clientUpdateTryEditMessage",this.onClientUpdateTryEditMessage),X.a.on("updateNewMessage",this.onUpdateNewMessage),X.a.on("updateDeleteMessages",this.onUpdateDeleteMessages),X.a.on("updateMessageContent",this.onUpdateMessageContent),X.a.on("updateMessageSendSucceeded",this.onUpdateMessageSendSucceeded),is.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),is.b.on("clientUpdateMediaEnding",this.onClientUpdateMediaEnding),is.b.on("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}},{key:"componentWillUnmount",value:function(){lt.a.off("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),lt.a.off("clientUpdateDialogsReady",this.onClientUpdateDialogsReady),D.a.off("clientUpdateClearHistory",this.onClientUpdateClearHistory),D.a.off("updateChatLastMessage",this.onUpdateChatLastMessage),X.a.off("clientUpdateClearSelection",this.onClientUpdateSelection),X.a.off("clientUpdateMessageSelected",this.onClientUpdateSelection),X.a.off("clientUpdateOpenReply",this.onClientUpdateOpenReply),X.a.off("clientUpdateTryEditMessage",this.onClientUpdateTryEditMessage),X.a.off("updateNewMessage",this.onUpdateNewMessage),X.a.off("updateDeleteMessages",this.onUpdateDeleteMessages),X.a.off("updateMessageContent",this.onUpdateMessageContent),X.a.off("updateMessageSendSucceeded",this.onUpdateMessageSendSucceeded),is.b.off("clientUpdateMediaActive",this.onClientUpdateMediaActive),is.b.off("clientUpdateMediaEnding",this.onClientUpdateMediaEnding),is.b.off("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}},{key:"handleSelectChat",value:function(){var e=Object(i.a)(r.a.mark((function e(t,a,n,i){var o,s,c,l,u,d,p,h,m,f,g,b,C,y=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=D.a.get(t),s=D.a.get(a),this.sessionId=Date.now(),this.loading=!1,this.completed=!1,this.loadMigratedHistory=!1,this.defferedActions=[],!o||1111!=t){e.next=12;break}return this.loading=!0,this.replace(0,[],(function(){y.loading=!1})),s&&a!==t&&$.a.send({"@type":"closeChat",chat_id:a}),e.abrupt("return");case 12:if(!o){e.next=56;break}return $.a.send({"@type":"openChat",chat_id:o.id}),c=!n&&o.unread_count>0,l=c&&o.unread_count>1?o.last_read_inbox_message_id:n||0,u=c&&o.unread_count>1||n?-1-v.s:0,d=c&&o.unread_count>1||n?2*v.s:v.s,this.loading=!0,p=this.sessionId,e.next=22,$.a.send({"@type":"getChatHistory",chat_id:o.id,from_message_id:l,offset:u,limit:d}).finally((function(){y.loading=!1}));case 22:if(h=e.sent,p===this.sessionId){e.next=25;break}return e.abrupt("return");case 25:if(o.last_message?this.completed=h.messages.length>0&&o.last_message.id===h.messages[0].id:this.completed=!0,X.a.setItems(h.messages),h.messages.reverse(),m=this.state.separatorMessageId,t===a){e.next=44;break}if(m=Number.MAX_VALUE,!(o&&o.unread_count>1)){e.next=43;break}f=h.messages.length-1;case 33:if(!(f>=0)){e.next=43;break}if(g=h.messages[f].id,!(!h.messages[f].is_outgoing&&g>o.last_read_inbox_message_id&&g<m)){e.next=39;break}m=g,e.next=40;break;case 39:return e.abrupt("break",43);case 40:f--,e.next=33;break;case 43:m=m===Number.MAX_VALUE?0:m;case 44:b=gc.SCROLL_TO_BOTTOM,n?b=gc.SCROLL_TO_MESSAGE:c&&m&&(b=gc.SCROLL_TO_UNREAD),this.replace(m,h.messages,(function(){y.handleScrollBehavior(b,y.snapshot),n&&Object(Q.g)(t,n)})),C=R.a.getStore(),Object(N.y)(C,h.messages),this.viewMessages(h.messages),Object(N.u)(C,[t]),Object(N.v)(C,t),this.loadIncompleteHistory(h),Object(x.m)(o.id),e.next=58;break;case 56:this.loading=!0,this.replace(0,[],(function(){y.loading=!1}));case 58:s&&a!==t&&$.a.send({"@type":"closeChat",chat_id:a});case 59:case"end":return e.stop()}}),e,this)})));return function(t,a,n,r){return e.apply(this,arguments)}}()},{key:"viewMessages",value:function(e){if(e&&0!==e.length&&e[0].chat_id){var t=function(){$.a.send({"@type":"viewMessages",chat_id:e[0].chat_id,message_ids:e.map((function(e){return e.id}))})};window.hasFocus?t():this.defferedActions.push(t)}}},{key:"cancelLoadMessageContents",value:function(e){for(var t=e.length-1;t>=0;t--){var a=e[t];if(a&&a.content)switch(a.content["@type"]){case"messagePhoto":var n=this.getMessagePhoto(a),r=Object(C.a)(n,2),i=r[0];if(r[1])Object(We.k)(a.content.photo.sizes).blob||R.a.cancelGetRemoteFile(i,a);break;case"messageSticker":var o=this.getMessageSticker(a),s=Object(C.a)(o,2),c=s[0];if(s[1])a.content.sticker.sticker.blob||R.a.cancelGetRemoteFile(c,a)}}}},{key:"replace",value:function(e,t,a){this.setState({separatorMessageId:e,history:t},a)}},{key:"replaceMessage",value:function(e,t,a){t?this.setState({history:this.state.history.filter((function(t){return t.id!==e})).concat([t])},a):a&&a()}},{key:"insertNext",value:function(e,t){0!==e.length?this.setState({history:e.concat(this.state.history)},t):t&&t()}},{key:"insertPrevious",value:function(e,t,a){0!==e.length?this.setState(Object(Ge.a)({history:this.state.history.concat(e)},t),a):a&&a()}},{key:"deleteHistory",value:function(e,t){var a=this.state.history;if(0!==a.length){var n=new Map(e.map((function(e){return[e,e]})));this.setState({history:a.filter((function(e){return!n.has(e.id)}))},t)}else t&&t()}},{key:"showMessageTitle",value:function(e,t,a){if(!e)return!1;var n=e.chat_id,r=e.date,i=e.sender_user_id;e.content;return!!a||(!!Object(x.J)(n)||t&&(Object(uc.b)(t)||i!==t.sender_user_id||r-t.date>v.t))}},{key:"showMessageDate",value:function(e,t,a){if(a)return!0;var n=new Date(1e3*e.date),r=t?new Date(1e3*t.date):n;return n.getFullYear()!==r.getFullYear()||n.getMonth()!==r.getMonth()||n.getDate()!==r.getDate()}},{key:"render",value:function(){var e=this,t=this.props.chatId,a=this.state,n=a.history,r=a.separatorMessageId,i=a.clearHistory,o=a.selectionActive,s=a.scrollDownVisible;return this.itemsMap.clear(),this.messages=i?null:n.map((function(t,a){var i=a>0?n[a-1]:null,o=a<n.length-1?n[a+1]:null,s=e.showMessageDate(t,i,0===a),c=null;if(Object(uc.b)(t))c=d.a.createElement(hc,{key:"chat_id=".concat(t.chat_id," message_id=").concat(t.id),ref:function(t){return e.itemsMap.set(a,t)},chatId:t.chat_id,messageId:t.id,showUnreadSeparator:r===t.id});else{var l=e.showMessageTitle(t,i,0===a),u=e.showMessageTitle(o,t,!1),p=!o||Object(uc.b)(o)||u;c=d.a.createElement(rc,{key:"chat_id=".concat(t.chat_id," message_id=").concat(t.id),ref:function(t){return e.itemsMap.set(a,t)},chatId:t.chat_id,messageId:t.id,sendingState:t.sending_state,showTitle:l,showTail:p,showUnreadSeparator:r===t.id,showDate:s})}return c})),d.a.createElement("div",{className:h()("messages-list",{"messages-list-selection-active":o}),onDragEnter:this.handleListDragEnter},d.a.createElement("div",{ref:this.listRef,className:"messages-list-wrapper",onScroll:this.handleScroll},d.a.createElement("div",{className:"messages-list-top"}),d.a.createElement("div",{ref:this.itemsRef,className:"messages-list-items"},this.messages)),d.a.createElement(Ss,{chatId:t}),d.a.createElement(oc,null),s&&d.a.createElement(lc,{ref:this.scrollDownButtonRef,onClick:this.handleScrollDownClick}),d.a.createElement(ws,null),d.a.createElement(fc,null))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.chatId!==t.prevChatId||e.messageId!==t.prevMessageId?{prevChatId:e.chatId,prevMessageId:e.messageId,clearHistory:!1,selectionActive:!1,separatorMessageId:e.chatId!==t.prevChatId?0:t.separatorMessageId,scrollDownVisible:e.chatId===t.prevChatId&&(t.scrollDownVisible||t.replyHistory.length>0),replyHistory:e.chatId!==t.prevChatId?[]:t.replyHistory}:null}}]),a}(d.a.Component),bc=a(607),Cc=a.n(bc),yc=a(608),kc=a.n(yc),Ec=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={anchorEl:null},e.handleMenuClick=function(t){e.handleOpen(t.currentTarget)},e.handleOpen=function(t){e.setState({anchorEl:t})},e.handleClose=function(){e.setState({anchorEl:null})},e.handleCopyLink=function(){e.handleClose();var t=e.props.t,a=e.getStickersLink(mo.a.stickerSet);a&&(z(a),e.handleScheduledAction(t("LinkCopied")))},e.getStickersLink=function(e){if(!e)return"";var t=e.name;if(!t)return"";var a=G.a.get("t_me_url");return(a?a.value:"https://telegram.org/")+"addstickers/"+t},e.handleScheduledAction=function(t){var a=e.props,n=a.enqueueSnackbar,r=a.closeSnackbar,i=n(t,{autoHideDuration:v.x,preventDuplicate:!0,action:[d.a.createElement(E.a,{key:"close","aria-label":"Close",color:"inherit",className:"notification-close-button",onClick:function(){return r(i)}},d.a.createElement(w.a,null))]})},e.handleShare=function(){e.handleClose();var t=e.getStickersLink(mo.a.stickerSet);if(t){$.a.clientUpdate({"@type":"clientUpdateStickerSet",stickerSet:null});var a={"@type":"inputMessageText",text:{"@type":"formattedText",text:t,entities:null},disable_web_page_preview:!1,clear_draft:!1};Object(Q.e)(a)}},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.t,a=e.className,n=this.state.anchorEl;return d.a.createElement(d.a.Fragment,null,d.a.createElement(E.a,{className:a,"aria-label":"Share",open:Boolean(n),onClick:this.handleMenuClick},d.a.createElement(_n,null)),d.a.createElement(un.a,{id:"attach-menu",anchorEl:n,open:Boolean(n),getContentAnchorEl:null,disableAutoFocusItem:!0,disableRestoreFocus:!0,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},onClose:this.handleClose},d.a.createElement(Et.a,{onClick:this.handleCopyLink},d.a.createElement(be.a,null,d.a.createElement(Cc.a,null)),d.a.createElement(Ce.a,{primary:t("CopyLink")})),d.a.createElement(Et.a,{onClick:this.handleShare},d.a.createElement(be.a,null,d.a.createElement(kc.a,null)),d.a.createElement(Ce.a,{primary:t("StickersShare")}))))}}]),a}(d.a.Component),Sc=Object(m.a)(Object(y.d)(),g.withSnackbar)(Ec),Oc=(a(609),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleUpdateInstalledStickerSets=function(e){var t=mo.a.stickerSet;n.setState({stickerSet:t})},n.handleClientUpdateStickerSet=function(e){var t=e.stickerSet;if(n.setState({stickerSet:t}),t){var a=R.a.getStore();Object(N.C)(a,t)}},n.handleClose=function(){$.a.clientUpdate({"@type":"clientUpdateStickerSet",stickerSet:null})},n.handleDone=function(){var e=n.state.stickerSet;if(e){var t=e.is_installed;$.a.send({"@type":"changeStickerSet",set_id:e.id,is_installed:!t}),n.handleClose()}},n.loadPreviewContent=function(e){var t=n.state.stickerSet.stickers.find((function(t){return t.sticker.id===e}));if(t){var a=R.a.getStore();Object(N.B)(a,t,null),n.getNeighborStickers(e).forEach((function(e){Object(N.B)(a,e,null)}))}},n.getNeighborStickers=function(e){var t=n.state.stickerSet;if(!t)return[];var a=t.stickers;if(!a)return[];var r=[],i=a.findIndex((function(t){return t.sticker.id===e}));if(-1===i)return[];var o=Math.floor(i/4),s=i%4,c=o-1,l=o+1,u=s-1,d=s+1;return c>=0&&(u>=0&&r.push(4*c+u),r.push(4*c+s),d<4&&r.push(4*c+d)),u>=0&&r.push(4*o+u),d<4&&r.push(4*o+d),l<Math.ceil(a.length/4)&&(u>=0&&r.push(4*l+u),r.push(4*l+s),d<4&&r.push(4*l+d)),r.map((function(e){return a[e]}))},n.handleMouseUp=function(){n.setState({sticker:null}),$.a.clientUpdate({"@type":"clientUpdateStickerPreview",sticker:null}),n.mouseDown=!1,document.removeEventListener("mouseup",n.handleMouseUp)},n.handleMouseEnter=function(e){var t=Number(e.currentTarget.dataset.stickerId),a=n.getSticker(t);a&&n.mouseDown&&(n.setState({sticker:a}),$.a.clientUpdate({"@type":"clientUpdateStickerPreview",sticker:a}),n.loadPreviewContent(t))},n.handleMouseDown=function(e){var t=Number(e.currentTarget.dataset.stickerId),a=n.getSticker(t);if(a)return n.setState({sticker:a}),$.a.clientUpdate({"@type":"clientUpdateStickerPreview",sticker:a}),n.loadPreviewContent(t),n.mouseDown=!0,document.addEventListener("mouseup",n.handleMouseUp),e.preventDefault(),e.stopPropagation(),!1},n.state={stickerSet:mo.a.stickerSet,stickerId:0},n}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t,a){var n=this.state,r=n.stickerSet,i=n.sticker;return r!==t.stickerSet||i!==t.sticker}},{key:"componentDidMount",value:function(){mo.a.on("clientUpdateStickerSet",this.handleClientUpdateStickerSet),mo.a.on("updateInstalledStickerSets",this.handleUpdateInstalledStickerSets)}},{key:"componentWillUnmount",value:function(){mo.a.off("clientUpdateStickerSet",this.handleClientUpdateStickerSet),mo.a.off("updateInstalledStickerSets",this.handleUpdateInstalledStickerSets)}},{key:"getSticker",value:function(e){var t=this.state.stickerSet;if(!t)return null;var a=t.stickers,n=a.findIndex((function(t){return t.sticker.id===e}));return-1!==n?a[n]:null}},{key:"render",value:function(){var e=this,t=this.props.t,a=this.state,n=a.stickerSet,r=a.sticker;if(!n)return null;var i=n.title,o=n.stickers,s=n.is_installed,c=o.map((function(t){return d.a.createElement("div",{className:"sticker-set-dialog-item",key:t.sticker.id,"data-sticker-id":t.sticker.id,style:{width:76,height:76},onMouseEnter:e.handleMouseEnter,onMouseDown:e.handleMouseDown},d.a.createElement(Ks.b,{key:t.sticker.id,className:"sticker-set-dialog-item-sticker",sticker:t,autoplay:!1,blur:!1,displaySize:v.mb,preview:!0,source:Ks.a.STICKER_SET}),d.a.createElement("div",{className:"sticker-set-dialog-item-emoji"},t.emoji))}));return d.a.createElement(S.a,{className:"sticker-set-dialog",open:!0,transitionDuration:0,onClose:this.handleClose,"aria-labelledby":"sticker-set-dialog-title-text",classes:{paper:"sticker-set-dialog-paper"}},d.a.createElement(U.a,{id:"sticker-set-dialog-title-text",className:h()({"sticker-set-dialog-disabled":Boolean(r)}),disableTypography:!0},d.a.createElement(Se.a,{variant:"h6",className:"sticker-set-dialog-title-typography",noWrap:!0},i),d.a.createElement(Sc,{className:"sticker-set-dialog-share-button"})),d.a.createElement(xn.a,{classes:{root:"sticker-set-dialog-content-root"},onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut},c),d.a.createElement(O.a,{className:h()({"sticker-set-dialog-disabled":Boolean(r)})},d.a.createElement(k.a,{color:"primary",onClick:this.handleClose},t("Cancel")),d.a.createElement(k.a,{color:"primary",onClick:this.handleDone},t(s?"StickersRemove":"Add"))),d.a.createElement(mc.a,{sticker:r}))}}]),a}(d.a.Component)),Uc=Object(y.d)()(Oc),wc=(a(610),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdateDocumentBlob=function(e){var t=n.state.wallpaper;if(t){var a=t.document;if(a){var r=a.document;if(r){var i=e.fileId;if(r.id===i){if(n.thumbnailTime)if(n.thumbnailTime.wallpaper===t)if(new Date-n.thumbnailTime.time<250)return void setTimeout((function(){n.forceUpdate()}),250);n.forceUpdate()}}}}},n.onClientUpdateDocumentThumbnailBlob=function(e){var t=n.state.wallpaper;if(t){var a=t.document;if(a){var r=a.thumbnail;if(r){var i=r.photo;if(i){var o=e.fileId;i.id===o&&(n.thumbnailTime={wallpaper:t,time:new Date},n.forceUpdate())}}}}},n.onClientUpdateChatBackground=function(e){var t=e.wallpaper;n.thumbnailTime={wallpaper:t,time:new Date},n.setState({wallpaper:t})},n.onUpdateChatDetailsVisibility=function(e){n.forceUpdate()},n.onClientUpdateChatId=function(e){n.setState({chatId:e.nextChatId,messageId:e.nextMessageId})},n.scrollToBottom=function(){n.messagesList.scrollToBottom()},n.scrollToStart=function(){n.messagesList.scrollToStart()},n.scrollToMessage=function(){n.messagesList.scrollToMessage()},n.state={chatId:lt.a.getChatId(),messageId:lt.a.getMessageId(),selectedCount:0,wallpaper:null,wallpaperSrc:null},n}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.state,n=a.chatId,r=a.messageId,i=a.selectedCount,o=a.wallpaper;return t.chatId!==n||(t.messageId!==r||(t.selectedCount!==i||t.wallpaper!==o))}},{key:"componentDidMount",value:function(){lt.a.on("clientUpdateChatDetailsVisibility",this.onUpdateChatDetailsVisibility),lt.a.on("clientUpdateChatId",this.onClientUpdateChatId),D.a.on("clientUpdateChatBackground",this.onClientUpdateChatBackground),R.a.on("clientUpdateDocumentThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob),R.a.on("clientUpdateDocumentBlob",this.onClientUpdateDocumentBlob)}},{key:"componentWillUnmount",value:function(){lt.a.off("clientUpdateChatDetailsVisibility",this.onUpdateChatDetailsVisibility),lt.a.off("clientUpdateChatId",this.onClientUpdateChatId),D.a.off("clientUpdateChatBackground",this.onClientUpdateChatBackground),R.a.off("clientUpdateDocumentThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob),R.a.off("clientUpdateDocumentBlob",this.onClientUpdateDocumentBlob)}},{key:"render",value:function(){var e=this,t=this.state,a=t.chatId,n=t.messageId,r=t.wallpaper,i=null,o=null;if(r){var s=r.document;if(s){var c=s.thumbnail,l=s.document;l&&(o=Object(N.l)(l)),!o&&c&&(o=Object(N.l)(c.photo))}i={backgroundImage:o?"url(".concat(o,")"):null}}return d.a.createElement("div",{className:"dialog-details",style:i},d.a.createElement(ks,null),d.a.createElement(Ho,{chatId:a}),d.a.createElement(vc,{ref:function(t){return e.messagesList=t},chatId:a,messageId:n}),d.a.createElement(wo,{chatId:a}),d.a.createElement(Uc,null),d.a.createElement(Si,null))}}]),a}(u.Component)),Mc=d.a.createContext(null),Ic=Mc;function jc(e){var t=function(t){Object(c.a)(n,t);var a=Object(l.a)(n);function n(){return Object(o.a)(this,n),a.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){var t=this;return d.a.createElement(Mc.Consumer,null,(function(a){return d.a.createElement(e,Object.assign({iv:a},t.props))}))}}]),n}(d.a.Component);return t.displayName="WithIV(".concat(Object(m.b)(e),")"),t}function _c(e){return function(e){if(!e)return null;if(e instanceof String)return e;switch(e["@type"]){case"richTextAnchor":var t=e.name,a=e.text;return d.a.createElement(El,{text:a,name:t});case"richTextBold":var n=e.text;return d.a.createElement(ul,{text:n});case"richTextEmailAddress":var r=e.email_address,i=e.text;return d.a.createElement(dl,{emailAddress:r,text:i});case"richTextFixed":var o=e.text;return d.a.createElement(pl,{text:o});case"richTextIcon":var s=e.document,c=e.height,l=e.width;return d.a.createElement(hl,{document:s,height:c,width:l});case"richTextItalic":var u=e.text;return d.a.createElement(ml,{text:u});case"richTextMarked":var p=e.text;return d.a.createElement(fl,{text:p});case"richTextPhoneNumber":var h=e.phone_number,m=e.text;return d.a.createElement(gl,{phoneNumber:h,text:m});case"richTextPlain":var f=e.text;return d.a.createElement(bl,{text:f});case"richTextStrikethrough":var g=e.text;return d.a.createElement(Cl,{text:g});case"richTextSubscript":var v=e.text;return d.a.createElement(yl,{text:v});case"richTextSuperscript":var b=e.text;return d.a.createElement(kl,{text:b});case"richTexts":var C=e.texts;return d.a.createElement(Sl,{texts:C});case"richTextUnderline":var y=e.text;return d.a.createElement(Ol,{text:y});case"richTextUrl":var k=e.text,E=e.url;return d.a.createElement(Ul,{text:k,url:E})}return"[".concat(e["@type"],"]")}(e.text)}_c.propTypes={text:bt.a.object.isRequired};var xc=_c;var Tc=function(e){return d.a.createElement("a",{id:e.name})};var Lc=function(e){var t=e.text,a=e.credit,n=!Nl(t),r=!Nl(a);return n||r?d.a.createElement("figcaption",null,n&&d.a.createElement(xc,{text:t}),r&&d.a.createElement("cite",null,d.a.createElement(xc,{text:a}))):null};var Pc=function(e){var t=e.animation,a=e.block,n=e.caption,r=(e.need_autoplay,e.openMedia);return d.a.createElement("figure",null,d.a.createElement(Gs.a,{iv:!0,pageBlock:a,animation:t,displaySize:v.i,openMedia:r}),d.a.createElement(Lc,{text:n.text,credit:n.credit}))},Nc=a(366);var Dc=function(e){var t=e.author,a=e.publishDate,n=!Nl(t),r=a>0;if(!n&&!r)return null;var i=a>0?new Date(1e3*a):null;return d.a.createElement("address",null,n&&d.a.createElement("a",{rel:"author"},d.a.createElement(xc,{text:t})),n&&r&&" \u2022 ",r&&d.a.createElement("time",{dateTime:i.toISOString()},Object(Nc.a)(i,"dd mmm, yyyy")))};var Rc=function(e){var t=e.text,a=e.credit;return d.a.createElement("blockquote",null,d.a.createElement(xc,{text:t}),a&&d.a.createElement("cite",null,d.a.createElement(xc,{text:a})))};var Bc=jc((function(e){var t=e.pageBlocks,a=e.caption,n=e.iv;return d.a.createElement("div",{className:"collage"},t.map((function(e,t){return Pl(e,n,t)})),d.a.createElement(Lc,{text:a.text,credit:a.credit}))}));function Ac(e){return Pl(e.cover,e.iv)}Ac.propTypes={cover:bt.a.object.isRequired};var Fc=jc(Ac);var Vc=jc((function(e){var t=e.header,a=e.pageBlocks,n=e.isOpen,r=e.iv;return d.a.createElement("details",{open:n},d.a.createElement("summary",null,d.a.createElement(xc,{text:t})),a.map((function(e,t){return Pl(e,r,t)})))}));var zc=function(){return d.a.createElement("hr",null)},Hc=a(611),Wc=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).updateIframe=function(e){if(!e.src){var t=e.content||e.children;if(t){var a=n.frameRef.current;if(a){var r=a.contentDocument;r&&("string"===typeof t?(r.open(),r.write(t),r.close()):(r.open(),r.write('<div id="iframe-root"></div>'),r.close(),bs.a.render(t,r.getElementById("iframe-root"))))}}}},n.injectIframeResizerUrl=function(){if(n.props.iframeResizerUrl){var e=n.frameRef.current;if(e){var t=e.contentDocument;if(t){var a=null;if(["head","HEAD","body","BODY","div","DIV"].forEach((function(e){if(!a){var n=t.getElementsByTagName(e);n&&n.length&&(a=n[0])}})),a){var r=document.createElement("script");r.type="text/javascript",r.src=n.props.iframeResizerUrl,a.appendChild(r)}else console.error("Unable to inject iframe resizer script")}}}},n.onLoad=function(){n.injectIframeResizerUrl()},n.resizeIframe=function(e){var t=n.frameRef.current;t&&e.iframeResizerEnable&&Object(Hc.iframeResizer)(e.iframeResizerOptions,t)},n.frameRef=d.a.createRef(),n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.updateIframe(this.props),this.resizeIframe(this.props)}},{key:"componentWillUnmount",value:function(){var e=this.frameRef.current;if(e){var t=e.iframeResizer;t&&t.removeListeners()}}},{key:"componentWillReceiveProps",value:function(e){this.updateIframe(e),this.resizeIframe(e)}},{key:"render",value:function(){var e=this.props,t=e.src,a=e.id,n=e.frameBorder,r=e.className,i=e.style;return d.a.createElement("iframe",{ref:this.frameRef,src:t,id:a,frameBorder:n,className:r,style:i,onLoad:this.onLoad})}}]),a}(d.a.Component);Wc.defaultProps={iframeResizerEnable:!0,iframeResizerOptions:{},iframeResizerUrl:"https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/3.5.8/iframeResizer.contentWindow.min.js",frameBorder:0,style:{width:"100%",minHeight:20}};var Gc=Wc,Zc=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.setIframeSource()}},{key:"componentDidUpdate",value:function(e,t,a){var n=this.props,r=n.url,i=n.html;r===e.url&&i===e.html||this.setIframeSource()}},{key:"setIframeSource",value:function(){var e=this.props,t=e.url,a=e.html;this.setState({url:t,html:a})}},{key:"render",value:function(){var e=this.state,t=e.url,a=e.html,n=this.props,r=n.width,i=n.height,o=n.caption,s=n.isFullWidth,c=n.allowScrolling,l={scrolling:c},u=r>0&&i>0,p=Boolean(t)||Boolean(a);return d.a.createElement("figure",null,p&&d.a.createElement(d.a.Fragment,null,u?d.a.createElement("iframe",{src:t||null,srcDoc:t?null:a,width:r>0?r:null,height:i>0?i:null,allowFullScreen:s,scrolling:c?"auto":"no",frameBorder:0}):d.a.createElement(Gc,{content:a,src:t,iframeResizerOptions:l,style:{width:"100%"}})),d.a.createElement(Lc,{text:o.text,credit:o.credit}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.url!==t.prevUrl||e.html!==t.prevHtml?{url:null,html:null,prevUrl:e.url,prevHtml:e.html}:null}}]),a}(d.a.Component);var qc=jc((function(e){e.url;var t=e.author,a=(e.authorPhoto,e.date),n=e.pageBlocks,r=e.caption,i=e.iv;return d.a.createElement("blockquote",null,d.a.createElement("figure",null,Boolean(t)&&d.a.createElement("h3",null,t),d.a.createElement(Dc,{author:null,publishDate:a}),n.map((function(e,t){return Pl(e,i,t)})),d.a.createElement(Lc,{text:r.text,credit:r.credit})))})),Kc=(a(615),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={error:null,errorInfo:null},e}return Object(s.a)(a,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,errorInfo:t})}},{key:"render",value:function(){var e=this.props.children,t=this.state,a=t.error,n=t.errorInfo;return a||n?d.a.createElement("div",{className:"error-handler"},d.a.createElement("span",null,d.a.createElement("pre",null,"".concat(a.name,": ").concat(a.message),n.componentStack))):e}}]),a}(d.a.Component));var Jc=function(e){return d.a.createElement("footer",null,d.a.createElement(xc,{text:e.footer}))};var Yc=function(e){return d.a.createElement("h3",null,d.a.createElement(xc,{text:e.header}))};var Qc=function(e){var t=e.kicker;return d.a.createElement("h6",{className:"kicker"},d.a.createElement(xc,{text:t}))};var Xc=jc((function(e){return d.a.createElement("li",{"data-before":e.label},e.pageBlocks.map((function(t,a){return Pl(t,e.iv,a)})))}));var $c=function(e){return d.a.createElement("ul",null,e.items.map((function(e,t){return d.a.createElement(Xc,{key:t,label:e.label,pageBlocks:e.page_blocks})})))};var el=function(e){return d.a.createElement("p",null,d.a.createElement(xc,{text:e.text}))};var tl=function(e){var t=e.photo,a=e.caption,n=(e.url,e.openMedia);return d.a.createElement("figure",null,d.a.createElement(Bt.a,{photo:t,size:v.j,displaySize:v.i,openMedia:n}),d.a.createElement(Lc,{text:a.text,credit:a.credit}))};var al=function(e){return d.a.createElement("pre",null,d.a.createElement(xc,{text:e.text}))};var nl=function(e){var t=e.text,a=e.credit;return d.a.createElement("aside",null,d.a.createElement(xc,{text:t}),a&&d.a.createElement("cite",null,d.a.createElement(xc,{text:a})))},rl=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleClick=function(t){t.preventDefault(),t.stopPropagation();var a=e.props.url;$.a.clientUpdate({"@type":"clientUpdateInstantViewUrl",url:a})},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.author,a=(e.description,e.publishDate),n=e.title,r=e.url,i=a>0?new Date(1e3*a):null,o=t&&i,s=i||t;return d.a.createElement("li",null,d.a.createElement(At.a,{url:r,onClick:this.handleClick},n),s&&d.a.createElement("address",null,t,o&&" \u2022 ",i&&d.a.createElement("time",{dateTime:i.toISOString()},Object(Nc.a)(i,"dd mmm, yyyy"))))}}]),a}(d.a.Component);var il=function(e){return d.a.createElement(d.a.Fragment,null,d.a.createElement("h4",null,d.a.createElement(xc,{text:e.header})),d.a.createElement("ul",{className:"related-articles"},e.articles.map((function(e){return d.a.createElement(rl,{key:e.url,url:e.url,title:e.title,description:e.description,photo:e.photo,author:e.author,publishDate:e.publish_date})}))))};var ol=jc((function(e){var t=e.pageBlocks,a=e.caption,n=e.iv;return d.a.createElement("div",{className:"slideshow"},t.map((function(e,t){return Pl(e,n,t)})),d.a.createElement(Lc,{text:a.text,credit:a.credit}))}));var sl=function(e){return d.a.createElement("h4",null,d.a.createElement(xc,{text:e.subheader}))};var cl=function(e){return d.a.createElement("h2",null,d.a.createElement(xc,{text:e.subtitle}))};var ll=function(e){return d.a.createElement("h1",null,d.a.createElement(xc,{text:e.title}))};var ul=function(e){return d.a.createElement("b",null,d.a.createElement(xc,{text:e.text}))};var dl=function(e){return d.a.createElement("a",{href:"mailto:".concat(e.emailAddress)},d.a.createElement(xc,{text:e.text}))};var pl=function(e){return d.a.createElement("code",null,d.a.createElement(xc,{text:e.text}))},hl=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).onClientUpdateDocumentThumbnailBlob=function(t){var a=e.props.document;if(a){var n=a.thumbnail;if(n){var r=n.photo;if(r){var i=t.fileId;r.id===i&&e.forceUpdate()}}}},e.onClientUpdateDocumentBlob=function(t){var a=e.props.document;if(a){var n=a.document;if(n){var r=t.fileId;n.id===r&&e.forceUpdate()}}},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){R.a.on("clientUpdateDocumentThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob),R.a.on("clientUpdateDocumentBlob",this.onClientUpdateDocumentBlob)}},{key:"componentWillUnmount",value:function(){R.a.off("clientUpdateDocumentThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob),R.a.off("clientUpdateDocumentBlob",this.onClientUpdateDocumentBlob)}},{key:"emptyPlaceholderSrc",value:function(e,t){return'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 '.concat(e," ").concat(t,'"%3E%3C/svg%3E')}},{key:"render",value:function(){var e=this.props,t=e.document,a=e.height,n=e.width;if(!t)return null;var r=t.thumbnail,i=t.document,o=Object(N.l)(r?r.photo:null),s=Object(N.l)(i);return d.a.createElement("img",{src:s||o||this.emptyPlaceholderSrc(1,1),width:n>0?n:null,height:a>0?a:null,draggable:!1,alt:""})}}]),a}(d.a.Component);var ml=function(e){return d.a.createElement("i",null,d.a.createElement(xc,{text:e.text}))};var fl=function(e){return d.a.createElement("mark",null,d.a.createElement(xc,{text:e.text}))};var gl=function(e){return d.a.createElement("a",{href:"tel:".concat(e.phoneNumber)},d.a.createElement(xc,{text:e.text}))};function vl(e){return e.text}vl.propTypes={text:bt.a.string.isRequired};var bl=vl;var Cl=function(e){return d.a.createElement("del",null,d.a.createElement(xc,{text:e.text}))};var yl=function(e){return d.a.createElement("sub",null,d.a.createElement(xc,{text:e.text}))};var kl=function(e){return d.a.createElement("sup",null,d.a.createElement(xc,{text:e.text}))};var El=function(e){return d.a.createElement("a",{id:e.name},d.a.createElement(xc,{text:e.text}))};var Sl=function(e){return d.a.createElement(d.a.Fragment,null,e.texts.map((function(e,t){return d.a.createElement(xc,{key:t,text:e})})))};var Ol=function(e){return d.a.createElement("ins",null,d.a.createElement(xc,{text:e.text}))},Ul=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleClick=function(t){t.preventDefault(),t.stopPropagation();var a=e.props.url;$.a.clientUpdate({"@type":"clientUpdateInstantViewUrl",url:a})},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.text,a=e.url;return d.a.createElement(At.a,{url:a,onClick:this.handleClick},d.a.createElement(xc,{text:t}))}}]),a}(d.a.Component);var wl=jc((function(e){var t=e.caption,a=e.cells,n=e.isBordered,r=e.isStriped,i=e.iv;return d.a.createElement("table",{striped:r?"":null,border:n?1:0},!Nl(t)&&d.a.createElement("caption",null,d.a.createElement(xc,{text:t})),d.a.createElement("tbody",null,a.map((function(e,t){return d.a.createElement("tr",{key:t},e.map((function(e,t){return Pl(e,i,t)})))}))))}));var Ml=function(e){var t=e.text,a=e.isHeader,n=e.colspan,r=e.rowspan,i=e.align,o=e.valign;if(Nl(t))return null;var s={colSpan:n,rowSpan:r,align:Dl(i),valign:Rl(o)},c=d.a.createElement(xc,{text:t});return a?d.a.createElement("th",s,c):d.a.createElement("td",s,c)},Il=a(383);var jl=function(e){var t=e.location,a=e.caption;return d.a.createElement("figure",null,d.a.createElement(Il.a,{width:v.h,height:v.g,location:t}),d.a.createElement(Lc,{text:a.text,credit:a.credit}))};var _l=function(e){var t=e.audio,a=e.caption,n=e.openMedia;return d.a.createElement("figure",null,d.a.createElement(Zs.a,{audio:t,displaySize:v.D,openMedia:n}),d.a.createElement(Lc,{text:a.text,credit:a.credit}))};var xl=function(e){return d.a.createElement("div",null)};var Tl=function(e){var t=e.video,a=e.caption,n=(e.needAutoplay,e.isLooped,e.openMedia);return d.a.createElement("figure",null,d.a.createElement(Js.a,{video:t,displaySize:v.i,openMedia:n}),d.a.createElement(Lc,{text:a.text,credit:a.credit}))};function Ll(e,t,a,n,r){if(e){switch(e["@type"]){case"animation":var i=e.animation;if(!i)return;if(i=R.a.get(i.id)||i,r&&i.local.is_downloading_active)return void R.a.cancelGetRemoteFile(i.id,e);if(r&&i.remote.is_uploading_active)return void R.a.cancelUploadFile(i.id,e);Object(N.c)(i,e,R.a.updateAnimationBlob(0,0,i.id)),Object(Q.p)({media:e,caption:t,block:a,instantView:n});break;case"audio":var o=e.audio;if(!o)return;if(o=R.a.get(o.id)||o,r&&o.local.is_downloading_active)return void R.a.cancelGetRemoteFile(o.id,e);if(r&&o.remote.is_uploading_active)return void R.a.cancelUploadFile(o.id,e);Object(N.c)(o,e,R.a.updateAudioBlob(0,0,o.id)),$.a.clientUpdate({"@type":"clientUpdateMediaActive",instantView:n,block:a});break;case"photo":Object(Q.p)({media:e,caption:t,block:a,instantView:n});break;case"video":var s=e.video;if(!s)return;if(s=R.a.get(s.id)||s,r&&s.local.is_downloading_active)return void R.a.cancelGetRemoteFile(s.id,e);if(r&&s.remote.is_uploading_active)return void R.a.cancelUploadFile(s.id,e);Object(N.c)(s,e,R.a.updateVideoBlob(0,0,s.id)),Object(Q.p)({media:e,caption:t,block:a,instantView:n})}}}function Pl(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if(!e)return null;var n=null;switch(e["@type"]){case"pageBlockAnchor":n=d.a.createElement(Tc,{name:e.name});break;case"pageBlockAnimation":n=d.a.createElement(Pc,{block:e,caption:e.caption,animation:e.animation,needAutoplay:e.need_autoplay,openMedia:function(){return Ll(e.animation,e.caption,e,t,!0)}});break;case"pageBlockAudio":n=d.a.createElement(_l,{caption:e.caption,audio:e.audio,openMedia:function(){return Ll(e.audio,e.caption,e,t,!0)}});break;case"pageBlockAuthorDate":n=d.a.createElement(Dc,{author:e.author,publishDate:e.publish_date});break;case"pageBlockBlockQuote":n=d.a.createElement(Rc,{credit:e.credit,text:e.text});break;case"pageBlockCollage":n=d.a.createElement(Bc,{pageBlocks:e.page_blocks,caption:e.caption});break;case"pageBlockChatLink":n=d.a.createElement(xl,{title:e.title,photo:e.photo,username:e.username});break;case"pageBlockCover":n=d.a.createElement(Fc,{cover:e.cover});break;case"pageBlockDetails":n=d.a.createElement(Vc,{header:e.header,pageBlocks:e.page_blocks,isOpen:e.is_open});break;case"pageBlockDivider":n=d.a.createElement(zc,null);break;case"pageBlockEmbedded":n=d.a.createElement(Zc,{url:e.url,html:e.html,posterPhoto:e.poster_photo,width:e.width,height:e.height,caption:e.caption,isFullWidth:e.is_full_width,allowScrolling:e.allow_scrolling});break;case"pageBlockEmbeddedPost":n=d.a.createElement(qc,{url:e.url,author:e.author,authorPhoto:e.author_photo,date:e.date,pageBlocks:e.page_blocks,caption:e.caption});break;case"pageBlockFooter":n=d.a.createElement(Jc,{footer:e.footer});break;case"pageBlockHeader":n=d.a.createElement(Yc,{header:e.header});break;case"pageBlockKicker":n=d.a.createElement(Qc,{kicker:e.kicker});break;case"pageBlockList":n=d.a.createElement($c,{items:e.items});break;case"pageBlockListItem":n=d.a.createElement(Xc,{label:e.label,pageBlocks:e.page_blocks});break;case"pageBlockMap":n=d.a.createElement(jl,{location:e.location,zoom:e.zoom,width:e.width,height:e.height,caption:e.caption});break;case"pageBlockParagraph":n=d.a.createElement(el,{text:e.text});break;case"pageBlockPhoto":n=d.a.createElement(tl,{caption:e.caption,photo:e.photo,url:e.url,openMedia:function(){return Ll(e.photo,e.caption,e,t,!0)}});break;case"pageBlockPreformatted":n=d.a.createElement(al,{text:e.text,language:e.language});break;case"pageBlockPullQuote":n=d.a.createElement(nl,{credit:e.credit,text:e.text});break;case"pageBlockRelatedArticle":n=d.a.createElement(rl,{url:e.url,title:e.title,description:e.description,photo:e.photo,author:e.author,publishDate:e.publish_date});break;case"pageBlockRelatedArticles":n=d.a.createElement(il,{header:e.header,articles:e.articles});break;case"pageBlockSlideshow":n=d.a.createElement(ol,{pageBlocks:e.page_blocks,caption:e.caption});break;case"pageBlockSubheader":n=d.a.createElement(sl,{subheader:e.subheader});break;case"pageBlockSubtitle":n=d.a.createElement(cl,{subtitle:e.subtitle});break;case"pageBlockTable":n=d.a.createElement(wl,{caption:e.caption,cells:e.cells,isBordered:e.is_bordered,isStriped:e.is_striped});break;case"pageBlockTableCell":n=d.a.createElement(Ml,{text:e.text,isHeader:e.is_header,colspan:e.colspan,rowspan:e.rowspan,align:e.align,valign:e.valign});break;case"pageBlockTitle":n=d.a.createElement(ll,{title:e.title});break;case"pageBlockVideo":n=d.a.createElement(Tl,{caption:e.caption,video:e.video,needAutoplay:e.need_autoplay,isLooped:e.is_looped,openMedia:function(){return Ll(e.video,e.caption,e,t,!0)}})}return n?d.a.createElement(Kc,{key:a},n):d.a.createElement("div",null,"[".concat(e["@type"],"]"))}function Nl(e){if(!e)return!0;switch(e["@type"]){case"richTextAnchor":return Nl(e.text);case"richTextBold":return Nl(e.text);case"richTextEmailAddress":return Nl(e.text);case"richTextFixed":return Nl(e.text);case"richTextIcon":return!1;case"richTextItalic":return Nl(e.text);case"richTextMarked":return Nl(e.text);case"richTextPhoneNumber":return Nl(e.text);case"richTextPlain":return Nl(e.text);case"richTextStrikethrough":return Nl(e.text);case"richTextSubscript":return Nl(e.text);case"richTextSuperscript":return Nl(e.text);case"richTexts":return e.texts.every(Nl);case"richTextUnderline":return Nl(e.text);case"richTextUrl":return Nl(e.text)}return!1}function Dl(e){if(!e)return null;switch(e["@type"]){case"pageBlockHorizontalAlignmentCenter":return"center";case"pageBlockHorizontalAlignmentLeft":return"left";case"pageBlockHorizontalAlignmentRight":return"right"}return null}function Rl(e){if(!e)return null;switch(e["@type"]){case"pageBlockVerticalAlignmentBottom":return"bottom";case"pageBlockVerticalAlignmentMiddle":return"middle";case"pageBlockVerticalAlignmentTop":return"top"}return null}function Bl(e){if(!e)return[];switch(e["@type"]){case"pageBlockAnchor":return[];case"pageBlockAnimation":case"pageBlockAudio":return[e.caption];case"pageBlockAuthorDate":case"pageBlockBlockQuote":case"pageBlockChatLink":return[];case"pageBlockCollage":var t=e.page_blocks.map((function(e){return[e].concat(Object(Ct.a)(Bl(e)))}));return[].concat.apply([],t);case"pageBlockCover":return[e.cover];case"pageBlockDetails":var a=e.page_blocks.map((function(e){return[e].concat(Object(Ct.a)(Bl(e)))}));return[].concat.apply([],a);case"pageBlockDivider":return[];case"pageBlockEmbedded":return[e.caption];case"pageBlockEmbeddedPost":var n=e.page_blocks.map((function(e){return[e].concat(Object(Ct.a)(Bl(e)))}));return[].concat.apply([e.caption],n);case"pageBlockFooter":case"pageBlockHeader":case"pageBlockKicker":return[];case"pageBlockList":var r=e.items.map((function(e){return[e].concat(Object(Ct.a)(Bl(e)))}));return[].concat.apply([],r);case"pageBlockListItem":var i=e.page_blocks.map((function(e){return[e].concat(Object(Ct.a)(Bl(e)))}));return[].concat.apply([],i);case"pageBlockMap":return[e.caption];case"pageBlockParagraph":return[];case"pageBlockPhoto":return[e.caption];case"pageBlockPreformatted":case"pageBlockPullQuote":case"pageBlockRelatedArticle":return[];case"pageBlockRelatedArticles":return Object(Ct.a)(e.articles);case"pageBlockSlideshow":var o=e.page_blocks.map((function(e){return[e].concat(Object(Ct.a)(Bl(e)))}));return[].concat.apply([e.caption],o);case"pageBlockSubheader":case"pageBlockSubtitle":return[];case"pageBlockTable":return Object(Ct.a)(e.cells);case"pageBlockTableCell":case"pageBlockTitle":return[];case"pageBlockVideo":return[e.caption]}return[]}function Al(e){if(!e)return null;switch(e["@type"]){case"pageBlockAnimation":return e.animation;case"pageBlockPhoto":return e.photo;case"pageBlockVideo":return e.video}return null}function Fl(e){if(!e)return!1;switch(e["@type"]){case"pageBlockAnimation":case"pageBlockPhoto":case"pageBlockVideo":return!0}return!1}a(616);var Vl=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.forwardedRef,a=e.iv;if(!a)return null;var n=a.page_blocks,r=a.is_rtl;if(n){var i=n.map((function(e,t){return Pl(e,a,t)}));return d.a.createElement("article",{ref:t,dir:r?"rtl":"ltr"},i)}}}]),a}(d.a.PureComponent),zl=Object(m.a)(Object(m.d)(),jc)(Vl),Hl=Object(M.a)(d.a.createElement("path",{d:"M9.91421356,11.5 L16.2071068,5.20710678 C16.5976311,4.81658249 16.5976311,4.18341751 16.2071068,3.79289322 C15.8165825,3.40236893 15.1834175,3.40236893 14.7928932,3.79289322 L7.79289322,10.7928932 C7.40236893,11.1834175 7.40236893,11.8165825 7.79289322,12.2071068 L14.7928932,19.2071068 C15.1834175,19.5976311 15.8165825,19.5976311 16.2071068,19.2071068 C16.5976311,18.8165825 16.5976311,18.1834175 16.2071068,17.7928932 L9.91421356,11.5 Z"}),"Left"),Wl=(a(617),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleClick=function(e){e.stopPropagation()},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.text;return d.a.createElement("div",{className:"media-caption",onClick:this.handleClick},d.a.createElement("div",{className:"media-caption-text"},e))}}]),a}(d.a.Component));Wl.defaultProps={};var Gl=Wl,Zl=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdateMediaBlob=function(e){var t=e.fileId,a=n.props,r=a.media,i=a.size,o=n.state.file;if(o&&o.id===t){var s=Object(N.n)(r,i),c=Object(C.a)(s,4),l=c[0],u=c[1],d=c[2],p=c[3];n.setState({width:l,height:u,file:d,src:Object(N.l)(d),mimeType:p})}},n.onClientUpdateMediaThumbnailBlob=function(e){var t=e.fileId,a=n.state.thumbnail;a&&a.id===t&&n.forceUpdate()},n.videoRef=d.a.createRef(),n.state={},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){R.a.on("clientUpdatePhotoBlob",this.onClientUpdateMediaBlob),R.a.on("clientUpdateVideoBlob",this.onClientUpdateMediaBlob),R.a.on("clientUpdateAnimationBlob",this.onClientUpdateMediaBlob),R.a.on("clientUpdateVideoThumbnailBlob",this.onClientUpdateMediaThumbnailBlob),R.a.on("clientUpdateAnimationThumbnailBlob",this.onClientUpdateMediaThumbnailBlob)}},{key:"componentWillUnmount",value:function(){R.a.off("clientUpdatePhotoBlob",this.onClientUpdateMediaBlob),R.a.off("clientUpdateVideoBlob",this.onClientUpdateMediaBlob),R.a.off("clientUpdateAnimationBlob",this.onClientUpdateMediaBlob),R.a.off("clientUpdateVideoThumbnailBlob",this.onClientUpdateMediaThumbnailBlob),R.a.off("clientUpdateAnimationThumbnailBlob",this.onClientUpdateMediaThumbnailBlob)}},{key:"componentDidUpdate",value:function(e,t,a){var n=this.state.src;if(t.src!==n){var r=this.videoRef.current;if(!r)return;r.load()}}},{key:"render",value:function(){var e=this,t=this.props,a=t.media,n=t.caption,r=t.url;if(!a)return null;var i=this.state,o=i.width,s=i.height,c=i.file,l=i.src,u=i.mimeType,p=i.thumbnailWidth,m=i.thumbnailHeight,f=i.thumbnail,g=i.minithumbnail,v=i.isPlaying;if(!c)return null;var b=g?"data:image/jpeg;base64, "+g.data:null,C=Object(N.l)(f),y=C?Object(Mt.k)({width:p,height:m}):Boolean(b),k=o,E=s;if(Math.max(k,E)>640){var S=640/Math.max(k,E);E=E>(k=k>E?640:Math.floor(k*S))?640:Math.floor(E*S)}var O=null,U=l?d.a.createElement("source",{src:l,type:u}):null;switch(a["@type"]){case"video":O=d.a.createElement("div",{className:"media-viewer-content-wrapper"},d.a.createElement("video",{ref:this.videoRef,className:"media-viewer-content-video-player",onClick:this.handleContentClick,controls:!0,autoPlay:!0,width:k,height:E,onPlay:function(){e.setState({isPlaying:!0}),$.a.clientUpdate({"@type":"clientUpdateMediaViewerPlay"})},onCanPlay:function(){var t=e.videoRef.current;t&&(t.volume=is.b.volume)},onPause:function(){$.a.clientUpdate({"@type":"clientUpdateMediaViewerPause"})},onEnded:function(){$.a.clientUpdate({"@type":"clientUpdateMediaViewerEnded"})},onVolumeChange:function(){var t=e.videoRef.current;t&&$.a.clientUpdate({"@type":"clientUpdateMediaVolume",volume:t.volume})}},U),!v&&(C||b?d.a.createElement("img",{className:h()("media-viewer-content-video-thumbnail",{"media-blurred":y}),src:C||b,alt:"",width:k,height:E}):d.a.createElement("div",{className:"media-viewer-content-video-thumbnail",style:{width:k,height:E}})));break;case"animation":O=d.a.createElement("div",{className:"media-viewer-content-wrapper"},d.a.createElement("video",{ref:this.videoRef,className:"media-viewer-content-video-player",onClick:this.handleContentClick,loop:!0,autoPlay:!0,width:k,height:E,onPlay:function(){e.setState({isPlaying:!0})}},U),!v&&(C||b?d.a.createElement("img",{className:h()("media-viewer-content-video-thumbnail",{"media-blurred":y}),src:C||b,alt:"",width:k,height:E}):d.a.createElement("div",{className:"media-viewer-content-video-thumbnail",style:{width:k,height:E}})));break;default:O=d.a.createElement("img",{className:"media-viewer-content-image",src:l,alt:"",onClick:this.handleContentClick})}return d.a.createElement("div",{className:"media-viewer-content"},O,d.a.createElement(Yn.a,{file:c,zIndex:2}),n&&(!Nl(n.text)||!Nl(n.credit)||r)&&d.a.createElement(Gl,{text:d.a.createElement(d.a.Fragment,null,d.a.createElement(Lc,{text:n.text,credit:n.credit}),d.a.createElement(At.a,{url:r}))}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.media,n=e.size;e.caption,e.url;if(a!==t.prevMedia){var r=Object(N.n)(a,n),i=Object(C.a)(r,4),o=i[0],s=i[1],c=i[2],l=i[3];c=R.a.get(c.id)||c;var u=Object(N.p)(a),d=Object(C.a)(u,3),p=d[0],h=d[1],m=d[2];m=R.a.get(m.id)||m;var f=Object(N.o)(a),g=Object(C.a)(f,3),v=g[0],b=g[1],y=g[2];return{prevMedia:a,speed:1,isPlaying:!1,width:o,height:s,file:c,src:Object(N.l)(c),mimeType:l,thumbnailWidth:p,thumbnailHeight:h,thumbnail:m,minithumbnailWidth:v,minithumbnailHeight:b,minithumbnail:y}}return null}}]),a}(d.a.Component),ql=(a(618),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleClick=function(t){t.stopPropagation();var a=e.props,n=a.disabled,r=a.onClick;n||r(t)},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.disabled,a=e.grow,n=e.children,r=e.className,i=e.style,o=h()(t?"media-viewer-button-disabled":"media-viewer-button",{grow:a},r);return d.a.createElement("div",{className:o,style:i,onClick:this.handleClick},n)}}]),a}(d.a.Component)),Kl=(a(619),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.title,a=e.subtitle,n=e.style;return d.a.createElement("div",{className:"media-viewer-footer-text",style:n},d.a.createElement("div",{className:"media-viewer-footer-text-wrapper"},d.a.createElement("span",null,t),Boolean(a)&&d.a.createElement("span",null,"\xa0",a)))}}]),a}(d.a.Component)),Jl=(a(416),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleClick=function(t){t.stopPropagation();var a=e.props,n=a.onClick;a.disabled||n(t)},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.checked,a=e.children,n=e.disabled,r=e.title;return d.a.createElement("div",{className:h()("media-viewer-footer-button",{"media-viewer-footer-button-checked":t,"media-viewer-footer-button-disabled":n}),title:r,onClick:this.handleClick},a)}}]),a}(d.a.Component)),Yl=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdateMediaBlob=function(e){var t=n.state.fileId;t===e.fileId&&n.setState({disabled:a.saveDisabled(t)})},n.handleClick=function(e){e.stopPropagation();var t=n.props.onClick;n.state.disabled||t(e)};var r=e.fileId;return n.state={prevPropsFileId:r,fileId:r,disabled:a.saveDisabled(r)},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){R.a.on("clientUpdateAnimationBlob",this.onClientUpdateMediaBlob),R.a.on("clientUpdateChatBlob",this.onClientUpdateMediaBlob),R.a.on("clientUpdateDocumentBlob",this.onClientUpdateMediaBlob),R.a.on("clientUpdatePhotoBlob",this.onClientUpdateMediaBlob),R.a.on("clientUpdateUserBlob",this.onClientUpdateMediaBlob),R.a.on("clientUpdateVideoBlob",this.onClientUpdateMediaBlob)}},{key:"componentWillUnmount",value:function(){R.a.off("clientUpdateAnimationBlob",this.onClientUpdateMediaBlob),R.a.off("clientUpdateChatBlob",this.onClientUpdateMediaBlob),R.a.off("clientUpdateDocumentBlob",this.onClientUpdateMediaBlob),R.a.off("clientUpdatePhotoBlob",this.onClientUpdateMediaBlob),R.a.off("clientUpdateUserBlob",this.onClientUpdateMediaBlob),R.a.off("clientUpdateVideoBlob",this.onClientUpdateMediaBlob)}},{key:"render",value:function(){var e=this.props,t=e.title,a=e.children,n=this.state.disabled;return d.a.createElement(Jl,{disabled:n,title:t,onClick:this.handleClick},a||d.a.createElement(Zr.a,null))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.fileId;return n!==t.prevPropsFileId?{prevPropsFileId:n,fileId:n,disabled:a.saveDisabled(n)}:null}}]),a}(d.a.Component);Yl.saveDisabled=function(e){return!Boolean(R.a.getBlob(e))};var Ql=Yl,Xl=(a(620),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onKeyDown=function(e){27===e.keyCode?n.handleClose():39===e.keyCode?n.handlePrevious():37===e.keyCode&&n.handleNext()},n.handlePrevious=function(e){e&&e.stopPropagation();var t=n.state,a=t.index,r=t.blocks,i=a+1;if(n.hasPreviousMedia(a,r))return n.loadMedia(i)},n.handleNext=function(e){e&&e.stopPropagation();var t=n.state,a=t.index,r=t.blocks,i=a-1;if(n.hasNextMedia(a,r))return n.loadMedia(i)},n.loadMedia=function(e){var t=n.state.blocks;return!(e<0)&&(!(e>=t.length)&&(n.setState({index:e,hasPreviousMedia:n.hasPreviousMedia(e,t),hasNextMedia:n.hasNextMedia(e,t)}),Object(N.G)(e,t),!0))},n.handleClose=function(){Object(Q.p)(null);var e=n.state,t=e.index,a=e.blocks;-1!==t&&Object(N.a)(t,a)},n.handleForward=function(){var e=n.props.media,t=Object(Mt.e)(e,null);t&&Object(Q.e)(t)},n.handleSave=function(){var e=n.props.media;Object(N.J)(e,null)},n.state={index:-1,hasPreviousMedia:!1,hasNextMedia:!1,blocks:[]},n.keyboardHandler=new Ja(n.onKeyDown),n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.loadContent(),Ya.add(this.keyboardHandler)}},{key:"componentWillUnmount",value:function(){Ya.remove(this.keyboardHandler)}},{key:"loadContent",value:function(){var e=this.props,t=e.iv,a=e.media,n=function(e){if(!e)return[];var t=e.page_blocks,a=[];return t.forEach((function(e){a.push(e),Bl(e).forEach((function(e){a.push(e)}))})),a.filter(Fl)}(t),r=n.findIndex((function(e){return Al(e)===a}));this.setState({blocks:n,index:r,hasPreviousMedia:this.hasPreviousMedia(r,n),hasNextMedia:this.hasNextMedia(r,n)}),Object(N.G)(r,n)}},{key:"hasPreviousMedia",value:function(e,t){return-1!==e&&e+1<t.length}},{key:"hasNextMedia",value:function(e,t){return-1!==e&&e-1>=0}},{key:"render",value:function(){var e=this.props,t=e.size,a=e.t,n=this.state,r=n.index,i=n.blocks,o=n.hasNextMedia,s=n.hasPreviousMedia;if(!i)return null;if(-1===r)return null;var c=i[r],l=Al(c),u=function(e){if(!e)return null;switch(e["@type"]){case"pageBlockAnimation":case"pageBlockPhoto":case"pageBlockVideo":return e.caption}return null}(c),p=function(e){if(!e)return null;switch(e["@type"]){case"pageBlockPhoto":return e.url}return null}(c),m=Object(N.n)(l,t),f=Object(C.a)(m,3),g=(f[0],f[1],f[2]),v="";"photo"===l["@type"]&&(v=a("AttachPhoto")),"video"===l["@type"]?v=a("AttachVideo"):"animation"===l["@type"]&&(v=a("AttachGif"));var b=i.length;return d.a.createElement("div",{className:h()("instant-view-media-viewer","media-viewer-default")},d.a.createElement("div",{className:"media-viewer-footer"},d.a.createElement(Kl,{title:v,subtitle:b&&r>=0?"".concat(r+1," of ").concat(b):null,style:{marginLeft:128}}),d.a.createElement(Ql,{title:a("Save"),fileId:g.id,onClick:this.handleSave}),d.a.createElement(Jl,{title:a("Forward"),onClick:this.handleForward},d.a.createElement(As,null)),d.a.createElement(Jl,{title:a("Close"),onClick:this.handleClose},d.a.createElement(w.a,null))),d.a.createElement("div",{className:"media-viewer-wrapper"},d.a.createElement("div",{className:"media-viewer-left-column"},d.a.createElement(ql,{disabled:!o,grow:!0,onClick:this.handleNext},d.a.createElement(Hl,null))),d.a.createElement("div",{className:"media-viewer-content-column"},d.a.createElement(Zl,{media:l,size:t,caption:u,url:p})),d.a.createElement("div",{className:"media-viewer-right-column"},d.a.createElement(ql,{disabled:!s,grow:!0,onClick:this.handlePrevious},d.a.createElement(Hl,{style:{transform:"rotate(180deg)"}})))))}}]),a}(d.a.Component)),$l=Object(m.a)(Object(y.d)(),jc)(Xl),eu=a(368),tu=(a(621),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdateInstantViewViewerContent=function(e){var t=e.content;if(t){var a=t.media,r=t.caption,i=t.url,o=t.instantView;n.props.instantView===o&&n.setState({media:a,caption:r,url:i})}else n.setState({media:null,caption:null,url:null})},n.onClientUpdateInstantViewUrl=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,i,o,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("[IV] clientUpdateInstantViewUrl",t),a=t.url,i=eu.a.getCurrent(),o=n.props.instantView,i===o){e.next=6;break}return e.abrupt("return");case 6:if(!o||!a.startsWith(o.url)){e.next=15;break}if(s=new URL(a).hash,a.indexOf("#")!==a.length-1){e.next=13;break}return n.scrollTop("smooth"),e.abrupt("return");case 13:if(!s||!n.scrollToHash(s,"smooth")){e.next=15;break}return e.abrupt("return");case 15:$s(a);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onKeyDown=function(e){if(27===e.keyCode){if(n.state.media)return void Object(Q.p)(null);n.handleClose()}},n.handleBack=function(){var e=n.state,t=e.hasPrev;e.hasScroll?n.scrollTop("smooth"):t?$.a.clientUpdate({"@type":"clientUpdatePrevInstantView"}):n.handleClose()},n.handleScroll=function(){var e=n.instantViewerRef.current;n.setState({hasScroll:e.scrollTop>50}),n.updateItemsInView()},n.keyboardHandler=new Ja(n.onKeyDown),n.articleRef=d.a.createRef(),n.instantViewerRef=d.a.createRef(),n.state={},n.updateItemsInView=Object(We.z)(n.updateItemsInView,500),n}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t,a){var n=this.props.instantView,r=this.state,i=r.hasScroll,o=r.hasPrev,s=r.media,c=r.caption,l=r.url;return n!==e.instantView||(i!==t.hasScroll||(o!==t.hasPrev||(s!==t.media||(c!==t.caption||l!==t.url))))}},{key:"componentDidMount",value:function(){this.mounted=!0,this.handleScroll(),Ya.add(this.keyboardHandler),eu.a.on("clientUpdateInstantViewUrl",this.onClientUpdateInstantViewUrl),eu.a.on("clientUpdateInstantViewViewerContent",this.onClientUpdateInstantViewViewerContent)}},{key:"componentWillUnmount",value:function(){this.mounted=!1,Ya.remove(this.keyboardHandler),eu.a.off("clientUpdateInstantViewUrl",this.onClientUpdateInstantViewUrl),eu.a.off("clientUpdateInstantViewViewerContent",this.onClientUpdateInstantViewViewerContent)}},{key:"scrollToHash",value:function(e,t){if(!e)return!1;var a=document.getElementById(e.substr(1));if(a){var n=[],r=!1,i=a;do{(i=i.parentNode)?"DETAILS"===i.nodeName?n.push(i):"ARTICLE"===i.nodeName&&(r=!0):r=!0}while(!r);return n.forEach((function(e){return e.open=!0})),a.scrollIntoView({block:"center",behavior:t}),!0}return!1}},{key:"scrollTop",value:function(e){var t=this.instantViewerRef.current;switch(e){case"smooth":Wa(t);break;default:t.scrollTo({top:0,behavior:e})}}},{key:"componentDidUpdate",value:function(e,t,a){var n=this.props,r=n.instantView;n.url;console.log("[IV] componentDidUpdate",r.url,r.url===e.instantView.url);var i=new URL(r.url).hash;e.instantView!==r&&(e.instantView.url!==r.url?r.url.indexOf("#")===r.url.length-1?(console.log("[IV] componentDidUpdate scrollTop auto"),this.scrollTop("auto")):i?(console.log("[IV] componentDidUpdate scrollToHash",i),this.scrollToHash(i,"auto")):(console.log("[IV] componentDidUpdate scrollTop auto"),this.scrollTop("auto")):i?(console.log("[IV] componentDidUpdate scrollToHash",i),this.scrollToHash(i,"auto")):(console.log("[IV] componentDidUpdate scrollTop smooth"),this.scrollTop("smooth")),this.handleScroll())}},{key:"handleClose",value:function(){Object(Q.o)(null)}},{key:"updateItemsInView",value:function(){if(this.mounted){var e=this.props.instantView;if(e){for(var t=e.page_blocks,a=new Map,n=Object(We.v)(this.instantViewerRef,this.articleRef),r=0;r<n.length;r++){var i=t[n[r]];a.set(i,i),Bl(i).forEach((function(e){return a.set(e,e)}))}$.a.clientUpdate({"@type":"clientUpdateBlocksInView",blocks:a})}}}},{key:"render",value:function(){var e=this.props,t=(e.classes,e.instantView),a=this.state,n=(a.hasPrev,a.hasScroll),r=a.media,i=a.caption,o=a.url;return t?d.a.createElement(Ic.Provider,{value:t},d.a.createElement("div",{ref:this.instantViewerRef,className:"instant-viewer",onScroll:this.handleScroll},d.a.createElement("div",{className:"instant-viewer-left-column",onClick:this.handleBack},d.a.createElement(ql,{className:"instant-viewer-left-button",style:{alignItems:"flex-start"},onClick:this.handleBack},d.a.createElement(Hl,{style:{transition:"transform 0.25s ease-out",transform:n?"rotate(90deg)":"rotate(0deg)"}}))),d.a.createElement("div",{className:"instant-viewer-content-column"},d.a.createElement("div",null,d.a.createElement(zl,{ref:this.articleRef}))),d.a.createElement("div",{className:"instant-viewer-right-column"},d.a.createElement(ql,{className:"instant-viewer-right-button",onClick:this.handleClose},d.a.createElement(w.a,null)))),r&&d.a.createElement($l,{media:r,size:v.j,caption:i,url:o})):null}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.instantView!==t.prevInstantView?{prevInstantView:e.instantView,hasPrev:eu.a.hasPrev(),hasScroll:!1,media:null,caption:null,url:null}:null}}]),a}(d.a.Component)),au=Object(y.d)()(tu),nu=(a(417),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){return Object(o.a)(this,a),t.call(this,e)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.messageId,n=X.a.get(t,a);if(!n)return null;var r=n.date,i=Object(wt.w)(n),o=Object(wt.k)(r),s=i?d.a.createElement(nn.a,{userId:i}):d.a.createElement(A,{chatId:t});return d.a.createElement("div",{className:"media-info"},d.a.createElement("div",{className:"media-info-wrapper"},s,d.a.createElement("div",{className:"media-info-content"},d.a.createElement("div",{className:"media-info-row"},d.a.createElement(ia.a,{chatId:t,userId:i})),d.a.createElement("div",{className:"media-info-row meta"},d.a.createElement("span",null,o)))))}}]),a}(d.a.Component)),ru=(a(622),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdateDocumentBlob=function(e){var t=n.props,a=t.chatId,r=t.messageId;a===e.chatId&&r===e.messageId&&n.updateAnimationData()},n.updateAnimationData=Object(i.a)(r.a.mark((function e(){var t,a,i,o,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props,a=t.chatId,i=t.messageId,Object(wt.G)(a,i)){e.next=3;break}return e.abrupt("return");case 3:return o=n.state.file,e.next=6,Object(N.d)(o);case 6:s=e.sent,n.setState({animationData:s});case 8:case"end":return e.stop()}}),e)}))),n.onClientUpdateMediaBlob=function(e){var t=n.props,a=t.chatId,r=t.messageId,i=t.size;if(a===e.chatId&&r===e.messageId){var o=Object(N.i)(a,r,i),s=Object(C.a)(o,4),c=s[0],l=s[1],u=s[2],d=s[3];n.setState({width:c,height:l,file:u,src:Object(N.l)(u),mimeType:d})}},n.onClientUpdateMediaThumbnailBlob=function(e){var t=n.props,a=t.chatId,r=t.messageId;if(a===e.chatId&&r===e.messageId){var i=Object(N.k)(a,r),o=Object(C.a)(i,3),s=o[0],c=o[1],l=o[2];n.setState({thumbnailWidth:s,thumbnailHeight:c,thumbnail:l})}},n.onUpdateMessageContent=function(e){var t=n.props,a=t.chatId,r=t.messageId,i=t.size,o=t.t,s=e.chat_id,c=e.message_id;if(a===s&&r===c){var l=Object(N.i)(a,r,i),u=Object(C.a)(l,4),d=u[0],p=u[1],h=u[2],m=u[3],f=X.a.get(a,r),g=Object(wt.x)(f,null,o);n.setState({width:d,height:p,file:h,src:Object(N.l)(h),mimeType:m,text:g})}},n.handleContentClick=function(e){e&&e.stopPropagation()},n.changeSpeed=function(e){n.setState({speed:e})},n.state={},n.videoRef=d.a.createRef(),n.lottieRef=d.a.createRef(),n.updateAnimationData(),n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){R.a.on("clientUpdateDocumentBlob",this.onClientUpdateDocumentBlob),R.a.on("clientUpdatePhotoBlob",this.onClientUpdateMediaBlob),R.a.on("clientUpdateVideoBlob",this.onClientUpdateMediaBlob),R.a.on("clientUpdateAnimationBlob",this.onClientUpdateMediaBlob),R.a.on("clientUpdateVideoThumbnailBlob",this.onClientUpdateMediaThumbnailBlob),R.a.on("clientUpdateAnimationThumbnailBlob",this.onClientUpdateMediaThumbnailBlob),X.a.on("updateMessageContent",this.onUpdateMessageContent)}},{key:"componentWillUnmount",value:function(){R.a.off("clientUpdateDocumentBlob",this.onClientUpdateDocumentBlob),R.a.off("clientUpdatePhotoBlob",this.onClientUpdateMediaBlob),R.a.off("clientUpdateVideoBlob",this.onClientUpdateMediaBlob),R.a.off("clientUpdateAnimationBlob",this.onClientUpdateMediaBlob),R.a.off("clientUpdateVideoThumbnailBlob",this.onClientUpdateMediaThumbnailBlob),R.a.off("clientUpdateAnimationThumbnailBlob",this.onClientUpdateMediaThumbnailBlob),X.a.off("updateMessageContent",this.onUpdateMessageContent)}},{key:"componentDidUpdate",value:function(e,t,a){var n=this.props,r=n.chatId,i=n.messageId,o=this.state.src;if(e.chatId===r&&e.messageId===i||this.updateAnimationData(),t.src!==o){var s=this.videoRef.current;if(!s)return;s.load()}}},{key:"render",value:function(){var e=this,t=this.props,a=t.chatId,n=t.messageId,r=this.state,i=r.width,o=r.height,s=r.file,c=r.src,l=r.mimeType,u=r.text,p=r.thumbnailWidth,m=r.thumbnailHeight,f=r.minithumbnail,g=r.thumbnail,v=r.isPlaying;if(!s)return null;var b=f?"data:image/jpeg;base64, "+f.data:null,C=Object(N.l)(g),y=C?Object(Mt.k)({width:p,height:m}):Boolean(b),k=Object(wt.M)(a,n),E=Object(wt.C)(a,n),S=Object(wt.G)(a,n),O=i,U=o;if(Math.max(O,U)>640){var w=640/Math.max(O,U);U=U>(O=O>U?640:Math.floor(O*w))?640:Math.floor(U*w)}var M=null,I=c?d.a.createElement("source",{src:c,type:l}):null;return k?M=d.a.createElement("div",{className:"media-viewer-content-wrapper"},d.a.createElement("video",{ref:this.videoRef,className:"media-viewer-content-video-player",onClick:this.handleContentClick,controls:!0,autoPlay:!0,width:O,height:U,onPlay:function(){e.setState({isPlaying:!0}),$.a.clientUpdate({"@type":"clientUpdateMediaViewerPlay"})},onCanPlay:function(){var t=e.videoRef.current;t&&(t.volume=is.b.volume)},onPause:function(){$.a.clientUpdate({"@type":"clientUpdateMediaViewerPause"})},onEnded:function(){$.a.clientUpdate({"@type":"clientUpdateMediaViewerEnded"})},onVolumeChange:function(){var t=e.videoRef.current;t&&$.a.clientUpdate({"@type":"clientUpdateMediaVolume",volume:t.volume})}},I),!v&&(C||b?d.a.createElement("img",{className:h()("media-viewer-content-video-thumbnail",{"media-blurred":y}),src:C||b,alt:"",width:O,height:U}):d.a.createElement("div",{className:"media-viewer-content-video-thumbnail",style:{width:O,height:U}}))):E?M=d.a.createElement("div",{className:"media-viewer-content-wrapper"},d.a.createElement("video",{ref:this.videoRef,className:"media-viewer-content-video-player",onClick:this.handleContentClick,loop:!0,autoPlay:!0,width:O,height:U,onPlay:function(){e.setState({isPlaying:!0})}},I),!v&&(C||b?d.a.createElement("img",{className:h()("media-viewer-content-video-thumbnail",{"media-blurred":y}),src:C||b,alt:"",width:O,height:U}):d.a.createElement("div",{className:"media-viewer-content-video-thumbnail",style:{width:O,height:U}}))):S||(M=d.a.createElement(d.a.Fragment,null,d.a.createElement("img",{className:"media-viewer-content-image",src:c,alt:"",onClick:this.handleContentClick}))),d.a.createElement("div",{className:"media-viewer-content"},M,d.a.createElement(Yn.a,{file:s,zIndex:2}),u&&u.length>0&&d.a.createElement(Gl,{text:u}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.chatId,n=e.messageId,r=e.size,i=e.t;if(a!==t.prevChatId||n!==t.prevMessageId){var o=Object(N.i)(a,n,r),s=Object(C.a)(o,4),c=s[0],l=s[1],u=s[2],d=s[3];u=R.a.get(u.id)||u;var p=Object(N.k)(a,n),h=Object(C.a)(p,3),m=h[0],f=h[1],g=h[2];g=R.a.get(g.id)||g;var v=Object(N.j)(a,n),b=Object(C.a)(v,3),y=b[0],k=b[1],E=b[2],S=X.a.get(a,n),O=Object(wt.x)(S,null,i);return{prevChatId:a,prevMessageId:n,speed:1,isPlaying:!1,width:c,height:l,file:u,src:Object(N.l)(u),mimeType:d,text:O,thumbnailWidth:m,thumbnailHeight:f,thumbnail:g,minithumbnailWidth:y,minithumbnailHeight:k,minithumbnail:E}}return null}}]),a}(d.a.Component)),iu=Object(y.d)()(ru),ou=(a(418),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).onKeyDown=function(e){if(27===e.keyCode){if(n.state.deleteConfirmationOpened)return;n.handleClose()}else 39===e.keyCode?n.handleNext():37===e.keyCode&&n.handlePrevious()},n.onUpdateMessageContent=function(e){var t=e.chat_id,a=e.message_id,r=e.new_content,i=e.old_content,o=n.props.chatId,s=n.state,c=s.currentMessageId,l=s.totalCount;if(o===t){var u=X.a.get(t,a);if(u){if(Object(N.x)([u]),Object(wt.H)(r)&&!Object(wt.H)(i)){if(n.history.length>=2&&(n.firstSliceLoaded||Object(We.b)(a,n.history[0].id,n.history[n.history.length-1].id))){for(var d=!1,p=[],h=0;h<n.history.length;h++)n.history[h].id>a||d||(d=!0,p.push(u)),p.push(n.history[h]);n.history=p}var m=n.history.findIndex((function(e){return e.id===c}));n.setState({hasNextMedia:n.hasNextMedia(m),hasPreviousMedia:n.hasPreviousMedia(m),totalCount:l+1})}if(!Object(wt.H)(r)&&Object(wt.H)(i)){var f=n.history;if(n.history=n.history.filter((function(e){return e.id!==a})),c===a){var g=new Map;g.set(a,a),n.moveToNextMedia(f,g),n.setState({totalCount:Math.max(l-1,0)})}else{var v=n.history.findIndex((function(e){return e.id===c}));n.setState({hasNextMedia:n.hasNextMedia(v),hasPreviousMedia:n.hasPreviousMedia(v),totalCount:Math.max(l-1,0)})}}}}},n.onUpdateDeleteMessages=function(e){var t=e.chat_id,a=e.message_ids,r=e.is_permanent,i=n.props.chatId,o=n.state,s=o.currentMessageId,c=o.totalCount;if(r&&i===t){var l=a.reduce((function(e,t){return e.set(t,t),e}),new Map),u=n.history,d=u.length;n.history=n.history.filter((function(e){return!l.has(e.id)})),d-=n.history.length,n.setState({totalCount:Math.max(c-d,0)}),n.history.length?l.has(s)&&n.moveToNextMedia(u,l):Object(Q.q)(null)}},n.onUpdateNewMessage=function(e){var t=n.props.chatId,a=n.state,r=a.currentMessageId,i=a.totalCount,o=e.message;if(o&&Object(wt.H)(o.content)&&o.chat_id===t&&n.firstSliceLoaded){n.history=[o].concat(n.history);var s=n.history.findIndex((function(e){return e.id===r}));n.setState({hasNextMedia:n.hasNextMedia(s),hasPreviousMedia:n.hasPreviousMedia(s),totalCount:i+1})}},n.getFilter=function(e,t){var a=X.a.get(e,t);if(!a)return null;var n=a.content;if(!n)return null;switch(n["@type"]){case"messageChatChangePhoto":return{"@type":"searchMessagesFilterChatPhoto"};case"messagePhoto":case"messageVideo":return{"@type":"searchMessagesFilterPhotoAndVideo"};default:return null}},n.loadHistory=Object(i.a)(r.a.mark((function e(){var t,a,i,o,s,c,l,u,d,p,h;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props,a=t.chatId,i=t.messageId,o=n.getFilter(a,i),s={"@type":"messages",messages:[],total_count:0},!o){e.next=7;break}return e.next=6,$.a.send({"@type":"searchChatMessages",chat_id:a,query:"",sender_user_id:0,from_message_id:i,offset:-v.r,limit:2*v.r,filter:o});case 6:s=e.sent;case 7:if(Object(wt.f)(s,n.history),X.a.setItems(s.messages),n.history=s.messages,n.firstSliceLoaded=0===s.messages.length,c=n.state.currentMessageId,l=n.history.findIndex((function(e){return e.id===c})),n.setState({hasNextMedia:n.hasNextMedia(l),hasPreviousMedia:n.hasPreviousMedia(l)}),-1!==l){e.next=19;break}n.history=[X.a.get(a,c)],Object(N.H)(0,n.history),e.next=30;break;case 19:if(Object(N.H)(l,n.history),u=n.getFilter(a,i)){e.next=23;break}return e.abrupt("return");case 23:d=1500,p=0,h=r.a.mark((function e(){var t,i,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.a.send({"@type":"searchChatMessages",chat_id:a,query:"",sender_user_id:0,from_message_id:n.history.length>0?n.history[0].id:0,offset:-99,limit:100,filter:u});case 2:t=e.sent,p+=t.messages.length,Object(wt.f)(t,n.history),X.a.setItems(t.messages),n.history=t.messages.concat(n.history),n.firstSliceLoaded=0===t.messages.length,i=n.state.currentMessageId,o=n.history.findIndex((function(e){return e.id===i})),n.setState({hasNextMedia:n.hasNextMedia(o),hasPreviousMedia:n.hasPreviousMedia(o),firstSliceLoaded:n.firstSliceLoaded,totalCount:t.total_count});case 11:case"end":return e.stop()}}),e)}));case 26:if(n.firstSliceLoaded||!(p<d)){e.next=30;break}return e.delegateYield(h(),"t0",28);case 28:e.next=26;break;case 30:case"end":return e.stop()}}),e)}))),n.handleClose=function(){Object(Q.q)(null);var e=n.state.currentMessageId,t=n.history.findIndex((function(t){return t.id===e}));-1!==t&&Object(N.b)(t,n.history)},n.handleSave=function(){var e=n.props.chatId,t=n.state.currentMessageId,a=X.a.get(e,t);if(a){var r=a.content;if(r){var i=null;switch(r["@type"]){case"messageAnimation":i=r.animation;break;case"messageChatChangePhoto":i=r.photo;break;case"messageDocument":i=r.document;break;case"messagePhoto":i=r.photo;break;case"messageText":var o=r.web_page;if(!o)return;var s=o.animation,c=o.document,l=o.photo,u=o.video;if(s){i=s;break}if(c){i=c;break}if(l){i=l;break}if(u){i=u;break}break;case"messageVideo":i=r.video}Object(N.J)(i,a)}}},n.handleForward=function(){var e=n.props.chatId,t=n.state.currentMessageId;Object(Q.f)(e,[t])},n.handleDelete=function(){n.handleDialogOpen()},n.hasPreviousMedia=function(e){return-1!==e&&e+1<n.history.length},n.handlePrevious=function(e){e&&e.stopPropagation();var t=n.state.currentMessageId,a=n.history.findIndex((function(e){return e.id===t}))+1;return n.loadMedia(a,(function(){a===n.history.length-1&&n.loadPrevious()}))},n.loadPrevious=Object(i.a)(r.a.mark((function e(){var t,a,i,o,s,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props,a=t.chatId,i=t.messageId,o=n.state.currentMessageId,s=n.getFilter(a,i),c={"@type":"messages",messages:[],total_count:0},!s){e.next=8;break}return e.next=7,$.a.send({"@type":"searchChatMessages",chat_id:a,query:"",sender_user_id:0,from_message_id:o,offset:0,limit:v.r,filter:s});case 7:c=e.sent;case 8:Object(wt.f)(c,n.history),X.a.setItems(c.messages),n.history=n.history.concat(c.messages),l=n.history.findIndex((function(e){return e.id===o})),n.setState({hasNextMedia:n.hasNextMedia(l),hasPreviousMedia:n.hasPreviousMedia(l),totalCount:c.total_count});case 13:case"end":return e.stop()}}),e)}))),n.hasNextMedia=function(e){return-1!==e&&e-1>=0},n.handleNext=function(e){e&&e.stopPropagation();var t=n.state.currentMessageId,a=n.history.findIndex((function(e){return e.id===t}))-1;return n.loadMedia(a,(function(){0===a&&n.loadNext()}))},n.loadNext=Object(i.a)(r.a.mark((function e(){var t,a,i,o,s,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props,a=t.chatId,i=t.messageId,o=n.state.currentMessageId,s=n.getFilter(a,i),c={"@type":"messages",messages:[],total_count:0},!s){e.next=8;break}return e.next=7,$.a.send({"@type":"searchChatMessages",chat_id:a,query:"",sender_user_id:0,from_message_id:o,offset:-v.r,limit:v.r+1,filter:s});case 7:c=e.sent;case 8:Object(wt.f)(c,n.history),X.a.setItems(c.messages),n.firstSliceLoaded=0===c.messages.length,n.history=c.messages.concat(n.history),l=n.history.findIndex((function(e){return e.id===o})),n.setState({hasNextMedia:n.hasNextMedia(l),hasPreviousMedia:n.hasPreviousMedia(l),firstSliceLoaded:n.firstSliceLoaded,totalCount:c.total_count});case 14:case"end":return e.stop()}}),e)}))),n.loadMedia=function(e,t){return!(e<0)&&(!(e>=n.history.length)&&(n.setState({currentMessageId:n.history[e].id,hasNextMedia:n.hasNextMedia(e),hasPreviousMedia:n.hasPreviousMedia(e)},t),Object(N.H)(e,n.history),!0))},n.moveToNextMedia=function(e,t){for(var a=n.state.currentMessageId,r=e.findIndex((function(e){return e.id===a})),i=0,o=r-1;o>=0;o--)if(t&&!t.has(e[o].id)){i=e[o].id;break}if(!i)for(var s=r+1;s<e.length;s++)if(t&&!t.has(e[s].id)){i=e[s].id;break}if(i){var c=n.history.findIndex((function(e){return e.id===i}));return n.loadMedia(c,(function(){0===c?n.loadNext():c===n.history.length-1&&n.loadPrevious()}))}},n.handleDialogOpen=function(){n.setState({deleteConfirmationOpened:!0})},n.handleDialogClose=function(){n.setState({deleteConfirmationOpened:!1})},n.handleDone=function(){n.setState({deleteConfirmationOpened:!1});var e=n.props.chatId,t=n.state,a=t.currentMessageId,r=t.deleteForAll,i=X.a.get(e,a);if(i){var o=i.can_be_deleted_only_for_self,s=i.can_be_deleted_for_all_users;(o||s)&&$.a.send({"@type":"deleteMessages",chat_id:e,message_ids:[a],revoke:s&&r})}},n.handleChangeDeleteForAll=function(e){n.setState({deleteForAll:e.target.checked})},n.handleInvertColors=function(){var e="media-viewer-default";switch(n.state.background){case"media-viewer-default":e="media-viewer-dark";break;case"media-viewer-dark":e="media-viewer-light";break;case"media-viewer-light":e="media-viewer-default"}n.setState({background:e})},n.canBeForwarded=function(e,t){var a=X.a.get(e,t);if(!a)return!1;var n=a.can_be_forwarded,r=a.content;if(!r)return!1;switch(r["@type"]){case"messageChatChangePhoto":return!0;default:return n}},n.keyboardHandler=new Ja(n.onKeyDown),n.history=[];var s=n.props,c=s.chatId,l=s.messageId;return n.state={speed:1,background:"media-viewer-default",prevChatId:c,prevMessageId:l,currentMessageId:l,hasNextMedia:!1,hasPreviousMedia:!1,deleteConfirmationOpened:!1,deleteForAll:!0},n}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props,n=a.chatId,r=a.messageId,i=this.state,o=i.background,s=i.currentMessageId,c=i.deleteConfirmationOpened,l=i.firstSliceLoaded,u=i.hasNextMedia,d=i.hasPreviousMedia,p=i.speed,h=i.totalCount;return t.background!==o||(e.chatId!==n||(e.messageId!==r||(t.currentMessageId!==s||(t.hasPrevousMedia!==d||(t.hasNextMedia!==u||(t.firstSliceLoaded!==l||(t.totalCount!==h||(t.deleteConfirmationOpened!==c||t.speed!==p))))))))}},{key:"componentDidMount",value:function(){this.loadHistory(),Ya.add(this.keyboardHandler),X.a.on("updateDeleteMessages",this.onUpdateDeleteMessages),X.a.on("updateNewMessage",this.onUpdateNewMessage),X.a.on("updateMessageContent",this.onUpdateMessageContent)}},{key:"componentWillUnmount",value:function(){Ya.remove(this.keyboardHandler),X.a.off("updateDeleteMessages",this.onUpdateDeleteMessages),X.a.off("updateNewMessage",this.onUpdateNewMessage),X.a.off("updateMessageContent",this.onUpdateMessageContent)}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.t,n=this.state,r=n.background,i=n.currentMessageId,o=n.deleteConfirmationOpened,s=n.deleteForAll,c=n.firstSliceLoaded,l=n.hasNextMedia,u=n.hasPreviousMedia,p=(n.speed,n.totalCount),m=-1;p&&c&&(m=this.history.findIndex((function(e){return e.id===i})));var f=Math.max(this.history.length,p),g=X.a.get(t,i),b=g.can_be_deleted_for_all_users,y=g.can_be_deleted_only_for_self,E=b||y,M=this.canBeForwarded(t,i),I="";I=Object(wt.M)(t,i)?a("AreYouSureDeleteVideo"):Object(wt.C)(t,i)?a("AreYouSureDeleteGIF"):a("AreYouSureDeletePhoto");var j=o?d.a.createElement(S.a,{transitionDuration:0,open:o,onClose:this.handleDialogClose,"aria-labelledby":"form-dialog-title"},d.a.createElement(U.a,{id:"form-dialog-title"},a("Confirm")),d.a.createElement(xn.a,null,d.a.createElement(Tn.a,null,I),b&&d.a.createElement(rr.a,{label:a("DeleteForAll"),control:d.a.createElement(wr.a,{color:"primary",value:"deleteAll",onChange:this.handleChangeDeleteForAll}),checked:s})),d.a.createElement(O.a,null,d.a.createElement(k.a,{onClick:this.handleDialogClose,color:"primary"},a("Cancel")),d.a.createElement(k.a,{onClick:this.handleDone,color:"primary"},a("Ok")))):null,_=Object(N.i)(t,i,v.B),x=Object(C.a)(_,4),T=(x[0],x[1],x[2]),L=(x[3],T?T.id:0),P=a("AttachPhoto");return Object(wt.M)(t,i)?P=a("AttachVideo"):Object(wt.C)(t,i)?P=a("AttachGif"):Object(wt.G)(t,i)&&(P=""),d.a.createElement("div",{className:h()("media-viewer",r)},d.a.createElement("div",{className:"media-viewer-footer"},d.a.createElement(nu,{chatId:t,messageId:i}),d.a.createElement(Kl,{title:P,subtitle:f&&m>=0?"".concat(f-m," of ").concat(f):null}),d.a.createElement(Ql,{title:a("Save"),fileId:L,onClick:this.handleSave}),d.a.createElement(Jl,{title:a("Forward"),disabled:!M,onClick:this.handleForward},d.a.createElement(As,null)),d.a.createElement(Jl,{title:a("Delete"),disabled:!E,onClick:this.handleDelete},d.a.createElement(Qa,null)),d.a.createElement(Jl,{title:a("Close"),onClick:this.handleClose},d.a.createElement(w.a,null))),d.a.createElement("div",{className:"media-viewer-wrapper",onClick:this.handlePrevious},d.a.createElement("div",{className:"media-viewer-left-column"},d.a.createElement(ql,{disabled:!u,grow:!0,onClick:this.handlePrevious},d.a.createElement(Hl,null))),d.a.createElement("div",{className:"media-viewer-content-column"},d.a.createElement(iu,{chatId:t,messageId:i,size:v.B,onClick:this.handlePrevious})),d.a.createElement("div",{className:"media-viewer-right-column"},d.a.createElement(ql,{disabled:!l,grow:!0,onClick:this.handleNext},d.a.createElement(Hl,{style:{transform:"rotate(180deg)"}})))),j)}}]),a}(d.a.Component)),su=Object(y.d)()(ou),cu=(a(419),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdateChatBlob=function(e){var t=n.props,a=t.chatId,r=t.photo;if(a===e.chatId&&r.big.id===e.fileId){var i=R.a.get(e.fileId)||n.state.file;n.setState({file:i})}},n.onClientUpdateUserBlob=function(e){var t=n.props,a=t.chatId,r=t.photo;if(Object(x.u)(a)===e.userId&&r.big.id===e.fileId){var i=R.a.get(e.fileId)||n.state.file;n.setState({file:i})}},n.handleContentClick=function(e){e&&e.stopPropagation(),n.props.onClick(e)};var r=n.props,i=r.chatId,s=r.photo,c=s.big;return c=R.a.get(c.id)||c,n.state={prevChatId:i,prevPhoto:s,width:v.db,height:v.db,file:c},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){R.a.on("clientUpdateChatBlob",this.onClientUpdateChatBlob),R.a.on("clientUpdateUserBlob",this.onClientUpdateUserBlob)}},{key:"componentWillUnmount",value:function(){R.a.off("clientUpdateChatBlob",this.onClientUpdateChatBlob),R.a.off("clientUpdateUserBlob",this.onClientUpdateUserBlob)}},{key:"render",value:function(){var e=this.state,t=(e.width,e.height,e.file);if(!t)return null;var a=R.a.getBlob(t.id)||t.blob,n=R.a.getBlobUrl(a);return d.a.createElement("div",{className:"media-viewer-content"},d.a.createElement("img",{className:"media-viewer-content-image",src:n,alt:"",onClick:this.handleContentClick}),d.a.createElement(Yn.a,{file:t}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.chatId,n=e.photo;return a!==t.prevChatId||n!==t.prevPhoto?{prevChatId:a,prevPhoto:n,width:v.db,height:v.db,file:n.big}:null}}]),a}(d.a.Component)),lu=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){return Object(o.a)(this,a),t.call(this,e)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.date;return d.a.createElement("div",{className:"media-info"},d.a.createElement("div",{className:"media-info-wrapper"},d.a.createElement(A,{chatId:t,showSavedMessages:!1}),d.a.createElement("div",{className:"media-info-content"},d.a.createElement("div",{className:"media-info-row"},d.a.createElement(ia.a,{chatId:t})),a&&d.a.createElement("div",{className:"media-info-row meta"},d.a.createElement("span",null,a)))))}}]),a}(d.a.Component),uu=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).handleKeyDown=function(e){if(e.preventDefault(),e.stopPropagation(),27===e.keyCode){if(n.state.deleteConfirmationOpened)return;n.handleClose()}else 39===e.keyCode?n.handlePrevious():37===e.keyCode&&n.handleNext()},n.loadHistory=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.props.chatId,Object(x.U)(a)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,$.a.send({"@type":"getUserProfilePhotos",user_id:Object(x.u)(a),offset:0,limit:100});case 5:i=e.sent,n.history=i.photos,n.firstSliceLoaded=0===i.photos.length,0,n.setState({currentIndex:0,hasNextMedia:n.hasNextMedia(0),hasPreviousMedia:n.hasPreviousMedia(0),totalCount:i.total_count}),Object(N.I)(a,0,n.history);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleClose=function(){Object(Q.r)(null)},n.handleSave=function(){var e=n.props.chatId,t=n.state,a=t.currentIndex,r=t.totalCount,i=D.a.get(e);if(i){var o=-1;r&&(o=a);var s=o>0&&o<n.history.length?Object(_.a)(n.history[o]):Object(x.D)(e);if(s&&s.big){var c=R.a.get(s.big.id)||s.big;c&&Object(N.K)(c,c.id+".jpg",i,(function(){return R.a.updateChatPhotoBlob(e,c.id)}))}}},n.handleForward=function(){var e=n.props.chatId,t=n.state,a=t.currentIndex,r=-1;t.totalCount&&(r=a);var i=null;if(n.history&&r>=0&&r<n.history.length){var o=Object(_.a)(n.history[r]);if(!o)return;var s=o.big;if(!s)return;i={"@type":"inputFileId",id:s.id}}else{var c=Object(x.D)(e);if(!c)return;var l=c.big;if(!l)return;var u=R.a.getBlob(l.id);if(!u)return;i={"@type":"inputFileBlob",data:u,name:""}}if(i){var d={"@type":"inputMessagePhoto",photo:i,thumbnail:null,added_sticker_file_ids:[],width:v.db,height:v.db,caption:{"@type":"formattedText",text:"",entities:null},ttl:0};Object(Q.e)(d)}},n.handleDelete=function(){var e=n.props,t=e.chatId,a=(e.messageId,n.state),r=a.currentIndex,i=-1;a.totalCount&&(i=r);var o=i>0&&i<n.history.length?Object(_.a)(n.history[i]):Object(x.D)(t);if(o){var s=o.big;if(s=R.a.get(s.id)||s){var c=R.a.getReadWriteStore();R.a.deleteLocalFile(c,s)}}},n.hasPreviousMedia=function(e){return-1!==e&&e+1<n.history.length},n.handlePrevious=function(e){e&&e.stopPropagation();var t=n.state.currentIndex+1;return n.loadMedia(t,(function(){t===n.history.length-1&&n.loadPrevious()}))},n.loadPrevious=Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),e)}))),n.hasNextMedia=function(e){return-1!==e&&e-1>=0},n.handleNext=function(e){e&&e.stopPropagation();var t=n.state.currentIndex-1;return n.loadMedia(t,(function(){0===t&&n.loadNext()}))},n.loadNext=Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),e)}))),n.loadMedia=function(e,t){if(e<0)return!1;if(e>=n.history.length)return!1;n.setState({currentIndex:e,hasNextMedia:n.hasNextMedia(e),hasPreviousMedia:n.hasPreviousMedia(e)},t);var a=n.props.chatId;return Object(N.I)(a,e,n.history),!0},n.history=[],n.keyboardHandler=new Ja(n.handleKeyDown);var s=n.props,c=s.chatId,l=s.fileId;return n.state={prevChatId:c,prevFileId:l,currentIndex:0,hasNextMedia:!1,hasPreviousMedia:!1,deleteConfirmationOpened:!1},n}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props,n=a.chatId,r=a.messageId,i=this.state,o=i.currentFileId,s=i.hasPreviousMedia,c=i.hasNextMedia,l=i.firstSliceLoaded,u=i.totalCount,d=i.deleteConfirmationOpened;return e.chatId!==n||(e.messageId!==r||(t.currentFileId!==o||(t.hasPrevousMedia!==s||(t.hasNextMedia!==c||(t.firstSliceLoaded!==l||(t.totalCount!==u||t.deleteConfirmationOpened!==d))))))}},{key:"componentDidMount",value:function(){var e=this.props.chatId,t=Object(x.D)(e);Object(N.z)(e,[t]),this.loadHistory(t),Ya.add(this.keyboardHandler)}},{key:"componentWillUnmount",value:function(){Ya.remove(this.keyboardHandler)}},{key:"render",value:function(){var e=this.props,t=e.chatId,a=e.t,n=this.state,r=n.currentIndex,i=n.hasNextMedia,o=n.hasPreviousMedia,s=(n.firstSliceLoaded,n.totalCount),c=(n.deleteConfirmationOpened,n.deleteForAll,-1);s&&(c=r);var l=c>=0&&c<this.history.length,u=l&&0!==c?Object(_.a)(this.history[c]):Object(x.D)(t),p=l?this.history[c]:null,m=u.big;return d.a.createElement("div",{className:h()("media-viewer","media-viewer-default")},d.a.createElement("div",{className:"media-viewer-footer"},d.a.createElement(lu,{chatId:t,date:Object(_.b)(p)}),d.a.createElement(Kl,{title:a("AttachPhoto"),subtitle:s&&c>=0?"".concat(c+1," of ").concat(s):null}),d.a.createElement(Ql,{title:a("Save"),fileId:m.id,onClick:this.handleSave}),d.a.createElement(Ql,{title:a("Forward"),fileId:m.id,onClick:this.handleForward},d.a.createElement(As,null)),d.a.createElement(Jl,{title:a("Delete"),disabled:!0,onClick:this.handleDelete},d.a.createElement(Qa,null)),d.a.createElement(Jl,{title:a("Close"),onClick:this.handleClose},d.a.createElement(w.a,null))),d.a.createElement("div",{className:"media-viewer-wrapper",onClick:this.handlePrevious},d.a.createElement("div",{className:"media-viewer-left-column"},d.a.createElement(ql,{disabled:!i,grow:!0,onClick:this.handleNext},d.a.createElement(Hl,null))),d.a.createElement("div",{className:"media-viewer-content-column"},d.a.createElement(cu,{chatId:t,photo:u,onClick:this.handlePrevious})),d.a.createElement("div",{className:"media-viewer-right-column"},d.a.createElement(ql,{disabled:!o,grow:!0,onClick:this.handlePrevious},d.a.createElement(Hl,{style:{transform:"rotate(180deg)"}})))),null)}}]),a}(d.a.Component),du=Object(y.d)()(uu),pu=(a(201),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).onClientUpdatePageWidth=function(e){var t=e.isSmallWidth;n.setState({isSmallWidth:t})},n.onClientUpdateInstantViewContent=function(e){var t=e.content;n.setState({instantViewContent:t})},n.onClientUpdateOpenChat=function(e){var t=e.chatId,a=e.messageId,r=e.popup;n.handleSelectChat(t,a,r)},n.onClientUpdateOpenUser=function(e){var t=e.userId,a=e.popup;n.handleSelectUser(t,a)},n.onClientUpdateChatDetailsVisibility=function(e){var t=lt.a.isChatDetailsVisible;n.setState({isChatDetailsVisible:t})},n.onClientUpdateMediaViewerContent=function(e){var t=lt.a.mediaViewerContent;n.setState({mediaViewerContent:t})},n.onClientUpdateProfileMediaViewerContent=function(e){var t=lt.a.profileMediaViewerContent;n.setState({profileMediaViewerContent:t})},n.onClientUpdateForward=function(e){var t=e.info;n.setState({forwardInfo:t})},n.handleSelectChat=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=lt.a.getChatId(),i=lt.a.dialogChatId,o=lt.a.getMessageId();a?i!==e&&$.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:e}):r===e&&t&&o===t?(n.dialogDetailsRef.current.scrollToMessage(),t&&Object(Q.g)(e,t)):r!==e||t?$.a.setChatId(e,t):n.dialogDetailsRef.current.scrollToStart()},n.handleSelectUser=function(){var e=Object(i.a)(r.a.mark((function e(t,a){var i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,$.a.send({"@type":"createPrivateChat",user_id:t,force:!0});case 4:i=e.sent,n.handleSelectChat(i.id,null,a);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.dialogDetailsRef=d.a.createRef();var s=lt.a.isChatDetailsVisible,c=lt.a.mediaViewerContent,l=lt.a.profileMediaViewerContent,u=lt.a.isSmallWidth;return n.state={isChatDetailsVisible:s,mediaViewerContent:c,profileMediaViewerContent:l,isSmallWidth:u,forwardInfo:null,instantViewContent:null},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){T.a.on("clientUpdateOpenUser",this.onClientUpdateOpenUser),D.a.on("clientUpdateOpenChat",this.onClientUpdateOpenChat),lt.a.on("clientUpdateChatDetailsVisibility",this.onClientUpdateChatDetailsVisibility),lt.a.on("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent),lt.a.on("clientUpdatePageWidth",this.onClientUpdatePageWidth),lt.a.on("clientUpdateProfileMediaViewerContent",this.onClientUpdateProfileMediaViewerContent),lt.a.on("clientUpdateForward",this.onClientUpdateForward),eu.a.on("clientUpdateInstantViewContent",this.onClientUpdateInstantViewContent)}},{key:"componentWillUnmount",value:function(){T.a.off("clientUpdateOpenUser",this.onClientUpdateOpenUser),D.a.off("clientUpdateOpenChat",this.onClientUpdateOpenChat),lt.a.off("clientUpdateChatDetailsVisibility",this.onClientUpdateChatDetailsVisibility),lt.a.off("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent),lt.a.off("clientUpdatePageWidth",this.onClientUpdatePageWidth),lt.a.off("clientUpdateProfileMediaViewerContent",this.onClientUpdateProfileMediaViewerContent),lt.a.off("clientUpdateForward",this.onClientUpdateForward),eu.a.off("clientUpdateInstantViewContent",this.onClientUpdateInstantViewContent)}},{key:"render",value:function(){var e=this.state,t=e.instantViewContent,a=e.isChatDetailsVisible,n=e.mediaViewerContent,r=e.profileMediaViewerContent,i=e.forwardInfo,o=e.isSmallWidth;return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:h()("page",{"page-small":o,"page-third-column":a})},d.a.createElement(Ei,null),d.a.createElement(wc,{ref:this.dialogDetailsRef}),a&&d.a.createElement(pa,null)),t&&d.a.createElement(au,t),n&&d.a.createElement(su,n),r&&d.a.createElement(du,r),i&&d.a.createElement(te,i))}}]),a}(d.a.Component)),hu=Object(m.a)(f.a,b);t.default=hu(pu)}])]);
//# sourceMappingURL=4.887a3259.chunk.js.map