(this.webpackJsonptelegram_react=this.webpackJsonptelegram_react||[]).push([[8],{626:function(e,t,n){},628:function(e,t,n){},629:function(e,t,n){},630:function(e,t,n){},660:function(e,t,n){"use strict";n.r(t);var r=n(7),a=n.n(r),s=n(13),i=n(8),c=n(9),o=n(11),l=n(10),u=n(0),d=n.n(u),p=n(127),f=n.n(p),h=n(59),k=n(139),m=n.n(k),S=n(31),v=n(320),b=n(286),E=n(415),w=n(631),g=n(387),j=n(25),y=n(20),C=n(627),O=n.n(C),P=n(355),M=n(16),R=(n(626),function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"shouldComponentUpdate",value:function(e,t,n){var r=this.props,a=r.info;return r.theme!==e.theme||a!==e.info}},{key:"render",value:function(){var e=this.props,t=e.info,n=e.onSelect,r=e.onMouseDown,a=e.onMouseEnter,s=e.onDeleteClick;if(!t)return null;var i=t.title,c=t.stickers.map((function(e,t){return d.a.createElement("div",{className:"sticker-set-item",key:e.sticker.id,"data-sticker-id":e.sticker.id,onClick:function(){return n(e)},onMouseEnter:a,onMouseDown:r,style:{width:M.mb,height:M.mb}},d.a.createElement(P.b,{key:e.sticker.id,sticker:e,autoplay:!1,blur:!1,displaySize:M.mb-6,preview:!0,source:P.a.PICKER}))}));return d.a.createElement("div",{className:"sticker-set"},d.a.createElement("div",{className:"sticker-set-title"},d.a.createElement("div",{className:"sticker-set-title-wrapper"},d.a.createElement("span",null,i)),s&&d.a.createElement(b.a,{"aria-label":"delete",classes:{root:"sticker-set-icon-root"},size:"small",onClick:s},d.a.createElement(O.a,{fontSize:"inherit"}))),d.a.createElement("div",{className:"sticker-set-content"},c))}}]),n}(d.a.Component)),U=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(i.a)(this,e),this.start=function(){n.stopped=!1,n.id=requestAnimationFrame(n.startAnim)},this.startAnim=function(e){var t=n.start,r=n.duration;n.start=e,n.end=t+r,n.draw(e)},this.draw=function(t){var r=n.stopped,a=n.duration,s=n.start,i=n.options;if(t-s>a&&i.every((function(e){return e.to===e.last}))&&(n.stopped=!0),!r){var c=Math.min(t-s,a),o=0===a?1:c/a,l=e.outSine(o);i.forEach((function(e){var t=e.from,n=e.to,r=e.func;e.last=t+(n-t)*l,r(e.last)})),n.id=requestAnimationFrame(n.draw)}},this.stop=function(){n.stopped=!0,cancelAnimationFrame(n.id)},this.options=r,this.duration=t}return Object(c.a)(e,null,[{key:"outSine",value:function(e){return Math.sin(e*Math.PI/2)}}]),e}(),D=n(357),x=(n(628),function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).onClientUpdateStickerSetPosition=function(e){var t=e.position;r.setState({position:t})},r.scrollToPosition=function(){var e=r.state.position,t=Object(j.a)(r),n=t.animator,a=t.anchorRef,s=t.scrollRef.current,i=a.current,c=y.findDOMNode(i),o=s.scrollLeft,l=44*e-147,u=Number(c.style.left.replace("px","")),d=44*e;n&&n.stop(),r.animator=new U(0,[{from:o,to:l,func:function(e){return s.scrollLeft=e}},{from:Math.abs(d-u)>338?d-338*Math.sign(d-u):u,to:d,func:function(e){return c.style.left=e+"px"}}]),setTimeout((function(){r.animator&&r.animator.start()}),0)},r.handleWheel=function(e){var t=Object(j.a)(r).scrollRef;0===e.deltaX&&(t.current.scrollLeft+=e.deltaY)},r.handleSelect=function(e){var t=r.props,n=t.stickers;(0,t.onSelect)(n.indexOf(e))},r.scrollRef=d.a.createRef(),r.anchorRef=d.a.createRef(),r.state={position:0},r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){D.a.on("clientUpdateStickerSetPosition",this.onClientUpdateStickerSetPosition)}},{key:"componentWillUnmount",value:function(){D.a.off("clientUpdateStickerSetPosition",this.onClientUpdateStickerSetPosition)}},{key:"componentDidUpdate",value:function(e,t,n){t.position!==this.state.position&&this.scrollToPosition()}},{key:"render",value:function(){var e=this,t=this.props.stickers.map((function(t){return d.a.createElement(P.b,{key:t.sticker.id,className:"stickers-picker-header-sticker",style:{width:32,height:32},sticker:t,play:!1,autoplay:!1,blur:!1,displaySize:32,preview:!0,source:P.a.PICKER_HEADER,openMedia:function(){return e.handleSelect(t)}})}));return d.a.createElement("div",{className:"stickers-picker-header"},d.a.createElement("div",{ref:this.scrollRef,className:"stickers-picker-header-scroll",onWheel:this.handleWheel},d.a.createElement("div",{className:"stickers-picker-header-items"},t),d.a.createElement("div",{ref:this.anchorRef,className:"stickers-picker-header-anchor"})))}}]),n}(d.a.Component)),T=n(22),I=n(337),N=n(343),L=n(336),_=n(2),V=(n(629),function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).onUpdateInstalledStickerSets=function(e){var t=e.is_masks;e.sticker_set_ids;t&&r.filterSets()},r.onUpdateRecentStickers=function(e){r.reloadRecentContent()},r.scrollTop=function(){r.scrollRef.current.scrollTop=0},r.loadContent=function(){var e=Object(s.a)(a.a.mark((function e(t,n,s){var i,c,o,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=4;break}return e.next=3,_.a.send({"@type":"getRecentStickers",is_attached:!1});case 3:t=e.sent;case 4:if(s){e.next=13;break}return e.next=7,_.a.send({"@type":"getInstalledStickerSets",is_masks:!1});case 7:return i=e.sent,c=[],i.sets.forEach((function(e){c.push(_.a.send({"@type":"getStickerSet",set_id:e.id}))})),e.next=12,Promise.all(c);case 12:s=e.sent;case 13:o=s.slice(0,5),l=s.reduce((function(e,t){return t.stickers.length>0&&e.push(t.stickers[0]),e}),[]),r.setState({recent:t,stickerSets:n,sets:o,fullSets:s,headerStickers:l}),r.setsLength=o.length;case 17:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),r.loadInViewContentOnScroll=function(){r.loadInViewContent()},r.loadInViewContentOnScrollEnd=function(){r.loadInViewContent(400)},r.loadInViewContent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=r.scrollRef.current,n=r.state.sets,a=[];n.forEach((function(n){var s=r.itemsMap.get(n.id),i=y.findDOMNode(s);if(i){var c=t.scrollTop-e,o=t.scrollTop+t.offsetHeight+e,l=i.offsetTop,u=i.offsetTop+i.clientHeight;(l>=c&&i.offsetTop<=o||u>=c&&u<=o||l<=c&&u>=o)&&a.push(n)}})),a.forEach((function(e){var t=L.a.getStore();r.loadedSets.has(e.id)||(r.loadedSets.set(e.id,e.id),Object(I.C)(t,e))}))},r.updatePosition=function(){var e=r.scrollRef.current,t=r.state.sets,n=e.scrollHeight,a=0,s=0;t.forEach((function(t,i){var c=r.itemsMap.get(t.id);if(c){var o=y.findDOMNode(c);if(o){s=0===i?o.offsetTop:s;var l=o.offsetTop-s;if(o&&l<=e.scrollTop){var u=Math.abs(e.scrollTop-l);u<=n&&(n=u,a=i)}}}})),_.a.clientUpdate({"@type":"clientUpdateStickerSetPosition",position:a})},r.handleScroll=Object(s.a)(a.a.mark((function e(){var t,n,s,i,c,o,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.loadInViewContentOnScrollEnd(),r.updatePosition(),t=r.scrollRef.current,!r.loadingChunk){e.next=5;break}return e.abrupt("return");case 5:if(n=!1,t.scrollTop+t.offsetHeight>=t.scrollHeight-400&&(n=!0),n){e.next=9;break}return e.abrupt("return",!1);case 9:if(s=r.state,i=s.sets,(c=s.stickerSets).sets.length!==i.length){e.next=12;break}return e.abrupt("return");case 12:return r.loadingChunk=!0,o=[],c.sets.slice(r.setsLength,r.setsLength+5).forEach((function(e){o.push(_.a.send({"@type":"getStickerSet",set_id:e.id}))})),e.next=17,Promise.all(o).finally((function(){r.loadingChunk=!1}));case 17:l=e.sent,r.setsLength+=l.length,r.setState({sets:i.concat(l)});case 20:case"end":return e.stop()}}),e)}))),r.loadPreviewContent=function(e){var t=r.state,n=t.recent,a=t.sets,s=Object(N.j)([n].concat(a)).find((function(t){return t.sticker.id===e}));if(s){var i=L.a.getStore();Object(I.B)(i,s,null);Object(N.i)(s,a,5).forEach((function(e){Object(I.B)(i,e,null)}))}},r.handleMouseEnter=function(e){var t=Number(e.currentTarget.dataset.stickerId);if(t&&r.mouseDown){r.mouseDownStickerId!==t&&(r.mouseDownStickerId=null),r.setState({previewStickerId:t}),r.loadPreviewContent(t);var n=r.props.onPreview,a=r.state,s=a.recent,i=a.sets;n(Object(N.j)([s].concat(i)).find((function(e){return e.sticker.id===t})))}},r.handleMouseDown=function(e){var t=Number(e.currentTarget.dataset.stickerId);if(t){r.mouseDownStickerId=t;var n=Date.now();return r.setState({previewStickerId:t,timestamp:n,showPreview:!1,cancelSend:!1}),setTimeout((function(){r.state.timestamp===n&&r.setState({showPreview:!0,cancelSend:!0},(function(){var e=r.props.onPreview,n=r.state,a=n.recent,s=n.sets;e(Object(N.j)([a].concat(s)).find((function(e){return e.sticker.id===t})))}))}),500),r.loadPreviewContent(t),r.mouseDown=!0,document.addEventListener("mouseup",r.handleMouseUp),e.preventDefault(),e.stopPropagation(),!1}},r.handleMouseUp=function(){r.setState({previewStickerId:0,timestamp:0,showPreview:!1}),(0,r.props.onPreview)(null),r.mouseDown=!1,document.removeEventListener("mouseup",r.handleMouseUp)},r.handleStickerSelect=function(e){var t=r.props.onSelect;r.state.cancelSend||t(e)},r.handleSelectSet=function(){var e=Object(s.a)(a.a.mark((function e(t){var n,s,i,c,o,l,u,d,p,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.state,s=n.sets,i=n.stickerSets,c=Object(j.a)(r),o=c.scrollRef,!(t<s.length)){e.next=7;break}(l=r.itemsMap.get(s[t].id))&&(u=y.findDOMNode(l))&&(o.current.scrollTop=u.offsetTop),e.next=21;break;case 7:if(!(t<i.sets.length)){e.next=21;break}if(!r.loadingChunk){e.next=10;break}return e.abrupt("return");case 10:if(i.sets.length!==s.length){e.next=12;break}return e.abrupt("return");case 12:return r.loadingChunk=!0,d=[],i.sets.slice(r.setsLength,t+1).forEach((function(e){d.push(_.a.send({"@type":"getStickerSet",set_id:e.id}))})),e.next=17,Promise.all(d).finally((function(){return r.loadingChunk=!1}));case 17:p=e.sent,r.setsLength+=p.length,f=s.concat(p),r.setState({sets:f},(function(){t<f.length&&r.handleSelectSet(t)}));case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.handleDeleteRecent=function(){_.a.send({"@type":"clearRecentStickers",is_attached:!1})},r.handleDeleteStickerSet=function(e){_.a.send({"@type":"changeStickerSet",set_id:e,is_installed:!1})},r.scrollRef=d.a.createRef(),r.itemsMap=new Map,r.loadedSets=new Map,r.state={recent:null,stickerSets:null,sets:[],headerStickers:[],position:0},r.loadInViewContentOnScrollEnd=Object(T.d)(r.loadInViewContentOnScrollEnd,100),r.loadInViewContentOnScroll=Object(T.z)(r.loadInViewContentOnScroll,2e3),r.updatePosition=Object(T.z)(r.updatePosition,250),r}return Object(c.a)(n,[{key:"shouldComponentUpdate",value:function(e,t,n){var r=this.state,a=r.position,s=r.recent,i=r.stickerSets,c=r.sets,o=r.showPreview;return t.recent!==s||(t.stickerSets!==i||(t.sets!==c||(t.showPreview!==o||t.position!==a)))}},{key:"componentDidMount",value:function(){D.a.on("updateInstalledStickerSets",this.onUpdateInstalledStickerSets),D.a.on("updateRecentStickers",this.onUpdateRecentStickers)}},{key:"componentWillUnmount",value:function(){D.a.off("updateInstalledStickerSets",this.onUpdateInstalledStickerSets),D.a.off("updateRecentStickers",this.onUpdateRecentStickers)}},{key:"filterSets",value:function(e){var t=this.state;t.sets,t.stickerSets}},{key:"reloadRecentContent",value:function(){var e=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.a.send({"@type":"getRecentStickers",is_attached:!1});case 2:t=e.sent,this.setState({recent:t});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.t,n=this.state,r=n.recent,a=(n.stickerSets,n.sets),s=n.headerStickers;this.itemsMap.clear();var i=a.map((function(t){return d.a.createElement(R,{key:t.id,ref:function(n){return e.itemsMap.set(t.id,n)},info:t,onSelect:e.handleStickerSelect,onMouseDown:e.handleMouseDown,onMouseEnter:e.handleMouseEnter})})),c=r&&r.stickers.length>0?{stickers:r.stickers,title:t("RecentStickers")}:null;return d.a.createElement("div",{className:"stickers-picker"},d.a.createElement(x,{onSelect:this.handleSelectSet,stickers:s}),d.a.createElement("div",{ref:this.scrollRef,className:"stickers-picker-scroll",onScroll:this.handleScroll},Boolean(c)&&d.a.createElement(R,{info:c,onSelect:this.handleStickerSelect,onMouseDown:this.handleMouseDown,onMouseEnter:this.handleMouseEnter,onDeleteClick:this.handleDeleteRecent}),i))}}]),n}(d.a.Component)),A=Object(h.a)(Object(h.d)(),Object(S.d)(),Object(h.c)())(V),B=n(14),F=n(66),z=(n(630),function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).onClientUpdateChange=function(e){r.picker=null},r.handleButtonMouseEnter=function(e){r.buttonEnter=!0,setTimeout((function(){r.buttonEnter&&(r.updatePicker(!0),r.loadStickerSets())}),M.e)},r.loadStickerSets=Object(s.a)(a.a.mark((function e(){var t,n,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.sets){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,_.a.send({"@type":"getRecentStickers",is_attached:!1});case 4:return r.recent=e.sent,e.next=7,_.a.send({"@type":"getInstalledStickerSets",is_masks:!1});case 7:return r.stickerSets=e.sent,t=[],r.stickerSets.sets.forEach((function(e){t.push(_.a.send({"@type":"getStickerSet",set_id:e.id}))})),e.next=12,Promise.all(t);case 12:r.sets=e.sent,n=r.stickersPickerRef.current,s=L.a.getStore(),Object(I.A)(s,r.recent),r.sets.slice(0,5).reverse().forEach((function(e){Object(I.C)(s,e),n.loadedSets.set(e.id,e.id)})),r.sets.reduce((function(e,t){return t.stickers.length>0&&e.push(t.stickers[0]),e}),[]).forEach((function(e){Object(I.D)(s,e)}));case 20:case"end":return e.stop()}}),e)}))),r.handleButtonMouseLeave=function(){r.buttonEnter=!1,setTimeout((function(){r.tryClosePicker()}),M.e)},r.tryClosePicker=function(){var e=r.state.sticker;r.paperEnter||r.buttonEnter||e||r.updatePicker(!1)},r.handlePaperMouseEnter=function(){r.paperEnter=!0},r.handlePaperMouseLeave=function(){r.paperEnter=!1,setTimeout((function(){r.tryClosePicker()}),M.e)},r.updatePicker=function(e){r.setState({open:e})},r.handleEmojiClick=function(){r.setState({tab:0})},r.handleStickersClick=function(){var e=r.stickersPickerRef.current,t=r.state.tab;e.loadContent(r.recent,r.stickerSets,r.sets),r.setState({tab:1}),1===t&&e.scrollTop()},r.handleStickerSend=function(e){e&&(_.a.clientUpdate({"@type":"clientUpdateStickerSend",sticker:e}),r.updatePicker(!1))},r.handleStickerPreview=function(e){r.setState({sticker:e}),_.a.clientUpdate({"@type":"clientUpdateStickerPreview",sticker:e}),e||r.tryClosePicker()},r.state={open:!1,tab:0},r.emojiPickerRef=d.a.createRef(),r.stickersPickerRef=d.a.createRef(),r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){B.a.on("clientUpdateThemeChange",this.onClientUpdateChange),F.a.on("clientUpdateLanguageChange",this.onClientUpdateChange)}},{key:"componentWillUnmount",value:function(){B.a.off("clientUpdateThemeChange",this.onClientUpdateChange),F.a.off("clientUpdateLanguageChange",this.onClientUpdateChange)}},{key:"render",value:function(){var e=this.props,t=e.theme,n=e.t,r=this.state,a=r.open,s=r.tab,i=r.sticker;if(a&&!this.picker){var c={search:n("Search"),notfound:n("NotEmojiFound"),skintext:n("ChooseDefaultSkinTone"),categories:{search:n("SearchResults"),recent:n("Recent"),people:n("SmileysPeople"),nature:n("AnimalsNature"),foods:n("FoodDrink"),activity:n("Activity"),places:n("TravelPlaces"),objects:n("Objects"),symbols:n("Symbols"),flags:n("Flags"),custom:n("Custom")}};this.picker=d.a.createElement(w.a,{ref:this.emojiPickerRef,set:"apple",showPreview:!1,showSkinTones:!1,onSelect:this.props.onSelect,color:t.palette.primary.dark,i18n:c,native:Object(T.q)(),style:{width:338,overflowX:"hidden"}}),this.stickersPicker=d.a.createElement(A,{ref:this.stickersPickerRef,onSelect:this.handleStickerSend,onPreview:this.handleStickerPreview})}return d.a.createElement(d.a.Fragment,null,d.a.createElement("link",{rel:"stylesheet",type:"text/css",href:"dark"===t.palette.type?"emoji-mart.dark.css":"emoji-mart.light.css"}),d.a.createElement(b.a,{className:"inputbox-icon-button","aria-label":"Emoticon",onMouseEnter:this.handleButtonMouseEnter,onMouseLeave:this.handleButtonMouseLeave},d.a.createElement(E.a,null)),d.a.createElement("div",{className:f()("emoji-picker-root",{"emoji-picker-root-opened":a}),onMouseEnter:this.handlePaperMouseEnter,onMouseLeave:this.handlePaperMouseLeave},d.a.createElement("div",{className:"emoji-picker-header"},d.a.createElement(v.a,{color:0===s?"primary":"default",className:"emoji-picker-header-button",onClick:this.handleEmojiClick},n("Emoji")),d.a.createElement(v.a,{color:1===s?"primary":"default",className:"emoji-picker-header-button",onClick:this.handleStickersClick},n("Stickers"))),d.a.createElement("div",{className:f()("emoji-picker-content",{"emoji-picker-content-stickers":1===s})},this.picker,this.stickersPicker),Boolean(i)&&d.a.createElement(g.a,{sticker:i})))}}]),n}(d.a.Component)),H=Object(h.a)(Object(S.d)(),m.a);t.default=H(z)}}]);
//# sourceMappingURL=8.9c36f98d.chunk.js.map